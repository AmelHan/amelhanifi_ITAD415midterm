<html>
<head>
<title>test_orthogonal.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6897bb;}
.s3 { color: #6a8759;}
.s4 { color: #808080;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_orthogonal.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">from </span><span class="s1">numpy </span><span class="s0">import </span><span class="s1">array</span><span class="s0">, </span><span class="s1">sqrt</span>
<span class="s0">from </span><span class="s1">numpy.testing </span><span class="s0">import </span><span class="s1">(assert_array_almost_equal</span><span class="s0">, </span><span class="s1">assert_equal</span><span class="s0">,</span>
                           <span class="s1">assert_almost_equal</span><span class="s0">, </span><span class="s1">assert_allclose)</span>
<span class="s0">from </span><span class="s1">pytest </span><span class="s0">import </span><span class="s1">raises </span><span class="s0">as </span><span class="s1">assert_raises</span>

<span class="s0">from </span><span class="s1">scipy </span><span class="s0">import </span><span class="s1">integrate</span>
<span class="s0">import </span><span class="s1">scipy.special </span><span class="s0">as </span><span class="s1">sc</span>
<span class="s0">from </span><span class="s1">scipy.special </span><span class="s0">import </span><span class="s1">gamma</span>
<span class="s0">import </span><span class="s1">scipy.special._orthogonal </span><span class="s0">as </span><span class="s1">orth</span>


<span class="s0">class </span><span class="s1">TestCheby:</span>
    <span class="s0">def </span><span class="s1">test_chebyc(self):</span>
        <span class="s1">C0 = orth.chebyc(</span><span class="s2">0</span><span class="s1">)</span>
        <span class="s1">C1 = orth.chebyc(</span><span class="s2">1</span><span class="s1">)</span>
        <span class="s0">with </span><span class="s1">np.errstate(all=</span><span class="s3">'ignore'</span><span class="s1">):</span>
            <span class="s1">C2 = orth.chebyc(</span><span class="s2">2</span><span class="s1">)</span>
            <span class="s1">C3 = orth.chebyc(</span><span class="s2">3</span><span class="s1">)</span>
            <span class="s1">C4 = orth.chebyc(</span><span class="s2">4</span><span class="s1">)</span>
            <span class="s1">C5 = orth.chebyc(</span><span class="s2">5</span><span class="s1">)</span>

        <span class="s1">assert_array_almost_equal(C0.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">2</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(C1.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">1</span><span class="s0">,</span><span class="s2">0</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(C2.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">1</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s1">-</span><span class="s2">2</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(C3.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">1</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s1">-</span><span class="s2">3</span><span class="s0">,</span><span class="s2">0</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(C4.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">1</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s1">-</span><span class="s2">4</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s2">2</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(C5.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">1</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s1">-</span><span class="s2">5</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s2">5</span><span class="s0">,</span><span class="s2">0</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_chebys(self):</span>
        <span class="s1">S0 = orth.chebys(</span><span class="s2">0</span><span class="s1">)</span>
        <span class="s1">S1 = orth.chebys(</span><span class="s2">1</span><span class="s1">)</span>
        <span class="s1">S2 = orth.chebys(</span><span class="s2">2</span><span class="s1">)</span>
        <span class="s1">S3 = orth.chebys(</span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">S4 = orth.chebys(</span><span class="s2">4</span><span class="s1">)</span>
        <span class="s1">S5 = orth.chebys(</span><span class="s2">5</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(S0.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">1</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(S1.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">1</span><span class="s0">,</span><span class="s2">0</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(S2.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">1</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s1">-</span><span class="s2">1</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(S3.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">1</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s1">-</span><span class="s2">2</span><span class="s0">,</span><span class="s2">0</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(S4.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">1</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s1">-</span><span class="s2">3</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s2">1</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(S5.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">1</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s1">-</span><span class="s2">4</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s2">3</span><span class="s0">,</span><span class="s2">0</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_chebyt(self):</span>
        <span class="s1">T0 = orth.chebyt(</span><span class="s2">0</span><span class="s1">)</span>
        <span class="s1">T1 = orth.chebyt(</span><span class="s2">1</span><span class="s1">)</span>
        <span class="s1">T2 = orth.chebyt(</span><span class="s2">2</span><span class="s1">)</span>
        <span class="s1">T3 = orth.chebyt(</span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">T4 = orth.chebyt(</span><span class="s2">4</span><span class="s1">)</span>
        <span class="s1">T5 = orth.chebyt(</span><span class="s2">5</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(T0.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">1</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(T1.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">1</span><span class="s0">,</span><span class="s2">0</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(T2.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">2</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s1">-</span><span class="s2">1</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(T3.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">4</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s1">-</span><span class="s2">3</span><span class="s0">,</span><span class="s2">0</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(T4.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">8</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s1">-</span><span class="s2">8</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s2">1</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(T5.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">16</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s1">-</span><span class="s2">20</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s2">5</span><span class="s0">,</span><span class="s2">0</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_chebyu(self):</span>
        <span class="s1">U0 = orth.chebyu(</span><span class="s2">0</span><span class="s1">)</span>
        <span class="s1">U1 = orth.chebyu(</span><span class="s2">1</span><span class="s1">)</span>
        <span class="s1">U2 = orth.chebyu(</span><span class="s2">2</span><span class="s1">)</span>
        <span class="s1">U3 = orth.chebyu(</span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">U4 = orth.chebyu(</span><span class="s2">4</span><span class="s1">)</span>
        <span class="s1">U5 = orth.chebyu(</span><span class="s2">5</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(U0.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">1</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(U1.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">2</span><span class="s0">,</span><span class="s2">0</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(U2.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">4</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s1">-</span><span class="s2">1</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(U3.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">8</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s1">-</span><span class="s2">4</span><span class="s0">,</span><span class="s2">0</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(U4.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">16</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s1">-</span><span class="s2">12</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s2">1</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(U5.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">32</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s1">-</span><span class="s2">32</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s2">6</span><span class="s0">,</span><span class="s2">0</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>


<span class="s0">class </span><span class="s1">TestGegenbauer:</span>

    <span class="s0">def </span><span class="s1">test_gegenbauer(self):</span>
        <span class="s1">a = </span><span class="s2">5</span><span class="s1">*np.random.random() - </span><span class="s2">0.5</span>
        <span class="s0">if </span><span class="s1">np.any(a == </span><span class="s2">0</span><span class="s1">):</span>
            <span class="s1">a = -</span><span class="s2">0.2</span>
        <span class="s1">Ca0 = orth.gegenbauer(</span><span class="s2">0</span><span class="s0">,</span><span class="s1">a)</span>
        <span class="s1">Ca1 = orth.gegenbauer(</span><span class="s2">1</span><span class="s0">,</span><span class="s1">a)</span>
        <span class="s1">Ca2 = orth.gegenbauer(</span><span class="s2">2</span><span class="s0">,</span><span class="s1">a)</span>
        <span class="s1">Ca3 = orth.gegenbauer(</span><span class="s2">3</span><span class="s0">,</span><span class="s1">a)</span>
        <span class="s1">Ca4 = orth.gegenbauer(</span><span class="s2">4</span><span class="s0">,</span><span class="s1">a)</span>
        <span class="s1">Ca5 = orth.gegenbauer(</span><span class="s2">5</span><span class="s0">,</span><span class="s1">a)</span>

        <span class="s1">assert_array_almost_equal(Ca0.c</span><span class="s0">,</span><span class="s1">array([</span><span class="s2">1</span><span class="s1">])</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(Ca1.c</span><span class="s0">,</span><span class="s1">array([</span><span class="s2">2</span><span class="s1">*a</span><span class="s0">,</span><span class="s2">0</span><span class="s1">])</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(Ca2.c</span><span class="s0">,</span><span class="s1">array([</span><span class="s2">2</span><span class="s1">*a*(a+</span><span class="s2">1</span><span class="s1">)</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s1">-a])</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(Ca3.c</span><span class="s0">,</span><span class="s1">array([</span><span class="s2">4</span><span class="s1">*sc.poch(a</span><span class="s0">,</span><span class="s2">3</span><span class="s1">)</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s1">-</span><span class="s2">6</span><span class="s1">*a*(a+</span><span class="s2">1</span><span class="s1">)</span><span class="s0">,</span>
                                               <span class="s2">0</span><span class="s1">])/</span><span class="s2">3.0</span><span class="s0">,</span><span class="s2">11</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(Ca4.c</span><span class="s0">,</span><span class="s1">array([</span><span class="s2">4</span><span class="s1">*sc.poch(a</span><span class="s0">,</span><span class="s2">4</span><span class="s1">)</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s1">-</span><span class="s2">12</span><span class="s1">*sc.poch(a</span><span class="s0">,</span><span class="s2">3</span><span class="s1">)</span><span class="s0">,</span>
                                               <span class="s2">0</span><span class="s0">,</span><span class="s2">3</span><span class="s1">*a*(a+</span><span class="s2">1</span><span class="s1">)])/</span><span class="s2">6.0</span><span class="s0">,</span><span class="s2">11</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(Ca5.c</span><span class="s0">,</span><span class="s1">array([</span><span class="s2">4</span><span class="s1">*sc.poch(a</span><span class="s0">,</span><span class="s2">5</span><span class="s1">)</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s1">-</span><span class="s2">20</span><span class="s1">*sc.poch(a</span><span class="s0">,</span><span class="s2">4</span><span class="s1">)</span><span class="s0">,</span>
                                               <span class="s2">0</span><span class="s0">,</span><span class="s2">15</span><span class="s1">*sc.poch(a</span><span class="s0">,</span><span class="s2">3</span><span class="s1">)</span><span class="s0">,</span><span class="s2">0</span><span class="s1">])/</span><span class="s2">15.0</span><span class="s0">,</span><span class="s2">11</span><span class="s1">)</span>


<span class="s0">class </span><span class="s1">TestHermite:</span>
    <span class="s0">def </span><span class="s1">test_hermite(self):</span>
        <span class="s1">H0 = orth.hermite(</span><span class="s2">0</span><span class="s1">)</span>
        <span class="s1">H1 = orth.hermite(</span><span class="s2">1</span><span class="s1">)</span>
        <span class="s1">H2 = orth.hermite(</span><span class="s2">2</span><span class="s1">)</span>
        <span class="s1">H3 = orth.hermite(</span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">H4 = orth.hermite(</span><span class="s2">4</span><span class="s1">)</span>
        <span class="s1">H5 = orth.hermite(</span><span class="s2">5</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(H0.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">1</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(H1.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">2</span><span class="s0">,</span><span class="s2">0</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(H2.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">4</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s1">-</span><span class="s2">2</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(H3.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">8</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s1">-</span><span class="s2">12</span><span class="s0">,</span><span class="s2">0</span><span class="s1">]</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(H4.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">16</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s1">-</span><span class="s2">48</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s2">12</span><span class="s1">]</span><span class="s0">,</span><span class="s2">12</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(H5.c</span><span class="s0">,</span><span class="s1">[</span><span class="s2">32</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s1">-</span><span class="s2">160</span><span class="s0">,</span><span class="s2">0</span><span class="s0">,</span><span class="s2">120</span><span class="s0">,</span><span class="s2">0</span><span class="s1">]</span><span class="s0">,</span><span class="s2">12</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_hermitenorm(self):</span>
        <span class="s4"># He_n(x) = 2**(-n/2) H_n(x/sqrt(2))</span>
        <span class="s1">psub = np.poly1d([</span><span class="s2">1.0</span><span class="s1">/sqrt(</span><span class="s2">2</span><span class="s1">)</span><span class="s0">,</span><span class="s2">0</span><span class="s1">])</span>
        <span class="s1">H0 = orth.hermitenorm(</span><span class="s2">0</span><span class="s1">)</span>
        <span class="s1">H1 = orth.hermitenorm(</span><span class="s2">1</span><span class="s1">)</span>
        <span class="s1">H2 = orth.hermitenorm(</span><span class="s2">2</span><span class="s1">)</span>
        <span class="s1">H3 = orth.hermitenorm(</span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">H4 = orth.hermitenorm(</span><span class="s2">4</span><span class="s1">)</span>
        <span class="s1">H5 = orth.hermitenorm(</span><span class="s2">5</span><span class="s1">)</span>
        <span class="s1">he0 = orth.hermite(</span><span class="s2">0</span><span class="s1">)(psub)</span>
        <span class="s1">he1 = orth.hermite(</span><span class="s2">1</span><span class="s1">)(psub) / sqrt(</span><span class="s2">2</span><span class="s1">)</span>
        <span class="s1">he2 = orth.hermite(</span><span class="s2">2</span><span class="s1">)(psub) / </span><span class="s2">2.0</span>
        <span class="s1">he3 = orth.hermite(</span><span class="s2">3</span><span class="s1">)(psub) / (</span><span class="s2">2</span><span class="s1">*sqrt(</span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">he4 = orth.hermite(</span><span class="s2">4</span><span class="s1">)(psub) / </span><span class="s2">4.0</span>
        <span class="s1">he5 = orth.hermite(</span><span class="s2">5</span><span class="s1">)(psub) / (</span><span class="s2">4.0</span><span class="s1">*sqrt(</span><span class="s2">2</span><span class="s1">))</span>

        <span class="s1">assert_array_almost_equal(H0.c</span><span class="s0">,</span><span class="s1">he0.c</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(H1.c</span><span class="s0">,</span><span class="s1">he1.c</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(H2.c</span><span class="s0">,</span><span class="s1">he2.c</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(H3.c</span><span class="s0">,</span><span class="s1">he3.c</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(H4.c</span><span class="s0">,</span><span class="s1">he4.c</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(H5.c</span><span class="s0">,</span><span class="s1">he5.c</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>


<span class="s0">class </span><span class="s1">TestShLegendre:</span>
    <span class="s0">def </span><span class="s1">test_sh_legendre(self):</span>
        <span class="s4"># P*_n(x) = P_n(2x-1)</span>
        <span class="s1">psub = np.poly1d([</span><span class="s2">2</span><span class="s0">,</span><span class="s1">-</span><span class="s2">1</span><span class="s1">])</span>
        <span class="s1">Ps0 = orth.sh_legendre(</span><span class="s2">0</span><span class="s1">)</span>
        <span class="s1">Ps1 = orth.sh_legendre(</span><span class="s2">1</span><span class="s1">)</span>
        <span class="s1">Ps2 = orth.sh_legendre(</span><span class="s2">2</span><span class="s1">)</span>
        <span class="s1">Ps3 = orth.sh_legendre(</span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">Ps4 = orth.sh_legendre(</span><span class="s2">4</span><span class="s1">)</span>
        <span class="s1">Ps5 = orth.sh_legendre(</span><span class="s2">5</span><span class="s1">)</span>
        <span class="s1">pse0 = orth.legendre(</span><span class="s2">0</span><span class="s1">)(psub)</span>
        <span class="s1">pse1 = orth.legendre(</span><span class="s2">1</span><span class="s1">)(psub)</span>
        <span class="s1">pse2 = orth.legendre(</span><span class="s2">2</span><span class="s1">)(psub)</span>
        <span class="s1">pse3 = orth.legendre(</span><span class="s2">3</span><span class="s1">)(psub)</span>
        <span class="s1">pse4 = orth.legendre(</span><span class="s2">4</span><span class="s1">)(psub)</span>
        <span class="s1">pse5 = orth.legendre(</span><span class="s2">5</span><span class="s1">)(psub)</span>
        <span class="s1">assert_array_almost_equal(Ps0.c</span><span class="s0">,</span><span class="s1">pse0.c</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(Ps1.c</span><span class="s0">,</span><span class="s1">pse1.c</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(Ps2.c</span><span class="s0">,</span><span class="s1">pse2.c</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(Ps3.c</span><span class="s0">,</span><span class="s1">pse3.c</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(Ps4.c</span><span class="s0">,</span><span class="s1">pse4.c</span><span class="s0">,</span><span class="s2">12</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(Ps5.c</span><span class="s0">,</span><span class="s1">pse5.c</span><span class="s0">,</span><span class="s2">12</span><span class="s1">)</span>


<span class="s0">class </span><span class="s1">TestShChebyt:</span>
    <span class="s0">def </span><span class="s1">test_sh_chebyt(self):</span>
        <span class="s4"># T*_n(x) = T_n(2x-1)</span>
        <span class="s1">psub = np.poly1d([</span><span class="s2">2</span><span class="s0">,</span><span class="s1">-</span><span class="s2">1</span><span class="s1">])</span>
        <span class="s1">Ts0 = orth.sh_chebyt(</span><span class="s2">0</span><span class="s1">)</span>
        <span class="s1">Ts1 = orth.sh_chebyt(</span><span class="s2">1</span><span class="s1">)</span>
        <span class="s1">Ts2 = orth.sh_chebyt(</span><span class="s2">2</span><span class="s1">)</span>
        <span class="s1">Ts3 = orth.sh_chebyt(</span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">Ts4 = orth.sh_chebyt(</span><span class="s2">4</span><span class="s1">)</span>
        <span class="s1">Ts5 = orth.sh_chebyt(</span><span class="s2">5</span><span class="s1">)</span>
        <span class="s1">tse0 = orth.chebyt(</span><span class="s2">0</span><span class="s1">)(psub)</span>
        <span class="s1">tse1 = orth.chebyt(</span><span class="s2">1</span><span class="s1">)(psub)</span>
        <span class="s1">tse2 = orth.chebyt(</span><span class="s2">2</span><span class="s1">)(psub)</span>
        <span class="s1">tse3 = orth.chebyt(</span><span class="s2">3</span><span class="s1">)(psub)</span>
        <span class="s1">tse4 = orth.chebyt(</span><span class="s2">4</span><span class="s1">)(psub)</span>
        <span class="s1">tse5 = orth.chebyt(</span><span class="s2">5</span><span class="s1">)(psub)</span>
        <span class="s1">assert_array_almost_equal(Ts0.c</span><span class="s0">,</span><span class="s1">tse0.c</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(Ts1.c</span><span class="s0">,</span><span class="s1">tse1.c</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(Ts2.c</span><span class="s0">,</span><span class="s1">tse2.c</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(Ts3.c</span><span class="s0">,</span><span class="s1">tse3.c</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(Ts4.c</span><span class="s0">,</span><span class="s1">tse4.c</span><span class="s0">,</span><span class="s2">12</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(Ts5.c</span><span class="s0">,</span><span class="s1">tse5.c</span><span class="s0">,</span><span class="s2">12</span><span class="s1">)</span>


<span class="s0">class </span><span class="s1">TestShChebyu:</span>
    <span class="s0">def </span><span class="s1">test_sh_chebyu(self):</span>
        <span class="s4"># U*_n(x) = U_n(2x-1)</span>
        <span class="s1">psub = np.poly1d([</span><span class="s2">2</span><span class="s0">,</span><span class="s1">-</span><span class="s2">1</span><span class="s1">])</span>
        <span class="s1">Us0 = orth.sh_chebyu(</span><span class="s2">0</span><span class="s1">)</span>
        <span class="s1">Us1 = orth.sh_chebyu(</span><span class="s2">1</span><span class="s1">)</span>
        <span class="s1">Us2 = orth.sh_chebyu(</span><span class="s2">2</span><span class="s1">)</span>
        <span class="s1">Us3 = orth.sh_chebyu(</span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">Us4 = orth.sh_chebyu(</span><span class="s2">4</span><span class="s1">)</span>
        <span class="s1">Us5 = orth.sh_chebyu(</span><span class="s2">5</span><span class="s1">)</span>
        <span class="s1">use0 = orth.chebyu(</span><span class="s2">0</span><span class="s1">)(psub)</span>
        <span class="s1">use1 = orth.chebyu(</span><span class="s2">1</span><span class="s1">)(psub)</span>
        <span class="s1">use2 = orth.chebyu(</span><span class="s2">2</span><span class="s1">)(psub)</span>
        <span class="s1">use3 = orth.chebyu(</span><span class="s2">3</span><span class="s1">)(psub)</span>
        <span class="s1">use4 = orth.chebyu(</span><span class="s2">4</span><span class="s1">)(psub)</span>
        <span class="s1">use5 = orth.chebyu(</span><span class="s2">5</span><span class="s1">)(psub)</span>
        <span class="s1">assert_array_almost_equal(Us0.c</span><span class="s0">,</span><span class="s1">use0.c</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(Us1.c</span><span class="s0">,</span><span class="s1">use1.c</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(Us2.c</span><span class="s0">,</span><span class="s1">use2.c</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(Us3.c</span><span class="s0">,</span><span class="s1">use3.c</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(Us4.c</span><span class="s0">,</span><span class="s1">use4.c</span><span class="s0">,</span><span class="s2">12</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(Us5.c</span><span class="s0">,</span><span class="s1">use5.c</span><span class="s0">,</span><span class="s2">11</span><span class="s1">)</span>


<span class="s0">class </span><span class="s1">TestShJacobi:</span>
    <span class="s0">def </span><span class="s1">test_sh_jacobi(self):</span>
        <span class="s4"># G^(p,q)_n(x) = n! gamma(n+p)/gamma(2*n+p) * P^(p-q,q-1)_n(2*x-1)</span>
        <span class="s0">def </span><span class="s1">conv(n</span><span class="s0">, </span><span class="s1">p):</span>
            <span class="s0">return </span><span class="s1">gamma(n + </span><span class="s2">1</span><span class="s1">) * gamma(n + p) / gamma(</span><span class="s2">2 </span><span class="s1">* n + p)</span>
        <span class="s1">psub = np.poly1d([</span><span class="s2">2</span><span class="s0">,</span><span class="s1">-</span><span class="s2">1</span><span class="s1">])</span>
        <span class="s1">q = </span><span class="s2">4 </span><span class="s1">* np.random.random()</span>
        <span class="s1">p = q-</span><span class="s2">1 </span><span class="s1">+ </span><span class="s2">2</span><span class="s1">*np.random.random()</span>
        <span class="s4"># print(&quot;shifted jacobi p,q = &quot;, p, q)</span>
        <span class="s1">G0 = orth.sh_jacobi(</span><span class="s2">0</span><span class="s0">,</span><span class="s1">p</span><span class="s0">,</span><span class="s1">q)</span>
        <span class="s1">G1 = orth.sh_jacobi(</span><span class="s2">1</span><span class="s0">,</span><span class="s1">p</span><span class="s0">,</span><span class="s1">q)</span>
        <span class="s1">G2 = orth.sh_jacobi(</span><span class="s2">2</span><span class="s0">,</span><span class="s1">p</span><span class="s0">,</span><span class="s1">q)</span>
        <span class="s1">G3 = orth.sh_jacobi(</span><span class="s2">3</span><span class="s0">,</span><span class="s1">p</span><span class="s0">,</span><span class="s1">q)</span>
        <span class="s1">G4 = orth.sh_jacobi(</span><span class="s2">4</span><span class="s0">,</span><span class="s1">p</span><span class="s0">,</span><span class="s1">q)</span>
        <span class="s1">G5 = orth.sh_jacobi(</span><span class="s2">5</span><span class="s0">,</span><span class="s1">p</span><span class="s0">,</span><span class="s1">q)</span>
        <span class="s1">ge0 = orth.jacobi(</span><span class="s2">0</span><span class="s0">,</span><span class="s1">p-q</span><span class="s0">,</span><span class="s1">q-</span><span class="s2">1</span><span class="s1">)(psub) * conv(</span><span class="s2">0</span><span class="s0">,</span><span class="s1">p)</span>
        <span class="s1">ge1 = orth.jacobi(</span><span class="s2">1</span><span class="s0">,</span><span class="s1">p-q</span><span class="s0">,</span><span class="s1">q-</span><span class="s2">1</span><span class="s1">)(psub) * conv(</span><span class="s2">1</span><span class="s0">,</span><span class="s1">p)</span>
        <span class="s1">ge2 = orth.jacobi(</span><span class="s2">2</span><span class="s0">,</span><span class="s1">p-q</span><span class="s0">,</span><span class="s1">q-</span><span class="s2">1</span><span class="s1">)(psub) * conv(</span><span class="s2">2</span><span class="s0">,</span><span class="s1">p)</span>
        <span class="s1">ge3 = orth.jacobi(</span><span class="s2">3</span><span class="s0">,</span><span class="s1">p-q</span><span class="s0">,</span><span class="s1">q-</span><span class="s2">1</span><span class="s1">)(psub) * conv(</span><span class="s2">3</span><span class="s0">,</span><span class="s1">p)</span>
        <span class="s1">ge4 = orth.jacobi(</span><span class="s2">4</span><span class="s0">,</span><span class="s1">p-q</span><span class="s0">,</span><span class="s1">q-</span><span class="s2">1</span><span class="s1">)(psub) * conv(</span><span class="s2">4</span><span class="s0">,</span><span class="s1">p)</span>
        <span class="s1">ge5 = orth.jacobi(</span><span class="s2">5</span><span class="s0">,</span><span class="s1">p-q</span><span class="s0">,</span><span class="s1">q-</span><span class="s2">1</span><span class="s1">)(psub) * conv(</span><span class="s2">5</span><span class="s0">,</span><span class="s1">p)</span>

        <span class="s1">assert_array_almost_equal(G0.c</span><span class="s0">,</span><span class="s1">ge0.c</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(G1.c</span><span class="s0">,</span><span class="s1">ge1.c</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(G2.c</span><span class="s0">,</span><span class="s1">ge2.c</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(G3.c</span><span class="s0">,</span><span class="s1">ge3.c</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(G4.c</span><span class="s0">,</span><span class="s1">ge4.c</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(G5.c</span><span class="s0">,</span><span class="s1">ge5.c</span><span class="s0">,</span><span class="s2">13</span><span class="s1">)</span>


<span class="s0">class </span><span class="s1">TestCall:</span>
    <span class="s0">def </span><span class="s1">test_call(self):</span>
        <span class="s1">poly = []</span>
        <span class="s0">for </span><span class="s1">n </span><span class="s0">in </span><span class="s1">range(</span><span class="s2">5</span><span class="s1">):</span>
            <span class="s1">poly.extend([x.strip() </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in</span>
                <span class="s1">(</span><span class="s3">&quot;&quot;&quot; 
                orth.jacobi(%(n)d,0.3,0.9) 
                orth.sh_jacobi(%(n)d,0.3,0.9) 
                orth.genlaguerre(%(n)d,0.3) 
                orth.laguerre(%(n)d) 
                orth.hermite(%(n)d) 
                orth.hermitenorm(%(n)d) 
                orth.gegenbauer(%(n)d,0.3) 
                orth.chebyt(%(n)d) 
                orth.chebyu(%(n)d) 
                orth.chebyc(%(n)d) 
                orth.chebys(%(n)d) 
                orth.sh_chebyt(%(n)d) 
                orth.sh_chebyu(%(n)d) 
                orth.legendre(%(n)d) 
                orth.sh_legendre(%(n)d) 
                &quot;&quot;&quot; </span><span class="s1">% dict(n=n)).split()</span>
            <span class="s1">])</span>
        <span class="s0">with </span><span class="s1">np.errstate(all=</span><span class="s3">'ignore'</span><span class="s1">):</span>
            <span class="s0">for </span><span class="s1">pstr </span><span class="s0">in </span><span class="s1">poly:</span>
                <span class="s1">p = eval(pstr)</span>
                <span class="s1">assert_almost_equal(p(</span><span class="s2">0.315</span><span class="s1">)</span><span class="s0">, </span><span class="s1">np.poly1d(p.coef)(</span><span class="s2">0.315</span><span class="s1">)</span><span class="s0">,</span>
                                    <span class="s1">err_msg=pstr)</span>


<span class="s0">class </span><span class="s1">TestGenlaguerre:</span>
    <span class="s0">def </span><span class="s1">test_regression(self):</span>
        <span class="s1">assert_equal(orth.genlaguerre(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s1">monic=</span><span class="s0">False</span><span class="s1">)(</span><span class="s2">0</span><span class="s1">)</span><span class="s0">, </span><span class="s2">2.</span><span class="s1">)</span>
        <span class="s1">assert_equal(orth.genlaguerre(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s1">monic=</span><span class="s0">True</span><span class="s1">)(</span><span class="s2">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">2.</span><span class="s1">)</span>
        <span class="s1">assert_equal(orth.genlaguerre(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s1">monic=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">, </span><span class="s1">np.poly1d([-</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s1">]))</span>
        <span class="s1">assert_equal(orth.genlaguerre(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s1">monic=</span><span class="s0">True</span><span class="s1">)</span><span class="s0">, </span><span class="s1">np.poly1d([</span><span class="s2">1</span><span class="s0">, </span><span class="s1">-</span><span class="s2">2</span><span class="s1">]))</span>


<span class="s0">def </span><span class="s1">verify_gauss_quad(root_func</span><span class="s0">, </span><span class="s1">eval_func</span><span class="s0">, </span><span class="s1">weight_func</span><span class="s0">, </span><span class="s1">a</span><span class="s0">, </span><span class="s1">b</span><span class="s0">, </span><span class="s1">N</span><span class="s0">,</span>
                      <span class="s1">rtol=</span><span class="s2">1e-15</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">5e-14</span><span class="s1">):</span>
    <span class="s4"># this test is copied from numpy's TestGauss in test_hermite.py</span>
    <span class="s1">x</span><span class="s0">, </span><span class="s1">w</span><span class="s0">, </span><span class="s1">mu = root_func(N</span><span class="s0">, True</span><span class="s1">)</span>

    <span class="s1">n = np.arange(N)</span>
    <span class="s1">v = eval_func(n[:</span><span class="s0">,</span><span class="s1">np.newaxis]</span><span class="s0">, </span><span class="s1">x)</span>
    <span class="s1">vv = np.dot(v*w</span><span class="s0">, </span><span class="s1">v.T)</span>
    <span class="s1">vd = </span><span class="s2">1 </span><span class="s1">/ np.sqrt(vv.diagonal())</span>
    <span class="s1">vv = vd[:</span><span class="s0">, </span><span class="s1">np.newaxis] * vv * vd</span>
    <span class="s1">assert_allclose(vv</span><span class="s0">, </span><span class="s1">np.eye(N)</span><span class="s0">, </span><span class="s1">rtol</span><span class="s0">, </span><span class="s1">atol)</span>

    <span class="s4"># check that the integral of 1 is correct</span>
    <span class="s1">assert_allclose(w.sum()</span><span class="s0">, </span><span class="s1">mu</span><span class="s0">, </span><span class="s1">rtol</span><span class="s0">, </span><span class="s1">atol)</span>

    <span class="s4"># compare the results of integrating a function with quad.</span>
    <span class="s0">def </span><span class="s1">f(x):</span>
        <span class="s0">return </span><span class="s1">x ** </span><span class="s2">3 </span><span class="s1">- </span><span class="s2">3 </span><span class="s1">* x ** </span><span class="s2">2 </span><span class="s1">+ x - </span><span class="s2">2</span>
    <span class="s1">resI = integrate.quad(</span><span class="s0">lambda </span><span class="s1">x: f(x)*weight_func(x)</span><span class="s0">, </span><span class="s1">a</span><span class="s0">, </span><span class="s1">b)</span>
    <span class="s1">resG = np.vdot(f(x)</span><span class="s0">, </span><span class="s1">w)</span>
    <span class="s1">rtol = </span><span class="s2">1e-6 </span><span class="s0">if </span><span class="s2">1e-6 </span><span class="s1">&lt; resI[</span><span class="s2">1</span><span class="s1">] </span><span class="s0">else </span><span class="s1">resI[</span><span class="s2">1</span><span class="s1">] * </span><span class="s2">10</span>
    <span class="s1">assert_allclose(resI[</span><span class="s2">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">resG</span><span class="s0">, </span><span class="s1">rtol=rtol)</span>

<span class="s0">def </span><span class="s1">test_roots_jacobi():</span>
    <span class="s0">def </span><span class="s1">rf(a</span><span class="s0">, </span><span class="s1">b):</span>
        <span class="s0">return lambda </span><span class="s1">n</span><span class="s0">, </span><span class="s1">mu: sc.roots_jacobi(n</span><span class="s0">, </span><span class="s1">a</span><span class="s0">, </span><span class="s1">b</span><span class="s0">, </span><span class="s1">mu)</span>
    <span class="s0">def </span><span class="s1">ef(a</span><span class="s0">, </span><span class="s1">b):</span>
        <span class="s0">return lambda </span><span class="s1">n</span><span class="s0">, </span><span class="s1">x: sc.eval_jacobi(n</span><span class="s0">, </span><span class="s1">a</span><span class="s0">, </span><span class="s1">b</span><span class="s0">, </span><span class="s1">x)</span>
    <span class="s0">def </span><span class="s1">wf(a</span><span class="s0">, </span><span class="s1">b):</span>
        <span class="s0">return lambda </span><span class="s1">x: (</span><span class="s2">1 </span><span class="s1">- x) ** a * (</span><span class="s2">1 </span><span class="s1">+ x) ** b</span>

    <span class="s1">vgq = verify_gauss_quad</span>
    <span class="s1">vgq(rf(-</span><span class="s2">0.5</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.75</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(-</span><span class="s2">0.5</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.75</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(-</span><span class="s2">0.5</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.75</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">vgq(rf(-</span><span class="s2">0.5</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.75</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(-</span><span class="s2">0.5</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.75</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(-</span><span class="s2">0.5</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.75</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">,</span>
        <span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>
    <span class="s1">vgq(rf(-</span><span class="s2">0.5</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.75</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(-</span><span class="s2">0.5</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.75</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(-</span><span class="s2">0.5</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.75</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">,</span>
        <span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-11</span><span class="s1">)</span>

    <span class="s1">vgq(rf(</span><span class="s2">0.5</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">0.5</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">0.5</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">0.5</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">0.5</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">0.5</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1.5e-13</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">0.5</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">0.5</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">0.5</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">2e-12</span><span class="s1">)</span>

    <span class="s1">vgq(rf(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">2e-13</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">2e-13</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>

    <span class="s1">vgq(rf(</span><span class="s2">0.9</span><span class="s0">, </span><span class="s2">2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">0.9</span><span class="s0">, </span><span class="s2">2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">0.9</span><span class="s0">, </span><span class="s2">2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">0.9</span><span class="s0">, </span><span class="s2">2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">0.9</span><span class="s0">, </span><span class="s2">2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">0.9</span><span class="s0">, </span><span class="s2">2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">0.9</span><span class="s0">, </span><span class="s2">2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">0.9</span><span class="s0">, </span><span class="s2">2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">0.9</span><span class="s0">, </span><span class="s2">2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">3e-13</span><span class="s1">)</span>

    <span class="s1">vgq(rf(</span><span class="s2">18.24</span><span class="s0">, </span><span class="s2">27.3</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">18.24</span><span class="s0">, </span><span class="s2">27.3</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">18.24</span><span class="s0">, </span><span class="s2">27.3</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">18.24</span><span class="s0">, </span><span class="s2">27.3</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">18.24</span><span class="s0">, </span><span class="s2">27.3</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">18.24</span><span class="s0">, </span><span class="s2">27.3</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s0">,</span>
        <span class="s1">atol=</span><span class="s2">1.1e-14</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">18.24</span><span class="s0">, </span><span class="s2">27.3</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">18.24</span><span class="s0">, </span><span class="s2">27.3</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">18.24</span><span class="s0">, </span><span class="s2">27.3</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">,</span>
        <span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>

    <span class="s1">vgq(rf(</span><span class="s2">47.1</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">47.1</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">47.1</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">47.1</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">47.1</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">47.1</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">2e-13</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">47.1</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">47.1</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">47.1</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">,</span>
        <span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-11</span><span class="s1">)</span>

    <span class="s1">vgq(rf(</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">658.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">658.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">658.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">2e-13</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">658.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">658.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">658.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">658.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">658.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">658.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-11</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">658.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">658.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">658.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">250</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-11</span><span class="s1">)</span>

    <span class="s1">vgq(rf(</span><span class="s2">511.</span><span class="s0">, </span><span class="s2">511.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">511.</span><span class="s0">, </span><span class="s2">511.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">511.</span><span class="s0">, </span><span class="s2">511.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s0">,</span>
        <span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">511.</span><span class="s0">, </span><span class="s2">511.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">511.</span><span class="s0">, </span><span class="s2">511.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">511.</span><span class="s0">, </span><span class="s2">511.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s0">,</span>
        <span class="s1">atol=</span><span class="s2">1e-11</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">511.</span><span class="s0">, </span><span class="s2">511.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">511.</span><span class="s0">, </span><span class="s2">511.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">511.</span><span class="s0">, </span><span class="s2">511.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">100</span><span class="s0">,</span>
        <span class="s1">atol=</span><span class="s2">1e-10</span><span class="s1">)</span>

    <span class="s1">vgq(rf(</span><span class="s2">511.</span><span class="s0">, </span><span class="s2">512.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">511.</span><span class="s0">, </span><span class="s2">512.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">511.</span><span class="s0">, </span><span class="s2">512.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s0">,</span>
        <span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">511.</span><span class="s0">, </span><span class="s2">512.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">511.</span><span class="s0">, </span><span class="s2">512.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">511.</span><span class="s0">, </span><span class="s2">512.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s0">,</span>
        <span class="s1">atol=</span><span class="s2">1e-11</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">511.</span><span class="s0">, </span><span class="s2">512.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">511.</span><span class="s0">, </span><span class="s2">512.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">511.</span><span class="s0">, </span><span class="s2">512.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">100</span><span class="s0">,</span>
        <span class="s1">atol=</span><span class="s2">1e-10</span><span class="s1">)</span>

    <span class="s1">vgq(rf(</span><span class="s2">1000.</span><span class="s0">, </span><span class="s2">500.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">1000.</span><span class="s0">, </span><span class="s2">500.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">1000.</span><span class="s0">, </span><span class="s2">500.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s0">,</span>
        <span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">1000.</span><span class="s0">, </span><span class="s2">500.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">1000.</span><span class="s0">, </span><span class="s2">500.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">1000.</span><span class="s0">, </span><span class="s2">500.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s0">,</span>
        <span class="s1">atol=</span><span class="s2">1e-11</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">1000.</span><span class="s0">, </span><span class="s2">500.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">1000.</span><span class="s0">, </span><span class="s2">500.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">1000.</span><span class="s0">, </span><span class="s2">500.</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">100</span><span class="s0">,</span>
        <span class="s1">atol=</span><span class="s2">1e-10</span><span class="s1">)</span>

    <span class="s1">vgq(rf(</span><span class="s2">2.25</span><span class="s0">, </span><span class="s2">68.9</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">2.25</span><span class="s0">, </span><span class="s2">68.9</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">2.25</span><span class="s0">, </span><span class="s2">68.9</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">2.25</span><span class="s0">, </span><span class="s2">68.9</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">2.25</span><span class="s0">, </span><span class="s2">68.9</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">2.25</span><span class="s0">, </span><span class="s2">68.9</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s0">,</span>
        <span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">2.25</span><span class="s0">, </span><span class="s2">68.9</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">2.25</span><span class="s0">, </span><span class="s2">68.9</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">2.25</span><span class="s0">, </span><span class="s2">68.9</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">100</span><span class="s0">,</span>
        <span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>

    <span class="s4"># when alpha == beta == 0, P_n^{a,b}(x) == P_n(x)</span>
    <span class="s1">xj</span><span class="s0">, </span><span class="s1">wj = sc.roots_jacobi(</span><span class="s2">6</span><span class="s0">, </span><span class="s2">0.0</span><span class="s0">, </span><span class="s2">0.0</span><span class="s1">)</span>
    <span class="s1">xl</span><span class="s0">, </span><span class="s1">wl = sc.roots_legendre(</span><span class="s2">6</span><span class="s1">)</span>
    <span class="s1">assert_allclose(xj</span><span class="s0">, </span><span class="s1">xl</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>
    <span class="s1">assert_allclose(wj</span><span class="s0">, </span><span class="s1">wl</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>

    <span class="s4"># when alpha == beta != 0, P_n^{a,b}(x) == C_n^{alpha+0.5}(x)</span>
    <span class="s1">xj</span><span class="s0">, </span><span class="s1">wj = sc.roots_jacobi(</span><span class="s2">6</span><span class="s0">, </span><span class="s2">4.0</span><span class="s0">, </span><span class="s2">4.0</span><span class="s1">)</span>
    <span class="s1">xc</span><span class="s0">, </span><span class="s1">wc = sc.roots_gegenbauer(</span><span class="s2">6</span><span class="s0">, </span><span class="s2">4.5</span><span class="s1">)</span>
    <span class="s1">assert_allclose(xj</span><span class="s0">, </span><span class="s1">xc</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>
    <span class="s1">assert_allclose(wj</span><span class="s0">, </span><span class="s1">wc</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>

    <span class="s1">x</span><span class="s0">, </span><span class="s1">w = sc.roots_jacobi(</span><span class="s2">5</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, False</span><span class="s1">)</span>
    <span class="s1">y</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s1">m = sc.roots_jacobi(</span><span class="s2">5</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, True</span><span class="s1">)</span>
    <span class="s1">assert_allclose(x</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>
    <span class="s1">assert_allclose(w</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>

    <span class="s1">muI</span><span class="s0">, </span><span class="s1">muI_err = integrate.quad(wf(</span><span class="s2">2</span><span class="s0">,</span><span class="s2">3</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1</span><span class="s0">, </span><span class="s2">1</span><span class="s1">)</span>
    <span class="s1">assert_allclose(m</span><span class="s0">, </span><span class="s1">muI</span><span class="s0">, </span><span class="s1">rtol=muI_err)</span>

    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_jacobi</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s2">1</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_jacobi</span><span class="s0">, </span><span class="s2">3.3</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s2">1</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_jacobi</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s1">-</span><span class="s2">2</span><span class="s0">, </span><span class="s2">1</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_jacobi</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s1">-</span><span class="s2">2</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_jacobi</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s1">-</span><span class="s2">2</span><span class="s0">, </span><span class="s1">-</span><span class="s2">2</span><span class="s1">)</span>

<span class="s0">def </span><span class="s1">test_roots_sh_jacobi():</span>
    <span class="s0">def </span><span class="s1">rf(a</span><span class="s0">, </span><span class="s1">b):</span>
        <span class="s0">return lambda </span><span class="s1">n</span><span class="s0">, </span><span class="s1">mu: sc.roots_sh_jacobi(n</span><span class="s0">, </span><span class="s1">a</span><span class="s0">, </span><span class="s1">b</span><span class="s0">, </span><span class="s1">mu)</span>
    <span class="s0">def </span><span class="s1">ef(a</span><span class="s0">, </span><span class="s1">b):</span>
        <span class="s0">return lambda </span><span class="s1">n</span><span class="s0">, </span><span class="s1">x: sc.eval_sh_jacobi(n</span><span class="s0">, </span><span class="s1">a</span><span class="s0">, </span><span class="s1">b</span><span class="s0">, </span><span class="s1">x)</span>
    <span class="s0">def </span><span class="s1">wf(a</span><span class="s0">, </span><span class="s1">b):</span>
        <span class="s0">return lambda </span><span class="s1">x: (</span><span class="s2">1.0 </span><span class="s1">- x) ** (a - b) * x ** (b - </span><span class="s2">1.0</span><span class="s1">)</span>

    <span class="s1">vgq = verify_gauss_quad</span>
    <span class="s1">vgq(rf(-</span><span class="s2">0.5</span><span class="s0">, </span><span class="s2">0.25</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(-</span><span class="s2">0.5</span><span class="s0">, </span><span class="s2">0.25</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(-</span><span class="s2">0.5</span><span class="s0">, </span><span class="s2">0.25</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">vgq(rf(-</span><span class="s2">0.5</span><span class="s0">, </span><span class="s2">0.25</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(-</span><span class="s2">0.5</span><span class="s0">, </span><span class="s2">0.25</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(-</span><span class="s2">0.5</span><span class="s0">, </span><span class="s2">0.25</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">,</span>
        <span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>
    <span class="s1">vgq(rf(-</span><span class="s2">0.5</span><span class="s0">, </span><span class="s2">0.25</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(-</span><span class="s2">0.5</span><span class="s0">, </span><span class="s2">0.25</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(-</span><span class="s2">0.5</span><span class="s0">, </span><span class="s2">0.25</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">,</span>
        <span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-11</span><span class="s1">)</span>

    <span class="s1">vgq(rf(</span><span class="s2">0.5</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">0.5</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">0.5</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">0.5</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">0.5</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">0.5</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">0.5</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">0.5</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">0.5</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>

    <span class="s1">vgq(rf(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1.5e-13</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">2e-12</span><span class="s1">)</span>

    <span class="s1">vgq(rf(</span><span class="s2">2</span><span class="s0">, </span><span class="s2">0.9</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">2</span><span class="s0">, </span><span class="s2">0.9</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">2</span><span class="s0">, </span><span class="s2">0.9</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">2</span><span class="s0">, </span><span class="s2">0.9</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">2</span><span class="s0">, </span><span class="s2">0.9</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">2</span><span class="s0">, </span><span class="s2">0.9</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">2</span><span class="s0">, </span><span class="s2">0.9</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">2</span><span class="s0">, </span><span class="s2">0.9</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">2</span><span class="s0">, </span><span class="s2">0.9</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>

    <span class="s1">vgq(rf(</span><span class="s2">27.3</span><span class="s0">, </span><span class="s2">18.24</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">27.3</span><span class="s0">, </span><span class="s2">18.24</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">27.3</span><span class="s0">, </span><span class="s2">18.24</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">27.3</span><span class="s0">, </span><span class="s2">18.24</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">27.3</span><span class="s0">, </span><span class="s2">18.24</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">27.3</span><span class="s0">, </span><span class="s2">18.24</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">27.3</span><span class="s0">, </span><span class="s2">18.24</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">27.3</span><span class="s0">, </span><span class="s2">18.24</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">27.3</span><span class="s0">, </span><span class="s2">18.24</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">,</span>
        <span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>

    <span class="s1">vgq(rf(</span><span class="s2">47.1</span><span class="s0">, </span><span class="s2">0.2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">47.1</span><span class="s0">, </span><span class="s2">0.2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">47.1</span><span class="s0">, </span><span class="s2">0.2</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">47.1</span><span class="s0">, </span><span class="s2">0.2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">47.1</span><span class="s0">, </span><span class="s2">0.2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">47.1</span><span class="s0">, </span><span class="s2">0.2</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-11</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">47.1</span><span class="s0">, </span><span class="s2">0.2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">47.1</span><span class="s0">, </span><span class="s2">0.2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">47.1</span><span class="s0">, </span><span class="s2">0.2</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-10</span><span class="s1">)</span>

    <span class="s1">vgq(rf(</span><span class="s2">68.9</span><span class="s0">, </span><span class="s2">2.25</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">68.9</span><span class="s0">, </span><span class="s2">2.25</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">68.9</span><span class="s0">, </span><span class="s2">2.25</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">3.5e-14</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">68.9</span><span class="s0">, </span><span class="s2">2.25</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">68.9</span><span class="s0">, </span><span class="s2">2.25</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">68.9</span><span class="s0">, </span><span class="s2">2.25</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">2e-13</span><span class="s1">)</span>
    <span class="s1">vgq(rf(</span><span class="s2">68.9</span><span class="s0">, </span><span class="s2">2.25</span><span class="s1">)</span><span class="s0">, </span><span class="s1">ef(</span><span class="s2">68.9</span><span class="s0">, </span><span class="s2">2.25</span><span class="s1">)</span><span class="s0">, </span><span class="s1">wf(</span><span class="s2">68.9</span><span class="s0">, </span><span class="s2">2.25</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">,</span>
        <span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>

    <span class="s1">x</span><span class="s0">, </span><span class="s1">w = sc.roots_sh_jacobi(</span><span class="s2">5</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, False</span><span class="s1">)</span>
    <span class="s1">y</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s1">m = sc.roots_sh_jacobi(</span><span class="s2">5</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, True</span><span class="s1">)</span>
    <span class="s1">assert_allclose(x</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>
    <span class="s1">assert_allclose(w</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>

    <span class="s1">muI</span><span class="s0">, </span><span class="s1">muI_err = integrate.quad(wf(</span><span class="s2">3</span><span class="s0">,</span><span class="s2">2</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">1</span><span class="s1">)</span>
    <span class="s1">assert_allclose(m</span><span class="s0">, </span><span class="s1">muI</span><span class="s0">, </span><span class="s1">rtol=muI_err)</span>

    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_sh_jacobi</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s2">1</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_sh_jacobi</span><span class="s0">, </span><span class="s2">3.3</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s2">1</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_sh_jacobi</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s1">)    </span><span class="s4"># p - q &lt;= -1</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_sh_jacobi</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1</span><span class="s1">)   </span><span class="s4"># q &lt;= 0</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_sh_jacobi</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s1">-</span><span class="s2">2</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1</span><span class="s1">)  </span><span class="s4"># both</span>

<span class="s0">def </span><span class="s1">test_roots_hermite():</span>
    <span class="s1">rootf = sc.roots_hermite</span>
    <span class="s1">evalf = sc.eval_hermite</span>
    <span class="s1">weightf = orth.hermite(</span><span class="s2">5</span><span class="s1">).weight_func</span>

    <span class="s1">verify_gauss_quad(rootf</span><span class="s0">, </span><span class="s1">evalf</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s1">-np.inf</span><span class="s0">, </span><span class="s1">np.inf</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">verify_gauss_quad(rootf</span><span class="s0">, </span><span class="s1">evalf</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s1">-np.inf</span><span class="s0">, </span><span class="s1">np.inf</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>
    <span class="s1">verify_gauss_quad(rootf</span><span class="s0">, </span><span class="s1">evalf</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s1">-np.inf</span><span class="s0">, </span><span class="s1">np.inf</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>

    <span class="s4"># Golub-Welsch branch</span>
    <span class="s1">x</span><span class="s0">, </span><span class="s1">w = sc.roots_hermite(</span><span class="s2">5</span><span class="s0">, False</span><span class="s1">)</span>
    <span class="s1">y</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s1">m = sc.roots_hermite(</span><span class="s2">5</span><span class="s0">, True</span><span class="s1">)</span>
    <span class="s1">assert_allclose(x</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>
    <span class="s1">assert_allclose(w</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>

    <span class="s1">muI</span><span class="s0">, </span><span class="s1">muI_err = integrate.quad(weightf</span><span class="s0">, </span><span class="s1">-np.inf</span><span class="s0">, </span><span class="s1">np.inf)</span>
    <span class="s1">assert_allclose(m</span><span class="s0">, </span><span class="s1">muI</span><span class="s0">, </span><span class="s1">rtol=muI_err)</span>

    <span class="s4"># Asymptotic branch (switch over at n &gt;= 150)</span>
    <span class="s1">x</span><span class="s0">, </span><span class="s1">w = sc.roots_hermite(</span><span class="s2">200</span><span class="s0">, False</span><span class="s1">)</span>
    <span class="s1">y</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s1">m = sc.roots_hermite(</span><span class="s2">200</span><span class="s0">, True</span><span class="s1">)</span>
    <span class="s1">assert_allclose(x</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>
    <span class="s1">assert_allclose(w</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>
    <span class="s1">assert_allclose(sum(v)</span><span class="s0">, </span><span class="s1">m</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>

    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_hermite</span><span class="s0">, </span><span class="s2">0</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_hermite</span><span class="s0">, </span><span class="s2">3.3</span><span class="s1">)</span>

<span class="s0">def </span><span class="s1">test_roots_hermite_asy():</span>
    <span class="s4"># Recursion for Hermite functions</span>
    <span class="s0">def </span><span class="s1">hermite_recursion(n</span><span class="s0">, </span><span class="s1">nodes):</span>
        <span class="s1">H = np.zeros((n</span><span class="s0">, </span><span class="s1">nodes.size))</span>
        <span class="s1">H[</span><span class="s2">0</span><span class="s0">,</span><span class="s1">:] = np.pi**(-</span><span class="s2">0.25</span><span class="s1">) * np.exp(-</span><span class="s2">0.5</span><span class="s1">*nodes**</span><span class="s2">2</span><span class="s1">)</span>
        <span class="s0">if </span><span class="s1">n &gt; </span><span class="s2">1</span><span class="s1">:</span>
            <span class="s1">H[</span><span class="s2">1</span><span class="s0">,</span><span class="s1">:] = sqrt(</span><span class="s2">2.0</span><span class="s1">) * nodes * H[</span><span class="s2">0</span><span class="s0">,</span><span class="s1">:]</span>
            <span class="s0">for </span><span class="s1">k </span><span class="s0">in </span><span class="s1">range(</span><span class="s2">2</span><span class="s0">, </span><span class="s1">n):</span>
                <span class="s1">H[k</span><span class="s0">,</span><span class="s1">:] = sqrt(</span><span class="s2">2.0</span><span class="s1">/k) * nodes * H[k-</span><span class="s2">1</span><span class="s0">,</span><span class="s1">:] - sqrt((k-</span><span class="s2">1.0</span><span class="s1">)/k) * H[k-</span><span class="s2">2</span><span class="s0">,</span><span class="s1">:]</span>
        <span class="s0">return </span><span class="s1">H</span>

    <span class="s4"># This tests only the nodes</span>
    <span class="s0">def </span><span class="s1">test(N</span><span class="s0">, </span><span class="s1">rtol=</span><span class="s2">1e-15</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-14</span><span class="s1">):</span>
        <span class="s1">x</span><span class="s0">, </span><span class="s1">w = orth._roots_hermite_asy(N)</span>
        <span class="s1">H = hermite_recursion(N+</span><span class="s2">1</span><span class="s0">, </span><span class="s1">x)</span>
        <span class="s1">assert_allclose(H[-</span><span class="s2">1</span><span class="s0">,</span><span class="s1">:]</span><span class="s0">, </span><span class="s1">np.zeros(N)</span><span class="s0">, </span><span class="s1">rtol</span><span class="s0">, </span><span class="s1">atol)</span>
        <span class="s1">assert_allclose(sum(w)</span><span class="s0">, </span><span class="s1">sqrt(np.pi)</span><span class="s0">, </span><span class="s1">rtol</span><span class="s0">, </span><span class="s1">atol)</span>

    <span class="s1">test(</span><span class="s2">150</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>
    <span class="s1">test(</span><span class="s2">151</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>
    <span class="s1">test(</span><span class="s2">300</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>
    <span class="s1">test(</span><span class="s2">301</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>
    <span class="s1">test(</span><span class="s2">500</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>
    <span class="s1">test(</span><span class="s2">501</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>
    <span class="s1">test(</span><span class="s2">999</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>
    <span class="s1">test(</span><span class="s2">1000</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>
    <span class="s1">test(</span><span class="s2">2000</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>
    <span class="s1">test(</span><span class="s2">5000</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>

<span class="s0">def </span><span class="s1">test_roots_hermitenorm():</span>
    <span class="s1">rootf = sc.roots_hermitenorm</span>
    <span class="s1">evalf = sc.eval_hermitenorm</span>
    <span class="s1">weightf = orth.hermitenorm(</span><span class="s2">5</span><span class="s1">).weight_func</span>

    <span class="s1">verify_gauss_quad(rootf</span><span class="s0">, </span><span class="s1">evalf</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s1">-np.inf</span><span class="s0">, </span><span class="s1">np.inf</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">verify_gauss_quad(rootf</span><span class="s0">, </span><span class="s1">evalf</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s1">-np.inf</span><span class="s0">, </span><span class="s1">np.inf</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>
    <span class="s1">verify_gauss_quad(rootf</span><span class="s0">, </span><span class="s1">evalf</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s1">-np.inf</span><span class="s0">, </span><span class="s1">np.inf</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>

    <span class="s1">x</span><span class="s0">, </span><span class="s1">w = sc.roots_hermitenorm(</span><span class="s2">5</span><span class="s0">, False</span><span class="s1">)</span>
    <span class="s1">y</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s1">m = sc.roots_hermitenorm(</span><span class="s2">5</span><span class="s0">, True</span><span class="s1">)</span>
    <span class="s1">assert_allclose(x</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>
    <span class="s1">assert_allclose(w</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>

    <span class="s1">muI</span><span class="s0">, </span><span class="s1">muI_err = integrate.quad(weightf</span><span class="s0">, </span><span class="s1">-np.inf</span><span class="s0">, </span><span class="s1">np.inf)</span>
    <span class="s1">assert_allclose(m</span><span class="s0">, </span><span class="s1">muI</span><span class="s0">, </span><span class="s1">rtol=muI_err)</span>

    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_hermitenorm</span><span class="s0">, </span><span class="s2">0</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_hermitenorm</span><span class="s0">, </span><span class="s2">3.3</span><span class="s1">)</span>

<span class="s0">def </span><span class="s1">test_roots_gegenbauer():</span>
    <span class="s0">def </span><span class="s1">rootf(a):</span>
        <span class="s0">return lambda </span><span class="s1">n</span><span class="s0">, </span><span class="s1">mu: sc.roots_gegenbauer(n</span><span class="s0">, </span><span class="s1">a</span><span class="s0">, </span><span class="s1">mu)</span>
    <span class="s0">def </span><span class="s1">evalf(a):</span>
        <span class="s0">return lambda </span><span class="s1">n</span><span class="s0">, </span><span class="s1">x: sc.eval_gegenbauer(n</span><span class="s0">, </span><span class="s1">a</span><span class="s0">, </span><span class="s1">x)</span>
    <span class="s0">def </span><span class="s1">weightf(a):</span>
        <span class="s0">return lambda </span><span class="s1">x: (</span><span class="s2">1 </span><span class="s1">- x ** </span><span class="s2">2</span><span class="s1">) ** (a - </span><span class="s2">0.5</span><span class="s1">)</span>

    <span class="s1">vgq = verify_gauss_quad</span>
    <span class="s1">vgq(rootf(-</span><span class="s2">0.25</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(-</span><span class="s2">0.25</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(-</span><span class="s2">0.25</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(-</span><span class="s2">0.25</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(-</span><span class="s2">0.25</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(-</span><span class="s2">0.25</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(-</span><span class="s2">0.25</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(-</span><span class="s2">0.25</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(-</span><span class="s2">0.25</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-11</span><span class="s1">)</span>

    <span class="s1">vgq(rootf(</span><span class="s2">0.1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">0.1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">0.1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">0.1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">0.1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">0.1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">0.1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">0.1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">0.1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>

    <span class="s1">vgq(rootf(</span><span class="s2">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>

    <span class="s1">vgq(rootf(</span><span class="s2">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>

    <span class="s1">vgq(rootf(</span><span class="s2">50</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">50</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">50</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">50</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">50</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">50</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">50</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">50</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">50</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-11</span><span class="s1">)</span>

    <span class="s4"># Alpha=170 is where the approximation used in roots_gegenbauer changes</span>
    <span class="s1">vgq(rootf(</span><span class="s2">170</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">170</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">170</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">170</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">170</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">170</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">170</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">170</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">170</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-11</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">170.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">170.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">170.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1.25e-13</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">170.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">170.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">170.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">170.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">170.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">170.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-11</span><span class="s1">)</span>

    <span class="s4"># Test for failures, e.g. overflows, resulting from large alphas</span>
    <span class="s1">vgq(rootf(</span><span class="s2">238</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">238</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">238</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">238</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">238</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">238</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">238</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">238</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">238</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-11</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">512.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">512.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">512.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">512.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">512.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">512.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-11</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">512.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">512.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">512.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-10</span><span class="s1">)</span>

    <span class="s4"># this is a special case that the old code supported.</span>
    <span class="s4"># when alpha = 0, the gegenbauer polynomial is uniformly 0. but it goes</span>
    <span class="s4"># to a scaled down copy of T_n(x) there.</span>
    <span class="s1">vgq(rootf(</span><span class="s2">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">sc.eval_chebyt</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">sc.eval_chebyt</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">sc.eval_chebyt</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>

    <span class="s1">x</span><span class="s0">, </span><span class="s1">w = sc.roots_gegenbauer(</span><span class="s2">5</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, False</span><span class="s1">)</span>
    <span class="s1">y</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s1">m = sc.roots_gegenbauer(</span><span class="s2">5</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, True</span><span class="s1">)</span>
    <span class="s1">assert_allclose(x</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>
    <span class="s1">assert_allclose(w</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>

    <span class="s1">muI</span><span class="s0">, </span><span class="s1">muI_err = integrate.quad(weightf(</span><span class="s2">2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1</span><span class="s0">, </span><span class="s2">1</span><span class="s1">)</span>
    <span class="s1">assert_allclose(m</span><span class="s0">, </span><span class="s1">muI</span><span class="s0">, </span><span class="s1">rtol=muI_err)</span>

    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_gegenbauer</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">2</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_gegenbauer</span><span class="s0">, </span><span class="s2">3.3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_gegenbauer</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s1">-</span><span class="s2">.75</span><span class="s1">)</span>

<span class="s0">def </span><span class="s1">test_roots_chebyt():</span>
    <span class="s1">weightf = orth.chebyt(</span><span class="s2">5</span><span class="s1">).weight_func</span>
    <span class="s1">verify_gauss_quad(sc.roots_chebyt</span><span class="s0">, </span><span class="s1">sc.eval_chebyt</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">verify_gauss_quad(sc.roots_chebyt</span><span class="s0">, </span><span class="s1">sc.eval_chebyt</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s1">)</span>
    <span class="s1">verify_gauss_quad(sc.roots_chebyt</span><span class="s0">, </span><span class="s1">sc.eval_chebyt</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>

    <span class="s1">x</span><span class="s0">, </span><span class="s1">w = sc.roots_chebyt(</span><span class="s2">5</span><span class="s0">, False</span><span class="s1">)</span>
    <span class="s1">y</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s1">m = sc.roots_chebyt(</span><span class="s2">5</span><span class="s0">, True</span><span class="s1">)</span>
    <span class="s1">assert_allclose(x</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>
    <span class="s1">assert_allclose(w</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>

    <span class="s1">muI</span><span class="s0">, </span><span class="s1">muI_err = integrate.quad(weightf</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1</span><span class="s0">, </span><span class="s2">1</span><span class="s1">)</span>
    <span class="s1">assert_allclose(m</span><span class="s0">, </span><span class="s1">muI</span><span class="s0">, </span><span class="s1">rtol=muI_err)</span>

    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_chebyt</span><span class="s0">, </span><span class="s2">0</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_chebyt</span><span class="s0">, </span><span class="s2">3.3</span><span class="s1">)</span>

<span class="s0">def </span><span class="s1">test_chebyt_symmetry():</span>
    <span class="s1">x</span><span class="s0">, </span><span class="s1">w = sc.roots_chebyt(</span><span class="s2">21</span><span class="s1">)</span>
    <span class="s1">pos</span><span class="s0">, </span><span class="s1">neg = x[:</span><span class="s2">10</span><span class="s1">]</span><span class="s0">, </span><span class="s1">x[</span><span class="s2">11</span><span class="s1">:]</span>
    <span class="s1">assert_equal(neg</span><span class="s0">, </span><span class="s1">-pos[::-</span><span class="s2">1</span><span class="s1">])</span>
    <span class="s1">assert_equal(x[</span><span class="s2">10</span><span class="s1">]</span><span class="s0">, </span><span class="s2">0</span><span class="s1">)</span>

<span class="s0">def </span><span class="s1">test_roots_chebyu():</span>
    <span class="s1">weightf = orth.chebyu(</span><span class="s2">5</span><span class="s1">).weight_func</span>
    <span class="s1">verify_gauss_quad(sc.roots_chebyu</span><span class="s0">, </span><span class="s1">sc.eval_chebyu</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">verify_gauss_quad(sc.roots_chebyu</span><span class="s0">, </span><span class="s1">sc.eval_chebyu</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s1">)</span>
    <span class="s1">verify_gauss_quad(sc.roots_chebyu</span><span class="s0">, </span><span class="s1">sc.eval_chebyu</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">100</span><span class="s1">)</span>

    <span class="s1">x</span><span class="s0">, </span><span class="s1">w = sc.roots_chebyu(</span><span class="s2">5</span><span class="s0">, False</span><span class="s1">)</span>
    <span class="s1">y</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s1">m = sc.roots_chebyu(</span><span class="s2">5</span><span class="s0">, True</span><span class="s1">)</span>
    <span class="s1">assert_allclose(x</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>
    <span class="s1">assert_allclose(w</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>

    <span class="s1">muI</span><span class="s0">, </span><span class="s1">muI_err = integrate.quad(weightf</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1</span><span class="s0">, </span><span class="s2">1</span><span class="s1">)</span>
    <span class="s1">assert_allclose(m</span><span class="s0">, </span><span class="s1">muI</span><span class="s0">, </span><span class="s1">rtol=muI_err)</span>

    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_chebyu</span><span class="s0">, </span><span class="s2">0</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_chebyu</span><span class="s0">, </span><span class="s2">3.3</span><span class="s1">)</span>

<span class="s0">def </span><span class="s1">test_roots_chebyc():</span>
    <span class="s1">weightf = orth.chebyc(</span><span class="s2">5</span><span class="s1">).weight_func</span>
    <span class="s1">verify_gauss_quad(sc.roots_chebyc</span><span class="s0">, </span><span class="s1">sc.eval_chebyc</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s1">-</span><span class="s2">2.</span><span class="s0">, </span><span class="s2">2.</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">verify_gauss_quad(sc.roots_chebyc</span><span class="s0">, </span><span class="s1">sc.eval_chebyc</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s1">-</span><span class="s2">2.</span><span class="s0">, </span><span class="s2">2.</span><span class="s0">, </span><span class="s2">25</span><span class="s1">)</span>
    <span class="s1">verify_gauss_quad(sc.roots_chebyc</span><span class="s0">, </span><span class="s1">sc.eval_chebyc</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s1">-</span><span class="s2">2.</span><span class="s0">, </span><span class="s2">2.</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>

    <span class="s1">x</span><span class="s0">, </span><span class="s1">w = sc.roots_chebyc(</span><span class="s2">5</span><span class="s0">, False</span><span class="s1">)</span>
    <span class="s1">y</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s1">m = sc.roots_chebyc(</span><span class="s2">5</span><span class="s0">, True</span><span class="s1">)</span>
    <span class="s1">assert_allclose(x</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>
    <span class="s1">assert_allclose(w</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>

    <span class="s1">muI</span><span class="s0">, </span><span class="s1">muI_err = integrate.quad(weightf</span><span class="s0">, </span><span class="s1">-</span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s1">)</span>
    <span class="s1">assert_allclose(m</span><span class="s0">, </span><span class="s1">muI</span><span class="s0">, </span><span class="s1">rtol=muI_err)</span>

    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_chebyc</span><span class="s0">, </span><span class="s2">0</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_chebyc</span><span class="s0">, </span><span class="s2">3.3</span><span class="s1">)</span>

<span class="s0">def </span><span class="s1">test_roots_chebys():</span>
    <span class="s1">weightf = orth.chebys(</span><span class="s2">5</span><span class="s1">).weight_func</span>
    <span class="s1">verify_gauss_quad(sc.roots_chebys</span><span class="s0">, </span><span class="s1">sc.eval_chebys</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s1">-</span><span class="s2">2.</span><span class="s0">, </span><span class="s2">2.</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">verify_gauss_quad(sc.roots_chebys</span><span class="s0">, </span><span class="s1">sc.eval_chebys</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s1">-</span><span class="s2">2.</span><span class="s0">, </span><span class="s2">2.</span><span class="s0">, </span><span class="s2">25</span><span class="s1">)</span>
    <span class="s1">verify_gauss_quad(sc.roots_chebys</span><span class="s0">, </span><span class="s1">sc.eval_chebys</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s1">-</span><span class="s2">2.</span><span class="s0">, </span><span class="s2">2.</span><span class="s0">, </span><span class="s2">100</span><span class="s1">)</span>

    <span class="s1">x</span><span class="s0">, </span><span class="s1">w = sc.roots_chebys(</span><span class="s2">5</span><span class="s0">, False</span><span class="s1">)</span>
    <span class="s1">y</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s1">m = sc.roots_chebys(</span><span class="s2">5</span><span class="s0">, True</span><span class="s1">)</span>
    <span class="s1">assert_allclose(x</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>
    <span class="s1">assert_allclose(w</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>

    <span class="s1">muI</span><span class="s0">, </span><span class="s1">muI_err = integrate.quad(weightf</span><span class="s0">, </span><span class="s1">-</span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s1">)</span>
    <span class="s1">assert_allclose(m</span><span class="s0">, </span><span class="s1">muI</span><span class="s0">, </span><span class="s1">rtol=muI_err)</span>

    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_chebys</span><span class="s0">, </span><span class="s2">0</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_chebys</span><span class="s0">, </span><span class="s2">3.3</span><span class="s1">)</span>

<span class="s0">def </span><span class="s1">test_roots_sh_chebyt():</span>
    <span class="s1">weightf = orth.sh_chebyt(</span><span class="s2">5</span><span class="s1">).weight_func</span>
    <span class="s1">verify_gauss_quad(sc.roots_sh_chebyt</span><span class="s0">, </span><span class="s1">sc.eval_sh_chebyt</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">verify_gauss_quad(sc.roots_sh_chebyt</span><span class="s0">, </span><span class="s1">sc.eval_sh_chebyt</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s1">)</span>
    <span class="s1">verify_gauss_quad(sc.roots_sh_chebyt</span><span class="s0">, </span><span class="s1">sc.eval_sh_chebyt</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">,</span>
                      <span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>

    <span class="s1">x</span><span class="s0">, </span><span class="s1">w = sc.roots_sh_chebyt(</span><span class="s2">5</span><span class="s0">, False</span><span class="s1">)</span>
    <span class="s1">y</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s1">m = sc.roots_sh_chebyt(</span><span class="s2">5</span><span class="s0">, True</span><span class="s1">)</span>
    <span class="s1">assert_allclose(x</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>
    <span class="s1">assert_allclose(w</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>

    <span class="s1">muI</span><span class="s0">, </span><span class="s1">muI_err = integrate.quad(weightf</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">1</span><span class="s1">)</span>
    <span class="s1">assert_allclose(m</span><span class="s0">, </span><span class="s1">muI</span><span class="s0">, </span><span class="s1">rtol=muI_err)</span>

    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_sh_chebyt</span><span class="s0">, </span><span class="s2">0</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_sh_chebyt</span><span class="s0">, </span><span class="s2">3.3</span><span class="s1">)</span>

<span class="s0">def </span><span class="s1">test_roots_sh_chebyu():</span>
    <span class="s1">weightf = orth.sh_chebyu(</span><span class="s2">5</span><span class="s1">).weight_func</span>
    <span class="s1">verify_gauss_quad(sc.roots_sh_chebyu</span><span class="s0">, </span><span class="s1">sc.eval_sh_chebyu</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">verify_gauss_quad(sc.roots_sh_chebyu</span><span class="s0">, </span><span class="s1">sc.eval_sh_chebyu</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">25</span><span class="s1">)</span>
    <span class="s1">verify_gauss_quad(sc.roots_sh_chebyu</span><span class="s0">, </span><span class="s1">sc.eval_sh_chebyu</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">,</span>
                      <span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>

    <span class="s1">x</span><span class="s0">, </span><span class="s1">w = sc.roots_sh_chebyu(</span><span class="s2">5</span><span class="s0">, False</span><span class="s1">)</span>
    <span class="s1">y</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s1">m = sc.roots_sh_chebyu(</span><span class="s2">5</span><span class="s0">, True</span><span class="s1">)</span>
    <span class="s1">assert_allclose(x</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>
    <span class="s1">assert_allclose(w</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>

    <span class="s1">muI</span><span class="s0">, </span><span class="s1">muI_err = integrate.quad(weightf</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">1</span><span class="s1">)</span>
    <span class="s1">assert_allclose(m</span><span class="s0">, </span><span class="s1">muI</span><span class="s0">, </span><span class="s1">rtol=muI_err)</span>

    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_sh_chebyu</span><span class="s0">, </span><span class="s2">0</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_sh_chebyu</span><span class="s0">, </span><span class="s2">3.3</span><span class="s1">)</span>

<span class="s0">def </span><span class="s1">test_roots_legendre():</span>
    <span class="s1">weightf = orth.legendre(</span><span class="s2">5</span><span class="s1">).weight_func</span>
    <span class="s1">verify_gauss_quad(sc.roots_legendre</span><span class="s0">, </span><span class="s1">sc.eval_legendre</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">verify_gauss_quad(sc.roots_legendre</span><span class="s0">, </span><span class="s1">sc.eval_legendre</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">,</span>
                      <span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>
    <span class="s1">verify_gauss_quad(sc.roots_legendre</span><span class="s0">, </span><span class="s1">sc.eval_legendre</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">,</span>
                      <span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>

    <span class="s1">x</span><span class="s0">, </span><span class="s1">w = sc.roots_legendre(</span><span class="s2">5</span><span class="s0">, False</span><span class="s1">)</span>
    <span class="s1">y</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s1">m = sc.roots_legendre(</span><span class="s2">5</span><span class="s0">, True</span><span class="s1">)</span>
    <span class="s1">assert_allclose(x</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>
    <span class="s1">assert_allclose(w</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>

    <span class="s1">muI</span><span class="s0">, </span><span class="s1">muI_err = integrate.quad(weightf</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1</span><span class="s0">, </span><span class="s2">1</span><span class="s1">)</span>
    <span class="s1">assert_allclose(m</span><span class="s0">, </span><span class="s1">muI</span><span class="s0">, </span><span class="s1">rtol=muI_err)</span>

    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_legendre</span><span class="s0">, </span><span class="s2">0</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_legendre</span><span class="s0">, </span><span class="s2">3.3</span><span class="s1">)</span>

<span class="s0">def </span><span class="s1">test_roots_sh_legendre():</span>
    <span class="s1">weightf = orth.sh_legendre(</span><span class="s2">5</span><span class="s1">).weight_func</span>
    <span class="s1">verify_gauss_quad(sc.roots_sh_legendre</span><span class="s0">, </span><span class="s1">sc.eval_sh_legendre</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">verify_gauss_quad(sc.roots_sh_legendre</span><span class="s0">, </span><span class="s1">sc.eval_sh_legendre</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">,</span>
                      <span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>
    <span class="s1">verify_gauss_quad(sc.roots_sh_legendre</span><span class="s0">, </span><span class="s1">sc.eval_sh_legendre</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s2">1.</span><span class="s0">,</span>
                      <span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>

    <span class="s1">x</span><span class="s0">, </span><span class="s1">w = sc.roots_sh_legendre(</span><span class="s2">5</span><span class="s0">, False</span><span class="s1">)</span>
    <span class="s1">y</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s1">m = sc.roots_sh_legendre(</span><span class="s2">5</span><span class="s0">, True</span><span class="s1">)</span>
    <span class="s1">assert_allclose(x</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>
    <span class="s1">assert_allclose(w</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>

    <span class="s1">muI</span><span class="s0">, </span><span class="s1">muI_err = integrate.quad(weightf</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">1</span><span class="s1">)</span>
    <span class="s1">assert_allclose(m</span><span class="s0">, </span><span class="s1">muI</span><span class="s0">, </span><span class="s1">rtol=muI_err)</span>

    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_sh_legendre</span><span class="s0">, </span><span class="s2">0</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_sh_legendre</span><span class="s0">, </span><span class="s2">3.3</span><span class="s1">)</span>

<span class="s0">def </span><span class="s1">test_roots_laguerre():</span>
    <span class="s1">weightf = orth.laguerre(</span><span class="s2">5</span><span class="s1">).weight_func</span>
    <span class="s1">verify_gauss_quad(sc.roots_laguerre</span><span class="s0">, </span><span class="s1">sc.eval_laguerre</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s1">np.inf</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">verify_gauss_quad(sc.roots_laguerre</span><span class="s0">, </span><span class="s1">sc.eval_laguerre</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s1">np.inf</span><span class="s0">,</span>
                      <span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>
    <span class="s1">verify_gauss_quad(sc.roots_laguerre</span><span class="s0">, </span><span class="s1">sc.eval_laguerre</span><span class="s0">, </span><span class="s1">weightf</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s1">np.inf</span><span class="s0">,</span>
                      <span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>

    <span class="s1">x</span><span class="s0">, </span><span class="s1">w = sc.roots_laguerre(</span><span class="s2">5</span><span class="s0">, False</span><span class="s1">)</span>
    <span class="s1">y</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s1">m = sc.roots_laguerre(</span><span class="s2">5</span><span class="s0">, True</span><span class="s1">)</span>
    <span class="s1">assert_allclose(x</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>
    <span class="s1">assert_allclose(w</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>

    <span class="s1">muI</span><span class="s0">, </span><span class="s1">muI_err = integrate.quad(weightf</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s1">np.inf)</span>
    <span class="s1">assert_allclose(m</span><span class="s0">, </span><span class="s1">muI</span><span class="s0">, </span><span class="s1">rtol=muI_err)</span>

    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_laguerre</span><span class="s0">, </span><span class="s2">0</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_laguerre</span><span class="s0">, </span><span class="s2">3.3</span><span class="s1">)</span>

<span class="s0">def </span><span class="s1">test_roots_genlaguerre():</span>
    <span class="s0">def </span><span class="s1">rootf(a):</span>
        <span class="s0">return lambda </span><span class="s1">n</span><span class="s0">, </span><span class="s1">mu: sc.roots_genlaguerre(n</span><span class="s0">, </span><span class="s1">a</span><span class="s0">, </span><span class="s1">mu)</span>
    <span class="s0">def </span><span class="s1">evalf(a):</span>
        <span class="s0">return lambda </span><span class="s1">n</span><span class="s0">, </span><span class="s1">x: sc.eval_genlaguerre(n</span><span class="s0">, </span><span class="s1">a</span><span class="s0">, </span><span class="s1">x)</span>
    <span class="s0">def </span><span class="s1">weightf(a):</span>
        <span class="s0">return lambda </span><span class="s1">x: x ** a * np.exp(-x)</span>

    <span class="s1">vgq = verify_gauss_quad</span>
    <span class="s1">vgq(rootf(-</span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(-</span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(-</span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s1">np.inf</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(-</span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(-</span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(-</span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s1">np.inf</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(-</span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(-</span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(-</span><span class="s2">0.5</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s1">np.inf</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>

    <span class="s1">vgq(rootf(</span><span class="s2">0.1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">0.1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">0.1</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s1">np.inf</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">0.1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">0.1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">0.1</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s1">np.inf</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">0.1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">0.1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">0.1</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s1">np.inf</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1.6e-13</span><span class="s1">)</span>

    <span class="s1">vgq(rootf(</span><span class="s2">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">1</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s1">np.inf</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">1</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s1">np.inf</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">1</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s1">np.inf</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1.03e-13</span><span class="s1">)</span>

    <span class="s1">vgq(rootf(</span><span class="s2">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">10</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s1">np.inf</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">10</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s1">np.inf</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">10</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s1">np.inf</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-12</span><span class="s1">)</span>

    <span class="s1">vgq(rootf(</span><span class="s2">50</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">50</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">50</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s1">np.inf</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">50</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">50</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">50</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s1">np.inf</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">1e-13</span><span class="s1">)</span>
    <span class="s1">vgq(rootf(</span><span class="s2">50</span><span class="s1">)</span><span class="s0">, </span><span class="s1">evalf(</span><span class="s2">50</span><span class="s1">)</span><span class="s0">, </span><span class="s1">weightf(</span><span class="s2">50</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s1">np.inf</span><span class="s0">, </span><span class="s2">100</span><span class="s0">, </span><span class="s1">rtol=</span><span class="s2">1e-14</span><span class="s0">, </span><span class="s1">atol=</span><span class="s2">2e-13</span><span class="s1">)</span>

    <span class="s1">x</span><span class="s0">, </span><span class="s1">w = sc.roots_genlaguerre(</span><span class="s2">5</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, False</span><span class="s1">)</span>
    <span class="s1">y</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s1">m = sc.roots_genlaguerre(</span><span class="s2">5</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, True</span><span class="s1">)</span>
    <span class="s1">assert_allclose(x</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>
    <span class="s1">assert_allclose(w</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s0">, </span><span class="s2">1e-14</span><span class="s1">)</span>

    <span class="s1">muI</span><span class="s0">, </span><span class="s1">muI_err = integrate.quad(weightf(</span><span class="s2">2.</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0.</span><span class="s0">, </span><span class="s1">np.inf)</span>
    <span class="s1">assert_allclose(m</span><span class="s0">, </span><span class="s1">muI</span><span class="s0">, </span><span class="s1">rtol=muI_err)</span>

    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_genlaguerre</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">2</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_genlaguerre</span><span class="s0">, </span><span class="s2">3.3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sc.roots_genlaguerre</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.1</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_gh_6721():</span>
    <span class="s4"># Regresssion test for gh_6721. This should not raise.</span>
    <span class="s1">sc.chebyt(</span><span class="s2">65</span><span class="s1">)(</span><span class="s2">0.2</span><span class="s1">)</span>
</pre>
</body>
</html>