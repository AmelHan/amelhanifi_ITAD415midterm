<html>
<head>
<title>test_markov_regression.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #629755; font-style: italic;}
.s1 { color: #a9b7c6;}
.s2 { color: #cc7832;}
.s3 { color: #808080;}
.s4 { color: #6897bb;}
.s5 { color: #6a8759;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_markov_regression.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot; 
Tests for Markov Regression models 
 
Author: Chad Fulton 
License: BSD-3 
&quot;&quot;&quot;</span>

<span class="s2">import </span><span class="s1">os</span>
<span class="s2">import </span><span class="s1">warnings</span>

<span class="s2">import </span><span class="s1">numpy </span><span class="s2">as </span><span class="s1">np</span>
<span class="s2">from </span><span class="s1">numpy.testing </span><span class="s2">import </span><span class="s1">assert_allclose</span><span class="s2">, </span><span class="s1">assert_raises</span>
<span class="s2">import </span><span class="s1">pandas </span><span class="s2">as </span><span class="s1">pd</span>
<span class="s2">import </span><span class="s1">pytest</span>

<span class="s2">from </span><span class="s1">statsmodels.tsa.regime_switching </span><span class="s2">import </span><span class="s1">(markov_switching</span><span class="s2">,</span>
                                              <span class="s1">markov_regression)</span>


<span class="s1">current_path = os.path.dirname(os.path.abspath(__file__))</span>


<span class="s3"># See https://www.stata-press.com/data/r14/usmacro</span>
<span class="s1">fedfunds = [</span><span class="s4">1.03</span><span class="s2">, </span><span class="s4">0.99</span><span class="s2">, </span><span class="s4">1.34</span><span class="s2">, </span><span class="s4">1.5</span><span class="s2">, </span><span class="s4">1.94</span><span class="s2">, </span><span class="s4">2.36</span><span class="s2">, </span><span class="s4">2.48</span><span class="s2">, </span><span class="s4">2.69</span><span class="s2">, </span><span class="s4">2.81</span><span class="s2">, </span><span class="s4">2.93</span><span class="s2">, </span><span class="s4">2.93</span><span class="s2">,</span>
            <span class="s4">3.0</span><span class="s2">, </span><span class="s4">3.23</span><span class="s2">, </span><span class="s4">3.25</span><span class="s2">, </span><span class="s4">1.86</span><span class="s2">, </span><span class="s4">0.94</span><span class="s2">, </span><span class="s4">1.32</span><span class="s2">, </span><span class="s4">2.16</span><span class="s2">, </span><span class="s4">2.57</span><span class="s2">, </span><span class="s4">3.08</span><span class="s2">, </span><span class="s4">3.58</span><span class="s2">, </span><span class="s4">3.99</span><span class="s2">,</span>
            <span class="s4">3.93</span><span class="s2">, </span><span class="s4">3.7</span><span class="s2">, </span><span class="s4">2.94</span><span class="s2">, </span><span class="s4">2.3</span><span class="s2">, </span><span class="s4">2.0</span><span class="s2">, </span><span class="s4">1.73</span><span class="s2">, </span><span class="s4">1.68</span><span class="s2">, </span><span class="s4">2.4</span><span class="s2">, </span><span class="s4">2.46</span><span class="s2">, </span><span class="s4">2.61</span><span class="s2">, </span><span class="s4">2.85</span><span class="s2">,</span>
            <span class="s4">2.92</span><span class="s2">, </span><span class="s4">2.97</span><span class="s2">, </span><span class="s4">2.96</span><span class="s2">, </span><span class="s4">3.33</span><span class="s2">, </span><span class="s4">3.45</span><span class="s2">, </span><span class="s4">3.46</span><span class="s2">, </span><span class="s4">3.49</span><span class="s2">, </span><span class="s4">3.46</span><span class="s2">, </span><span class="s4">3.58</span><span class="s2">, </span><span class="s4">3.97</span><span class="s2">, </span><span class="s4">4.08</span><span class="s2">,</span>
            <span class="s4">4.07</span><span class="s2">, </span><span class="s4">4.17</span><span class="s2">, </span><span class="s4">4.56</span><span class="s2">, </span><span class="s4">4.91</span><span class="s2">, </span><span class="s4">5.41</span><span class="s2">, </span><span class="s4">5.56</span><span class="s2">, </span><span class="s4">4.82</span><span class="s2">, </span><span class="s4">3.99</span><span class="s2">, </span><span class="s4">3.89</span><span class="s2">, </span><span class="s4">4.17</span><span class="s2">, </span><span class="s4">4.79</span><span class="s2">,</span>
            <span class="s4">5.98</span><span class="s2">, </span><span class="s4">5.94</span><span class="s2">, </span><span class="s4">5.92</span><span class="s2">, </span><span class="s4">6.57</span><span class="s2">, </span><span class="s4">8.33</span><span class="s2">, </span><span class="s4">8.98</span><span class="s2">, </span><span class="s4">8.94</span><span class="s2">, </span><span class="s4">8.57</span><span class="s2">, </span><span class="s4">7.88</span><span class="s2">, </span><span class="s4">6.7</span><span class="s2">, </span><span class="s4">5.57</span><span class="s2">,</span>
            <span class="s4">3.86</span><span class="s2">, </span><span class="s4">4.56</span><span class="s2">, </span><span class="s4">5.47</span><span class="s2">, </span><span class="s4">4.75</span><span class="s2">, </span><span class="s4">3.54</span><span class="s2">, </span><span class="s4">4.3</span><span class="s2">, </span><span class="s4">4.74</span><span class="s2">, </span><span class="s4">5.14</span><span class="s2">, </span><span class="s4">6.54</span><span class="s2">, </span><span class="s4">7.82</span><span class="s2">, </span><span class="s4">10.56</span><span class="s2">,</span>
            <span class="s4">10.0</span><span class="s2">, </span><span class="s4">9.32</span><span class="s2">, </span><span class="s4">11.25</span><span class="s2">, </span><span class="s4">12.09</span><span class="s2">, </span><span class="s4">9.35</span><span class="s2">, </span><span class="s4">6.3</span><span class="s2">, </span><span class="s4">5.42</span><span class="s2">, </span><span class="s4">6.16</span><span class="s2">, </span><span class="s4">5.41</span><span class="s2">, </span><span class="s4">4.83</span><span class="s2">, </span><span class="s4">5.2</span><span class="s2">,</span>
            <span class="s4">5.28</span><span class="s2">, </span><span class="s4">4.87</span><span class="s2">, </span><span class="s4">4.66</span><span class="s2">, </span><span class="s4">5.16</span><span class="s2">, </span><span class="s4">5.82</span><span class="s2">, </span><span class="s4">6.51</span><span class="s2">, </span><span class="s4">6.76</span><span class="s2">, </span><span class="s4">7.28</span><span class="s2">, </span><span class="s4">8.1</span><span class="s2">, </span><span class="s4">9.58</span><span class="s2">, </span><span class="s4">10.07</span><span class="s2">,</span>
            <span class="s4">10.18</span><span class="s2">, </span><span class="s4">10.95</span><span class="s2">, </span><span class="s4">13.58</span><span class="s2">, </span><span class="s4">15.05</span><span class="s2">, </span><span class="s4">12.69</span><span class="s2">, </span><span class="s4">9.84</span><span class="s2">, </span><span class="s4">15.85</span><span class="s2">, </span><span class="s4">16.57</span><span class="s2">, </span><span class="s4">17.78</span><span class="s2">,</span>
            <span class="s4">17.58</span><span class="s2">, </span><span class="s4">13.59</span><span class="s2">, </span><span class="s4">14.23</span><span class="s2">, </span><span class="s4">14.51</span><span class="s2">, </span><span class="s4">11.01</span><span class="s2">, </span><span class="s4">9.29</span><span class="s2">, </span><span class="s4">8.65</span><span class="s2">, </span><span class="s4">8.8</span><span class="s2">, </span><span class="s4">9.46</span><span class="s2">, </span><span class="s4">9.43</span><span class="s2">,</span>
            <span class="s4">9.69</span><span class="s2">, </span><span class="s4">10.56</span><span class="s2">, </span><span class="s4">11.39</span><span class="s2">, </span><span class="s4">9.27</span><span class="s2">, </span><span class="s4">8.48</span><span class="s2">, </span><span class="s4">7.92</span><span class="s2">, </span><span class="s4">7.9</span><span class="s2">, </span><span class="s4">8.1</span><span class="s2">, </span><span class="s4">7.83</span><span class="s2">, </span><span class="s4">6.92</span><span class="s2">, </span><span class="s4">6.21</span><span class="s2">,</span>
            <span class="s4">6.27</span><span class="s2">, </span><span class="s4">6.22</span><span class="s2">, </span><span class="s4">6.65</span><span class="s2">, </span><span class="s4">6.84</span><span class="s2">, </span><span class="s4">6.92</span><span class="s2">, </span><span class="s4">6.66</span><span class="s2">, </span><span class="s4">7.16</span><span class="s2">, </span><span class="s4">7.98</span><span class="s2">, </span><span class="s4">8.47</span><span class="s2">, </span><span class="s4">9.44</span><span class="s2">, </span><span class="s4">9.73</span><span class="s2">,</span>
            <span class="s4">9.08</span><span class="s2">, </span><span class="s4">8.61</span><span class="s2">, </span><span class="s4">8.25</span><span class="s2">, </span><span class="s4">8.24</span><span class="s2">, </span><span class="s4">8.16</span><span class="s2">, </span><span class="s4">7.74</span><span class="s2">, </span><span class="s4">6.43</span><span class="s2">, </span><span class="s4">5.86</span><span class="s2">, </span><span class="s4">5.64</span><span class="s2">, </span><span class="s4">4.82</span><span class="s2">, </span><span class="s4">4.02</span><span class="s2">,</span>
            <span class="s4">3.77</span><span class="s2">, </span><span class="s4">3.26</span><span class="s2">, </span><span class="s4">3.04</span><span class="s2">, </span><span class="s4">3.04</span><span class="s2">, </span><span class="s4">3.0</span><span class="s2">, </span><span class="s4">3.06</span><span class="s2">, </span><span class="s4">2.99</span><span class="s2">, </span><span class="s4">3.21</span><span class="s2">, </span><span class="s4">3.94</span><span class="s2">, </span><span class="s4">4.49</span><span class="s2">, </span><span class="s4">5.17</span><span class="s2">,</span>
            <span class="s4">5.81</span><span class="s2">, </span><span class="s4">6.02</span><span class="s2">, </span><span class="s4">5.8</span><span class="s2">, </span><span class="s4">5.72</span><span class="s2">, </span><span class="s4">5.36</span><span class="s2">, </span><span class="s4">5.24</span><span class="s2">, </span><span class="s4">5.31</span><span class="s2">, </span><span class="s4">5.28</span><span class="s2">, </span><span class="s4">5.28</span><span class="s2">, </span><span class="s4">5.52</span><span class="s2">, </span><span class="s4">5.53</span><span class="s2">,</span>
            <span class="s4">5.51</span><span class="s2">, </span><span class="s4">5.52</span><span class="s2">, </span><span class="s4">5.5</span><span class="s2">, </span><span class="s4">5.53</span><span class="s2">, </span><span class="s4">4.86</span><span class="s2">, </span><span class="s4">4.73</span><span class="s2">, </span><span class="s4">4.75</span><span class="s2">, </span><span class="s4">5.09</span><span class="s2">, </span><span class="s4">5.31</span><span class="s2">, </span><span class="s4">5.68</span><span class="s2">, </span><span class="s4">6.27</span><span class="s2">,</span>
            <span class="s4">6.52</span><span class="s2">, </span><span class="s4">6.47</span><span class="s2">, </span><span class="s4">5.59</span><span class="s2">, </span><span class="s4">4.33</span><span class="s2">, </span><span class="s4">3.5</span><span class="s2">, </span><span class="s4">2.13</span><span class="s2">, </span><span class="s4">1.73</span><span class="s2">, </span><span class="s4">1.75</span><span class="s2">, </span><span class="s4">1.74</span><span class="s2">, </span><span class="s4">1.44</span><span class="s2">, </span><span class="s4">1.25</span><span class="s2">,</span>
            <span class="s4">1.25</span><span class="s2">, </span><span class="s4">1.02</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">1.01</span><span class="s2">, </span><span class="s4">1.43</span><span class="s2">, </span><span class="s4">1.95</span><span class="s2">, </span><span class="s4">2.47</span><span class="s2">, </span><span class="s4">2.94</span><span class="s2">, </span><span class="s4">3.46</span><span class="s2">, </span><span class="s4">3.98</span><span class="s2">,</span>
            <span class="s4">4.46</span><span class="s2">, </span><span class="s4">4.91</span><span class="s2">, </span><span class="s4">5.25</span><span class="s2">, </span><span class="s4">5.25</span><span class="s2">, </span><span class="s4">5.26</span><span class="s2">, </span><span class="s4">5.25</span><span class="s2">, </span><span class="s4">5.07</span><span class="s2">, </span><span class="s4">4.5</span><span class="s2">, </span><span class="s4">3.18</span><span class="s2">, </span><span class="s4">2.09</span><span class="s2">, </span><span class="s4">1.94</span><span class="s2">,</span>
            <span class="s4">0.51</span><span class="s2">, </span><span class="s4">0.18</span><span class="s2">, </span><span class="s4">0.18</span><span class="s2">, </span><span class="s4">0.16</span><span class="s2">, </span><span class="s4">0.12</span><span class="s2">, </span><span class="s4">0.13</span><span class="s2">, </span><span class="s4">0.19</span><span class="s2">, </span><span class="s4">0.19</span><span class="s2">, </span><span class="s4">0.19</span><span class="s1">]</span>

<span class="s3"># See https://www.stata-press.com/data/r14/usmacro</span>
<span class="s1">ogap = [-</span><span class="s4">0.53340107</span><span class="s2">, </span><span class="s4">0.72974336</span><span class="s2">, </span><span class="s4">2.93532324</span><span class="s2">, </span><span class="s4">3.58194304</span><span class="s2">, </span><span class="s4">4.15760183</span><span class="s2">,</span>
        <span class="s4">4.28775644</span><span class="s2">, </span><span class="s4">3.01683831</span><span class="s2">, </span><span class="s4">2.64185619</span><span class="s2">, </span><span class="s4">1.82473528</span><span class="s2">, </span><span class="s4">2.37461162</span><span class="s2">,</span>
        <span class="s4">2.39338565</span><span class="s2">, </span><span class="s4">1.24197006</span><span class="s2">, </span><span class="s4">1.1370815</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.28657401</span><span class="s2">, </span><span class="s1">-</span><span class="s4">4.46665335</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">4.79258966</span><span class="s2">, </span><span class="s1">-</span><span class="s4">3.06711817</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.3212384</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.54485309</span><span class="s2">, </span><span class="s4">0.86588413</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">0.2469136</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.75004685</span><span class="s2">, </span><span class="s4">0.7417022</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.71350163</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.5151515</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">3.80444455</span><span class="s2">, </span><span class="s1">-</span><span class="s4">4.02601957</span><span class="s2">, </span><span class="s1">-</span><span class="s4">3.17873883</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.48841596</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.42372882</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">0.61779928</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.6430338</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.73277968</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.38330388</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.31537247</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">0.95626277</span><span class="s2">, </span><span class="s4">0.</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.15248552</span><span class="s2">, </span><span class="s4">0.93233085</span><span class="s2">, </span><span class="s4">1.03888392</span><span class="s2">,</span>
        <span class="s4">1.27174389</span><span class="s2">, </span><span class="s4">0.63400578</span><span class="s2">, </span><span class="s4">2.13007665</span><span class="s2">, </span><span class="s4">2.44789481</span><span class="s2">, </span><span class="s4">3.37605071</span><span class="s2">,</span>
        <span class="s4">4.72771597</span><span class="s2">, </span><span class="s4">6.20753956</span><span class="s2">, </span><span class="s4">5.39234877</span><span class="s2">, </span><span class="s4">5.0825758</span><span class="s2">, </span><span class="s4">4.8605876</span><span class="s2">,</span>
        <span class="s4">4.65116262</span><span class="s2">, </span><span class="s4">3.52755141</span><span class="s2">, </span><span class="s4">3.35122228</span><span class="s2">, </span><span class="s4">3.09326482</span><span class="s2">, </span><span class="s4">4.10191917</span><span class="s2">,</span>
        <span class="s4">4.69641066</span><span class="s2">, </span><span class="s4">4.38452244</span><span class="s2">, </span><span class="s4">3.79841614</span><span class="s2">, </span><span class="s4">4.38338947</span><span class="s2">, </span><span class="s4">3.63766766</span><span class="s2">,</span>
        <span class="s4">3.24129653</span><span class="s2">, </span><span class="s4">1.84967709</span><span class="s2">, </span><span class="s4">0.75554705</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.02802691</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.03673432</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">1.90527546</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.14918824</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.42940569</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.46382189</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.97892815</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">0.12142799</span><span class="s2">, </span><span class="s4">1.37281513</span><span class="s2">, </span><span class="s4">1.5143193</span><span class="s2">, </span><span class="s4">2.47730422</span><span class="s2">, </span><span class="s4">3.9762032</span><span class="s2">,</span>
        <span class="s4">4.08987427</span><span class="s2">, </span><span class="s4">2.62857127</span><span class="s2">, </span><span class="s4">2.90107131</span><span class="s2">, </span><span class="s4">0.97277576</span><span class="s2">, </span><span class="s4">0.42547619</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">1.60488391</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.97784758</span><span class="s2">, </span><span class="s1">-</span><span class="s4">4.98650694</span><span class="s2">, </span><span class="s1">-</span><span class="s4">5.03382635</span><span class="s2">, </span><span class="s1">-</span><span class="s4">4.25698328</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">3.74993205</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.39661908</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.41223454</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.66694117</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.62232494</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">2.29969597</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.38809109</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.67855304</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.08100712</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.82682908</span><span class="s2">,</span>
        <span class="s4">0.92868561</span><span class="s2">, </span><span class="s4">0.87040615</span><span class="s2">, </span><span class="s4">1.32669306</span><span class="s2">, </span><span class="s4">0.56407404</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.13848817</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">0.13089494</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.58975571</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.00534534</span><span class="s2">, </span><span class="s1">-</span><span class="s4">3.55482054</span><span class="s2">, </span><span class="s1">-</span><span class="s4">4.20365095</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">2.97225475</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.57762408</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.77206445</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.32418823</span><span class="s2">, </span><span class="s1">-</span><span class="s4">4.01929235</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">6.25393772</span><span class="s2">, </span><span class="s1">-</span><span class="s4">6.46356869</span><span class="s2">, </span><span class="s1">-</span><span class="s4">7.47437572</span><span class="s2">, </span><span class="s1">-</span><span class="s4">8.06377602</span><span class="s2">, </span><span class="s1">-</span><span class="s4">7.57157278</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">6.14639282</span><span class="s2">, </span><span class="s1">-</span><span class="s4">5.00167227</span><span class="s2">, </span><span class="s1">-</span><span class="s4">3.74511886</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.54788184</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.64858043</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">1.47994602</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.44707143</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.31824112</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.20102882</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.57691002</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">0.64480144</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.57239723</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.93083948</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.8392899</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.19972074</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">1.18918467</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.87174636</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.78151888</span><span class="s2">, </span><span class="s4">0.10762761</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.10596547</span><span class="s2">,</span>
        <span class="s4">0.40488175</span><span class="s2">, </span><span class="s4">0.17958413</span><span class="s2">, </span><span class="s4">0.67704558</span><span class="s2">, </span><span class="s4">0.99767941</span><span class="s2">, </span><span class="s4">1.00495291</span><span class="s2">,</span>
        <span class="s4">0.98304421</span><span class="s2">, </span><span class="s4">0.47067845</span><span class="s2">, </span><span class="s4">0.80427116</span><span class="s2">, </span><span class="s4">0.45058677</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.26300991</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">1.84629929</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.99437666</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.90482664</span><span class="s2">, </span><span class="s1">-</span><span class="s4">3.09490418</span><span class="s2">, </span><span class="s1">-</span><span class="s4">3.32399321</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">2.87384319</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.47262239</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.19618678</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.91843009</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.46574545</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">2.58180451</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.72212362</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.17548561</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.96046102</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.3287729</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">1.42521954</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.04951096</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.47037697</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.87099183</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.72912872</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">1.76828432</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.85885167</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.9193368</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.95776832</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.62119246</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">0.53508854</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.04090983</span><span class="s2">, </span><span class="s4">0.47511154</span><span class="s2">, </span><span class="s4">0.41246772</span><span class="s2">, </span><span class="s4">0.57928383</span><span class="s2">,</span>
        <span class="s4">0.67604625</span><span class="s2">, </span><span class="s4">1.1378212</span><span class="s2">, </span><span class="s4">1.96481478</span><span class="s2">, </span><span class="s4">2.05066752</span><span class="s2">, </span><span class="s4">1.93714142</span><span class="s2">,</span>
        <span class="s4">2.34412026</span><span class="s2">, </span><span class="s4">3.16807413</span><span class="s2">, </span><span class="s4">2.57455897</span><span class="s2">, </span><span class="s4">3.59218717</span><span class="s2">, </span><span class="s4">2.79711962</span><span class="s2">,</span>
        <span class="s4">2.41787243</span><span class="s2">, </span><span class="s4">1.19362748</span><span class="s2">, </span><span class="s4">0.82524049</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.36692095</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.00542021</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">0.89346135</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.23166943</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.56921482</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.29188299</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.56877398</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">2.37549472</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.4183135</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.00017595</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.03901041</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.86736482</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">0.63541794</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.38296556</span><span class="s2">, </span><span class="s4">0.11404825</span><span class="s2">, </span><span class="s4">0.07249562</span><span class="s2">, </span><span class="s4">0.30608681</span><span class="s2">,</span>
        <span class="s4">0.27121997</span><span class="s2">, </span><span class="s4">0.90333837</span><span class="s2">, </span><span class="s4">0.595429</span><span class="s2">, </span><span class="s4">0.08057959</span><span class="s2">, </span><span class="s4">0.25154814</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">0.27741581</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.14053501</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.06035376</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.2722317</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.5122633</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">1.5272249</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.5325017</span><span class="s2">, </span><span class="s1">-</span><span class="s4">5.14671373</span><span class="s2">, </span><span class="s1">-</span><span class="s4">6.88223982</span><span class="s2">, </span><span class="s1">-</span><span class="s4">7.36753035</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">7.43927145</span><span class="s2">, </span><span class="s1">-</span><span class="s4">6.89403868</span><span class="s2">, </span><span class="s1">-</span><span class="s4">6.8306222</span><span class="s2">, </span><span class="s1">-</span><span class="s4">6.26507998</span><span class="s2">, </span><span class="s1">-</span><span class="s4">5.93287086</span><span class="s2">,</span>
        <span class="s1">-</span><span class="s4">5.59370756</span><span class="s1">]</span>

<span class="s3"># See https://www.stata-press.com/data/r14/usmacro</span>
<span class="s1">inf = [np.nan</span><span class="s2">, </span><span class="s1">np.nan</span><span class="s2">, </span><span class="s1">np.nan</span><span class="s2">, </span><span class="s1">np.nan</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.2347243</span><span class="s2">,</span>
       <span class="s4">0.37373397</span><span class="s2">, </span><span class="s4">0.25006533</span><span class="s2">, </span><span class="s4">1.04645514</span><span class="s2">, </span><span class="s4">2.01665616</span><span class="s2">, </span><span class="s4">2.58033299</span><span class="s2">,</span>
       <span class="s4">3.41399837</span><span class="s2">, </span><span class="s4">3.60986805</span><span class="s2">, </span><span class="s4">3.46304512</span><span class="s2">, </span><span class="s4">3.08529949</span><span class="s2">, </span><span class="s4">3.45609665</span><span class="s2">,</span>
       <span class="s4">3.27347994</span><span class="s2">, </span><span class="s4">2.29982662</span><span class="s2">, </span><span class="s4">1.91197193</span><span class="s2">, </span><span class="s4">0.89083761</span><span class="s2">, </span><span class="s4">0.390598</span><span class="s2">,</span>
       <span class="s4">0.96842253</span><span class="s2">, </span><span class="s4">1.47531354</span><span class="s2">, </span><span class="s4">1.39343977</span><span class="s2">, </span><span class="s4">1.82488036</span><span class="s2">, </span><span class="s4">1.35991514</span><span class="s2">,</span>
       <span class="s4">1.39598227</span><span class="s2">, </span><span class="s4">1.50695646</span><span class="s2">, </span><span class="s4">0.8690359</span><span class="s2">, </span><span class="s4">1.20648873</span><span class="s2">, </span><span class="s4">0.70517123</span><span class="s2">,</span>
       <span class="s4">0.89477205</span><span class="s2">, </span><span class="s4">1.30740857</span><span class="s2">, </span><span class="s4">1.20212376</span><span class="s2">, </span><span class="s4">1.30043352</span><span class="s2">, </span><span class="s4">1.22895002</span><span class="s2">,</span>
       <span class="s4">1.03573787</span><span class="s2">, </span><span class="s4">1.36272156</span><span class="s2">, </span><span class="s4">1.39236343</span><span class="s2">, </span><span class="s4">1.48636675</span><span class="s2">, </span><span class="s4">1.46398985</span><span class="s2">,</span>
       <span class="s4">1.07421875</span><span class="s2">, </span><span class="s4">1.26611042</span><span class="s2">, </span><span class="s4">1.1639185</span><span class="s2">, </span><span class="s4">1.64622331</span><span class="s2">, </span><span class="s4">1.71658623</span><span class="s2">,</span>
       <span class="s4">1.78565705</span><span class="s2">, </span><span class="s4">2.41930342</span><span class="s2">, </span><span class="s4">2.6897428</span><span class="s2">, </span><span class="s4">3.27391338</span><span class="s2">, </span><span class="s4">3.5685041</span><span class="s2">,</span>
       <span class="s4">2.87078357</span><span class="s2">, </span><span class="s4">2.56671929</span><span class="s2">, </span><span class="s4">2.70717716</span><span class="s2">, </span><span class="s4">2.99242783</span><span class="s2">, </span><span class="s4">3.74010396</span><span class="s2">,</span>
       <span class="s4">4.11855173</span><span class="s2">, </span><span class="s4">4.47761202</span><span class="s2">, </span><span class="s4">4.62397051</span><span class="s2">, </span><span class="s4">4.87426901</span><span class="s2">, </span><span class="s4">5.50198364</span><span class="s2">,</span>
       <span class="s4">5.52285719</span><span class="s2">, </span><span class="s4">5.83354473</span><span class="s2">, </span><span class="s4">6.22577858</span><span class="s2">, </span><span class="s4">6.03848171</span><span class="s2">, </span><span class="s4">5.68597221</span><span class="s2">,</span>
       <span class="s4">5.60000038</span><span class="s2">, </span><span class="s4">4.81102371</span><span class="s2">, </span><span class="s4">4.31496382</span><span class="s2">, </span><span class="s4">4.27074528</span><span class="s2">, </span><span class="s4">3.53535342</span><span class="s2">,</span>
       <span class="s4">3.50587225</span><span class="s2">, </span><span class="s4">3.22580624</span><span class="s2">, </span><span class="s4">3.02948403</span><span class="s2">, </span><span class="s4">3.33414626</span><span class="s2">, </span><span class="s4">4.1129365</span><span class="s2">,</span>
       <span class="s4">5.60817289</span><span class="s2">, </span><span class="s4">6.83709764</span><span class="s2">, </span><span class="s4">8.41692829</span><span class="s2">, </span><span class="s4">9.91564655</span><span class="s2">, </span><span class="s4">10.54788017</span><span class="s2">,</span>
       <span class="s4">11.45758915</span><span class="s2">, </span><span class="s4">12.04798317</span><span class="s2">, </span><span class="s4">11.13530636</span><span class="s2">, </span><span class="s4">9.53939915</span><span class="s2">, </span><span class="s4">8.67963028</span><span class="s2">,</span>
       <span class="s4">7.38337183</span><span class="s2">, </span><span class="s4">6.34047985</span><span class="s2">, </span><span class="s4">6.01503754</span><span class="s2">, </span><span class="s4">5.58903217</span><span class="s2">, </span><span class="s4">5.18573475</span><span class="s2">,</span>
       <span class="s4">5.90339899</span><span class="s2">, </span><span class="s4">6.79609919</span><span class="s2">, </span><span class="s4">6.57417107</span><span class="s2">, </span><span class="s4">6.59522104</span><span class="s2">, </span><span class="s4">6.47466183</span><span class="s2">,</span>
       <span class="s4">7.02936935</span><span class="s2">, </span><span class="s4">8.02397346</span><span class="s2">, </span><span class="s4">8.9289465</span><span class="s2">, </span><span class="s4">9.78376389</span><span class="s2">, </span><span class="s4">10.75433922</span><span class="s2">,</span>
       <span class="s4">11.72252846</span><span class="s2">, </span><span class="s4">12.64148235</span><span class="s2">, </span><span class="s4">14.20953751</span><span class="s2">, </span><span class="s4">14.42577076</span><span class="s2">, </span><span class="s4">12.93487072</span><span class="s2">,</span>
       <span class="s4">12.53929329</span><span class="s2">, </span><span class="s4">11.26111889</span><span class="s2">, </span><span class="s4">9.87392902</span><span class="s2">, </span><span class="s4">10.85386753</span><span class="s2">, </span><span class="s4">9.5831337</span><span class="s2">,</span>
       <span class="s4">7.58190918</span><span class="s2">, </span><span class="s4">6.90676928</span><span class="s2">, </span><span class="s4">5.81573057</span><span class="s2">, </span><span class="s4">4.44292784</span><span class="s2">, </span><span class="s4">3.59408045</span><span class="s2">,</span>
       <span class="s4">3.29905081</span><span class="s2">, </span><span class="s4">2.52680969</span><span class="s2">, </span><span class="s4">3.23384356</span><span class="s2">, </span><span class="s4">4.62551022</span><span class="s2">, </span><span class="s4">4.40519285</span><span class="s2">,</span>
       <span class="s4">4.29570436</span><span class="s2">, </span><span class="s4">4.1543026</span><span class="s2">, </span><span class="s4">3.64175439</span><span class="s2">, </span><span class="s4">3.60676312</span><span class="s2">, </span><span class="s4">3.35249043</span><span class="s2">,</span>
       <span class="s4">3.5137701</span><span class="s2">, </span><span class="s4">3.1053853</span><span class="s2">, </span><span class="s4">1.67858768</span><span class="s2">, </span><span class="s4">1.66821122</span><span class="s2">, </span><span class="s4">1.34587157</span><span class="s2">,</span>
       <span class="s4">2.03802228</span><span class="s2">, </span><span class="s4">3.69979739</span><span class="s2">, </span><span class="s4">4.16317225</span><span class="s2">, </span><span class="s4">4.40493536</span><span class="s2">, </span><span class="s4">3.96511626</span><span class="s2">,</span>
       <span class="s4">3.97994113</span><span class="s2">, </span><span class="s4">4.1420536</span><span class="s2">, </span><span class="s4">4.3066597</span><span class="s2">, </span><span class="s4">4.67509222</span><span class="s2">, </span><span class="s4">5.15961123</span><span class="s2">,</span>
       <span class="s4">4.70588255</span><span class="s2">, </span><span class="s4">4.62759781</span><span class="s2">, </span><span class="s4">5.23231459</span><span class="s2">, </span><span class="s4">4.58372736</span><span class="s2">, </span><span class="s4">5.56420517</span><span class="s2">,</span>
       <span class="s4">6.27646685</span><span class="s2">, </span><span class="s4">5.25958157</span><span class="s2">, </span><span class="s4">4.84686804</span><span class="s2">, </span><span class="s4">3.85226536</span><span class="s2">, </span><span class="s4">2.96485686</span><span class="s2">,</span>
       <span class="s4">2.89388347</span><span class="s2">, </span><span class="s4">3.07301927</span><span class="s2">, </span><span class="s4">3.07467055</span><span class="s2">, </span><span class="s4">3.12198234</span><span class="s2">, </span><span class="s4">3.17306924</span><span class="s2">,</span>
       <span class="s4">3.12524581</span><span class="s2">, </span><span class="s4">2.8174715</span><span class="s2">, </span><span class="s4">2.76977897</span><span class="s2">, </span><span class="s4">2.53936958</span><span class="s2">, </span><span class="s4">2.38237333</span><span class="s2">,</span>
       <span class="s4">2.85493255</span><span class="s2">, </span><span class="s4">2.60332823</span><span class="s2">, </span><span class="s4">2.84049082</span><span class="s2">, </span><span class="s4">3.09557867</span><span class="s2">, </span><span class="s4">2.66420412</span><span class="s2">,</span>
       <span class="s4">2.62607908</span><span class="s2">, </span><span class="s4">2.78390908</span><span class="s2">, </span><span class="s4">2.8270874</span><span class="s2">, </span><span class="s4">2.8999064</span><span class="s2">, </span><span class="s4">3.23162007</span><span class="s2">,</span>
       <span class="s4">2.94453382</span><span class="s2">, </span><span class="s4">2.30179024</span><span class="s2">, </span><span class="s4">2.22504783</span><span class="s2">, </span><span class="s4">1.89075232</span><span class="s2">, </span><span class="s4">1.48277605</span><span class="s2">,</span>
       <span class="s4">1.58312511</span><span class="s2">, </span><span class="s4">1.59639311</span><span class="s2">, </span><span class="s4">1.5253576</span><span class="s2">, </span><span class="s4">1.68703699</span><span class="s2">, </span><span class="s4">2.11280179</span><span class="s2">,</span>
       <span class="s4">2.34625125</span><span class="s2">, </span><span class="s4">2.61982656</span><span class="s2">, </span><span class="s4">3.25799918</span><span class="s2">, </span><span class="s4">3.29342604</span><span class="s2">, </span><span class="s4">3.46889949</span><span class="s2">,</span>
       <span class="s4">3.44350553</span><span class="s2">, </span><span class="s4">3.40975904</span><span class="s2">, </span><span class="s4">3.32491398</span><span class="s2">, </span><span class="s4">2.67803454</span><span class="s2">, </span><span class="s4">1.87507534</span><span class="s2">,</span>
       <span class="s4">1.23194993</span><span class="s2">, </span><span class="s4">1.31765401</span><span class="s2">, </span><span class="s4">1.57628381</span><span class="s2">, </span><span class="s4">2.25352097</span><span class="s2">, </span><span class="s4">2.97640777</span><span class="s2">,</span>
       <span class="s4">2.00593972</span><span class="s2">, </span><span class="s4">2.21688938</span><span class="s2">, </span><span class="s4">2.00165296</span><span class="s2">, </span><span class="s4">1.81766617</span><span class="s2">, </span><span class="s4">2.78586531</span><span class="s2">,</span>
       <span class="s4">2.67522621</span><span class="s2">, </span><span class="s4">3.38513398</span><span class="s2">, </span><span class="s4">3.0353508</span><span class="s2">, </span><span class="s4">2.92293549</span><span class="s2">, </span><span class="s4">3.81956744</span><span class="s2">,</span>
       <span class="s4">3.6745038</span><span class="s2">, </span><span class="s4">3.69086194</span><span class="s2">, </span><span class="s4">3.92426181</span><span class="s2">, </span><span class="s4">3.34028482</span><span class="s2">, </span><span class="s4">1.96539891</span><span class="s2">,</span>
       <span class="s4">2.43147993</span><span class="s2">, </span><span class="s4">2.66511655</span><span class="s2">, </span><span class="s4">2.34880662</span><span class="s2">, </span><span class="s4">4.03147316</span><span class="s2">, </span><span class="s4">4.13719845</span><span class="s2">,</span>
       <span class="s4">4.31058264</span><span class="s2">, </span><span class="s4">5.25250196</span><span class="s2">, </span><span class="s4">1.59580016</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.1842365</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.94229329</span><span class="s2">,</span>
       <span class="s1">-</span><span class="s4">1.60695589</span><span class="s2">, </span><span class="s4">1.48749816</span><span class="s2">, </span><span class="s4">2.33687115</span><span class="s2">, </span><span class="s4">1.78588998</span><span class="s2">, </span><span class="s4">1.22873163</span><span class="s2">,</span>
       <span class="s4">1.21550024</span><span class="s1">]</span>

<span class="s3"># See https://www.stata-press.com/data/r14/snp500</span>
<span class="s1">areturns = [</span><span class="s4">1.60864139</span><span class="s2">, </span><span class="s4">0.6581642</span><span class="s2">, </span><span class="s4">0.91177338</span><span class="s2">,</span>
            <span class="s4">1.88970506</span><span class="s2">, </span><span class="s4">0.76378739</span><span class="s2">, </span><span class="s4">0.10790635</span><span class="s2">, </span><span class="s4">0.29509732</span><span class="s2">,</span>
            <span class="s4">0.16913767</span><span class="s2">, </span><span class="s4">1.30772412</span><span class="s2">, </span><span class="s4">0.85901159</span><span class="s2">, </span><span class="s4">0.92307973</span><span class="s2">,</span>
            <span class="s4">0.9833895</span><span class="s2">, </span><span class="s4">0.9116146</span><span class="s2">, </span><span class="s4">2.58575296</span><span class="s2">, </span><span class="s4">0.36441925</span><span class="s2">,</span>
            <span class="s4">1.89720023</span><span class="s2">, </span><span class="s4">0.65161127</span><span class="s2">, </span><span class="s4">1.17255056</span><span class="s2">, </span><span class="s4">0.53518051</span><span class="s2">,</span>
            <span class="s4">0.00534112</span><span class="s2">, </span><span class="s4">1.25064528</span><span class="s2">, </span><span class="s4">2.00023437</span><span class="s2">, </span><span class="s4">0.79801333</span><span class="s2">,</span>
            <span class="s4">1.42980587</span><span class="s2">, </span><span class="s4">0.02078664</span><span class="s2">, </span><span class="s4">2.31948757</span><span class="s2">, </span><span class="s4">2.78705025</span><span class="s2">,</span>
            <span class="s4">1.36003578</span><span class="s2">, </span><span class="s4">0.15257211</span><span class="s2">, </span><span class="s4">0.30815724</span><span class="s2">, </span><span class="s4">0.40030465</span><span class="s2">,</span>
            <span class="s4">0.89941251</span><span class="s2">, </span><span class="s4">0.36925647</span><span class="s2">, </span><span class="s4">0.75660467</span><span class="s2">, </span><span class="s4">0.87896836</span><span class="s2">,</span>
            <span class="s4">1.07261622</span><span class="s2">, </span><span class="s4">0.1137321</span><span class="s2">, </span><span class="s4">1.32838523</span><span class="s2">, </span><span class="s4">1.03085732</span><span class="s2">,</span>
            <span class="s4">1.33930087</span><span class="s2">, </span><span class="s4">0.66706187</span><span class="s2">, </span><span class="s4">0.94959277</span><span class="s2">, </span><span class="s4">1.07173061</span><span class="s2">,</span>
            <span class="s4">0.80687243</span><span class="s2">, </span><span class="s4">1.35347247</span><span class="s2">, </span><span class="s4">1.56781077</span><span class="s2">, </span><span class="s4">0.71599048</span><span class="s2">,</span>
            <span class="s4">0.50293237</span><span class="s2">, </span><span class="s4">0.33926481</span><span class="s2">, </span><span class="s4">2.94415998</span><span class="s2">, </span><span class="s4">0.72026408</span><span class="s2">,</span>
            <span class="s4">0.28967711</span><span class="s2">, </span><span class="s4">1.05362082</span><span class="s2">, </span><span class="s4">0.3702977</span><span class="s2">, </span><span class="s4">2.05277085</span><span class="s2">,</span>
            <span class="s4">0.49342933</span><span class="s2">, </span><span class="s4">0.03423685</span><span class="s2">, </span><span class="s4">0.34392089</span><span class="s2">, </span><span class="s4">1.01741159</span><span class="s2">,</span>
            <span class="s4">1.43457139</span><span class="s2">, </span><span class="s4">0.03759775</span><span class="s2">, </span><span class="s4">1.54626679</span><span class="s2">, </span><span class="s4">1.07742834</span><span class="s2">,</span>
            <span class="s4">0.28664029</span><span class="s2">, </span><span class="s4">0.72592038</span><span class="s2">, </span><span class="s4">0.91093767</span><span class="s2">, </span><span class="s4">0.06915179</span><span class="s2">,</span>
            <span class="s4">0.88005662</span><span class="s2">, </span><span class="s4">0.47802091</span><span class="s2">, </span><span class="s4">1.2907486</span><span class="s2">, </span><span class="s4">0.57604247</span><span class="s2">,</span>
            <span class="s4">0.71046084</span><span class="s2">, </span><span class="s4">0.81753206</span><span class="s2">, </span><span class="s4">0.26241753</span><span class="s2">, </span><span class="s4">2.57300162</span><span class="s2">,</span>
            <span class="s4">0.16590172</span><span class="s2">, </span><span class="s4">0.2918649</span><span class="s2">, </span><span class="s4">0.96136051</span><span class="s2">, </span><span class="s4">1.6711514</span><span class="s2">,</span>
            <span class="s4">0.94229084</span><span class="s2">, </span><span class="s4">1.83614326</span><span class="s2">, </span><span class="s4">0.28854966</span><span class="s2">, </span><span class="s4">0.35050908</span><span class="s2">,</span>
            <span class="s4">0.04593768</span><span class="s2">, </span><span class="s4">0.07599987</span><span class="s2">, </span><span class="s4">0.09888303</span><span class="s2">, </span><span class="s4">0.12907109</span><span class="s2">,</span>
            <span class="s4">2.0099268</span><span class="s2">, </span><span class="s4">0.23006552</span><span class="s2">, </span><span class="s4">1.18803704</span><span class="s2">, </span><span class="s4">0.99970037</span><span class="s2">,</span>
            <span class="s4">1.32702613</span><span class="s2">, </span><span class="s4">0.45646569</span><span class="s2">, </span><span class="s4">1.43720019</span><span class="s2">, </span><span class="s4">0.04425191</span><span class="s2">,</span>
            <span class="s4">0.53156406</span><span class="s2">, </span><span class="s4">0.45951003</span><span class="s2">, </span><span class="s4">1.26583254</span><span class="s2">, </span><span class="s4">0.26994073</span><span class="s2">,</span>
            <span class="s4">0.1238014</span><span class="s2">, </span><span class="s4">0.53068936</span><span class="s2">, </span><span class="s4">0.21927625</span><span class="s2">, </span><span class="s4">0.73882329</span><span class="s2">,</span>
            <span class="s4">0.13153869</span><span class="s2">, </span><span class="s4">0.97837049</span><span class="s2">, </span><span class="s4">2.36890459</span><span class="s2">, </span><span class="s4">2.29313374</span><span class="s2">,</span>
            <span class="s4">0.75562358</span><span class="s2">, </span><span class="s4">0.08656374</span><span class="s2">, </span><span class="s4">2.4979558</span><span class="s2">, </span><span class="s4">0.64189923</span><span class="s2">,</span>
            <span class="s4">0.22916116</span><span class="s2">, </span><span class="s4">2.27840376</span><span class="s2">, </span><span class="s4">0.46641645</span><span class="s2">, </span><span class="s4">2.02508688</span><span class="s2">,</span>
            <span class="s4">1.25530422</span><span class="s2">, </span><span class="s4">1.27711689</span><span class="s2">, </span><span class="s4">0.07773363</span><span class="s2">, </span><span class="s4">0.23380435</span><span class="s2">,</span>
            <span class="s4">1.58663058</span><span class="s2">, </span><span class="s4">0.19108967</span><span class="s2">, </span><span class="s4">0.52218717</span><span class="s2">, </span><span class="s4">0.18055375</span><span class="s2">,</span>
            <span class="s4">1.18262017</span><span class="s2">, </span><span class="s4">0.47418493</span><span class="s2">, </span><span class="s4">0.88282752</span><span class="s2">, </span><span class="s4">0.98944044</span><span class="s2">,</span>
            <span class="s4">1.04560554</span><span class="s2">, </span><span class="s4">0.65470523</span><span class="s2">, </span><span class="s4">0.2604697</span><span class="s2">, </span><span class="s4">0.14658713</span><span class="s2">,</span>
            <span class="s4">0.77688956</span><span class="s2">, </span><span class="s4">1.10911596</span><span class="s2">, </span><span class="s4">0.69967973</span><span class="s2">, </span><span class="s4">1.04578161</span><span class="s2">,</span>
            <span class="s4">0.29641318</span><span class="s2">, </span><span class="s4">0.98087156</span><span class="s2">, </span><span class="s4">0.46531865</span><span class="s2">, </span><span class="s4">0.11846001</span><span class="s2">,</span>
            <span class="s4">0.44440377</span><span class="s2">, </span><span class="s4">1.11066306</span><span class="s2">, </span><span class="s4">0.02238905</span><span class="s2">, </span><span class="s4">0.19865835</span><span class="s2">,</span>
            <span class="s4">1.48028743</span><span class="s2">, </span><span class="s4">0.27695858</span><span class="s2">, </span><span class="s4">0.9391492</span><span class="s2">, </span><span class="s4">1.70575404</span><span class="s2">,</span>
            <span class="s4">2.94507742</span><span class="s2">, </span><span class="s4">0.35386264</span><span class="s2">, </span><span class="s4">0.72816408</span><span class="s2">, </span><span class="s4">1.80369282</span><span class="s2">,</span>
            <span class="s4">0.12440593</span><span class="s2">, </span><span class="s4">1.04197288</span><span class="s2">, </span><span class="s4">1.2957871</span><span class="s2">, </span><span class="s4">1.35031664</span><span class="s2">,</span>
            <span class="s4">0.55384284</span><span class="s2">, </span><span class="s4">1.13915396</span><span class="s2">, </span><span class="s4">0.29186234</span><span class="s2">, </span><span class="s4">1.21344364</span><span class="s2">,</span>
            <span class="s4">0.23005128</span><span class="s2">, </span><span class="s4">0.85578758</span><span class="s2">, </span><span class="s4">1.80613887</span><span class="s2">, </span><span class="s4">1.55996382</span><span class="s2">,</span>
            <span class="s4">1.46395147</span><span class="s2">, </span><span class="s4">0.59826899</span><span class="s2">, </span><span class="s4">0.65880769</span><span class="s2">, </span><span class="s4">1.68974137</span><span class="s2">,</span>
            <span class="s4">1.12778795</span><span class="s2">, </span><span class="s4">4.19566727</span><span class="s2">, </span><span class="s4">0.14379959</span><span class="s2">, </span><span class="s4">2.09945345</span><span class="s2">,</span>
            <span class="s4">0.29264972</span><span class="s2">, </span><span class="s4">1.25936544</span><span class="s2">, </span><span class="s4">0.84738803</span><span class="s2">, </span><span class="s4">0.54094779</span><span class="s2">,</span>
            <span class="s4">2.27655816</span><span class="s2">, </span><span class="s4">1.48392296</span><span class="s2">, </span><span class="s4">1.13808954</span><span class="s2">, </span><span class="s4">1.16038692</span><span class="s2">,</span>
            <span class="s4">0.46204364</span><span class="s2">, </span><span class="s4">2.09433556</span><span class="s2">, </span><span class="s4">1.16782069</span><span class="s2">, </span><span class="s4">2.0192802</span><span class="s2">,</span>
            <span class="s4">2.6190269</span><span class="s2">, </span><span class="s4">1.63471925</span><span class="s2">, </span><span class="s4">0.25279006</span><span class="s2">, </span><span class="s4">2.64083171</span><span class="s2">,</span>
            <span class="s4">1.64290273</span><span class="s2">, </span><span class="s4">2.42852569</span><span class="s2">, </span><span class="s4">1.54714262</span><span class="s2">, </span><span class="s4">1.14975035</span><span class="s2">,</span>
            <span class="s4">3.59362221</span><span class="s2">, </span><span class="s4">1.16689992</span><span class="s2">, </span><span class="s4">5.11030865</span><span class="s2">, </span><span class="s4">1.81326246</span><span class="s2">,</span>
            <span class="s4">0.93489766</span><span class="s2">, </span><span class="s4">1.38605726</span><span class="s2">, </span><span class="s4">0.53841805</span><span class="s2">, </span><span class="s4">1.02298951</span><span class="s2">,</span>
            <span class="s4">2.03038621</span><span class="s2">, </span><span class="s4">2.8340385</span><span class="s2">, </span><span class="s4">0.13691254</span><span class="s2">, </span><span class="s4">3.18769765</span><span class="s2">,</span>
            <span class="s4">0.23076122</span><span class="s2">, </span><span class="s4">1.95332313</span><span class="s2">, </span><span class="s4">1.63122225</span><span class="s2">, </span><span class="s4">2.66484141</span><span class="s2">,</span>
            <span class="s4">0.86377442</span><span class="s2">, </span><span class="s4">1.1782372</span><span class="s2">, </span><span class="s4">0.57231718</span><span class="s2">, </span><span class="s4">1.11979997</span><span class="s2">,</span>
            <span class="s4">2.07001758</span><span class="s2">, </span><span class="s4">0.08726255</span><span class="s2">, </span><span class="s4">1.71130466</span><span class="s2">, </span><span class="s4">1.04979181</span><span class="s2">,</span>
            <span class="s4">1.9825747</span><span class="s2">, </span><span class="s4">3.43235064</span><span class="s2">, </span><span class="s4">1.50204682</span><span class="s2">, </span><span class="s4">1.75699294</span><span class="s2">,</span>
            <span class="s4">2.56816769</span><span class="s2">, </span><span class="s4">0.75786251</span><span class="s2">, </span><span class="s4">0.93131924</span><span class="s2">, </span><span class="s4">1.45494628</span><span class="s2">,</span>
            <span class="s4">0.49975556</span><span class="s2">, </span><span class="s4">0.32756457</span><span class="s2">, </span><span class="s4">0.47183469</span><span class="s2">, </span><span class="s4">3.3737793</span><span class="s2">,</span>
            <span class="s4">2.25759649</span><span class="s2">, </span><span class="s4">0.34138981</span><span class="s2">, </span><span class="s4">3.09048033</span><span class="s2">, </span><span class="s4">10.32189178</span><span class="s2">,</span>
            <span class="s4">10.15319347</span><span class="s2">, </span><span class="s4">0.12398402</span><span class="s2">, </span><span class="s4">4.65263939</span><span class="s2">, </span><span class="s4">7.62032652</span><span class="s2">,</span>
            <span class="s4">7.04052448</span><span class="s2">, </span><span class="s4">4.55579329</span><span class="s2">, </span><span class="s4">3.52704573</span><span class="s2">, </span><span class="s4">3.38968754</span><span class="s2">,</span>
            <span class="s4">3.00466204</span><span class="s2">, </span><span class="s4">0.46617937</span><span class="s2">, </span><span class="s4">1.42808878</span><span class="s2">, </span><span class="s4">1.00660408</span><span class="s2">,</span>
            <span class="s4">4.65142584</span><span class="s2">, </span><span class="s4">5.20996618</span><span class="s2">, </span><span class="s4">4.80301046</span><span class="s2">, </span><span class="s4">0.99780792</span><span class="s2">,</span>
            <span class="s4">1.15280604</span><span class="s2">, </span><span class="s4">1.87296033</span><span class="s2">, </span><span class="s4">4.60985804</span><span class="s2">, </span><span class="s4">5.41294718</span><span class="s2">,</span>
            <span class="s4">6.06733084</span><span class="s2">, </span><span class="s4">3.18375754</span><span class="s2">, </span><span class="s4">10.0548315</span><span class="s2">, </span><span class="s4">4.22182512</span><span class="s2">,</span>
            <span class="s4">1.24640226</span><span class="s2">, </span><span class="s4">2.66358495</span><span class="s2">, </span><span class="s4">2.60049844</span><span class="s2">, </span><span class="s4">0.00352026</span><span class="s2">,</span>
            <span class="s4">1.02208447</span><span class="s2">, </span><span class="s4">4.09924603</span><span class="s2">, </span><span class="s4">1.27764511</span><span class="s2">, </span><span class="s4">0.90124834</span><span class="s2">,</span>
            <span class="s4">0.5303241</span><span class="s2">, </span><span class="s4">3.84383249</span><span class="s2">, </span><span class="s4">1.24640775</span><span class="s2">, </span><span class="s4">1.39796948</span><span class="s2">,</span>
            <span class="s4">2.34609175</span><span class="s2">, </span><span class="s4">1.7742399</span><span class="s2">, </span><span class="s4">3.56689548</span><span class="s2">, </span><span class="s4">1.27681601</span><span class="s2">,</span>
            <span class="s4">5.32056713</span><span class="s2">, </span><span class="s4">3.19770503</span><span class="s2">, </span><span class="s4">1.89575887</span><span class="s2">, </span><span class="s4">0.59274858</span><span class="s2">,</span>
            <span class="s4">0.64010525</span><span class="s2">, </span><span class="s4">2.65920091</span><span class="s2">, </span><span class="s4">0.81912726</span><span class="s2">, </span><span class="s4">0.4868626</span><span class="s2">,</span>
            <span class="s4">3.13063931</span><span class="s2">, </span><span class="s4">1.3960743</span><span class="s2">, </span><span class="s4">1.03451502</span><span class="s2">, </span><span class="s4">1.28983963</span><span class="s2">,</span>
            <span class="s4">3.27489519</span><span class="s2">, </span><span class="s4">1.41772103</span><span class="s2">, </span><span class="s4">2.00014663</span><span class="s2">, </span><span class="s4">2.02787399</span><span class="s2">,</span>
            <span class="s4">3.50289273</span><span class="s2">, </span><span class="s4">1.65296888</span><span class="s2">, </span><span class="s4">0.02450024</span><span class="s2">, </span><span class="s4">0.04084374</span><span class="s2">,</span>
            <span class="s4">0.17252181</span><span class="s2">, </span><span class="s4">0.78132814</span><span class="s2">, </span><span class="s4">0.20216605</span><span class="s2">, </span><span class="s4">1.48436368</span><span class="s2">,</span>
            <span class="s4">0.3301619</span><span class="s2">, </span><span class="s4">1.12080252</span><span class="s2">, </span><span class="s4">0.00699845</span><span class="s2">, </span><span class="s4">3.87074757</span><span class="s2">,</span>
            <span class="s4">0.84627002</span><span class="s2">, </span><span class="s4">2.26680374</span><span class="s2">, </span><span class="s4">2.07992935</span><span class="s2">, </span><span class="s4">1.62452054</span><span class="s2">,</span>
            <span class="s4">0.66078293</span><span class="s2">, </span><span class="s4">2.26608515</span><span class="s2">, </span><span class="s4">1.58540344</span><span class="s2">, </span><span class="s4">0.98763937</span><span class="s2">,</span>
            <span class="s4">0.25370923</span><span class="s2">, </span><span class="s4">1.2576412</span><span class="s2">, </span><span class="s4">1.07146478</span><span class="s2">, </span><span class="s4">0.48786601</span><span class="s2">,</span>
            <span class="s4">0.02327727</span><span class="s2">, </span><span class="s4">1.29385257</span><span class="s2">, </span><span class="s4">3.52217674</span><span class="s2">, </span><span class="s4">1.05305433</span><span class="s2">,</span>
            <span class="s4">5.13598871</span><span class="s2">, </span><span class="s4">1.43351507</span><span class="s2">, </span><span class="s4">2.12951326</span><span class="s2">, </span><span class="s4">3.03700447</span><span class="s2">,</span>
            <span class="s4">0.65843326</span><span class="s2">, </span><span class="s4">4.28524971</span><span class="s2">, </span><span class="s4">2.3428576</span><span class="s2">, </span><span class="s4">4.72853422</span><span class="s2">,</span>
            <span class="s4">0.58606911</span><span class="s2">, </span><span class="s4">2.70345545</span><span class="s2">, </span><span class="s4">0.8207835</span><span class="s2">, </span><span class="s4">0.16228235</span><span class="s2">,</span>
            <span class="s4">2.80714321</span><span class="s2">, </span><span class="s4">1.97183621</span><span class="s2">, </span><span class="s4">0.5928334</span><span class="s2">, </span><span class="s4">3.61601782</span><span class="s2">,</span>
            <span class="s4">1.82700455</span><span class="s2">, </span><span class="s4">1.52638936</span><span class="s2">, </span><span class="s4">0.72525144</span><span class="s2">, </span><span class="s4">0.6499536</span><span class="s2">,</span>
            <span class="s4">1.58741212</span><span class="s2">, </span><span class="s4">0.72647524</span><span class="s2">, </span><span class="s4">0.65064299</span><span class="s2">, </span><span class="s4">0.43771812</span><span class="s2">,</span>
            <span class="s4">2.68048692</span><span class="s2">, </span><span class="s4">2.20902133</span><span class="s2">, </span><span class="s4">0.0988697</span><span class="s2">, </span><span class="s4">0.31138307</span><span class="s2">,</span>
            <span class="s4">2.79860616</span><span class="s2">, </span><span class="s4">1.13209391</span><span class="s2">, </span><span class="s4">0.91427463</span><span class="s2">, </span><span class="s4">0.69550049</span><span class="s2">,</span>
            <span class="s4">0.68990183</span><span class="s2">, </span><span class="s4">0.65359998</span><span class="s2">, </span><span class="s4">1.04932129</span><span class="s2">, </span><span class="s4">0.00310441</span><span class="s2">,</span>
            <span class="s4">0.48663121</span><span class="s2">, </span><span class="s4">1.68144464</span><span class="s2">, </span><span class="s4">0.99051267</span><span class="s2">, </span><span class="s4">0.22263506</span><span class="s2">,</span>
            <span class="s4">0.97846323</span><span class="s2">, </span><span class="s4">0.55040002</span><span class="s2">, </span><span class="s4">2.56734443</span><span class="s2">, </span><span class="s4">0.12510587</span><span class="s2">,</span>
            <span class="s4">2.15363359</span><span class="s2">, </span><span class="s4">1.18440747</span><span class="s2">, </span><span class="s4">0.66974002</span><span class="s2">, </span><span class="s4">0.48981813</span><span class="s2">,</span>
            <span class="s4">2.08285856</span><span class="s2">, </span><span class="s4">1.03952742</span><span class="s2">, </span><span class="s4">1.00747502</span><span class="s2">, </span><span class="s4">0.52523118</span><span class="s2">,</span>
            <span class="s4">0.81593889</span><span class="s2">, </span><span class="s4">0.22168602</span><span class="s2">, </span><span class="s4">2.73786068</span><span class="s2">, </span><span class="s4">1.21678591</span><span class="s2">,</span>
            <span class="s4">0.235705</span><span class="s2">, </span><span class="s4">0.56248677</span><span class="s2">, </span><span class="s4">3.66057348</span><span class="s2">, </span><span class="s4">0.35822684</span><span class="s2">,</span>
            <span class="s4">0.97550339</span><span class="s2">, </span><span class="s4">1.21677041</span><span class="s2">, </span><span class="s4">4.03415823</span><span class="s2">, </span><span class="s4">9.10342026</span><span class="s2">,</span>
            <span class="s4">2.24355674</span><span class="s2">, </span><span class="s4">3.6120553</span><span class="s2">, </span><span class="s4">4.36456299</span><span class="s2">, </span><span class="s4">0.83891636</span><span class="s2">,</span>
            <span class="s4">1.07712805</span><span class="s2">, </span><span class="s4">2.28685427</span><span class="s2">, </span><span class="s4">4.04548168</span><span class="s2">, </span><span class="s4">1.67408013</span><span class="s2">,</span>
            <span class="s4">4.57762337</span><span class="s2">, </span><span class="s4">2.47123241</span><span class="s2">, </span><span class="s4">1.88890803</span><span class="s2">, </span><span class="s4">1.62245703</span><span class="s2">,</span>
            <span class="s4">0.02149973</span><span class="s2">, </span><span class="s4">0.48483402</span><span class="s2">, </span><span class="s4">4.40716505</span><span class="s2">, </span><span class="s4">0.28621164</span><span class="s2">,</span>
            <span class="s4">4.56798553</span><span class="s2">, </span><span class="s4">1.6255945</span><span class="s2">, </span><span class="s4">0.6124717</span><span class="s2">, </span><span class="s4">2.72943926</span><span class="s2">,</span>
            <span class="s4">0.80645156</span><span class="s2">, </span><span class="s4">1.26738918</span><span class="s2">, </span><span class="s4">0.91451788</span><span class="s2">, </span><span class="s4">1.59959269</span><span class="s2">,</span>
            <span class="s4">0.0356785</span><span class="s2">, </span><span class="s4">1.93719864</span><span class="s2">, </span><span class="s4">0.42164543</span><span class="s2">, </span><span class="s4">0.87313241</span><span class="s2">,</span>
            <span class="s4">0.52508104</span><span class="s2">, </span><span class="s4">0.44771862</span><span class="s2">, </span><span class="s4">1.38226497</span><span class="s2">, </span><span class="s4">1.83891225</span><span class="s2">,</span>
            <span class="s4">0.00711749</span><span class="s2">, </span><span class="s4">0.26621303</span><span class="s2">, </span><span class="s4">2.25254321</span><span class="s2">, </span><span class="s4">0.27307722</span><span class="s2">,</span>
            <span class="s4">0.26436633</span><span class="s2">, </span><span class="s4">1.80608702</span><span class="s2">, </span><span class="s4">2.29477572</span><span class="s2">, </span><span class="s4">2.0931437</span><span class="s2">,</span>
            <span class="s4">2.2915051</span><span class="s2">, </span><span class="s4">0.82041657</span><span class="s2">, </span><span class="s4">2.09074521</span><span class="s2">, </span><span class="s4">1.87793779</span><span class="s2">,</span>
            <span class="s4">2.15142703</span><span class="s2">, </span><span class="s4">1.549685</span><span class="s2">, </span><span class="s4">2.44940472</span><span class="s2">, </span><span class="s4">0.45297864</span><span class="s2">,</span>
            <span class="s4">0.35515305</span><span class="s2">, </span><span class="s4">0.23224437</span><span class="s2">, </span><span class="s4">1.77138305</span><span class="s2">, </span><span class="s4">0.98827285</span><span class="s2">,</span>
            <span class="s4">0.98435384</span><span class="s2">, </span><span class="s4">0.80031335</span><span class="s2">, </span><span class="s4">0.49445853</span><span class="s2">, </span><span class="s4">0.36061874</span><span class="s2">,</span>
            <span class="s4">2.15444446</span><span class="s2">, </span><span class="s4">1.92558503</span><span class="s2">, </span><span class="s4">0.75404048</span><span class="s2">, </span><span class="s4">0.31921348</span><span class="s2">,</span>
            <span class="s4">0.32092738</span><span class="s2">, </span><span class="s4">0.48054051</span><span class="s2">, </span><span class="s4">0.98650485</span><span class="s2">, </span><span class="s4">1.1810472</span><span class="s2">,</span>
            <span class="s4">0.28533801</span><span class="s2">, </span><span class="s4">3.02953291</span><span class="s2">, </span><span class="s4">0.16818592</span><span class="s2">, </span><span class="s4">2.20164418</span><span class="s2">,</span>
            <span class="s4">0.3911584</span><span class="s2">, </span><span class="s4">0.6942575</span><span class="s2">, </span><span class="s4">0.55016953</span><span class="s2">, </span><span class="s4">0.06157291</span><span class="s2">,</span>
            <span class="s4">0.19509397</span><span class="s2">, </span><span class="s4">2.3744297</span><span class="s2">, </span><span class="s4">0.73775989</span><span class="s2">, </span><span class="s4">1.12842739</span><span class="s2">,</span>
            <span class="s4">0.87197775</span><span class="s2">, </span><span class="s4">0.30168825</span><span class="s2">, </span><span class="s4">0.71310955</span><span class="s2">, </span><span class="s4">0.27689508</span><span class="s2">,</span>
            <span class="s4">1.13476491</span><span class="s2">, </span><span class="s4">1.60331428</span><span class="s2">, </span><span class="s4">1.56165123</span><span class="s2">, </span><span class="s4">0.31513214</span><span class="s2">,</span>
            <span class="s4">0.02698154</span><span class="s2">, </span><span class="s4">0.49029687</span><span class="s2">, </span><span class="s4">0.17265303</span><span class="s2">, </span><span class="s4">0.36386153</span><span class="s2">,</span>
            <span class="s4">0.56225872</span><span class="s2">, </span><span class="s4">1.59077382</span><span class="s2">, </span><span class="s4">1.84919345</span><span class="s2">, </span><span class="s4">1.4230696</span><span class="s2">,</span>
            <span class="s4">1.28607559</span><span class="s2">, </span><span class="s4">0.57890779</span><span class="s2">, </span><span class="s4">1.14760947</span><span class="s2">, </span><span class="s4">0.22594096</span><span class="s2">,</span>
            <span class="s4">0.43510813</span><span class="s2">, </span><span class="s4">2.90668917</span><span class="s2">, </span><span class="s4">1.49716794</span><span class="s2">, </span><span class="s4">1.9549973</span><span class="s2">,</span>
            <span class="s4">2.10786223</span><span class="s2">, </span><span class="s4">0.71948445</span><span class="s2">, </span><span class="s4">0.19396119</span><span class="s2">, </span><span class="s4">0.86563414</span><span class="s2">,</span>
            <span class="s4">0.63498968</span><span class="s2">, </span><span class="s4">2.3593328</span><span class="s2">, </span><span class="s4">0.18950517</span><span class="s2">, </span><span class="s4">0.45737442</span><span class="s2">,</span>
            <span class="s4">1.82937241</span><span class="s2">, </span><span class="s4">1.72589195</span><span class="s2">, </span><span class="s4">0.29414186</span><span class="s2">, </span><span class="s4">0.74434268</span><span class="s2">,</span>
            <span class="s4">1.22564518</span><span class="s2">, </span><span class="s4">2.01444268</span><span class="s2">, </span><span class="s4">2.32068515</span><span class="s2">, </span><span class="s4">0.98414028</span><span class="s2">,</span>
            <span class="s4">0.1174908</span><span class="s2">, </span><span class="s4">0.22450124</span><span class="s2">, </span><span class="s4">1.24669802</span><span class="s2">, </span><span class="s4">0.70953292</span><span class="s2">,</span>
            <span class="s4">0.21857196</span><span class="s2">, </span><span class="s4">0.11119327</span><span class="s2">, </span><span class="s4">0.60500813</span><span class="s2">, </span><span class="s4">2.04446197</span><span class="s2">,</span>
            <span class="s4">1.146896</span><span class="s2">, </span><span class="s4">0.54849964</span><span class="s2">, </span><span class="s4">0.23402978</span><span class="s2">, </span><span class="s4">0.32219616</span><span class="s2">,</span>
            <span class="s4">2.7076292</span><span class="s2">, </span><span class="s4">1.57800817</span><span class="s2">, </span><span class="s4">2.08260155</span><span class="s2">, </span><span class="s4">1.81090641</span><span class="s2">,</span>
            <span class="s4">0.45189673</span><span class="s2">, </span><span class="s4">1.01260054</span><span class="s2">, </span><span class="s4">0.65379494</span><span class="s2">, </span><span class="s4">0.94736898</span><span class="s2">,</span>
            <span class="s4">0.37556711</span><span class="s2">, </span><span class="s4">0.44287458</span><span class="s2">, </span><span class="s4">0.34578958</span><span class="s2">, </span><span class="s4">1.48449266</span><span class="s2">,</span>
            <span class="s4">1.95924711</span><span class="s2">, </span><span class="s4">0.09717447</span><span class="s1">]</span>

<span class="s3"># See https://www.stata-press.com/data/r14/mumpspc</span>
<span class="s3"># Note that this has already been seasonally differenced at period 12</span>
<span class="s1">mumpspc = [</span><span class="s4">0.29791319</span><span class="s2">, </span><span class="s4">0.41467956</span><span class="s2">, </span><span class="s4">1.13061404</span><span class="s2">, </span><span class="s4">1.23267496</span><span class="s2">,</span>
           <span class="s4">1.55659747</span><span class="s2">, </span><span class="s4">1.41078568</span><span class="s2">, </span><span class="s4">0.45335022</span><span class="s2">, </span><span class="s4">0.1419628</span><span class="s2">,</span>
           <span class="s4">0.03802268</span><span class="s2">, </span><span class="s4">0.04621375</span><span class="s2">, </span><span class="s4">0.01261204</span><span class="s2">, </span><span class="s4">0.04653099</span><span class="s2">,</span>
           <span class="s4">0.10195512</span><span class="s2">, </span><span class="s4">0.18079406</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.1898452</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.24501109</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.71440864</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.82188988</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.32300544</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.07680188</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.0183593</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.02145147</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.14442876</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.13897884</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.41970083</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.53978181</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.81733</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.77516699</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.6827361</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.27539611</span><span class="s2">, </span><span class="s4">0.01427381</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.02352227</span><span class="s2">,</span>
           <span class="s4">0.00223821</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00509738</span><span class="s2">, </span><span class="s4">0.03753691</span><span class="s2">, </span><span class="s4">0.05826023</span><span class="s2">,</span>
           <span class="s4">0.34700248</span><span class="s2">, </span><span class="s4">0.53648567</span><span class="s2">, </span><span class="s4">0.56336415</span><span class="s2">, </span><span class="s4">0.73740566</span><span class="s2">,</span>
           <span class="s4">0.68290168</span><span class="s2">, </span><span class="s4">0.80702746</span><span class="s2">, </span><span class="s4">0.47288245</span><span class="s2">, </span><span class="s4">0.22873914</span><span class="s2">,</span>
           <span class="s4">0.1323263</span><span class="s2">, </span><span class="s4">0.18721257</span><span class="s2">, </span><span class="s4">0.38872179</span><span class="s2">, </span><span class="s4">0.5571546</span><span class="s2">,</span>
           <span class="s4">0.62545192</span><span class="s2">, </span><span class="s4">0.51162982</span><span class="s2">, </span><span class="s4">1.28496778</span><span class="s2">, </span><span class="s4">0.91240239</span><span class="s2">,</span>
           <span class="s4">0.44763446</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.34558165</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.32126725</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.13707247</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.11812115</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.14246191</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.33914241</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.59595251</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.76603931</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.95292002</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.69234133</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.44532502</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.8163048</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.27210402</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.05841839</span><span class="s2">, </span><span class="s4">0.02669862</span><span class="s2">,</span>
           <span class="s4">0.06060357</span><span class="s2">, </span><span class="s4">0.04068814</span><span class="s2">, </span><span class="s4">0.17806116</span><span class="s2">, </span><span class="s4">0.25716701</span><span class="s2">,</span>
           <span class="s4">0.58398741</span><span class="s2">, </span><span class="s4">0.95062274</span><span class="s2">, </span><span class="s4">2.00101161</span><span class="s2">, </span><span class="s4">2.05761814</span><span class="s2">,</span>
           <span class="s4">1.74057662</span><span class="s2">, </span><span class="s4">0.76864243</span><span class="s2">, </span><span class="s4">0.3566184</span><span class="s2">, </span><span class="s4">0.01938879</span><span class="s2">,</span>
           <span class="s4">0.01129906</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00691494</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.11471844</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.12220788</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.46378085</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.76668882</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.8203615</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.80084801</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">1.58501005</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.5208298</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.27426577</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.01387694</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.04243414</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.07133579</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.10209171</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.04366681</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.06109473</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.03943163</span><span class="s2">, </span><span class="s4">0.3148942</span><span class="s2">, </span><span class="s4">0.57496029</span><span class="s2">,</span>
           <span class="s4">0.60446811</span><span class="s2">, </span><span class="s4">0.73262405</span><span class="s2">, </span><span class="s4">0.37140131</span><span class="s2">, </span><span class="s4">0.18555129</span><span class="s2">,</span>
           <span class="s4">0.08227628</span><span class="s2">, </span><span class="s4">0.11913572</span><span class="s2">, </span><span class="s4">0.22764499</span><span class="s2">, </span><span class="s4">0.35582894</span><span class="s2">,</span>
           <span class="s4">0.60779673</span><span class="s2">, </span><span class="s4">0.85310715</span><span class="s2">, </span><span class="s4">1.23990095</span><span class="s2">, </span><span class="s4">0.89678788</span><span class="s2">,</span>
           <span class="s4">0.23346186</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.24769557</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.28325707</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.13954946</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.09492368</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.07607545</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.23001991</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.42238122</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.68010765</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.90599316</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.69077659</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.67265296</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">1.00972712</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.67655402</span><span class="s2">, </span><span class="s4">0.01419702</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00304723</span><span class="s2">,</span>
           <span class="s4">0.06103691</span><span class="s2">, </span><span class="s4">0.09834027</span><span class="s2">, </span><span class="s4">0.18685167</span><span class="s2">, </span><span class="s4">0.29223168</span><span class="s2">,</span>
           <span class="s4">0.52865916</span><span class="s2">, </span><span class="s4">0.54262394</span><span class="s2">, </span><span class="s4">0.64842945</span><span class="s2">, </span><span class="s4">0.95841271</span><span class="s2">,</span>
           <span class="s4">1.24009287</span><span class="s2">, </span><span class="s4">1.16617942</span><span class="s2">, </span><span class="s4">0.80071652</span><span class="s2">, </span><span class="s4">0.3447271</span><span class="s2">,</span>
           <span class="s4">0.1351914</span><span class="s2">, </span><span class="s4">0.04118001</span><span class="s2">, </span><span class="s4">0.1700764</span><span class="s2">, </span><span class="s4">0.39442945</span><span class="s2">,</span>
           <span class="s4">0.35222113</span><span class="s2">, </span><span class="s4">0.21554053</span><span class="s2">, </span><span class="s4">0.4189862</span><span class="s2">, </span><span class="s4">0.01172769</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.86072814</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.04859877</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.81989408</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.35956979</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.13597609</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.10660569</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.25517979</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.39934713</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.48581338</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.33558851</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.32364452</span><span class="s2">, </span><span class="s4">0.02615488</span><span class="s2">,</span>
           <span class="s4">0.53735149</span><span class="s2">, </span><span class="s4">0.43695128</span><span class="s2">, </span><span class="s4">0.12556195</span><span class="s2">, </span><span class="s4">0.04231615</span><span class="s2">,</span>
           <span class="s4">0.00691247</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.03409019</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.05299731</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.1705423</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.23371273</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.13540632</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.13686514</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.28611076</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.2569176</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.15721166</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.12167645</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.0396246</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.03912748</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.03107409</span><span class="s2">, </span><span class="s4">0.02763657</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.03745994</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.0960384</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.16005671</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.23481375</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.2919997</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.28406811</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.23517478</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.10721764</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.05092888</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.04520934</span><span class="s2">, </span><span class="s4">0.01234692</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.03137775</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.01226076</span><span class="s2">,</span>
           <span class="s4">0.00540099</span><span class="s2">, </span><span class="s4">0.0410589</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.06418979</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.23792684</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.19889355</span><span class="s2">, </span><span class="s4">0.15362859</span><span class="s2">, </span><span class="s4">0.19808075</span><span class="s2">, </span><span class="s4">0.09901999</span><span class="s2">,</span>
           <span class="s4">0.08383148</span><span class="s2">, </span><span class="s4">0.1328882</span><span class="s2">, </span><span class="s4">0.1155429</span><span class="s2">, </span><span class="s4">0.06566355</span><span class="s2">,</span>
           <span class="s4">0.13103351</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00214756</span><span class="s2">, </span><span class="s4">0.11389524</span><span class="s2">, </span><span class="s4">0.60455656</span><span class="s2">,</span>
           <span class="s4">0.43063915</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.11312306</span><span class="s2">, </span><span class="s4">0.00848174</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.04416773</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.03458966</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.11635408</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.09985384</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.10910749</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.03021795</span><span class="s2">, </span><span class="s4">0.00818002</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.20921308</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.42517149</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.26740992</span><span class="s2">, </span><span class="s4">0.21723568</span><span class="s2">, </span><span class="s4">0.19341183</span><span class="s2">, </span><span class="s4">0.03723881</span><span class="s2">,</span>
           <span class="s4">0.0800474</span><span class="s2">, </span><span class="s4">0.1313054</span><span class="s2">, </span><span class="s4">0.17315492</span><span class="s2">, </span><span class="s4">0.60613275</span><span class="s2">,</span>
           <span class="s4">0.88496959</span><span class="s2">, </span><span class="s4">1.29391515</span><span class="s2">, </span><span class="s4">1.67872524</span><span class="s2">, </span><span class="s4">1.1444242</span><span class="s2">,</span>
           <span class="s4">0.56303668</span><span class="s2">, </span><span class="s4">0.21097398</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.29172775</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.07173294</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.10594339</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.13427913</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.23306128</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.63841069</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">1.01829767</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.37716746</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.74518943</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.48689389</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">1.00245714</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.67613804</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.09916437</span><span class="s2">, </span><span class="s4">0.01034598</span><span class="s2">,</span>
           <span class="s4">0.00059676</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.02620511</span><span class="s2">, </span><span class="s4">0.07644644</span><span class="s2">, </span><span class="s4">0.21421635</span><span class="s2">,</span>
           <span class="s4">0.36779583</span><span class="s2">, </span><span class="s4">0.44090557</span><span class="s2">, </span><span class="s4">0.65572244</span><span class="s2">, </span><span class="s4">0.69319898</span><span class="s2">,</span>
           <span class="s4">1.03741217</span><span class="s2">, </span><span class="s4">1.03150916</span><span class="s2">, </span><span class="s4">0.48106751</span><span class="s2">, </span><span class="s4">0.19878693</span><span class="s2">,</span>
           <span class="s4">0.08993446</span><span class="s2">, </span><span class="s4">0.10016203</span><span class="s2">, </span><span class="s4">0.08885416</span><span class="s2">, </span><span class="s4">0.01304582</span><span class="s2">,</span>
           <span class="s4">0.01628131</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.16743767</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.3889482</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.25320077</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.41278255</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.64387393</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.24642634</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.09595281</span><span class="s2">,</span>
           <span class="s4">0.00029226</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.03017606</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.09989822</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.10608336</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.12089968</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.02303368</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.07865107</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.07976627</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.27282</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00616729</span><span class="s2">, </span><span class="s4">0.12162459</span><span class="s2">, </span><span class="s4">0.01441428</span><span class="s2">,</span>
           <span class="s4">0.01936977</span><span class="s2">, </span><span class="s4">0.04224043</span><span class="s2">, </span><span class="s4">0.10971794</span><span class="s2">, </span><span class="s4">0.31981739</span><span class="s2">,</span>
           <span class="s4">0.37371701</span><span class="s2">, </span><span class="s4">0.21740788</span><span class="s2">, </span><span class="s4">0.66436541</span><span class="s2">, </span><span class="s4">0.8377074</span><span class="s2">,</span>
           <span class="s4">1.11139965</span><span class="s2">, </span><span class="s4">0.89899027</span><span class="s2">, </span><span class="s4">0.63889956</span><span class="s2">, </span><span class="s4">0.26021931</span><span class="s2">,</span>
           <span class="s4">0.10602421</span><span class="s2">, </span><span class="s4">0.05764158</span><span class="s2">, </span><span class="s4">0.03996068</span><span class="s2">, </span><span class="s4">0.13342732</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.01258349</span><span class="s2">, </span><span class="s4">0.20526713</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.05639255</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.51611507</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">1.10225511</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.04906142</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.82814342</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.32945809</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.16659749</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.13606755</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.156371</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.44539213</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.54849428</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.57765388</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.46875834</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.20867264</span><span class="s2">,</span>
           <span class="s4">0.11628377</span><span class="s2">, </span><span class="s4">0.30508852</span><span class="s2">, </span><span class="s4">0.18076879</span><span class="s2">, </span><span class="s4">0.15996796</span><span class="s2">,</span>
           <span class="s4">0.09090945</span><span class="s2">, </span><span class="s4">0.13049443</span><span class="s2">, </span><span class="s4">0.37585843</span><span class="s2">, </span><span class="s4">0.47701722</span><span class="s2">,</span>
           <span class="s4">0.8886351</span><span class="s2">, </span><span class="s4">1.12534606</span><span class="s2">, </span><span class="s4">1.0532701</span><span class="s2">, </span><span class="s4">1.1787746</span><span class="s2">,</span>
           <span class="s4">1.19929063</span><span class="s2">, </span><span class="s4">0.67156017</span><span class="s2">, </span><span class="s4">0.26693404</span><span class="s2">, </span><span class="s4">0.08880523</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.0367229</span><span class="s2">, </span><span class="s4">0.01958427</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.2178995</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.35959432</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.61479795</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.12488365</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.24093127</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.37260103</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">1.34592342</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.1085875</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.48515847</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.22466549</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.01377375</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.15326615</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.20697775</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.21839607</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.37820193</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.18108195</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.23839343</span><span class="s2">, </span><span class="s4">0.00777894</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.01658171</span><span class="s2">, </span><span class="s4">0.14208788</span><span class="s2">, </span><span class="s4">0.21352491</span><span class="s2">, </span><span class="s4">0.08116969</span><span class="s2">,</span>
           <span class="s4">0.0220954</span><span class="s2">, </span><span class="s4">0.05151662</span><span class="s2">, </span><span class="s4">0.15160444</span><span class="s2">, </span><span class="s4">0.46347663</span><span class="s2">,</span>
           <span class="s4">0.59711337</span><span class="s2">, </span><span class="s4">0.69609326</span><span class="s2">, </span><span class="s4">0.85816896</span><span class="s2">, </span><span class="s4">0.44160861</span><span class="s2">,</span>
           <span class="s4">0.29913878</span><span class="s2">, </span><span class="s4">0.35687125</span><span class="s2">, </span><span class="s4">0.02410281</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00206721</span><span class="s2">,</span>
           <span class="s4">0.04784113</span><span class="s2">, </span><span class="s4">0.01441422</span><span class="s2">, </span><span class="s4">0.01972398</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.19168586</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.31085777</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.38792318</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.59203249</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.4652282</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.36413753</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.41189915</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.27989927</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.06170946</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.09512204</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.05406281</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.04524729</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.19567066</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.19209856</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.30510414</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.21937585</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.34253049</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.08848315</span><span class="s2">, </span><span class="s4">0.0628857</span><span class="s2">, </span><span class="s4">0.12370691</span><span class="s2">, </span><span class="s4">0.08033729</span><span class="s2">,</span>
           <span class="s4">0.02536885</span><span class="s2">, </span><span class="s4">0.06512444</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00683796</span><span class="s2">, </span><span class="s4">0.01617461</span><span class="s2">,</span>
           <span class="s4">0.09414208</span><span class="s2">, </span><span class="s4">0.17485267</span><span class="s2">, </span><span class="s4">0.01436073</span><span class="s2">, </span><span class="s4">0.15278709</span><span class="s2">,</span>
           <span class="s4">0.21909434</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.13190985</span><span class="s2">, </span><span class="s4">0.1297549</span><span class="s2">, </span><span class="s4">0.00458425</span><span class="s2">,</span>
           <span class="s4">0.00097814</span><span class="s2">, </span><span class="s4">0.0419029</span><span class="s2">, </span><span class="s4">0.09299085</span><span class="s2">, </span><span class="s4">0.30784416</span><span class="s2">,</span>
           <span class="s4">0.3420583</span><span class="s2">, </span><span class="s4">0.31633973</span><span class="s2">, </span><span class="s4">0.6052171</span><span class="s2">, </span><span class="s4">0.59994769</span><span class="s2">,</span>
           <span class="s4">0.19161701</span><span class="s2">, </span><span class="s4">0.14463156</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00356764</span><span class="s2">, </span><span class="s4">0.03013593</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.00030272</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.04639405</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.11171955</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.26541206</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.46245131</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.59785151</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.93805957</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.02102923</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.85468853</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.57457525</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.43376198</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.22778665</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.08325937</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.07688884</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.10757375</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.04266521</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.07971251</span><span class="s2">, </span><span class="s4">0.19849321</span><span class="s2">, </span><span class="s4">0.46367952</span><span class="s2">, </span><span class="s4">0.45219129</span><span class="s2">,</span>
           <span class="s4">0.5286305</span><span class="s2">, </span><span class="s4">0.82308269</span><span class="s2">, </span><span class="s4">0.62806904</span><span class="s2">, </span><span class="s4">0.44585282</span><span class="s2">,</span>
           <span class="s4">0.2649036</span><span class="s2">, </span><span class="s4">0.18073915</span><span class="s2">, </span><span class="s4">0.24439827</span><span class="s2">, </span><span class="s4">0.33583486</span><span class="s2">,</span>
           <span class="s4">0.36763605</span><span class="s2">, </span><span class="s4">0.31510991</span><span class="s2">, </span><span class="s4">0.44708037</span><span class="s2">, </span><span class="s4">0.27008474</span><span class="s2">,</span>
           <span class="s4">0.06621343</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.20664448</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.34370041</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.30381745</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.18254732</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.16462031</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.20288868</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.47805107</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.42589119</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.52396262</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.80304122</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.54068702</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.32430774</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.41455108</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.18256193</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.11230741</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.05113308</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00785848</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00410898</span><span class="s2">, </span><span class="s4">0.02002721</span><span class="s2">,</span>
           <span class="s4">0.04911622</span><span class="s2">, </span><span class="s4">0.11129829</span><span class="s2">, </span><span class="s4">0.03739616</span><span class="s2">, </span><span class="s4">0.23160917</span><span class="s2">,</span>
           <span class="s4">0.09051466</span><span class="s2">, </span><span class="s4">0.0703001</span><span class="s2">, </span><span class="s4">0.15306205</span><span class="s2">, </span><span class="s4">0.092351</span><span class="s2">,</span>
           <span class="s4">0.04038295</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00022292</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.0345473</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.104352</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.14002147</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.25555477</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.15546834</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.12915748</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.00736588</span><span class="s2">, </span><span class="s4">0.18039131</span><span class="s2">, </span><span class="s4">0.03981721</span><span class="s2">, </span><span class="s4">0.05406788</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.00028329</span><span class="s2">, </span><span class="s4">0.12522104</span><span class="s2">, </span><span class="s4">0.09731361</span><span class="s2">, </span><span class="s4">0.29498664</span><span class="s2">,</span>
           <span class="s4">0.20997131</span><span class="s2">, </span><span class="s4">0.16853192</span><span class="s2">, </span><span class="s4">0.07126871</span><span class="s2">, </span><span class="s4">0.02766478</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.13036358</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.26429421</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.18460721</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.17133695</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.06757163</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.16766661</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.17020702</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.26582304</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.23111637</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.16535208</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.13117793</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.28425765</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.30206084</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.16778651</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.0795947</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.0456669</span><span class="s2">,</span>
           <span class="s1">-</span><span class="s4">0.01921733</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.02716412</span><span class="s2">, </span><span class="s4">0.01525059</span><span class="s2">, </span><span class="s4">0.01458484</span><span class="s2">,</span>
           <span class="s4">0.00587094</span><span class="s2">, </span><span class="s4">0.01239279</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.03418982</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.09835899</span><span class="s2">,</span>
           <span class="s4">0.05628902</span><span class="s2">, </span><span class="s4">0.00924054</span><span class="s1">]</span>


<span class="s2">class </span><span class="s1">MarkovRegression:</span>
    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">setup_class(cls</span><span class="s2">, </span><span class="s1">true</span><span class="s2">, </span><span class="s1">endog</span><span class="s2">, </span><span class="s1">atol=</span><span class="s4">1e-5</span><span class="s2">, </span><span class="s1">rtol=</span><span class="s4">1e-7</span><span class="s2">, </span><span class="s1">**kwargs):</span>
        <span class="s1">cls.model = markov_regression.MarkovRegression(endog</span><span class="s2">, </span><span class="s1">**kwargs)</span>
        <span class="s1">cls.true = true</span>
        <span class="s1">cls.result = cls.model.smooth(cls.true[</span><span class="s5">'params'</span><span class="s1">])</span>
        <span class="s1">cls.atol = atol</span>
        <span class="s1">cls.rtol = rtol</span>

    <span class="s1">@pytest.mark.smoke</span>
    <span class="s2">def </span><span class="s1">test_summary(self):</span>
        <span class="s1">self.result.summary()</span>

    <span class="s2">def </span><span class="s1">test_llf(self):</span>
        <span class="s1">assert_allclose(self.result.llf</span><span class="s2">, </span><span class="s1">self.true[</span><span class="s5">'llf'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">atol=self.atol</span><span class="s2">,</span>
                        <span class="s1">rtol=self.rtol)</span>

    <span class="s2">def </span><span class="s1">test_fit(self</span><span class="s2">, </span><span class="s1">**kwargs):</span>
        <span class="s3"># Test fitting against Stata</span>
        <span class="s2">with </span><span class="s1">warnings.catch_warnings():</span>
            <span class="s1">warnings.simplefilter(</span><span class="s5">&quot;ignore&quot;</span><span class="s1">)</span>
            <span class="s1">res = self.model.fit(disp=</span><span class="s2">False, </span><span class="s1">**kwargs)</span>
        <span class="s1">assert_allclose(res.llf</span><span class="s2">, </span><span class="s1">self.true[</span><span class="s5">'llf_fit'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">atol=self.atol</span><span class="s2">,</span>
                        <span class="s1">rtol=self.rtol)</span>

    <span class="s1">@pytest.mark.smoke</span>
    <span class="s2">def </span><span class="s1">test_fit_em(self</span><span class="s2">, </span><span class="s1">**kwargs):</span>
        <span class="s3"># Test EM fitting (smoke test)</span>
        <span class="s1">res_em = self.model._fit_em(**kwargs)</span>
        <span class="s1">assert_allclose(res_em.llf</span><span class="s2">, </span><span class="s1">self.true[</span><span class="s5">'llf_fit_em'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">atol=self.atol</span><span class="s2">,</span>
                        <span class="s1">rtol=self.rtol)</span>


<span class="s1">fedfunds_const_filtered_joint_probabilities = np.array([</span>
         <span class="s1">[[</span><span class="s4">9.81875427e-01</span><span class="s2">,   </span><span class="s4">9.99977639e-01</span><span class="s2">,   </span><span class="s4">9.99982269e-01</span><span class="s2">,</span>
           <span class="s4">9.99977917e-01</span><span class="s2">,   </span><span class="s4">9.99961064e-01</span><span class="s2">,   </span><span class="s4">9.99932206e-01</span><span class="s2">,</span>
           <span class="s4">9.99919386e-01</span><span class="s2">,   </span><span class="s4">9.99894144e-01</span><span class="s2">,   </span><span class="s4">9.99875287e-01</span><span class="s2">,</span>
           <span class="s4">9.99853807e-01</span><span class="s2">,   </span><span class="s4">9.99852600e-01</span><span class="s2">,   </span><span class="s4">9.99839056e-01</span><span class="s2">,</span>
           <span class="s4">9.99783848e-01</span><span class="s2">,   </span><span class="s4">9.99774884e-01</span><span class="s2">,   </span><span class="s4">9.99954588e-01</span><span class="s2">,</span>
           <span class="s4">9.99988082e-01</span><span class="s2">,   </span><span class="s4">9.99982757e-01</span><span class="s2">,   </span><span class="s4">9.99948590e-01</span><span class="s2">,</span>
           <span class="s4">9.99910525e-01</span><span class="s2">,   </span><span class="s4">9.99825195e-01</span><span class="s2">,   </span><span class="s4">9.99660841e-01</span><span class="s2">,</span>
           <span class="s4">9.99411534e-01</span><span class="s2">,   </span><span class="s4">9.99435921e-01</span><span class="s2">,   </span><span class="s4">9.99578212e-01</span><span class="s2">,</span>
           <span class="s4">9.99835797e-01</span><span class="s2">,   </span><span class="s4">9.99931424e-01</span><span class="s2">,   </span><span class="s4">9.99955815e-01</span><span class="s2">,</span>
           <span class="s4">9.99969158e-01</span><span class="s2">,   </span><span class="s4">9.99971638e-01</span><span class="s2">,   </span><span class="s4">9.99929247e-01</span><span class="s2">,</span>
           <span class="s4">9.99921198e-01</span><span class="s2">,   </span><span class="s4">9.99904441e-01</span><span class="s2">,   </span><span class="s4">9.99869417e-01</span><span class="s2">,</span>
           <span class="s4">9.99855264e-01</span><span class="s2">,   </span><span class="s4">9.99845124e-01</span><span class="s2">,   </span><span class="s4">9.99846496e-01</span><span class="s2">,</span>
           <span class="s4">9.99755048e-01</span><span class="s2">,   </span><span class="s4">9.99708382e-01</span><span class="s2">,   </span><span class="s4">9.99701905e-01</span><span class="s2">,</span>
           <span class="s4">9.99690188e-01</span><span class="s2">,   </span><span class="s4">9.99700859e-01</span><span class="s2">,   </span><span class="s4">9.99653041e-01</span><span class="s2">,</span>
           <span class="s4">9.99426220e-01</span><span class="s2">,   </span><span class="s4">9.99320494e-01</span><span class="s2">,   </span><span class="s4">9.99321052e-01</span><span class="s2">,</span>
           <span class="s4">9.99230758e-01</span><span class="s2">,   </span><span class="s4">9.98727025e-01</span><span class="s2">,   </span><span class="s4">9.97930031e-01</span><span class="s2">,</span>
           <span class="s4">9.95880407e-01</span><span class="s2">,   </span><span class="s4">9.94433855e-01</span><span class="s2">,   </span><span class="s4">9.97574246e-01</span><span class="s2">,</span>
           <span class="s4">9.99263821e-01</span><span class="s2">,   </span><span class="s4">9.99459141e-01</span><span class="s2">,   </span><span class="s4">9.99242937e-01</span><span class="s2">,</span>
           <span class="s4">9.98291614e-01</span><span class="s2">,   </span><span class="s4">9.91580774e-01</span><span class="s2">,   </span><span class="s4">9.89101309e-01</span><span class="s2">,</span>
           <span class="s4">9.88455096e-01</span><span class="s2">,   </span><span class="s4">9.73457493e-01</span><span class="s2">,   </span><span class="s4">7.07858812e-01</span><span class="s2">,</span>
           <span class="s4">9.84830417e-02</span><span class="s2">,   </span><span class="s4">5.48777905e-03</span><span class="s2">,   </span><span class="s4">6.48064326e-04</span><span class="s2">,</span>
           <span class="s4">9.48013715e-04</span><span class="s2">,   </span><span class="s4">1.00281851e-02</span><span class="s2">,   </span><span class="s4">1.69325148e-01</span><span class="s2">,</span>
           <span class="s4">8.57820523e-01</span><span class="s2">,   </span><span class="s4">9.93211456e-01</span><span class="s2">,   </span><span class="s4">9.94962561e-01</span><span class="s2">,</span>
           <span class="s4">9.97835285e-01</span><span class="s2">,   </span><span class="s4">9.99559280e-01</span><span class="s2">,   </span><span class="s4">9.99122588e-01</span><span class="s2">,</span>
           <span class="s4">9.98381004e-01</span><span class="s2">,   </span><span class="s4">9.97159054e-01</span><span class="s2">,   </span><span class="s4">9.81694661e-01</span><span class="s2">,</span>
           <span class="s4">8.52237392e-01</span><span class="s2">,   </span><span class="s4">2.98185003e-02</span><span class="s2">,   </span><span class="s4">3.80317793e-04</span><span class="s2">,</span>
           <span class="s4">3.03223798e-05</span><span class="s2">,   </span><span class="s4">3.72338821e-06</span><span class="s2">,   </span><span class="s4">9.81252727e-08</span><span class="s2">,</span>
           <span class="s4">1.16279423e-06</span><span class="s2">,   </span><span class="s4">2.19178686e-03</span><span class="s2">,   </span><span class="s4">2.54688430e-01</span><span class="s2">,</span>
           <span class="s4">5.45485941e-01</span><span class="s2">,   </span><span class="s4">8.49963514e-01</span><span class="s2">,   </span><span class="s4">9.79591871e-01</span><span class="s2">,</span>
           <span class="s4">9.94535520e-01</span><span class="s2">,   </span><span class="s4">9.95920695e-01</span><span class="s2">,   </span><span class="s4">9.97652340e-01</span><span class="s2">,</span>
           <span class="s4">9.98379085e-01</span><span class="s2">,   </span><span class="s4">9.97097840e-01</span><span class="s2">,   </span><span class="s4">9.92715379e-01</span><span class="s2">,</span>
           <span class="s4">9.78668900e-01</span><span class="s2">,   </span><span class="s4">9.54978984e-01</span><span class="s2">,   </span><span class="s4">8.70032440e-01</span><span class="s2">,</span>
           <span class="s4">4.73445558e-01</span><span class="s2">,   </span><span class="s4">1.87649267e-02</span><span class="s2">,   </span><span class="s4">2.26217560e-04</span><span class="s2">,</span>
           <span class="s4">7.75338336e-06</span><span class="s2">,   </span><span class="s4">1.77410820e-06</span><span class="s2">,   </span><span class="s4">2.00686803e-08</span><span class="s2">,</span>
           <span class="s4">9.02595322e-11</span><span class="s2">,   </span><span class="s4">2.90324859e-10</span><span class="s2">,   </span><span class="s4">2.76383741e-07</span><span class="s2">,</span>
           <span class="s4">4.31669137e-09</span><span class="s2">,   </span><span class="s4">6.21472832e-13</span><span class="s2">,   </span><span class="s4">4.82334762e-14</span><span class="s2">,</span>
           <span class="s4">1.27598134e-14</span><span class="s2">,   </span><span class="s4">3.17409414e-12</span><span class="s2">,   </span><span class="s4">2.61276609e-10</span><span class="s2">,</span>
           <span class="s4">7.78226008e-11</span><span class="s2">,   </span><span class="s4">5.39702646e-09</span><span class="s2">,   </span><span class="s4">5.20281165e-06</span><span class="s2">,</span>
           <span class="s4">1.16430050e-04</span><span class="s2">,   </span><span class="s4">2.28275630e-04</span><span class="s2">,   </span><span class="s4">8.20520602e-05</span><span class="s2">,</span>
           <span class="s4">3.54392208e-05</span><span class="s2">,   </span><span class="s4">2.52690630e-05</span><span class="s2">,   </span><span class="s4">5.71223049e-06</span><span class="s2">,</span>
           <span class="s4">6.04760361e-07</span><span class="s2">,   </span><span class="s4">3.25802367e-06</span><span class="s2">,   </span><span class="s4">1.49189117e-04</span><span class="s2">,</span>
           <span class="s4">9.03616681e-04</span><span class="s2">,   </span><span class="s4">2.05169327e-03</span><span class="s2">,   </span><span class="s4">1.79174202e-03</span><span class="s2">,</span>
           <span class="s4">2.00293091e-03</span><span class="s2">,   </span><span class="s4">8.80162479e-03</span><span class="s2">,   </span><span class="s4">6.98800266e-02</span><span class="s2">,</span>
           <span class="s4">2.10894169e-01</span><span class="s2">,   </span><span class="s4">3.78257683e-01</span><span class="s2">,   </span><span class="s4">4.16997707e-01</span><span class="s2">,</span>
           <span class="s4">3.74555143e-01</span><span class="s2">,   </span><span class="s4">3.09162817e-01</span><span class="s2">,   </span><span class="s4">3.19673213e-01</span><span class="s2">,</span>
           <span class="s4">2.13371614e-01</span><span class="s2">,   </span><span class="s4">5.00408396e-02</span><span class="s2">,   </span><span class="s4">5.65131400e-03</span><span class="s2">,</span>
           <span class="s4">2.67174854e-04</span><span class="s2">,   </span><span class="s4">2.77281533e-05</span><span class="s2">,   </span><span class="s4">3.81188091e-05</span><span class="s2">,</span>
           <span class="s4">1.64157087e-04</span><span class="s2">,   </span><span class="s4">4.99719207e-04</span><span class="s2">,   </span><span class="s4">8.42437704e-04</span><span class="s2">,</span>
           <span class="s4">9.94072768e-04</span><span class="s2">,   </span><span class="s4">1.92236077e-03</span><span class="s2">,   </span><span class="s4">1.77274131e-02</span><span class="s2">,</span>
           <span class="s4">1.80694204e-01</span><span class="s2">,   </span><span class="s4">5.59064015e-01</span><span class="s2">,   </span><span class="s4">9.22767369e-01</span><span class="s2">,</span>
           <span class="s4">9.95149639e-01</span><span class="s2">,   </span><span class="s4">9.99418123e-01</span><span class="s2">,   </span><span class="s4">9.99755674e-01</span><span class="s2">,</span>
           <span class="s4">9.99825956e-01</span><span class="s2">,   </span><span class="s4">9.99829396e-01</span><span class="s2">,   </span><span class="s4">9.99837748e-01</span><span class="s2">,</span>
           <span class="s4">9.99825597e-01</span><span class="s2">,   </span><span class="s4">9.99839509e-01</span><span class="s2">,   </span><span class="s4">9.99789371e-01</span><span class="s2">,</span>
           <span class="s4">9.99458023e-01</span><span class="s2">,   </span><span class="s4">9.98857894e-01</span><span class="s2">,   </span><span class="s4">9.97136330e-01</span><span class="s2">,</span>
           <span class="s4">9.92814933e-01</span><span class="s2">,   </span><span class="s4">9.88571000e-01</span><span class="s2">,   </span><span class="s4">9.89824082e-01</span><span class="s2">,</span>
           <span class="s4">9.91277010e-01</span><span class="s2">,   </span><span class="s4">9.94688346e-01</span><span class="s2">,   </span><span class="s4">9.96090383e-01</span><span class="s2">,</span>
           <span class="s4">9.96010189e-01</span><span class="s2">,   </span><span class="s4">9.96126138e-01</span><span class="s2">,   </span><span class="s4">9.96152552e-01</span><span class="s2">,</span>
           <span class="s4">9.94805484e-01</span><span class="s2">,   </span><span class="s4">9.94365920e-01</span><span class="s2">,   </span><span class="s4">9.94404335e-01</span><span class="s2">,</span>
           <span class="s4">9.94350015e-01</span><span class="s2">,   </span><span class="s4">9.94473588e-01</span><span class="s2">,   </span><span class="s4">9.94298374e-01</span><span class="s2">,</span>
           <span class="s4">9.97447776e-01</span><span class="s2">,   </span><span class="s4">9.98217589e-01</span><span class="s2">,   </span><span class="s4">9.98253594e-01</span><span class="s2">,</span>
           <span class="s4">9.97319145e-01</span><span class="s2">,   </span><span class="s4">9.96244465e-01</span><span class="s2">,   </span><span class="s4">9.93650638e-01</span><span class="s2">,</span>
           <span class="s4">9.84885276e-01</span><span class="s2">,   </span><span class="s4">9.71807970e-01</span><span class="s2">,   </span><span class="s4">9.63220269e-01</span><span class="s2">,</span>
           <span class="s4">9.84748123e-01</span><span class="s2">,   </span><span class="s4">9.97795750e-01</span><span class="s2">,   </span><span class="s4">9.99604178e-01</span><span class="s2">,</span>
           <span class="s4">9.99934302e-01</span><span class="s2">,   </span><span class="s4">9.99968719e-01</span><span class="s2">,   </span><span class="s4">9.99969041e-01</span><span class="s2">,</span>
           <span class="s4">9.99969388e-01</span><span class="s2">,   </span><span class="s4">9.99978903e-01</span><span class="s2">,   </span><span class="s4">9.99983737e-01</span><span class="s2">,</span>
           <span class="s4">9.99983963e-01</span><span class="s2">,   </span><span class="s4">9.99987949e-01</span><span class="s2">,   </span><span class="s4">9.99988448e-01</span><span class="s2">,</span>
           <span class="s4">9.99988464e-01</span><span class="s2">,   </span><span class="s4">9.99988318e-01</span><span class="s2">,   </span><span class="s4">9.99980100e-01</span><span class="s2">,</span>
           <span class="s4">9.99960662e-01</span><span class="s2">,   </span><span class="s4">9.99921917e-01</span><span class="s2">,   </span><span class="s4">9.99854499e-01</span><span class="s2">,</span>
           <span class="s4">9.99711016e-01</span><span class="s2">,   </span><span class="s4">9.99422933e-01</span><span class="s2">,   </span><span class="s4">9.98897716e-01</span><span class="s2">,</span>
           <span class="s4">9.97954476e-01</span><span class="s2">,   </span><span class="s4">9.96644185e-01</span><span class="s2">,   </span><span class="s4">9.96382036e-01</span><span class="s2">,</span>
           <span class="s4">9.96295075e-01</span><span class="s2">,   </span><span class="s4">9.96325086e-01</span><span class="s2">,   </span><span class="s4">9.97066095e-01</span><span class="s2">,</span>
           <span class="s4">9.98599288e-01</span><span class="s2">,   </span><span class="s4">9.99729020e-01</span><span class="s2">,   </span><span class="s4">9.99942853e-01</span><span class="s2">,</span>
           <span class="s4">9.99959712e-01</span><span class="s2">,   </span><span class="s4">9.99992291e-01</span><span class="s2">,   </span><span class="s4">9.99995977e-01</span><span class="s2">,</span>
           <span class="s4">9.99996082e-01</span><span class="s2">,   </span><span class="s4">9.99996179e-01</span><span class="s2">,   </span><span class="s4">9.99996370e-01</span><span class="s2">,</span>
           <span class="s4">9.99996334e-01</span><span class="s2">,   </span><span class="s4">9.99996045e-01</span><span class="s2">,   </span><span class="s4">9.99996030e-01</span><span class="s2">,</span>
           <span class="s4">9.99996030e-01</span><span class="s1">]</span><span class="s2">,</span>
          <span class="s1">[</span><span class="s4">1.79021167e-02</span><span class="s2">,   </span><span class="s4">1.14091306e-05</span><span class="s2">,   </span><span class="s4">5.61557959e-07</span><span class="s2">,</span>
           <span class="s4">8.80398735e-07</span><span class="s2">,   </span><span class="s4">1.08717798e-06</span><span class="s2">,   </span><span class="s4">1.94073468e-06</span><span class="s2">,</span>
           <span class="s4">3.37670187e-06</span><span class="s2">,   </span><span class="s4">3.96039606e-06</span><span class="s2">,   </span><span class="s4">5.22475895e-06</span><span class="s2">,</span>
           <span class="s4">6.12683114e-06</span><span class="s2">,   </span><span class="s4">7.18211108e-06</span><span class="s2">,   </span><span class="s4">7.18979687e-06</span><span class="s2">,</span>
           <span class="s4">7.88353588e-06</span><span class="s2">,   </span><span class="s4">1.06791533e-05</span><span class="s2">,   </span><span class="s4">1.09974873e-05</span><span class="s2">,</span>
           <span class="s4">1.76468607e-06</span><span class="s2">,   </span><span class="s4">5.20603180e-07</span><span class="s2">,   </span><span class="s4">8.57457507e-07</span><span class="s2">,</span>
           <span class="s4">2.59206830e-06</span><span class="s2">,   </span><span class="s4">4.45469808e-06</span><span class="s2">,   </span><span class="s4">8.73353814e-06</span><span class="s2">,</span>
           <span class="s4">1.69387908e-05</span><span class="s2">,   </span><span class="s4">2.93063475e-05</span><span class="s2">,   </span><span class="s4">2.74245464e-05</span><span class="s2">,</span>
           <span class="s4">2.02263872e-05</span><span class="s2">,   </span><span class="s4">7.38324620e-06</span><span class="s2">,   </span><span class="s4">3.13785014e-06</span><span class="s2">,</span>
           <span class="s4">2.10478420e-06</span><span class="s2">,   </span><span class="s4">1.47354829e-06</span><span class="s2">,   </span><span class="s4">1.37871330e-06</span><span class="s2">,</span>
           <span class="s4">3.55723955e-06</span><span class="s2">,   </span><span class="s4">3.85823009e-06</span><span class="s2">,   </span><span class="s4">4.70191999e-06</span><span class="s2">,</span>
           <span class="s4">6.45467678e-06</span><span class="s2">,   </span><span class="s4">7.09050564e-06</span><span class="s2">,   </span><span class="s4">7.57792773e-06</span><span class="s2">,</span>
           <span class="s4">7.48186721e-06</span><span class="s2">,   </span><span class="s4">1.21760845e-05</span><span class="s2">,   </span><span class="s4">1.43286436e-05</span><span class="s2">,</span>
           <span class="s4">1.45502695e-05</span><span class="s2">,   </span><span class="s4">1.51400501e-05</span><span class="s2">,   </span><span class="s4">1.45617528e-05</span><span class="s2">,</span>
           <span class="s4">1.70401707e-05</span><span class="s2">,   </span><span class="s4">2.85443698e-05</span><span class="s2">,   </span><span class="s4">3.33783376e-05</span><span class="s2">,</span>
           <span class="s4">3.30986931e-05</span><span class="s2">,   </span><span class="s4">3.77268239e-05</span><span class="s2">,   </span><span class="s4">6.32867451e-05</span><span class="s2">,</span>
           <span class="s4">1.02678523e-04</span><span class="s2">,   </span><span class="s4">2.05654391e-04</span><span class="s2">,   </span><span class="s4">2.75680178e-04</span><span class="s2">,</span>
           <span class="s4">1.10405281e-04</span><span class="s2">,   </span><span class="s4">3.20904634e-05</span><span class="s2">,   </span><span class="s4">2.60815610e-05</span><span class="s2">,</span>
           <span class="s4">3.74458003e-05</span><span class="s2">,   </span><span class="s4">8.51014220e-05</span><span class="s2">,   </span><span class="s4">4.26242634e-04</span><span class="s2">,</span>
           <span class="s4">5.36412357e-04</span><span class="s2">,   </span><span class="s4">5.55614723e-04</span><span class="s2">,   </span><span class="s4">9.68406481e-04</span><span class="s2">,</span>
           <span class="s4">2.07440399e-03</span><span class="s2">,   </span><span class="s4">2.51696579e-03</span><span class="s2">,   </span><span class="s4">4.11814576e-03</span><span class="s2">,</span>
           <span class="s4">1.01505143e-02</span><span class="s2">,   </span><span class="s4">4.58175094e-02</span><span class="s2">,   </span><span class="s4">1.46789923e-01</span><span class="s2">,</span>
           <span class="s4">9.51602906e-02</span><span class="s2">,   </span><span class="s4">2.51277827e-03</span><span class="s2">,   </span><span class="s4">2.19080166e-04</span><span class="s2">,</span>
           <span class="s4">2.47729179e-04</span><span class="s2">,   </span><span class="s4">9.84424301e-05</span><span class="s2">,   </span><span class="s4">1.75415066e-05</span><span class="s2">,</span>
           <span class="s4">4.40579693e-05</span><span class="s2">,   </span><span class="s4">8.06554966e-05</span><span class="s2">,   </span><span class="s4">1.39332709e-04</span><span class="s2">,</span>
           <span class="s4">8.08543683e-04</span><span class="s2">,   </span><span class="s4">2.63400428e-04</span><span class="s2">,   </span><span class="s4">6.28778860e-04</span><span class="s2">,</span>
           <span class="s4">1.53926554e-03</span><span class="s2">,   </span><span class="s4">1.21448448e-04</span><span class="s2">,   </span><span class="s4">4.01921637e-05</span><span class="s2">,</span>
           <span class="s4">1.47981180e-03</span><span class="s2">,   </span><span class="s4">7.57754547e-02</span><span class="s2">,   </span><span class="s4">1.54441814e-01</span><span class="s2">,</span>
           <span class="s4">4.03957090e-02</span><span class="s2">,   </span><span class="s4">3.08060743e-02</span><span class="s2">,   </span><span class="s4">6.79972580e-03</span><span class="s2">,</span>
           <span class="s4">7.03557513e-04</span><span class="s2">,   </span><span class="s4">2.44292397e-04</span><span class="s2">,   </span><span class="s4">1.96941023e-04</span><span class="s2">,</span>
           <span class="s4">1.10340666e-04</span><span class="s2">,   </span><span class="s4">7.73495785e-05</span><span class="s2">,   </span><span class="s4">1.44199620e-04</span><span class="s2">,</span>
           <span class="s4">3.60905335e-04</span><span class="s2">,   </span><span class="s4">1.04887049e-03</span><span class="s2">,   </span><span class="s4">2.05193714e-03</span><span class="s2">,</span>
           <span class="s4">3.56087416e-03</span><span class="s2">,   </span><span class="s4">1.05497090e-03</span><span class="s2">,   </span><span class="s4">5.73656986e-04</span><span class="s2">,</span>
           <span class="s4">4.96641901e-04</span><span class="s2">,   </span><span class="s4">1.80265024e-04</span><span class="s2">,   </span><span class="s4">5.65192629e-06</span><span class="s2">,</span>
           <span class="s4">8.15973913e-07</span><span class="s2">,   </span><span class="s4">1.82423614e-05</span><span class="s2">,   </span><span class="s4">7.76851662e-04</span><span class="s2">,</span>
           <span class="s4">2.84604839e-07</span><span class="s2">,   </span><span class="s4">1.10296978e-07</span><span class="s2">,   </span><span class="s4">2.24235284e-08</span><span class="s2">,</span>
           <span class="s4">2.91783631e-08</span><span class="s2">,   </span><span class="s4">5.57802135e-06</span><span class="s2">,   </span><span class="s4">2.40181297e-06</span><span class="s2">,</span>
           <span class="s4">1.66126826e-06</span><span class="s2">,   </span><span class="s4">1.66577067e-04</span><span class="s2">,   </span><span class="s4">1.60124567e-03</span><span class="s2">,</span>
           <span class="s4">3.71040697e-03</span><span class="s2">,   </span><span class="s4">3.04702430e-03</span><span class="s2">,   </span><span class="s4">1.28036894e-03</span><span class="s2">,</span>
           <span class="s4">1.33199390e-03</span><span class="s2">,   </span><span class="s4">9.46259530e-04</span><span class="s2">,   </span><span class="s4">3.01196207e-04</span><span class="s2">,</span>
           <span class="s4">1.01009606e-04</span><span class="s2">,   </span><span class="s4">1.64390413e-03</span><span class="s2">,   </span><span class="s4">4.63667164e-03</span><span class="s2">,</span>
           <span class="s4">9.63523286e-03</span><span class="s2">,   </span><span class="s4">9.87732797e-03</span><span class="s2">,   </span><span class="s4">7.60992378e-03</span><span class="s2">,</span>
           <span class="s4">1.08213202e-02</span><span class="s2">,   </span><span class="s4">3.47413597e-02</span><span class="s2">,   </span><span class="s4">7.87085339e-02</span><span class="s2">,</span>
           <span class="s4">6.19641042e-02</span><span class="s2">,   </span><span class="s4">5.16881745e-02</span><span class="s2">,   </span><span class="s4">2.83502897e-02</span><span class="s2">,</span>
           <span class="s4">2.39198441e-02</span><span class="s2">,   </span><span class="s4">2.39310293e-02</span><span class="s2">,   </span><span class="s4">3.28190388e-02</span><span class="s2">,</span>
           <span class="s4">2.00980320e-02</span><span class="s2">,   </span><span class="s4">8.42451713e-03</span><span class="s2">,   </span><span class="s4">4.66668659e-03</span><span class="s2">,</span>
           <span class="s4">1.31406606e-03</span><span class="s2">,   </span><span class="s4">8.97753552e-04</span><span class="s2">,   </span><span class="s4">2.11004086e-03</span><span class="s2">,</span>
           <span class="s4">3.91003494e-03</span><span class="s2">,   </span><span class="s4">6.26373002e-03</span><span class="s2">,   </span><span class="s4">6.34371628e-03</span><span class="s2">,</span>
           <span class="s4">7.04224256e-03</span><span class="s2">,   </span><span class="s4">1.21673274e-02</span><span class="s2">,   </span><span class="s4">6.36067034e-02</span><span class="s2">,</span>
           <span class="s4">1.04652728e-01</span><span class="s2">,   </span><span class="s4">7.17968006e-02</span><span class="s2">,   </span><span class="s4">2.76866443e-02</span><span class="s2">,</span>
           <span class="s4">2.66003442e-03</span><span class="s2">,   </span><span class="s4">1.12494156e-04</span><span class="s2">,   </span><span class="s4">2.40738814e-05</span><span class="s2">,</span>
           <span class="s4">1.12943610e-05</span><span class="s2">,   </span><span class="s4">8.34520559e-06</span><span class="s2">,   </span><span class="s4">8.32013406e-06</span><span class="s2">,</span>
           <span class="s4">7.89300655e-06</span><span class="s2">,   </span><span class="s4">8.53818448e-06</span><span class="s2">,   </span><span class="s4">7.79122759e-06</span><span class="s2">,</span>
           <span class="s4">1.03973423e-05</span><span class="s2">,   </span><span class="s4">2.72411101e-05</span><span class="s2">,   </span><span class="s4">5.70666949e-05</span><span class="s2">,</span>
           <span class="s4">1.43281927e-04</span><span class="s2">,   </span><span class="s4">3.59485298e-04</span><span class="s2">,   </span><span class="s4">5.68122941e-04</span><span class="s2">,</span>
           <span class="s4">4.93097756e-04</span><span class="s2">,   </span><span class="s4">4.23244829e-04</span><span class="s2">,   </span><span class="s4">2.50908844e-04</span><span class="s2">,</span>
           <span class="s4">1.87544775e-04</span><span class="s2">,   </span><span class="s4">1.94954279e-04</span><span class="s2">,   </span><span class="s4">1.88610947e-04</span><span class="s2">,</span>
           <span class="s4">1.87324551e-04</span><span class="s2">,   </span><span class="s4">2.56591337e-04</span><span class="s2">,   </span><span class="s4">2.75680269e-04</span><span class="s2">,</span>
           <span class="s4">2.72701680e-04</span><span class="s2">,   </span><span class="s4">2.75688894e-04</span><span class="s2">,   </span><span class="s4">2.69118592e-04</span><span class="s2">,</span>
           <span class="s4">2.79368706e-04</span><span class="s2">,   </span><span class="s4">1.16602211e-04</span><span class="s2">,   </span><span class="s4">8.54105771e-05</span><span class="s2">,</span>
           <span class="s4">8.50836389e-05</span><span class="s2">,   </span><span class="s4">1.32948236e-04</span><span class="s2">,   </span><span class="s4">1.85246543e-04</span><span class="s2">,</span>
           <span class="s4">3.13229937e-04</span><span class="s2">,   </span><span class="s4">7.48658490e-04</span><span class="s2">,   </span><span class="s4">1.39370122e-03</span><span class="s2">,</span>
           <span class="s4">1.85235809e-03</span><span class="s2">,   </span><span class="s4">6.94881963e-04</span><span class="s2">,   </span><span class="s4">7.74820062e-05</span><span class="s2">,</span>
           <span class="s4">1.63275933e-05</span><span class="s2">,   </span><span class="s4">2.53162706e-06</span><span class="s2">,   </span><span class="s4">1.47419297e-06</span><span class="s2">,</span>
           <span class="s4">1.51187760e-06</span><span class="s2">,   </span><span class="s4">1.49217514e-06</span><span class="s2">,   </span><span class="s4">1.00525815e-06</span><span class="s2">,</span>
           <span class="s4">7.82384697e-07</span><span class="s2">,   </span><span class="s4">7.82207824e-07</span><span class="s2">,   </span><span class="s4">5.77845546e-07</span><span class="s2">,</span>
           <span class="s4">5.62709744e-07</span><span class="s2">,   </span><span class="s4">5.62700867e-07</span><span class="s2">,   </span><span class="s4">5.70153586e-07</span><span class="s2">,</span>
           <span class="s4">9.91143211e-07</span><span class="s2">,   </span><span class="s4">1.96623986e-06</span><span class="s2">,   </span><span class="s4">3.90276412e-06</span><span class="s2">,</span>
           <span class="s4">7.25964578e-06</span><span class="s2">,   </span><span class="s4">1.44416500e-05</span><span class="s2">,   </span><span class="s4">2.88341084e-05</span><span class="s2">,</span>
           <span class="s4">5.49895700e-05</span><span class="s2">,   </span><span class="s4">1.01928727e-04</span><span class="s2">,   </span><span class="s4">1.66788149e-04</span><span class="s2">,</span>
           <span class="s4">1.76920424e-04</span><span class="s2">,   </span><span class="s4">1.80878376e-04</span><span class="s2">,   </span><span class="s4">1.79263902e-04</span><span class="s2">,</span>
           <span class="s4">1.41441142e-04</span><span class="s2">,   </span><span class="s4">6.46353467e-05</span><span class="s2">,   </span><span class="s4">1.05822848e-05</span><span class="s2">,</span>
           <span class="s4">2.38770925e-06</span><span class="s2">,   </span><span class="s4">1.94345661e-06</span><span class="s2">,   </span><span class="s4">2.95614088e-07</span><span class="s2">,</span>
           <span class="s4">1.91116221e-07</span><span class="s2">,   </span><span class="s4">1.91095610e-07</span><span class="s2">,   </span><span class="s4">1.86129447e-07</span><span class="s2">,</span>
           <span class="s4">1.76579974e-07</span><span class="s2">,   </span><span class="s4">1.78918351e-07</span><span class="s2">,   </span><span class="s4">1.93625709e-07</span><span class="s2">,</span>
           <span class="s4">1.93628651e-07</span><span class="s1">]]</span><span class="s2">,</span>

         <span class="s1">[[</span><span class="s4">1.12025955e-05</span><span class="s2">,   </span><span class="s4">1.08238349e-05</span><span class="s2">,   </span><span class="s4">1.71596282e-05</span><span class="s2">,</span>
           <span class="s4">2.11831999e-05</span><span class="s2">,   </span><span class="s4">3.78067714e-05</span><span class="s2">,   </span><span class="s4">6.57213848e-05</span><span class="s2">,</span>
           <span class="s4">7.69689076e-05</span><span class="s2">,   </span><span class="s4">1.01479702e-04</span><span class="s2">,   </span><span class="s4">1.18846167e-04</span><span class="s2">,</span>
           <span class="s4">1.39184231e-04</span><span class="s2">,   </span><span class="s4">1.39184063e-04</span><span class="s2">,   </span><span class="s4">1.52618987e-04</span><span class="s2">,</span>
           <span class="s4">2.06583251e-04</span><span class="s2">,   </span><span class="s4">2.12093282e-04</span><span class="s2">,   </span><span class="s4">3.40270257e-05</span><span class="s2">,</span>
           <span class="s4">1.01343628e-05</span><span class="s2">,   </span><span class="s4">1.67136918e-05</span><span class="s2">,   </span><span class="s4">5.05076133e-05</span><span class="s2">,</span>
           <span class="s4">8.66507075e-05</span><span class="s2">,   </span><span class="s4">1.69568562e-04</span><span class="s2">,   </span><span class="s4">3.27466124e-04</span><span class="s2">,</span>
           <span class="s4">5.61681158e-04</span><span class="s2">,   </span><span class="s4">5.19031075e-04</span><span class="s2">,   </span><span class="s4">3.83481719e-04</span><span class="s2">,</span>
           <span class="s4">1.41026283e-04</span><span class="s2">,   </span><span class="s4">6.07294396e-05</span><span class="s2">,   </span><span class="s4">4.09142321e-05</span><span class="s2">,</span>
           <span class="s4">2.86746604e-05</span><span class="s2">,   </span><span class="s4">2.68478873e-05</span><span class="s2">,   </span><span class="s4">6.92750449e-05</span><span class="s2">,</span>
           <span class="s4">7.49687747e-05</span><span class="s2">,   </span><span class="s4">9.13357640e-05</span><span class="s2">,   </span><span class="s4">1.25272004e-04</span><span class="s2">,</span>
           <span class="s4">1.37363965e-04</span><span class="s2">,   </span><span class="s4">1.46709304e-04</span><span class="s2">,   </span><span class="s4">1.44790612e-04</span><span class="s2">,</span>
           <span class="s4">2.35646550e-04</span><span class="s2">,   </span><span class="s4">2.75965631e-04</span><span class="s2">,   </span><span class="s4">2.79621160e-04</span><span class="s2">,</span>
           <span class="s4">2.90883100e-04</span><span class="s2">,   </span><span class="s4">2.79620868e-04</span><span class="s2">,   </span><span class="s4">3.27463569e-04</span><span class="s2">,</span>
           <span class="s4">5.47092221e-04</span><span class="s2">,   </span><span class="s4">6.32282164e-04</span><span class="s2">,   </span><span class="s4">6.24012551e-04</span><span class="s2">,</span>
           <span class="s4">7.11758349e-04</span><span class="s2">,   </span><span class="s4">1.18880242e-03</span><span class="s2">,   </span><span class="s4">1.88316198e-03</span><span class="s2">,</span>
           <span class="s4">3.62983774e-03</span><span class="s2">,   </span><span class="s4">4.41594500e-03</span><span class="s2">,   </span><span class="s4">1.67213822e-03</span><span class="s2">,</span>
           <span class="s4">5.61598141e-04</span><span class="s2">,   </span><span class="s4">4.92415886e-04</span><span class="s2">,   </span><span class="s4">7.11767023e-04</span><span class="s2">,</span>
           <span class="s4">1.60853614e-03</span><span class="s2">,   </span><span class="s4">7.65465286e-03</span><span class="s2">,   </span><span class="s4">7.24380556e-03</span><span class="s2">,</span>
           <span class="s4">7.05094383e-03</span><span class="s2">,   </span><span class="s4">1.63405802e-02</span><span class="s2">,   </span><span class="s4">1.20569790e-01</span><span class="s2">,</span>
           <span class="s4">3.94742135e-02</span><span class="s2">,   </span><span class="s4">2.08678283e-03</span><span class="s2">,   </span><span class="s4">1.51404348e-04</span><span class="s2">,</span>
           <span class="s4">8.92900957e-05</span><span class="s2">,   </span><span class="s4">1.99758310e-04</span><span class="s2">,   </span><span class="s4">7.61880868e-04</span><span class="s2">,</span>
           <span class="s4">4.06265456e-04</span><span class="s2">,   </span><span class="s4">1.18223714e-03</span><span class="s2">,   </span><span class="s4">3.92458604e-03</span><span class="s2">,</span>
           <span class="s4">1.52531964e-03</span><span class="s2">,   </span><span class="s4">3.10635338e-04</span><span class="s2">,   </span><span class="s4">8.44534873e-04</span><span class="s2">,</span>
           <span class="s4">1.50619244e-03</span><span class="s2">,   </span><span class="s4">2.54719705e-03</span><span class="s2">,   </span><span class="s4">1.58406633e-02</span><span class="s2">,</span>
           <span class="s4">7.41723708e-02</span><span class="s2">,   </span><span class="s4">9.56881006e-02</span><span class="s2">,   </span><span class="s4">5.83874154e-04</span><span class="s2">,</span>
           <span class="s4">1.90161316e-05</span><span class="s2">,   </span><span class="s4">2.96375310e-05</span><span class="s2">,   </span><span class="s4">2.36039059e-06</span><span class="s2">,</span>
           <span class="s4">7.58604311e-07</span><span class="s2">,   </span><span class="s4">2.57849849e-05</span><span class="s2">,   </span><span class="s4">9.40604577e-04</span><span class="s2">,</span>
           <span class="s4">5.33706193e-03</span><span class="s2">,   </span><span class="s4">3.09799210e-03</span><span class="s2">,   </span><span class="s4">1.66375727e-03</span><span class="s2">,</span>
           <span class="s4">2.74932130e-03</span><span class="s2">,   </span><span class="s4">3.05895259e-03</span><span class="s2">,   </span><span class="s4">1.78605741e-03</span><span class="s2">,</span>
           <span class="s4">1.35561648e-03</span><span class="s2">,   </span><span class="s4">2.61499931e-03</span><span class="s2">,   </span><span class="s4">6.20778364e-03</span><span class="s2">,</span>
           <span class="s4">1.51802588e-02</span><span class="s2">,   </span><span class="s4">2.05865429e-02</span><span class="s2">,   </span><span class="s4">3.71923130e-02</span><span class="s2">,</span>
           <span class="s4">5.95732628e-02</span><span class="s2">,   </span><span class="s4">1.65718056e-02</span><span class="s2">,   </span><span class="s4">3.80823607e-04</span><span class="s2">,</span>
           <span class="s4">1.50863835e-05</span><span class="s2">,   </span><span class="s4">9.51367568e-06</span><span class="s2">,   </span><span class="s4">3.43305910e-06</span><span class="s2">,</span>
           <span class="s4">1.06949636e-07</span><span class="s2">,   </span><span class="s4">1.53871486e-08</span><span class="s2">,   </span><span class="s4">3.43715817e-07</span><span class="s2">,</span>
           <span class="s4">1.46644282e-05</span><span class="s2">,   </span><span class="s4">5.44780299e-09</span><span class="s2">,   </span><span class="s4">2.07973264e-09</span><span class="s2">,</span>
           <span class="s4">4.22811016e-10</span><span class="s2">,   </span><span class="s4">5.50174068e-10</span><span class="s2">,   </span><span class="s4">1.05177578e-07</span><span class="s2">,</span>
           <span class="s4">4.52926927e-08</span><span class="s2">,   </span><span class="s4">3.13205860e-08</span><span class="s2">,   </span><span class="s4">3.13648669e-06</span><span class="s2">,</span>
           <span class="s4">3.02223414e-05</span><span class="s2">,   </span><span class="s4">7.21922046e-05</span><span class="s2">,   </span><span class="s4">6.18725853e-05</span><span class="s2">,</span>
           <span class="s4">2.56885381e-05</span><span class="s2">,   </span><span class="s4">2.57933905e-05</span><span class="s2">,   </span><span class="s4">1.83306498e-05</span><span class="s2">,</span>
           <span class="s4">5.78811168e-06</span><span class="s2">,   </span><span class="s4">1.91303926e-06</span><span class="s2">,   </span><span class="s4">3.09596995e-05</span><span class="s2">,</span>
           <span class="s4">8.97107118e-05</span><span class="s2">,   </span><span class="s4">1.98397776e-04</span><span class="s2">,   </span><span class="s4">2.25453416e-04</span><span class="s2">,</span>
           <span class="s4">1.76630376e-04</span><span class="s2">,   </span><span class="s4">2.34227583e-04</span><span class="s2">,   </span><span class="s4">7.30232210e-04</span><span class="s2">,</span>
           <span class="s4">2.38495171e-03</span><span class="s2">,   </span><span class="s4">4.00510154e-03</span><span class="s2">,   </span><span class="s4">7.77726570e-03</span><span class="s2">,</span>
           <span class="s4">8.97115089e-03</span><span class="s2">,   </span><span class="s4">8.22739679e-03</span><span class="s2">,   </span><span class="s4">6.04111865e-03</span><span class="s2">,</span>
           <span class="s4">7.78825566e-03</span><span class="s2">,   </span><span class="s4">5.37640212e-03</span><span class="s2">,   </span><span class="s4">1.15742054e-03</span><span class="s2">,</span>
           <span class="s4">1.96231469e-04</span><span class="s2">,   </span><span class="s4">2.98340104e-05</span><span class="s2">,   </span><span class="s4">1.74288946e-05</span><span class="s2">,</span>
           <span class="s4">4.04251152e-05</span><span class="s2">,   </span><span class="s4">7.66081747e-05</span><span class="s2">,   </span><span class="s4">1.27458564e-04</span><span class="s2">,</span>
           <span class="s4">1.35365069e-04</span><span class="s2">,   </span><span class="s4">1.50582215e-04</span><span class="s2">,   </span><span class="s4">2.47483336e-04</span><span class="s2">,</span>
           <span class="s4">1.19104299e-03</span><span class="s2">,   </span><span class="s4">2.75836722e-03</span><span class="s2">,   </span><span class="s4">1.54674662e-03</span><span class="s2">,</span>
           <span class="s4">5.81818376e-04</span><span class="s2">,   </span><span class="s4">4.20436146e-04</span><span class="s2">,   </span><span class="s4">2.14900000e-04</span><span class="s2">,</span>
           <span class="s4">1.60869708e-04</span><span class="s2">,   </span><span class="s4">1.60870261e-04</span><span class="s2">,   </span><span class="s4">1.52618788e-04</span><span class="s2">,</span>
           <span class="s4">1.65161879e-04</span><span class="s2">,   </span><span class="s4">1.50622869e-04</span><span class="s2">,   </span><span class="s4">2.01215675e-04</span><span class="s2">,</span>
           <span class="s4">5.25921364e-04</span><span class="s2">,   </span><span class="s4">1.08428049e-03</span><span class="s2">,   </span><span class="s4">2.64975788e-03</span><span class="s2">,</span>
           <span class="s4">6.12720308e-03</span><span class="s2">,   </span><span class="s4">8.04408524e-03</span><span class="s2">,   </span><span class="s4">6.02884531e-03</span><span class="s2">,</span>
           <span class="s4">5.43410929e-03</span><span class="s2">,   </span><span class="s4">3.39451560e-03</span><span class="s2">,   </span><span class="s4">2.90252080e-03</span><span class="s2">,</span>
           <span class="s4">3.18247731e-03</span><span class="s2">,   </span><span class="s4">3.05958361e-03</span><span class="s2">,   </span><span class="s4">3.05966473e-03</span><span class="s2">,</span>
           <span class="s4">4.19096979e-03</span><span class="s2">,   </span><span class="s4">4.24463587e-03</span><span class="s2">,   </span><span class="s4">4.13448594e-03</span><span class="s2">,</span>
           <span class="s4">4.18905097e-03</span><span class="s2">,   </span><span class="s4">4.08069293e-03</span><span class="s2">,   </span><span class="s4">4.24434753e-03</span><span class="s2">,</span>
           <span class="s4">1.76233516e-03</span><span class="s2">,   </span><span class="s4">1.48624883e-03</span><span class="s2">,   </span><span class="s4">1.52595908e-03</span><span class="s2">,</span>
           <span class="s4">2.38530006e-03</span><span class="s2">,   </span><span class="s4">3.18322588e-03</span><span class="s2">,   </span><span class="s4">5.16768050e-03</span><span class="s2">,</span>
           <span class="s4">1.11378320e-02</span><span class="s2">,   </span><span class="s4">1.52736098e-02</span><span class="s2">,   </span><span class="s4">1.41741690e-02</span><span class="s2">,</span>
           <span class="s4">4.54911025e-03</span><span class="s2">,   </span><span class="s4">8.77392678e-04</span><span class="s2">,   </span><span class="s4">2.94712782e-04</span><span class="s2">,</span>
           <span class="s4">4.85508787e-05</span><span class="s2">,   </span><span class="s4">2.86746478e-05</span><span class="s2">,   </span><span class="s4">2.94397372e-05</span><span class="s2">,</span>
           <span class="s4">2.90546890e-05</span><span class="s2">,   </span><span class="s4">1.95742396e-05</span><span class="s2">,   </span><span class="s4">1.52422076e-05</span><span class="s2">,</span>
           <span class="s4">1.52422111e-05</span><span class="s2">,   </span><span class="s4">1.12600205e-05</span><span class="s2">,   </span><span class="s4">1.09674004e-05</span><span class="s2">,</span>
           <span class="s4">1.09674006e-05</span><span class="s2">,   </span><span class="s4">1.11127487e-05</span><span class="s2">,   </span><span class="s4">1.93182406e-05</span><span class="s2">,</span>
           <span class="s4">3.83078048e-05</span><span class="s2">,   </span><span class="s4">7.59623818e-05</span><span class="s2">,   </span><span class="s4">1.41028921e-04</span><span class="s2">,</span>
           <span class="s4">2.79623709e-04</span><span class="s2">,   </span><span class="s4">5.54340948e-04</span><span class="s2">,   </span><span class="s4">1.04233041e-03</span><span class="s2">,</span>
           <span class="s4">1.88320811e-03</span><span class="s2">,   </span><span class="s4">2.94262269e-03</span><span class="s2">,   </span><span class="s4">2.94184869e-03</span><span class="s2">,</span>
           <span class="s4">2.98057651e-03</span><span class="s2">,   </span><span class="s4">2.94168054e-03</span><span class="s2">,   </span><span class="s4">2.32272136e-03</span><span class="s2">,</span>
           <span class="s4">1.09836589e-03</span><span class="s2">,   </span><span class="s4">1.93411390e-04</span><span class="s2">,   </span><span class="s4">4.60605812e-05</span><span class="s2">,</span>
           <span class="s4">3.78067203e-05</span><span class="s2">,   </span><span class="s4">5.75348228e-06</span><span class="s2">,   </span><span class="s4">3.72600447e-06</span><span class="s2">,</span>
           <span class="s4">3.72600486e-06</span><span class="s2">,   </span><span class="s4">3.62917375e-06</span><span class="s2">,   </span><span class="s4">3.44299546e-06</span><span class="s2">,</span>
           <span class="s4">3.48862495e-06</span><span class="s2">,   </span><span class="s4">3.77538503e-06</span><span class="s2">,   </span><span class="s4">3.77538498e-06</span><span class="s2">,</span>
           <span class="s4">3.77538498e-06</span><span class="s1">]</span><span class="s2">,</span>
          <span class="s1">[</span><span class="s4">2.11253415e-04</span><span class="s2">,   </span><span class="s4">1.27726353e-07</span><span class="s2">,   </span><span class="s4">9.96660517e-09</span><span class="s2">,</span>
           <span class="s4">1.92893528e-08</span><span class="s2">,   </span><span class="s4">4.25132434e-08</span><span class="s2">,   </span><span class="s4">1.31928738e-07</span><span class="s2">,</span>
           <span class="s4">2.68831493e-07</span><span class="s2">,   </span><span class="s4">4.15719953e-07</span><span class="s2">,   </span><span class="s4">6.42307057e-07</span><span class="s2">,</span>
           <span class="s4">8.82117691e-07</span><span class="s2">,   </span><span class="s4">1.03405286e-06</span><span class="s2">,   </span><span class="s4">1.13509493e-06</span><span class="s2">,</span>
           <span class="s4">1.68479526e-06</span><span class="s2">,   </span><span class="s4">2.34314197e-06</span><span class="s2">,   </span><span class="s4">3.87056416e-07</span><span class="s2">,</span>
           <span class="s4">1.84972077e-08</span><span class="s2">,   </span><span class="s4">8.99961200e-09</span><span class="s2">,   </span><span class="s4">4.47949311e-08</span><span class="s2">,</span>
           <span class="s4">2.32324230e-07</span><span class="s2">,   </span><span class="s4">7.81405794e-07</span><span class="s2">,   </span><span class="s4">2.95897306e-06</span><span class="s2">,</span>
           <span class="s4">9.84611707e-06</span><span class="s2">,   </span><span class="s4">1.57411766e-05</span><span class="s2">,   </span><span class="s4">1.08818924e-05</span><span class="s2">,</span>
           <span class="s4">2.95071175e-06</span><span class="s2">,   </span><span class="s4">4.63781583e-07</span><span class="s2">,   </span><span class="s4">1.32789240e-07</span><span class="s2">,</span>
           <span class="s4">6.24246828e-08</span><span class="s2">,   </span><span class="s4">4.09188950e-08</span><span class="s2">,   </span><span class="s4">9.87912777e-08</span><span class="s2">,</span>
           <span class="s4">2.75844825e-07</span><span class="s2">,   </span><span class="s4">3.64508436e-07</span><span class="s2">,   </span><span class="s4">6.09288617e-07</span><span class="s2">,</span>
           <span class="s4">9.17164574e-07</span><span class="s2">,   </span><span class="s4">1.07606678e-06</span><span class="s2">,   </span><span class="s4">1.13499677e-06</span><span class="s2">,</span>
           <span class="s4">1.82395688e-06</span><span class="s2">,   </span><span class="s4">3.47637333e-06</span><span class="s2">,   </span><span class="s4">4.14516370e-06</span><span class="s2">,</span>
           <span class="s4">4.37886128e-06</span><span class="s2">,   </span><span class="s4">4.37989719e-06</span><span class="s2">,   </span><span class="s4">4.93360580e-06</span><span class="s2">,</span>
           <span class="s4">9.64763432e-06</span><span class="s2">,   </span><span class="s4">1.86794329e-05</span><span class="s2">,   </span><span class="s4">2.15570874e-05</span><span class="s2">,</span>
           <span class="s4">2.43845482e-05</span><span class="s2">,   </span><span class="s4">4.64462028e-05</span><span class="s2">,   </span><span class="s4">1.23520043e-04</span><span class="s2">,</span>
           <span class="s4">3.87076429e-04</span><span class="s2">,   </span><span class="s4">9.44545390e-04</span><span class="s2">,   </span><span class="s4">4.77935817e-04</span><span class="s2">,</span>
           <span class="s4">6.41759692e-05</span><span class="s2">,   </span><span class="s4">1.63523468e-05</span><span class="s2">,   </span><span class="s4">1.92148699e-05</span><span class="s2">,</span>
           <span class="s4">6.24041695e-05</span><span class="s2">,   </span><span class="s4">6.79471603e-04</span><span class="s2">,   </span><span class="s4">3.22864270e-03</span><span class="s2">,</span>
           <span class="s4">3.95754786e-03</span><span class="s2">,   </span><span class="s4">9.64631226e-03</span><span class="s2">,   </span><span class="s4">1.70602991e-01</span><span class="s2">,</span>
           <span class="s4">8.59968341e-01</span><span class="s2">,   </span><span class="s4">9.89908472e-01</span><span class="s2">,   </span><span class="s4">9.95082386e-01</span><span class="s2">,</span>
           <span class="s4">9.88812182e-01</span><span class="s2">,   </span><span class="s4">9.43954547e-01</span><span class="s2">,   </span><span class="s4">6.83123048e-01</span><span class="s2">,</span>
           <span class="s4">4.66129206e-02</span><span class="s2">,   </span><span class="s4">3.09352861e-03</span><span class="s2">,   </span><span class="s4">8.93773079e-04</span><span class="s2">,</span>
           <span class="s4">3.91666349e-04</span><span class="s2">,   </span><span class="s4">3.16418394e-05</span><span class="s2">,   </span><span class="s4">1.53356713e-05</span><span class="s2">,</span>
           <span class="s4">6.87457292e-05</span><span class="s2">,   </span><span class="s4">2.13092992e-04</span><span class="s2">,   </span><span class="s4">2.32534345e-03</span><span class="s2">,</span>
           <span class="s4">7.27816933e-02</span><span class="s2">,   </span><span class="s4">8.74229999e-01</span><span class="s2">,   </span><span class="s4">9.98407029e-01</span><span class="s2">,</span>
           <span class="s4">9.98411396e-01</span><span class="s2">,   </span><span class="s4">9.99845191e-01</span><span class="s2">,   </span><span class="s4">9.99957349e-01</span><span class="s2">,</span>
           <span class="s4">9.98518267e-01</span><span class="s2">,   </span><span class="s4">9.22006973e-01</span><span class="s2">,   </span><span class="s4">5.89929152e-01</span><span class="s2">,</span>
           <span class="s4">4.08781288e-01</span><span class="s2">,   </span><span class="s4">1.16132419e-01</span><span class="s2">,   </span><span class="s4">1.19446461e-02</span><span class="s2">,</span>
           <span class="s4">2.01160124e-03</span><span class="s2">,   </span><span class="s4">7.76059520e-04</span><span class="s2">,   </span><span class="s4">3.64661127e-04</span><span class="s2">,</span>
           <span class="s4">1.54958020e-04</span><span class="s2">,   </span><span class="s4">2.09811287e-04</span><span class="s2">,   </span><span class="s4">9.32637836e-04</span><span class="s2">,</span>
           <span class="s4">5.78993623e-03</span><span class="s2">,   </span><span class="s4">2.33856026e-02</span><span class="s2">,   </span><span class="s4">9.07233098e-02</span><span class="s2">,</span>
           <span class="s4">4.63420305e-01</span><span class="s2">,   </span><span class="s4">9.63608297e-01</span><span class="s2">,   </span><span class="s4">9.98819302e-01</span><span class="s2">,</span>
           <span class="s4">9.99480518e-01</span><span class="s2">,   </span><span class="s4">9.99808447e-01</span><span class="s2">,   </span><span class="s4">9.99990895e-01</span><span class="s2">,</span>
           <span class="s4">9.99999077e-01</span><span class="s2">,   </span><span class="s4">9.99981742e-01</span><span class="s2">,   </span><span class="s4">9.99222528e-01</span><span class="s2">,</span>
           <span class="s4">9.99985047e-01</span><span class="s2">,   </span><span class="s4">9.99999884e-01</span><span class="s2">,   </span><span class="s4">9.99999975e-01</span><span class="s2">,</span>
           <span class="s4">9.99999970e-01</span><span class="s2">,   </span><span class="s4">9.99994421e-01</span><span class="s2">,   </span><span class="s4">9.99997493e-01</span><span class="s2">,</span>
           <span class="s4">9.99998293e-01</span><span class="s2">,   </span><span class="s4">9.99833386e-01</span><span class="s2">,   </span><span class="s4">9.98390415e-01</span><span class="s2">,</span>
           <span class="s4">9.96142941e-01</span><span class="s2">,   </span><span class="s4">9.96652508e-01</span><span class="s2">,   </span><span class="s4">9.98575706e-01</span><span class="s2">,</span>
           <span class="s4">9.98606878e-01</span><span class="s2">,   </span><span class="s4">9.99002678e-01</span><span class="s2">,   </span><span class="s4">9.99674761e-01</span><span class="s2">,</span>
           <span class="s4">9.99892598e-01</span><span class="s2">,   </span><span class="s4">9.98350925e-01</span><span class="s2">,   </span><span class="s4">9.95183180e-01</span><span class="s2">,</span>
           <span class="s4">9.89371440e-01</span><span class="s2">,   </span><span class="s4">9.87872581e-01</span><span class="s2">,   </span><span class="s4">9.90372881e-01</span><span class="s2">,</span>
           <span class="s4">9.86999118e-01</span><span class="s2">,   </span><span class="s4">9.56222788e-01</span><span class="s2">,   </span><span class="s4">8.50681207e-01</span><span class="s2">,</span>
           <span class="s4">7.24756775e-01</span><span class="s2">,   </span><span class="s4">5.66049041e-01</span><span class="s2">,   </span><span class="s4">5.46874738e-01</span><span class="s2">,</span>
           <span class="s4">5.92553862e-01</span><span class="s2">,   </span><span class="s4">6.58678757e-01</span><span class="s2">,   </span><span class="s4">6.41466629e-01</span><span class="s2">,</span>
           <span class="s4">7.58742098e-01</span><span class="s2">,   </span><span class="s4">9.36158241e-01</span><span class="s2">,   </span><span class="s4">9.88524579e-01</span><span class="s2">,</span>
           <span class="s4">9.98222528e-01</span><span class="s2">,   </span><span class="s4">9.99044684e-01</span><span class="s2">,   </span><span class="s4">9.97834411e-01</span><span class="s2">,</span>
           <span class="s4">9.95885383e-01</span><span class="s2">,   </span><span class="s4">9.93159943e-01</span><span class="s2">,   </span><span class="s4">9.92686387e-01</span><span class="s2">,</span>
           <span class="s4">9.91828320e-01</span><span class="s2">,   </span><span class="s4">9.85759730e-01</span><span class="s2">,   </span><span class="s4">9.18418400e-01</span><span class="s2">,</span>
           <span class="s4">7.13462025e-01</span><span class="s2">,   </span><span class="s4">3.66380818e-01</span><span class="s2">,   </span><span class="s4">4.79992398e-02</span><span class="s2">,</span>
           <span class="s4">1.60850862e-03</span><span class="s2">,   </span><span class="s4">4.89463014e-05</span><span class="s2">,   </span><span class="s4">5.35211883e-06</span><span class="s2">,</span>
           <span class="s4">1.87952723e-06</span><span class="s2">,   </span><span class="s4">1.38874976e-06</span><span class="s2">,   </span><span class="s4">1.31354781e-06</span><span class="s2">,</span>
           <span class="s4">1.34854399e-06</span><span class="s2">,   </span><span class="s4">1.33034183e-06</span><span class="s2">,   </span><span class="s4">1.62179619e-06</span><span class="s2">,</span>
           <span class="s4">5.65868721e-06</span><span class="s2">,   </span><span class="s4">3.05843904e-05</span><span class="s2">,   </span><span class="s4">1.56845284e-04</span><span class="s2">,</span>
           <span class="s4">9.14581641e-04</span><span class="s2">,   </span><span class="s4">3.02542940e-03</span><span class="s2">,   </span><span class="s4">3.57894927e-03</span><span class="s2">,</span>
           <span class="s4">2.79578295e-03</span><span class="s2">,   </span><span class="s4">1.49389314e-03</span><span class="s2">,   </span><span class="s4">7.56187782e-04</span><span class="s2">,</span>
           <span class="s4">6.19788616e-04</span><span class="s2">,   </span><span class="s4">6.19323917e-04</span><span class="s2">,   </span><span class="s4">5.99172642e-04</span><span class="s2">,</span>
           <span class="s4">8.16221729e-04</span><span class="s2">,   </span><span class="s4">1.13285230e-03</span><span class="s2">,   </span><span class="s4">1.18549926e-03</span><span class="s2">,</span>
           <span class="s4">1.18823205e-03</span><span class="s2">,   </span><span class="s4">1.17003007e-03</span><span class="s2">,   </span><span class="s4">1.18816020e-03</span><span class="s2">,</span>
           <span class="s4">5.10520503e-04</span><span class="s2">,   </span><span class="s4">1.79560242e-04</span><span class="s2">,   </span><span class="s4">1.35036369e-04</span><span class="s2">,</span>
           <span class="s4">2.10470876e-04</span><span class="s2">,   </span><span class="s4">4.39360698e-04</span><span class="s2">,   </span><span class="s4">9.96435388e-04</span><span class="s2">,</span>
           <span class="s4">3.66366176e-03</span><span class="s2">,   </span><span class="s4">1.21697619e-02</span><span class="s2">,   </span><span class="s4">2.12118606e-02</span><span class="s2">,</span>
           <span class="s4">8.85040895e-03</span><span class="s2">,   </span><span class="s4">6.31975856e-04</span><span class="s2">,   </span><span class="s4">2.36270150e-05</span><span class="s2">,</span>
           <span class="s4">8.19945322e-07</span><span class="s2">,   </span><span class="s4">7.50841896e-08</span><span class="s2">,   </span><span class="s4">4.48888835e-08</span><span class="s2">,</span>
           <span class="s4">4.54342381e-08</span><span class="s2">,   </span><span class="s4">3.02100160e-08</span><span class="s2">,   </span><span class="s4">1.58478237e-08</span><span class="s2">,</span>
           <span class="s4">1.23342395e-08</span><span class="s2">,   </span><span class="s4">9.10969133e-09</span><span class="s2">,   </span><span class="s4">6.55477183e-09</span><span class="s2">,</span>
           <span class="s4">6.38307937e-09</span><span class="s2">,   </span><span class="s4">6.46757155e-09</span><span class="s2">,   </span><span class="s4">1.13921361e-08</span><span class="s2">,</span>
           <span class="s4">3.92715328e-08</span><span class="s2">,   </span><span class="s4">1.54492028e-07</span><span class="s2">,   </span><span class="s4">5.69351898e-07</span><span class="s2">,</span>
           <span class="s4">2.10015832e-06</span><span class="s2">,   </span><span class="s4">8.28479101e-06</span><span class="s2">,   </span><span class="s4">3.11191703e-05</span><span class="s2">,</span>
           <span class="s4">1.07326014e-04</span><span class="s2">,   </span><span class="s4">3.11263455e-04</span><span class="s2">,   </span><span class="s4">5.09327027e-04</span><span class="s2">,</span>
           <span class="s4">5.47428437e-04</span><span class="s2">,   </span><span class="s4">5.52354866e-04</span><span class="s2">,   </span><span class="s4">4.31919788e-04</span><span class="s2">,</span>
           <span class="s4">1.60904664e-04</span><span class="s2">,   </span><span class="s4">1.29332277e-05</span><span class="s2">,   </span><span class="s4">5.04162769e-07</span><span class="s2">,</span>
           <span class="s4">9.33695004e-08</span><span class="s2">,   </span><span class="s4">1.15650115e-08</span><span class="s2">,   </span><span class="s4">1.13921931e-09</span><span class="s2">,</span>
           <span class="s4">7.36511886e-10</span><span class="s2">,   </span><span class="s4">7.17294041e-10</span><span class="s2">,   </span><span class="s4">6.62811758e-10</span><span class="s2">,</span>
           <span class="s4">6.37139329e-10</span><span class="s2">,   </span><span class="s4">6.98642410e-10</span><span class="s2">,   </span><span class="s4">7.56071871e-10</span><span class="s2">,</span>
           <span class="s4">7.56083358e-10</span><span class="s1">]]])</span>


<span class="s2">class </span><span class="s1">TestFedFundsConst(MarkovRegression):</span>
    <span class="s3"># Results from Stata, see http://www.stata.com/manuals14/tsmswitch.pdf</span>
    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">setup_class(cls):</span>
        <span class="s1">path = os.path.join(current_path</span><span class="s2">, </span><span class="s5">'results'</span><span class="s2">,</span>
                            <span class="s5">'results_predict_fedfunds.csv'</span><span class="s1">)</span>
        <span class="s1">results = pd.read_csv(path)</span>
        <span class="s1">true = {</span>
            <span class="s5">'params'</span><span class="s1">: np.r_[</span><span class="s4">.9820939</span><span class="s2">, </span><span class="s4">.0503587</span><span class="s2">, </span><span class="s4">3.70877</span><span class="s2">, </span><span class="s4">9.556793</span><span class="s2">,</span>
                            <span class="s4">2.107562</span><span class="s1">**</span><span class="s4">2</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s5">'llf'</span><span class="s1">: -</span><span class="s4">508.63592</span><span class="s2">,</span>
            <span class="s5">'llf_fit'</span><span class="s1">: -</span><span class="s4">508.63592</span><span class="s2">,</span>
            <span class="s5">'llf_fit_em'</span><span class="s1">: -</span><span class="s4">508.65852</span><span class="s2">,</span>
            <span class="s5">'bse_oim'</span><span class="s1">: np.r_[</span><span class="s4">.0104002</span><span class="s2">, </span><span class="s4">.0268434</span><span class="s2">, </span><span class="s4">.1767083</span><span class="s2">, </span><span class="s4">.2999889</span><span class="s2">, </span><span class="s1">np.nan]</span><span class="s2">,</span>
            <span class="s5">'smoothed0'</span><span class="s1">: results[</span><span class="s5">'const_sm1'</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s5">'smoothed1'</span><span class="s1">: results[</span><span class="s5">'const_sm2'</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s5">'predict0'</span><span class="s1">: results[</span><span class="s5">'const_yhat1'</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s5">'predict1'</span><span class="s1">: results[</span><span class="s5">'const_yhat2'</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s5">'predict_predicted'</span><span class="s1">: results[</span><span class="s5">'const_pyhat'</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s5">'predict_filtered'</span><span class="s1">: results[</span><span class="s5">'const_fyhat'</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s5">'predict_smoothed'</span><span class="s1">: results[</span><span class="s5">'const_syhat'</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">}</span>
        <span class="s1">super(TestFedFundsConst</span><span class="s2">, </span><span class="s1">cls).setup_class(true</span><span class="s2">, </span><span class="s1">fedfunds</span><span class="s2">, </span><span class="s1">k_regimes=</span><span class="s4">2</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_filter_output(self</span><span class="s2">, </span><span class="s1">**kwargs):</span>
        <span class="s1">res = self.result</span>
        <span class="s1">assert_allclose(res.filtered_joint_probabilities</span><span class="s2">,</span>
                        <span class="s1">fedfunds_const_filtered_joint_probabilities)</span>

    <span class="s2">def </span><span class="s1">test_smoothed_marginal_probabilities(self):</span>
        <span class="s1">assert_allclose(self.result.smoothed_marginal_probabilities[:</span><span class="s2">, </span><span class="s4">0</span><span class="s1">]</span><span class="s2">,</span>
                        <span class="s1">self.true[</span><span class="s5">'smoothed0'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">atol=</span><span class="s4">1e-6</span><span class="s1">)</span>
        <span class="s1">assert_allclose(self.result.smoothed_marginal_probabilities[:</span><span class="s2">, </span><span class="s4">1</span><span class="s1">]</span><span class="s2">,</span>
                        <span class="s1">self.true[</span><span class="s5">'smoothed1'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">atol=</span><span class="s4">1e-6</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_predict(self):</span>
        <span class="s3"># Predictions conditional on regime (the same no matter which</span>
        <span class="s3"># probabilities are selected)</span>
        <span class="s2">for </span><span class="s1">name </span><span class="s2">in </span><span class="s1">[</span><span class="s5">'predicted'</span><span class="s2">, </span><span class="s5">'filtered'</span><span class="s2">, </span><span class="s5">'smoothed'</span><span class="s2">, None</span><span class="s1">]:</span>
            <span class="s1">actual = self.model.predict(</span>
                <span class="s1">self.true[</span><span class="s5">'params'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">probabilities=name</span><span class="s2">, </span><span class="s1">conditional=</span><span class="s2">True</span><span class="s1">)</span>
            <span class="s1">assert_allclose(actual[</span><span class="s4">0</span><span class="s1">]</span><span class="s2">,</span>
                            <span class="s1">self.true[</span><span class="s5">'predict0'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">atol=</span><span class="s4">1e-6</span><span class="s1">)</span>
            <span class="s1">assert_allclose(actual[</span><span class="s4">1</span><span class="s1">]</span><span class="s2">,</span>
                            <span class="s1">self.true[</span><span class="s5">'predict1'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">atol=</span><span class="s4">1e-6</span><span class="s1">)</span>

        <span class="s3"># Predicted</span>
        <span class="s1">actual = self.model.predict(</span>
            <span class="s1">self.true[</span><span class="s5">'params'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">probabilities=</span><span class="s5">'predicted'</span><span class="s1">)</span>
        <span class="s1">assert_allclose(actual</span><span class="s2">, </span><span class="s1">self.true[</span><span class="s5">'predict_predicted'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">atol=</span><span class="s4">1e-5</span><span class="s1">)</span>

        <span class="s3"># Filtered</span>
        <span class="s1">actual = self.model.predict(</span>
            <span class="s1">self.true[</span><span class="s5">'params'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">probabilities=</span><span class="s5">'filtered'</span><span class="s1">)</span>
        <span class="s1">assert_allclose(self.model.predict(self.true[</span><span class="s5">'params'</span><span class="s1">]</span><span class="s2">,</span>
                                           <span class="s1">probabilities=</span><span class="s5">'filtered'</span><span class="s1">)</span><span class="s2">,</span>
                        <span class="s1">self.true[</span><span class="s5">'predict_filtered'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">atol=</span><span class="s4">1e-5</span><span class="s1">)</span>

        <span class="s3"># Smoothed</span>
        <span class="s1">actual = self.model.predict(</span>
            <span class="s1">self.true[</span><span class="s5">'params'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">probabilities=</span><span class="s5">'smoothed'</span><span class="s1">)</span>
        <span class="s1">assert_allclose(actual</span><span class="s2">, </span><span class="s1">self.true[</span><span class="s5">'predict_smoothed'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">atol=</span><span class="s4">1e-6</span><span class="s1">)</span>
        <span class="s1">actual = self.model.predict(</span>
            <span class="s1">self.true[</span><span class="s5">'params'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">probabilities=</span><span class="s2">None</span><span class="s1">)</span>
        <span class="s1">assert_allclose(actual</span><span class="s2">, </span><span class="s1">self.true[</span><span class="s5">'predict_smoothed'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">atol=</span><span class="s4">1e-6</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_bse(self):</span>
        <span class="s3"># Cannot compare last element of bse because we estimate sigma^2 rather</span>
        <span class="s3"># than sigma^2</span>
        <span class="s1">bse = self.result.cov_params_approx.diagonal()**</span><span class="s4">0.5</span>
        <span class="s1">assert_allclose(bse[:-</span><span class="s4">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">self.true[</span><span class="s5">'bse_oim'</span><span class="s1">][:-</span><span class="s4">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">atol=</span><span class="s4">1e-7</span><span class="s1">)</span>


<span class="s1">fedfunds_const_short_filtered_joint_probabilities = np.array([</span>
         <span class="s1">[[</span><span class="s4">9.81370301e-01</span><span class="s2">,   </span><span class="s4">9.99956215e-01</span><span class="s2">,   </span><span class="s4">9.99995966e-01</span><span class="s2">,</span>
           <span class="s4">9.99996082e-01</span><span class="s2">,   </span><span class="s4">9.99996179e-01</span><span class="s2">,   </span><span class="s4">9.99996370e-01</span><span class="s2">,</span>
           <span class="s4">9.99996334e-01</span><span class="s2">,   </span><span class="s4">9.99996045e-01</span><span class="s2">,   </span><span class="s4">9.99996030e-01</span><span class="s2">,</span>
           <span class="s4">9.99996030e-01</span><span class="s1">]</span><span class="s2">,</span>
          <span class="s1">[</span><span class="s4">1.78929069e-02</span><span class="s2">,   </span><span class="s4">3.78065881e-05</span><span class="s2">,   </span><span class="s4">3.06546640e-07</span><span class="s2">,</span>
           <span class="s4">1.91118379e-07</span><span class="s2">,   </span><span class="s4">1.91095611e-07</span><span class="s2">,   </span><span class="s4">1.86129447e-07</span><span class="s2">,</span>
           <span class="s4">1.76579974e-07</span><span class="s2">,   </span><span class="s4">1.78918351e-07</span><span class="s2">,   </span><span class="s4">1.93625709e-07</span><span class="s2">,</span>
           <span class="s4">1.93628651e-07</span><span class="s1">]]</span><span class="s2">,</span>

         <span class="s1">[[</span><span class="s4">3.71038873e-05</span><span class="s2">,   </span><span class="s4">5.75327472e-06</span><span class="s2">,   </span><span class="s4">3.72600443e-06</span><span class="s2">,</span>
           <span class="s4">3.72600486e-06</span><span class="s2">,   </span><span class="s4">3.62917375e-06</span><span class="s2">,   </span><span class="s4">3.44299546e-06</span><span class="s2">,</span>
           <span class="s4">3.48862495e-06</span><span class="s2">,   </span><span class="s4">3.77538503e-06</span><span class="s2">,   </span><span class="s4">3.77538498e-06</span><span class="s2">,</span>
           <span class="s4">3.77538498e-06</span><span class="s1">]</span><span class="s2">,</span>
          <span class="s1">[</span><span class="s4">6.99688113e-04</span><span class="s2">,   </span><span class="s4">2.24977302e-07</span><span class="s2">,   </span><span class="s4">1.18135050e-09</span><span class="s2">,</span>
           <span class="s4">7.36520203e-10</span><span class="s2">,   </span><span class="s4">7.17294043e-10</span><span class="s2">,   </span><span class="s4">6.62811758e-10</span><span class="s2">,</span>
           <span class="s4">6.37139329e-10</span><span class="s2">,   </span><span class="s4">6.98642410e-10</span><span class="s2">,   </span><span class="s4">7.56071871e-10</span><span class="s2">,</span>
           <span class="s4">7.56083358e-10</span><span class="s1">]]])</span>


<span class="s1">fedfunds_const_short_predicted_joint_probabilities = np.array([</span>
         <span class="s1">[[[</span><span class="s4">7.11514435e-01</span><span class="s2">,   </span><span class="s4">9.63797786e-01</span><span class="s2">,   </span><span class="s4">9.82050899e-01</span><span class="s2">,</span>
            <span class="s4">9.82089938e-01</span><span class="s2">,   </span><span class="s4">9.82090052e-01</span><span class="s2">,   </span><span class="s4">9.82090147e-01</span><span class="s2">,</span>
            <span class="s4">9.82090335e-01</span><span class="s2">,   </span><span class="s4">9.82090300e-01</span><span class="s2">,   </span><span class="s4">9.82090016e-01</span><span class="s2">,</span>
            <span class="s4">9.82090001e-01</span><span class="s1">]</span><span class="s2">,</span>
           <span class="s1">[</span><span class="s4">1.29727398e-02</span><span class="s2">,   </span><span class="s4">1.75725147e-02</span><span class="s2">,   </span><span class="s4">3.71296195e-05</span><span class="s2">,</span>
            <span class="s4">3.01057585e-07</span><span class="s2">,   </span><span class="s4">1.87696195e-07</span><span class="s2">,   </span><span class="s4">1.87673833e-07</span><span class="s2">,</span>
            <span class="s4">1.82796594e-07</span><span class="s2">,   </span><span class="s4">1.73418115e-07</span><span class="s2">,   </span><span class="s4">1.75714621e-07</span><span class="s2">,</span>
            <span class="s4">1.90158628e-07</span><span class="s1">]]</span><span class="s2">,</span>

          <span class="s1">[[</span><span class="s4">6.65201476e-04</span><span class="s2">,   </span><span class="s4">1.86850353e-06</span><span class="s2">,   </span><span class="s4">2.89727435e-07</span><span class="s2">,</span>
            <span class="s4">1.87636739e-07</span><span class="s2">,   </span><span class="s4">1.87636761e-07</span><span class="s2">,   </span><span class="s4">1.82760472e-07</span><span class="s2">,</span>
            <span class="s4">1.73384775e-07</span><span class="s2">,   </span><span class="s4">1.75682617e-07</span><span class="s2">,   </span><span class="s4">1.90123482e-07</span><span class="s2">,</span>
            <span class="s4">1.90123479e-07</span><span class="s1">]</span><span class="s2">,</span>
           <span class="s1">[</span><span class="s4">1.25440648e-02</span><span class="s2">,   </span><span class="s4">3.52353838e-05</span><span class="s2">,   </span><span class="s4">1.13295645e-08</span><span class="s2">,</span>
            <span class="s4">5.94912755e-11</span><span class="s2">,   </span><span class="s4">3.70902000e-11</span><span class="s2">,   </span><span class="s4">3.61219955e-11</span><span class="s2">,</span>
            <span class="s4">3.33783385e-11</span><span class="s2">,   </span><span class="s4">3.20855083e-11</span><span class="s2">,   </span><span class="s4">3.51827235e-11</span><span class="s2">,</span>
            <span class="s4">3.80747965e-11</span><span class="s1">]]]</span><span class="s2">,</span>


         <span class="s1">[[[</span><span class="s4">1.29727398e-02</span><span class="s2">,   </span><span class="s4">1.75725147e-02</span><span class="s2">,   </span><span class="s4">1.79053160e-02</span><span class="s2">,</span>
            <span class="s4">1.79060278e-02</span><span class="s2">,   </span><span class="s4">1.79060298e-02</span><span class="s2">,   </span><span class="s4">1.79060316e-02</span><span class="s2">,</span>
            <span class="s4">1.79060350e-02</span><span class="s2">,   </span><span class="s4">1.79060344e-02</span><span class="s2">,   </span><span class="s4">1.79060292e-02</span><span class="s2">,</span>
            <span class="s4">1.79060289e-02</span><span class="s1">]</span><span class="s2">,</span>
           <span class="s1">[</span><span class="s4">2.36526442e-04</span><span class="s2">,   </span><span class="s4">3.20392181e-04</span><span class="s2">,   </span><span class="s4">6.76968547e-07</span><span class="s2">,</span>
            <span class="s4">5.48905479e-09</span><span class="s2">,   </span><span class="s4">3.42218481e-09</span><span class="s2">,   </span><span class="s4">3.42177711e-09</span><span class="s2">,</span>
            <span class="s4">3.33285249e-09</span><span class="s2">,   </span><span class="s4">3.16185867e-09</span><span class="s2">,   </span><span class="s4">3.20372988e-09</span><span class="s2">,</span>
            <span class="s4">3.46708131e-09</span><span class="s1">]]</span><span class="s2">,</span>

          <span class="s1">[[</span><span class="s4">1.25440648e-02</span><span class="s2">,   </span><span class="s4">3.52353838e-05</span><span class="s2">,   </span><span class="s4">5.46354728e-06</span><span class="s2">,</span>
            <span class="s4">3.53836769e-06</span><span class="s2">,   </span><span class="s4">3.53836810e-06</span><span class="s2">,   </span><span class="s4">3.44641328e-06</span><span class="s2">,</span>
            <span class="s4">3.26961068e-06</span><span class="s2">,   </span><span class="s4">3.31294233e-06</span><span class="s2">,   </span><span class="s4">3.58526155e-06</span><span class="s2">,</span>
            <span class="s4">3.58526150e-06</span><span class="s1">]</span><span class="s2">,</span>
           <span class="s1">[</span><span class="s4">2.36550228e-01</span><span class="s2">,   </span><span class="s4">6.64452729e-04</span><span class="s2">,   </span><span class="s4">2.13647738e-07</span><span class="s2">,</span>
            <span class="s4">1.12185923e-09</span><span class="s2">,   </span><span class="s4">6.99430003e-10</span><span class="s2">,   </span><span class="s4">6.81172047e-10</span><span class="s2">,</span>
            <span class="s4">6.29433420e-10</span><span class="s2">,   </span><span class="s4">6.05053821e-10</span><span class="s2">,   </span><span class="s4">6.63459686e-10</span><span class="s2">,</span>
            <span class="s4">7.17997074e-10</span><span class="s1">]]]])</span>

<span class="s1">fedfunds_const_short_smoothed_joint_probabilities = np.array([</span>
         <span class="s1">[[</span><span class="s4">9.82056759e-01</span><span class="s2">,   </span><span class="s4">9.99961887e-01</span><span class="s2">,   </span><span class="s4">9.99999502e-01</span><span class="s2">,</span>
           <span class="s4">9.99999618e-01</span><span class="s2">,   </span><span class="s4">9.99999623e-01</span><span class="s2">,   </span><span class="s4">9.99999637e-01</span><span class="s2">,</span>
           <span class="s4">9.99999644e-01</span><span class="s2">,   </span><span class="s4">9.99999627e-01</span><span class="s2">,   </span><span class="s4">9.99999612e-01</span><span class="s2">,</span>
           <span class="s4">9.99996030e-01</span><span class="s1">]</span><span class="s2">,</span>
          <span class="s1">[</span><span class="s4">1.79054228e-02</span><span class="s2">,   </span><span class="s4">3.78068025e-05</span><span class="s2">,   </span><span class="s4">3.06547724e-07</span><span class="s2">,</span>
           <span class="s4">1.91119055e-07</span><span class="s2">,   </span><span class="s4">1.91096269e-07</span><span class="s2">,   </span><span class="s4">1.86130055e-07</span><span class="s2">,</span>
           <span class="s4">1.76580558e-07</span><span class="s2">,   </span><span class="s4">1.78918992e-07</span><span class="s2">,   </span><span class="s4">1.93626403e-07</span><span class="s2">,</span>
           <span class="s4">1.93628651e-07</span><span class="s1">]]</span><span class="s2">,</span>

         <span class="s1">[[</span><span class="s4">1.90448249e-06</span><span class="s2">,   </span><span class="s4">2.95069837e-07</span><span class="s2">,   </span><span class="s4">1.91096241e-07</span><span class="s2">,</span>
           <span class="s4">1.91095282e-07</span><span class="s2">,   </span><span class="s4">1.86127261e-07</span><span class="s2">,   </span><span class="s4">1.76579242e-07</span><span class="s2">,</span>
           <span class="s4">1.78922146e-07</span><span class="s2">,   </span><span class="s4">1.93629492e-07</span><span class="s2">,   </span><span class="s4">1.94345814e-07</span><span class="s2">,</span>
           <span class="s4">3.77538498e-06</span><span class="s1">]</span><span class="s2">,</span>
          <span class="s1">[</span><span class="s4">3.59138585e-05</span><span class="s2">,   </span><span class="s4">1.15384749e-08</span><span class="s2">,   </span><span class="s4">6.05881299e-11</span><span class="s2">,</span>
           <span class="s4">3.77738466e-11</span><span class="s2">,   </span><span class="s4">3.67874300e-11</span><span class="s2">,   </span><span class="s4">3.39933060e-11</span><span class="s2">,</span>
           <span class="s4">3.26771544e-11</span><span class="s2">,   </span><span class="s4">3.58315175e-11</span><span class="s2">,   </span><span class="s4">3.89203762e-11</span><span class="s2">,</span>
           <span class="s4">7.56083358e-10</span><span class="s1">]]])</span>


<span class="s2">class </span><span class="s1">TestFedFundsConstShort(MarkovRegression):</span>
    <span class="s3"># This is just a set of regression tests</span>
    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">setup_class(cls):</span>
        <span class="s1">true = {</span>
            <span class="s5">'params'</span><span class="s1">: np.r_[</span><span class="s4">.9820939</span><span class="s2">, </span><span class="s4">.0503587</span><span class="s2">, </span><span class="s4">3.70877</span><span class="s2">, </span><span class="s4">9.556793</span><span class="s2">,</span>
                            <span class="s4">2.107562</span><span class="s1">**</span><span class="s4">2</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s5">'llf'</span><span class="s1">: -</span><span class="s4">29.909297</span><span class="s2">,</span>
            <span class="s5">'llf_fit'</span><span class="s1">: -</span><span class="s4">7.8553370</span><span class="s2">,</span>
            <span class="s5">'llf_fit_em'</span><span class="s1">: -</span><span class="s4">7.8554974</span>
        <span class="s1">}</span>
        <span class="s1">super(TestFedFundsConstShort</span><span class="s2">, </span><span class="s1">cls).setup_class(true</span><span class="s2">, </span><span class="s1">fedfunds[-</span><span class="s4">10</span><span class="s1">:]</span><span class="s2">,</span>
                                                       <span class="s1">k_regimes=</span><span class="s4">2</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_filter_output(self</span><span class="s2">, </span><span class="s1">**kwargs):</span>
        <span class="s1">res = self.result</span>

        <span class="s3"># Filtered</span>
        <span class="s1">assert_allclose(res.filtered_joint_probabilities</span><span class="s2">,</span>
                        <span class="s1">fedfunds_const_short_filtered_joint_probabilities)</span>

        <span class="s3"># Predicted</span>
        <span class="s1">desired = fedfunds_const_short_predicted_joint_probabilities</span>
        <span class="s2">if </span><span class="s1">desired.ndim &gt; res.predicted_joint_probabilities.ndim:</span>
            <span class="s1">desired = desired.sum(axis=-</span><span class="s4">2</span><span class="s1">)</span>
        <span class="s1">assert_allclose(res.predicted_joint_probabilities</span><span class="s2">, </span><span class="s1">desired)</span>

    <span class="s2">def </span><span class="s1">test_smoother_output(self</span><span class="s2">, </span><span class="s1">**kwargs):</span>
        <span class="s1">res = self.result</span>

        <span class="s3"># Filtered</span>
        <span class="s1">assert_allclose(res.filtered_joint_probabilities</span><span class="s2">,</span>
                        <span class="s1">fedfunds_const_short_filtered_joint_probabilities)</span>

        <span class="s3"># Predicted</span>
        <span class="s1">desired = fedfunds_const_short_predicted_joint_probabilities</span>
        <span class="s2">if </span><span class="s1">desired.ndim &gt; res.predicted_joint_probabilities.ndim:</span>
            <span class="s1">desired = desired.sum(axis=-</span><span class="s4">2</span><span class="s1">)</span>
        <span class="s1">assert_allclose(res.predicted_joint_probabilities</span><span class="s2">, </span><span class="s1">desired)</span>

        <span class="s3"># Smoothed, last entry</span>
        <span class="s1">assert_allclose(res.smoothed_joint_probabilities</span><span class="s2">,</span>
                        <span class="s1">fedfunds_const_short_smoothed_joint_probabilities)</span>

    <span class="s2">def </span><span class="s1">test_hamilton_filter_order_zero(self):</span>
        <span class="s1">k_regimes = </span><span class="s4">3</span>
        <span class="s1">nobs = </span><span class="s4">4</span>
        <span class="s1">initial_probabilities = np.ones(k_regimes) / k_regimes</span>

        <span class="s3"># We do not actually transition between the 3 regimes.</span>
        <span class="s1">regime_transition = np.eye(k_regimes)[:</span><span class="s2">, </span><span class="s1">:</span><span class="s2">, </span><span class="s1">np.newaxis]</span>

        <span class="s3"># Regime i correponds to a sequence of iid draws from discrete</span>
        <span class="s3"># random variables that are equally likely to be -1 and i for i=0,</span>
        <span class="s3"># 1, 2.  We observe the sequence -1, -1, 1, -1.  The first two</span>
        <span class="s3"># observations tell us nothing, but the third lets us know that we</span>
        <span class="s3"># are in regime 1 the whole time.</span>
        <span class="s1">conditional_likelihoods = np.ones((k_regimes</span><span class="s2">, </span><span class="s1">nobs)) / </span><span class="s4">2</span>
        <span class="s1">conditional_likelihoods[:</span><span class="s2">, </span><span class="s4">2</span><span class="s1">] = [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">0</span><span class="s1">]</span>

        <span class="s1">expected_marginals = np.empty((k_regimes</span><span class="s2">, </span><span class="s1">nobs))</span>
        <span class="s1">expected_marginals[:</span><span class="s2">, </span><span class="s1">:</span><span class="s4">2</span><span class="s1">] = [[</span><span class="s4">1</span><span class="s1">/</span><span class="s4">3</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s4">1</span><span class="s1">/</span><span class="s4">3</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s4">1</span><span class="s1">/</span><span class="s4">3</span><span class="s1">]]</span>
        <span class="s1">expected_marginals[:</span><span class="s2">, </span><span class="s4">2</span><span class="s1">:] = [[</span><span class="s4">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s4">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s4">0</span><span class="s1">]]</span>

        <span class="s1">cy_results = markov_switching.cy_hamilton_filter_log(</span>
            <span class="s1">initial_probabilities</span><span class="s2">, </span><span class="s1">regime_transition</span><span class="s2">,</span>
            <span class="s1">np.log(conditional_likelihoods + </span><span class="s4">1e-20</span><span class="s1">)</span><span class="s2">, </span><span class="s1">model_order=</span><span class="s4">0</span><span class="s1">)</span>
        <span class="s1">assert_allclose(cy_results[</span><span class="s4">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">expected_marginals</span><span class="s2">, </span><span class="s1">atol=</span><span class="s4">1e-15</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_hamilton_filter_order_zero_with_tvtp(self):</span>
        <span class="s1">k_regimes = </span><span class="s4">3</span>
        <span class="s1">nobs = </span><span class="s4">8</span>
        <span class="s1">initial_probabilities = np.ones(k_regimes) / k_regimes</span>

        <span class="s3"># We do not actually transition between the 3 regimes except from</span>
        <span class="s3"># t=3 to t=4 where we reset to regimes 1 and 2 being equally</span>
        <span class="s3"># likely.</span>
        <span class="s1">regime_transition = np.zeros((k_regimes</span><span class="s2">, </span><span class="s1">k_regimes</span><span class="s2">, </span><span class="s1">nobs))</span>
        <span class="s1">regime_transition[...] = np.eye(k_regimes)[:</span><span class="s2">, </span><span class="s1">:</span><span class="s2">, </span><span class="s1">np.newaxis]</span>
        <span class="s1">regime_transition[...</span><span class="s2">, </span><span class="s4">4</span><span class="s1">] = [[</span><span class="s4">0</span><span class="s2">,     </span><span class="s4">0</span><span class="s2">,   </span><span class="s4">0</span><span class="s1">]</span><span class="s2">,</span>
                                     <span class="s1">[</span><span class="s4">1</span><span class="s1">/</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s1">/</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s1">/</span><span class="s4">2</span><span class="s1">]</span><span class="s2">,</span>
                                     <span class="s1">[</span><span class="s4">1</span><span class="s1">/</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s1">/</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s1">/</span><span class="s4">2</span><span class="s1">]]</span>

        <span class="s3"># Regime i correponds to a sequence of iid draws from discrete</span>
        <span class="s3"># random variables that are equally likely to be -1, i, and i + 1</span>
        <span class="s3"># for i = 0, 1, 2.  We observe the sequence:</span>
        <span class="s3">#</span>
        <span class="s3">#     t =  0, 1, 2,  3,  4, 5, 6,  7</span>
        <span class="s3">#   X_t = -1, 1, 2, -1, -1, 2, 3, -1</span>
        <span class="s3">#</span>
        <span class="s3"># The first observations tell us nothing, the second tells us that</span>
        <span class="s3"># regime 0 and 1 are equally likely, and the third tells us that we</span>
        <span class="s3"># must be in regime 1 for t = 0, 1, 2, 3.  At t=4 we transition to</span>
        <span class="s3"># state 1 or 2.  In this case, neither a -1 or 2 changes our view</span>
        <span class="s3"># that these states are equally likely, but a 3 tells we must be in</span>
        <span class="s3"># state 2 for the second four timestamps.</span>
        <span class="s1">conditional_likelihoods = np.empty((k_regimes</span><span class="s2">, </span><span class="s1">nobs))</span>
        <span class="s1">conditional_likelihoods[:</span><span class="s2">, </span><span class="s4">0</span><span class="s1">] = [</span><span class="s4">1</span><span class="s1">/</span><span class="s4">3</span><span class="s2">, </span><span class="s4">1</span><span class="s1">/</span><span class="s4">3</span><span class="s2">, </span><span class="s4">1</span><span class="s1">/</span><span class="s4">3</span><span class="s1">]</span>
        <span class="s1">conditional_likelihoods[:</span><span class="s2">, </span><span class="s4">1</span><span class="s1">] = [</span><span class="s4">1</span><span class="s1">/</span><span class="s4">3</span><span class="s2">, </span><span class="s4">1</span><span class="s1">/</span><span class="s4">3</span><span class="s2">, </span><span class="s4">0</span><span class="s1">]</span>
        <span class="s1">conditional_likelihoods[:</span><span class="s2">, </span><span class="s4">2</span><span class="s1">] = [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s1">/</span><span class="s4">3</span><span class="s2">, </span><span class="s4">1</span><span class="s1">/</span><span class="s4">3</span><span class="s1">]</span>
        <span class="s1">conditional_likelihoods[:</span><span class="s2">, </span><span class="s4">3</span><span class="s1">:</span><span class="s4">5</span><span class="s1">] = [[</span><span class="s4">1</span><span class="s1">/</span><span class="s4">3</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s4">1</span><span class="s1">/</span><span class="s4">3</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s4">1</span><span class="s1">/</span><span class="s4">3</span><span class="s1">]]</span>
        <span class="s1">conditional_likelihoods[:</span><span class="s2">, </span><span class="s4">5</span><span class="s1">] = [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s1">/</span><span class="s4">3</span><span class="s2">, </span><span class="s4">1</span><span class="s1">/</span><span class="s4">3</span><span class="s1">]</span>
        <span class="s1">conditional_likelihoods[:</span><span class="s2">, </span><span class="s4">6</span><span class="s1">] = [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s1">/</span><span class="s4">3</span><span class="s1">]</span>
        <span class="s1">conditional_likelihoods[:</span><span class="s2">, </span><span class="s4">7</span><span class="s1">] = [</span><span class="s4">1</span><span class="s1">/</span><span class="s4">3</span><span class="s2">, </span><span class="s4">1</span><span class="s1">/</span><span class="s4">3</span><span class="s2">, </span><span class="s4">1</span><span class="s1">/</span><span class="s4">3</span><span class="s1">]</span>

        <span class="s1">expected_marginals = np.empty((k_regimes</span><span class="s2">, </span><span class="s1">nobs))</span>
        <span class="s1">expected_marginals[:</span><span class="s2">, </span><span class="s4">0</span><span class="s1">] = [</span><span class="s4">1</span><span class="s1">/</span><span class="s4">3</span><span class="s2">, </span><span class="s4">1</span><span class="s1">/</span><span class="s4">3</span><span class="s2">, </span><span class="s4">1</span><span class="s1">/</span><span class="s4">3</span><span class="s1">]</span>
        <span class="s1">expected_marginals[:</span><span class="s2">, </span><span class="s4">1</span><span class="s1">] = [</span><span class="s4">1</span><span class="s1">/</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s1">/</span><span class="s4">2</span><span class="s2">, </span><span class="s4">0</span><span class="s1">]</span>
        <span class="s1">expected_marginals[:</span><span class="s2">, </span><span class="s4">2</span><span class="s1">:</span><span class="s4">4</span><span class="s1">] = [[</span><span class="s4">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s4">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s4">0</span><span class="s1">]]</span>
        <span class="s1">expected_marginals[:</span><span class="s2">, </span><span class="s4">4</span><span class="s1">:</span><span class="s4">6</span><span class="s1">] = [[</span><span class="s4">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s4">1</span><span class="s1">/</span><span class="s4">2</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s4">1</span><span class="s1">/</span><span class="s4">2</span><span class="s1">]]</span>
        <span class="s1">expected_marginals[:</span><span class="s2">, </span><span class="s4">6</span><span class="s1">:</span><span class="s4">8</span><span class="s1">] = [[</span><span class="s4">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s4">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s4">1</span><span class="s1">]]</span>

        <span class="s1">cy_results = markov_switching.cy_hamilton_filter_log(</span>
            <span class="s1">initial_probabilities</span><span class="s2">, </span><span class="s1">regime_transition</span><span class="s2">,</span>
            <span class="s1">np.log(conditional_likelihoods + </span><span class="s4">1e-20</span><span class="s1">)</span><span class="s2">, </span><span class="s1">model_order=</span><span class="s4">0</span><span class="s1">)</span>
        <span class="s1">assert_allclose(cy_results[</span><span class="s4">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">expected_marginals</span><span class="s2">, </span><span class="s1">atol=</span><span class="s4">1e-15</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_hamilton_filter_shape_checks(self):</span>
        <span class="s1">k_regimes = </span><span class="s4">3</span>
        <span class="s1">nobs = </span><span class="s4">8</span>
        <span class="s1">order = </span><span class="s4">3</span>

        <span class="s1">initial_probabilities = np.ones(k_regimes) / k_regimes</span>
        <span class="s1">regime_transition = np.ones((k_regimes</span><span class="s2">, </span><span class="s1">k_regimes</span><span class="s2">, </span><span class="s1">nobs)) / k_regimes</span>
        <span class="s1">conditional_loglikelihoods = np.ones(order * (k_regimes</span><span class="s2">,</span><span class="s1">) + (nobs</span><span class="s2">,</span><span class="s1">))</span>

        <span class="s2">with </span><span class="s1">assert_raises(ValueError):</span>
            <span class="s1">markov_switching.cy_hamilton_filter_log(</span>
                <span class="s1">initial_probabilities</span><span class="s2">, </span><span class="s1">regime_transition</span><span class="s2">,</span>
                <span class="s1">conditional_loglikelihoods</span><span class="s2">, </span><span class="s1">model_order=order)</span>


<span class="s2">class </span><span class="s1">TestFedFundsConstL1(MarkovRegression):</span>
    <span class="s3"># Results from Stata, see http://www.stata.com/manuals14/tsmswitch.pdf</span>
    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">setup_class(cls):</span>
        <span class="s1">true = {</span>
            <span class="s5">'params'</span><span class="s1">: np.r_[</span><span class="s4">.6378175</span><span class="s2">, </span><span class="s4">.1306295</span><span class="s2">, </span><span class="s4">.724457</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.0988764</span><span class="s2">,</span>
                            <span class="s4">.7631424</span><span class="s2">, </span><span class="s4">1.061174</span><span class="s2">, </span><span class="s4">.6915759</span><span class="s1">**</span><span class="s4">2</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s5">'llf'</span><span class="s1">: -</span><span class="s4">264.71069</span><span class="s2">,</span>
            <span class="s5">'llf_fit'</span><span class="s1">: -</span><span class="s4">264.71069</span><span class="s2">,</span>
            <span class="s5">'llf_fit_em'</span><span class="s1">: -</span><span class="s4">264.71153</span><span class="s2">,</span>
            <span class="s5">'bse_oim'</span><span class="s1">: np.r_[</span><span class="s4">.1202616</span><span class="s2">, </span><span class="s4">.0495924</span><span class="s2">, </span><span class="s4">.2886657</span><span class="s2">, </span><span class="s4">.1183838</span><span class="s2">, </span><span class="s4">.0337234</span><span class="s2">,</span>
                             <span class="s4">.0185031</span><span class="s2">, </span><span class="s1">np.nan]</span>
        <span class="s1">}</span>
        <span class="s1">super(TestFedFundsConstL1</span><span class="s2">, </span><span class="s1">cls).setup_class(</span>
            <span class="s1">true</span><span class="s2">, </span><span class="s1">fedfunds[</span><span class="s4">1</span><span class="s1">:]</span><span class="s2">, </span><span class="s1">k_regimes=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">exog=fedfunds[:-</span><span class="s4">1</span><span class="s1">])</span>

    <span class="s2">def </span><span class="s1">test_bse(self):</span>
        <span class="s3"># Cannot compare last element of bse because we estimate sigma^2 rather</span>
        <span class="s3"># than sigma^2</span>
        <span class="s1">bse = self.result.cov_params_approx.diagonal()**</span><span class="s4">0.5</span>
        <span class="s1">assert_allclose(bse[:-</span><span class="s4">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">self.true[</span><span class="s5">'bse_oim'</span><span class="s1">][:-</span><span class="s4">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">atol=</span><span class="s4">1e-6</span><span class="s1">)</span>


<span class="s2">class </span><span class="s1">TestFedFundsConstL1Exog(MarkovRegression):</span>
    <span class="s3"># Results from Stata, see http://www.stata.com/manuals14/tsmswitch.pdf</span>
    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">setup_class(cls):</span>
        <span class="s1">path = os.path.join(current_path</span><span class="s2">, </span><span class="s5">'results'</span><span class="s2">,</span>
                            <span class="s5">'results_predict_fedfunds.csv'</span><span class="s1">)</span>
        <span class="s1">results = pd.read_csv(path)</span>

        <span class="s1">true = {</span>
            <span class="s5">'params'</span><span class="s1">: np.r_[</span><span class="s4">.7279288</span><span class="s2">, </span><span class="s4">.2114578</span><span class="s2">, </span><span class="s4">.6554954</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.0944924</span><span class="s2">,</span>
                            <span class="s4">.8314458</span><span class="s2">, </span><span class="s4">.9292574</span><span class="s2">, </span><span class="s4">.1355425</span><span class="s2">, </span><span class="s4">.0343072</span><span class="s2">,</span>
                            <span class="s1">-</span><span class="s4">.0273928</span><span class="s2">, </span><span class="s4">.2125275</span><span class="s2">, </span><span class="s4">.5764495</span><span class="s1">**</span><span class="s4">2</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s5">'llf'</span><span class="s1">: -</span><span class="s4">229.25614</span><span class="s2">,</span>
            <span class="s5">'llf_fit'</span><span class="s1">: -</span><span class="s4">229.25614</span><span class="s2">,</span>
            <span class="s5">'llf_fit_em'</span><span class="s1">: -</span><span class="s4">229.25624</span><span class="s2">,</span>
            <span class="s5">'bse_oim'</span><span class="s1">: np.r_[</span><span class="s4">.0929915</span><span class="s2">, </span><span class="s4">.0641179</span><span class="s2">, </span><span class="s4">.1373889</span><span class="s2">, </span><span class="s4">.1279231</span><span class="s2">, </span><span class="s4">.0333236</span><span class="s2">,</span>
                             <span class="s4">.0270852</span><span class="s2">, </span><span class="s4">.0294113</span><span class="s2">, </span><span class="s4">.0240138</span><span class="s2">, </span><span class="s4">.0408057</span><span class="s2">, </span><span class="s4">.0297351</span><span class="s2">,</span>
                             <span class="s1">np.nan]</span><span class="s2">,</span>
            <span class="s5">'predict0'</span><span class="s1">: results.iloc[</span><span class="s4">4</span><span class="s1">:][</span><span class="s5">'constL1exog_syhat1'</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s5">'predict1'</span><span class="s1">: results.iloc[</span><span class="s4">4</span><span class="s1">:][</span><span class="s5">'constL1exog_syhat2'</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s5">'predict_smoothed'</span><span class="s1">: results.iloc[</span><span class="s4">4</span><span class="s1">:][</span><span class="s5">'constL1exog_syhat'</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">}</span>
        <span class="s1">super(TestFedFundsConstL1Exog</span><span class="s2">, </span><span class="s1">cls).setup_class(</span>
            <span class="s1">true</span><span class="s2">, </span><span class="s1">fedfunds[</span><span class="s4">4</span><span class="s1">:]</span><span class="s2">, </span><span class="s1">k_regimes=</span><span class="s4">2</span><span class="s2">,</span>
            <span class="s1">exog=np.c_[fedfunds[</span><span class="s4">3</span><span class="s1">:-</span><span class="s4">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">ogap[</span><span class="s4">4</span><span class="s1">:]</span><span class="s2">, </span><span class="s1">inf[</span><span class="s4">4</span><span class="s1">:]])</span>

    <span class="s2">def </span><span class="s1">test_fit(self</span><span class="s2">, </span><span class="s1">**kwargs):</span>
        <span class="s1">kwargs.setdefault(</span><span class="s5">'em_iter'</span><span class="s2">, </span><span class="s4">10</span><span class="s1">)</span>
        <span class="s1">kwargs.setdefault(</span><span class="s5">'maxiter'</span><span class="s2">, </span><span class="s4">100</span><span class="s1">)</span>
        <span class="s1">super(TestFedFundsConstL1Exog</span><span class="s2">, </span><span class="s1">self).test_fit(**kwargs)</span>

    <span class="s2">def </span><span class="s1">test_predict(self):</span>
        <span class="s3"># Predictions conditional on regime (the same no matter which</span>
        <span class="s3"># probabilities are selected)</span>
        <span class="s2">for </span><span class="s1">name </span><span class="s2">in </span><span class="s1">[</span><span class="s5">'predicted'</span><span class="s2">, </span><span class="s5">'filtered'</span><span class="s2">, </span><span class="s5">'smoothed'</span><span class="s2">, None</span><span class="s1">]:</span>
            <span class="s1">actual = self.model.predict(</span>
                <span class="s1">self.true[</span><span class="s5">'params'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">probabilities=name</span><span class="s2">, </span><span class="s1">conditional=</span><span class="s2">True</span><span class="s1">)</span>
            <span class="s1">assert_allclose(actual[</span><span class="s4">0</span><span class="s1">]</span><span class="s2">,</span>
                            <span class="s1">self.true[</span><span class="s5">'predict0'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">atol=</span><span class="s4">1e-5</span><span class="s1">)</span>
            <span class="s1">assert_allclose(actual[</span><span class="s4">1</span><span class="s1">]</span><span class="s2">,</span>
                            <span class="s1">self.true[</span><span class="s5">'predict1'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">atol=</span><span class="s4">1e-5</span><span class="s1">)</span>

        <span class="s3"># Smoothed</span>
        <span class="s1">actual = self.model.predict(</span>
            <span class="s1">self.true[</span><span class="s5">'params'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">probabilities=</span><span class="s5">'smoothed'</span><span class="s1">)</span>
        <span class="s1">assert_allclose(actual</span><span class="s2">, </span><span class="s1">self.true[</span><span class="s5">'predict_smoothed'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">atol=</span><span class="s4">1e-5</span><span class="s1">)</span>
        <span class="s1">actual = self.model.predict(</span>
            <span class="s1">self.true[</span><span class="s5">'params'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">probabilities=</span><span class="s2">None</span><span class="s1">)</span>
        <span class="s1">assert_allclose(actual</span><span class="s2">, </span><span class="s1">self.true[</span><span class="s5">'predict_smoothed'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">atol=</span><span class="s4">1e-5</span><span class="s1">)</span>

        <span class="s1">actual = self.result.predict(probabilities=</span><span class="s5">'smoothed'</span><span class="s1">)</span>
        <span class="s1">assert_allclose(actual</span><span class="s2">, </span><span class="s1">self.true[</span><span class="s5">'predict_smoothed'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">atol=</span><span class="s4">1e-5</span><span class="s1">)</span>
        <span class="s1">actual = self.result.predict(probabilities=</span><span class="s2">None</span><span class="s1">)</span>
        <span class="s1">assert_allclose(actual</span><span class="s2">, </span><span class="s1">self.true[</span><span class="s5">'predict_smoothed'</span><span class="s1">]</span><span class="s2">, </span><span class="s1">atol=</span><span class="s4">1e-5</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_bse(self):</span>
        <span class="s3"># Cannot compare last element of bse because we estimate sigma^2 rather</span>
        <span class="s3"># than sigma^2</span>
        <span class="s1">bse = self.result.cov_params_approx.diagonal()**</span><span class="s4">0.5</span>
        <span class="s1">assert_allclose(bse[:-</span><span class="s4">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">self.true[</span><span class="s5">'bse_oim'</span><span class="s1">][:-</span><span class="s4">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">atol=</span><span class="s4">1e-7</span><span class="s1">)</span>


<span class="s2">class </span><span class="s1">TestFedFundsConstL1Exog3(MarkovRegression):</span>
    <span class="s3"># Results from Stata, see http://www.stata.com/manuals14/tsmswitch.pdf</span>
    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">setup_class(cls):</span>
        <span class="s1">true = {</span>
            <span class="s5">'params'</span><span class="s1">: np.r_[</span><span class="s4">.7253684</span><span class="s2">, </span><span class="s4">.1641252</span><span class="s2">, </span><span class="s4">.6178282</span><span class="s2">,</span>
                            <span class="s4">.2564055</span><span class="s2">, </span><span class="s4">.7994204</span><span class="s2">, </span><span class="s4">.3821718</span><span class="s2">,</span>
                            <span class="s4">.5261292</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.0034106</span><span class="s2">, </span><span class="s4">.6015991</span><span class="s2">,</span>
                            <span class="s4">.8464551</span><span class="s2">, </span><span class="s4">.9690088</span><span class="s2">, </span><span class="s4">.4178913</span><span class="s2">,</span>
                            <span class="s4">.1201952</span><span class="s2">, </span><span class="s4">.0464136</span><span class="s2">, </span><span class="s4">.1075357</span><span class="s2">,</span>
                            <span class="s1">-</span><span class="s4">.0425603</span><span class="s2">, </span><span class="s4">.1298906</span><span class="s2">, </span><span class="s4">.9099168</span><span class="s2">,</span>
                            <span class="s4">.438375</span><span class="s1">**</span><span class="s4">2</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s5">'llf'</span><span class="s1">: -</span><span class="s4">189.89493</span><span class="s2">,</span>
            <span class="s5">'llf_fit'</span><span class="s1">: -</span><span class="s4">182.27188</span><span class="s2">,</span>
            <span class="s5">'llf_fit_em'</span><span class="s1">: -</span><span class="s4">226.88581</span>
        <span class="s1">}</span>
        <span class="s1">super(TestFedFundsConstL1Exog3</span><span class="s2">, </span><span class="s1">cls).setup_class(</span>
            <span class="s1">true</span><span class="s2">, </span><span class="s1">fedfunds[</span><span class="s4">4</span><span class="s1">:]</span><span class="s2">, </span><span class="s1">k_regimes=</span><span class="s4">3</span><span class="s2">,</span>
            <span class="s1">exog=np.c_[fedfunds[</span><span class="s4">3</span><span class="s1">:-</span><span class="s4">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">ogap[</span><span class="s4">4</span><span class="s1">:]</span><span class="s2">, </span><span class="s1">inf[</span><span class="s4">4</span><span class="s1">:]])</span>

    <span class="s2">def </span><span class="s1">test_fit(self</span><span class="s2">, </span><span class="s1">**kwargs):</span>
        <span class="s1">kwargs[</span><span class="s5">'search_reps'</span><span class="s1">] = </span><span class="s4">20</span>
        <span class="s1">np.random.seed(</span><span class="s4">1234</span><span class="s1">)</span>
        <span class="s1">super(TestFedFundsConstL1Exog3</span><span class="s2">, </span><span class="s1">self).test_fit(**kwargs)</span>


<span class="s2">class </span><span class="s1">TestAreturnsConstL1Variance(MarkovRegression):</span>
    <span class="s3"># Results from Stata, see http://www.stata.com/manuals14/tsmswitch.pdf</span>
    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">setup_class(cls):</span>
        <span class="s1">true = {</span>
            <span class="s5">'params'</span><span class="s1">: np.r_[</span><span class="s4">.7530865</span><span class="s2">, </span><span class="s4">.6825357</span><span class="s2">, </span><span class="s4">.7641424</span><span class="s2">, </span><span class="s4">1.972771</span><span class="s2">, </span><span class="s4">.0790744</span><span class="s2">,</span>
                            <span class="s4">.527953</span><span class="s2">, </span><span class="s4">.5895792</span><span class="s1">**</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1.605333</span><span class="s1">**</span><span class="s4">2</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s5">'llf'</span><span class="s1">: -</span><span class="s4">745.7977</span><span class="s2">,</span>
            <span class="s5">'llf_fit'</span><span class="s1">: -</span><span class="s4">745.7977</span><span class="s2">,</span>
            <span class="s5">'llf_fit_em'</span><span class="s1">: -</span><span class="s4">745.83654</span><span class="s2">,</span>
            <span class="s5">'bse_oim'</span><span class="s1">: np.r_[</span><span class="s4">.0634387</span><span class="s2">, </span><span class="s4">.0662574</span><span class="s2">, </span><span class="s4">.0782852</span><span class="s2">, </span><span class="s4">.2784204</span><span class="s2">, </span><span class="s4">.0301862</span><span class="s2">,</span>
                             <span class="s4">.0857841</span><span class="s2">, </span><span class="s1">np.nan</span><span class="s2">, </span><span class="s1">np.nan]</span>
        <span class="s1">}</span>
        <span class="s1">super(TestAreturnsConstL1Variance</span><span class="s2">, </span><span class="s1">cls).setup_class(</span>
            <span class="s1">true</span><span class="s2">, </span><span class="s1">areturns[</span><span class="s4">1</span><span class="s1">:]</span><span class="s2">, </span><span class="s1">k_regimes=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">exog=areturns[:-</span><span class="s4">1</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">switching_variance=</span><span class="s2">True</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_fit(self</span><span class="s2">, </span><span class="s1">**kwargs):</span>
        <span class="s1">kwargs.setdefault(</span><span class="s5">'em_iter'</span><span class="s2">, </span><span class="s4">10</span><span class="s1">)</span>
        <span class="s1">kwargs.setdefault(</span><span class="s5">'maxiter'</span><span class="s2">, </span><span class="s4">100</span><span class="s1">)</span>
        <span class="s1">super(TestAreturnsConstL1Variance</span><span class="s2">, </span><span class="s1">self).test_fit(**kwargs)</span>

    <span class="s2">def </span><span class="s1">test_bse(self):</span>
        <span class="s3"># Cannot compare last two element of bse because we estimate sigma^2</span>
        <span class="s3"># rather than sigma</span>
        <span class="s1">bse = self.result.cov_params_approx.diagonal()**</span><span class="s4">0.5</span>
        <span class="s1">assert_allclose(bse[:-</span><span class="s4">2</span><span class="s1">]</span><span class="s2">, </span><span class="s1">self.true[</span><span class="s5">'bse_oim'</span><span class="s1">][:-</span><span class="s4">2</span><span class="s1">]</span><span class="s2">, </span><span class="s1">atol=</span><span class="s4">1e-7</span><span class="s1">)</span>


<span class="s2">class </span><span class="s1">TestMumpspcNoconstL1Variance(MarkovRegression):</span>
    <span class="s3"># Results from Stata, see http://www.stata.com/manuals14/tsmswitch.pdf</span>
    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">setup_class(cls):</span>
        <span class="s1">true = {</span>
            <span class="s5">'params'</span><span class="s1">: np.r_[</span><span class="s4">.762733</span><span class="s2">, </span><span class="s4">.1473767</span><span class="s2">, </span><span class="s4">.420275</span><span class="s2">, </span><span class="s4">.9847369</span><span class="s2">, </span><span class="s4">.0562405</span><span class="s1">**</span><span class="s4">2</span><span class="s2">,</span>
                            <span class="s4">.2611362</span><span class="s1">**</span><span class="s4">2</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s5">'llf'</span><span class="s1">: </span><span class="s4">131.7225</span><span class="s2">,</span>
            <span class="s5">'llf_fit'</span><span class="s1">: </span><span class="s4">131.7225</span><span class="s2">,</span>
            <span class="s5">'llf_fit_em'</span><span class="s1">: </span><span class="s4">131.7175</span>
        <span class="s1">}</span>
        <span class="s1">super(TestMumpspcNoconstL1Variance</span><span class="s2">, </span><span class="s1">cls).setup_class(</span>
            <span class="s1">true</span><span class="s2">, </span><span class="s1">mumpspc[</span><span class="s4">1</span><span class="s1">:]</span><span class="s2">, </span><span class="s1">k_regimes=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">trend=</span><span class="s5">'n'</span><span class="s2">, </span><span class="s1">exog=mumpspc[:-</span><span class="s4">1</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">switching_variance=</span><span class="s2">True, </span><span class="s1">atol=</span><span class="s4">1e-4</span><span class="s1">)</span>


<span class="s1">gh5380_series = [</span>
    <span class="s1">-</span><span class="s4">2.28833689e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">4.83175915e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">4.93236435e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.92251109e-04</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">4.03295179e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.01009784e-04</span><span class="s2">, </span><span class="s4">2.85109215e-04</span><span class="s2">, </span><span class="s4">1.85710827e-04</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">2.04503930e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">9.06050944e-05</span><span class="s2">, </span><span class="s4">1.06177818e-03</span><span class="s2">, </span><span class="s1">-</span><span class="s4">4.97251569e-04</span><span class="s2">,</span>
    <span class="s4">7.16669183e-04</span><span class="s2">, </span><span class="s4">1.81161945e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">6.87139289e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">4.85979721e-05</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">1.68387973e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">4.43257154e-04</span><span class="s2">, </span><span class="s4">5.37457383e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">8.17822909e-04</span><span class="s2">,</span>
    <span class="s4">6.06814040e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.05481968e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.15698730e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">8.57638924e-04</span><span class="s2">,</span>
    <span class="s4">8.98143953e-05</span><span class="s2">, </span><span class="s4">1.70216877e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.84874742e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.81999910e-05</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">3.43787510e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">5.74808548e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">6.47844682e-05</span><span class="s2">, </span><span class="s4">1.08667397e-04</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">1.28790034e-04</span><span class="s2">, </span><span class="s4">7.07615608e-05</span><span class="s2">, </span><span class="s4">1.17633886e-04</span><span class="s2">, </span><span class="s4">8.98163443e-07</span><span class="s2">,</span>
    <span class="s4">1.03860559e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.50298430e-06</span><span class="s2">, </span><span class="s1">-</span><span class="s4">9.09673045e-07</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.94645227e-05</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">5.21373877e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.38431813e-04</span><span class="s2">, </span><span class="s4">1.11092157e-04</span><span class="s2">, </span><span class="s4">3.09541647e-05</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">1.57756488e-04</span><span class="s2">, </span><span class="s4">4.93176285e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">4.87488913e-05</span><span class="s2">, </span><span class="s4">2.08097182e-04</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">7.08581132e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">8.12182224e-06</span><span class="s2">, </span><span class="s4">8.03090891e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.02981093e-05</span><span class="s2">,</span>
    <span class="s4">2.07550066e-05</span><span class="s2">, </span><span class="s4">3.75383116e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">3.96307514e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.12007982e-05</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">4.00958429e-05</span><span class="s2">, </span><span class="s4">2.01206738e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.95802891e-05</span><span class="s2">, </span><span class="s4">1.26422639e-04</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">3.95617289e-05</span><span class="s2">, </span><span class="s4">1.94523738e-04</span><span class="s2">, </span><span class="s4">4.63964270e-05</span><span class="s2">, </span><span class="s4">2.07712951e-05</span><span class="s2">,</span>
    <span class="s4">2.92417981e-04</span><span class="s2">, </span><span class="s4">2.15111259e-04</span><span class="s2">, </span><span class="s4">1.23762736e-04</span><span class="s2">, </span><span class="s4">7.78305555e-05</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">3.44022033e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.84249114e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.08351559e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.76944408e-04</span><span class="s2">,</span>
    <span class="s4">7.99332875e-05</span><span class="s2">, </span><span class="s4">5.09785758e-04</span><span class="s2">, </span><span class="s4">3.24506365e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.47943721e-04</span><span class="s2">,</span>
    <span class="s4">2.22346033e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">6.66164024e-05</span><span class="s2">, </span><span class="s4">2.00911206e-04</span><span class="s2">, </span><span class="s4">4.58750048e-04</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">1.55390954e-04</span><span class="s2">, </span><span class="s4">3.67913831e-04</span><span class="s2">, </span><span class="s4">1.08274314e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.27400351e-04</span><span class="s2">,</span>
    <span class="s4">1.50654063e-04</span><span class="s2">, </span><span class="s4">2.69976025e-04</span><span class="s2">, </span><span class="s4">4.51532804e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.21579419e-04</span><span class="s2">,</span>
    <span class="s4">1.54792373e-04</span><span class="s2">, </span><span class="s4">1.98397630e-04</span><span class="s2">, </span><span class="s4">3.96943388e-04</span><span class="s2">, </span><span class="s4">6.18663277e-04</span><span class="s2">,</span>
    <span class="s4">8.86151537e-04</span><span class="s2">, </span><span class="s4">6.16949774e-04</span><span class="s2">, </span><span class="s4">5.44538857e-03</span><span class="s2">, </span><span class="s4">7.33282114e-05</span><span class="s2">,</span>
    <span class="s4">3.93393013e-03</span><span class="s2">, </span><span class="s4">6.66556165e-04</span><span class="s2">, </span><span class="s4">6.18815111e-03</span><span class="s2">, </span><span class="s1">-</span><span class="s4">6.40775088e-03</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">1.98864768e-03</span><span class="s2">, </span><span class="s1">-</span><span class="s4">3.42828364e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">7.92023127e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.64656177e-03</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">3.31112273e-03</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.63499766e-03</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.55118821e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">3.63858500e-04</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">6.58065806e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">3.38492405e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.10458161e-03</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.08228620e-07</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">7.21562092e-05</span><span class="s2">, </span><span class="s4">7.92946105e-05</span><span class="s2">, </span><span class="s4">1.25472212e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.27190212e-04</span><span class="s2">,</span>
    <span class="s4">3.94913196e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.87353437e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">6.57929565e-06</span><span class="s2">, </span><span class="s4">1.61597869e-05</span><span class="s2">,</span>
    <span class="s4">1.90031845e-05</span><span class="s2">, </span><span class="s4">8.76129739e-03</span><span class="s2">, </span><span class="s1">-</span><span class="s4">8.34566734e-03</span><span class="s2">, </span><span class="s1">-</span><span class="s4">5.82053353e-05</span><span class="s2">,</span>
    <span class="s4">1.28770725e-04</span><span class="s2">, </span><span class="s4">2.38160836e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.84590083e-05</span><span class="s2">, </span><span class="s4">3.10903734e-05</span><span class="s2">,</span>
    <span class="s4">1.89366264e-05</span><span class="s2">, </span><span class="s4">7.61985181e-05</span><span class="s2">, </span><span class="s4">3.20208326e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">6.90388272e-05</span><span class="s2">,</span>
    <span class="s4">2.09928647e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">3.14720707e-05</span><span class="s2">, </span><span class="s4">1.32614437e-04</span><span class="s2">, </span><span class="s4">1.10385710e-04</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">4.91256074e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.16967974e-04</span><span class="s2">, </span><span class="s4">4.88977021e-05</span><span class="s2">, </span><span class="s4">6.19231048e-05</span><span class="s2">,</span>
    <span class="s4">2.95994863e-04</span><span class="s2">, </span><span class="s4">1.91592526e-03</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.22511393e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">8.04871984e-04</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">6.66886069e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">3.80754506e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">4.06613941e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">4.66164600e-04</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">1.48077847e-04</span><span class="s2">, </span><span class="s4">1.31787219e-04</span><span class="s2">, </span><span class="s4">5.12392307e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.61346302e-05</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">1.46071993e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">3.17839957e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.52143621e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.73768102e-04</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">6.88107229e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.14130430e-05</span><span class="s2">, </span><span class="s4">5.25348170e-07</span><span class="s2">, </span><span class="s1">-</span><span class="s4">9.80972737e-05</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">6.90120785e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.28208365e-04</span><span class="s2">, </span><span class="s4">2.09816018e-05</span><span class="s2">, </span><span class="s4">1.02199123e-05</span><span class="s2">,</span>
    <span class="s4">2.08633684e-05</span><span class="s2">, </span><span class="s4">1.05609818e-05</span><span class="s2">, </span><span class="s4">1.35835269e-05</span><span class="s2">, </span><span class="s4">1.50357742e-04</span><span class="s2">,</span>
    <span class="s4">5.72303827e-05</span><span class="s2">, </span><span class="s4">1.27501839e-04</span><span class="s2">, </span><span class="s4">1.20706157e-04</span><span class="s2">, </span><span class="s4">8.27340411e-06</span><span class="s2">,</span>
    <span class="s4">3.77430540e-05</span><span class="s2">, </span><span class="s4">8.10426523e-05</span><span class="s2">, </span><span class="s4">9.99617511e-05</span><span class="s2">, </span><span class="s4">1.21103273e-04</span><span class="s2">,</span>
    <span class="s4">1.10255996e-04</span><span class="s2">, </span><span class="s4">6.89558159e-05</span><span class="s2">, </span><span class="s4">3.22442426e-05</span><span class="s2">, </span><span class="s4">8.49416109e-05</span><span class="s2">,</span>
    <span class="s4">4.05396296e-04</span><span class="s2">, </span><span class="s4">1.69699170e-04</span><span class="s2">, </span><span class="s4">1.10892701e-04</span><span class="s2">, </span><span class="s4">7.21186150e-05</span><span class="s2">,</span>
    <span class="s4">1.24978570e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.91922347e-04</span><span class="s2">, </span><span class="s4">5.50447651e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.68467417e-04</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">7.06084859e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">3.73250482e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.49829854e-04</span><span class="s2">, </span><span class="s1">-</span><span class="s4">7.23752254e-05</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">9.80670951e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">3.00179050e-05</span><span class="s2">, </span><span class="s4">4.15704679e-05</span><span class="s2">, </span><span class="s4">2.87503307e-05</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">5.09988933e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">9.55791344e-06</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.74369249e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.23330122e-05</span><span class="s2">,</span>
    <span class="s4">9.74727035e-06</span><span class="s2">, </span><span class="s1">-</span><span class="s4">8.58146574e-06</span><span class="s2">, </span><span class="s4">2.97704340e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.12990428e-05</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">5.90507361e-05</span><span class="s2">, </span><span class="s4">9.50772649e-07</span><span class="s2">, </span><span class="s1">-</span><span class="s4">7.35502474e-07</span><span class="s2">, </span><span class="s4">5.66683332e-07</span><span class="s2">,</span>
    <span class="s1">-</span><span class="s4">9.81320792e-06</span><span class="s2">, </span><span class="s1">-</span><span class="s4">6.60845729e-07</span><span class="s2">, </span><span class="s1">-</span><span class="s4">3.19848073e-05</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.10779191e-04</span><span class="s1">]</span>


<span class="s1">@pytest.mark.smoke</span>
<span class="s2">def </span><span class="s1">test_avoid_underflow():</span>
    <span class="s3"># See GH5380 for example and dataset demonstrating underflow. This test is</span>
    <span class="s3"># the &quot;Example 1&quot; given there.</span>

    <span class="s3"># The underlying problem was an underflow error in computing the smoothed</span>
    <span class="s3"># states, which resulted in NaN values in e.g. smoothed_joint_probabilities</span>
    <span class="s3"># This causes NaNs in the EM algorithm (e.g. _em_regime_transition), and</span>
    <span class="s3"># so the _fit_em method would return NaN parameters, as would the fit</span>
    <span class="s3"># method.</span>

    <span class="s3"># This test runs the smoother at the last set of good parameter values</span>
    <span class="s3"># (i.e. these parameters were generated by _fit_em and did not have any</span>
    <span class="s3"># NaN values in them, but the smoothed_joint_probabilities computed at</span>
    <span class="s3"># those parameters have NaNs in them, so that the next set of parameters</span>
    <span class="s3"># would have NaNs). The test then checks that the underflow problem has</span>
    <span class="s3"># been resolved, i.e. that there are no NaNs in the predicted, filtered,</span>
    <span class="s3"># and smoothed joint probabilities.</span>
    <span class="s1">m = markov_regression.MarkovRegression(</span>
        <span class="s1">gh5380_series</span><span class="s2">, </span><span class="s1">k_regimes=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">switching_variance=</span><span class="s2">True</span><span class="s1">)</span>
    <span class="s3"># To get these params, the following command was used:</span>
    <span class="s3"># params = m._fit_em(maxiter=1).params</span>
    <span class="s1">params = np.array([</span>
        <span class="s4">6.97337611e-01</span><span class="s2">, </span><span class="s4">6.26116329e-01</span><span class="s2">, </span><span class="s1">-</span><span class="s4">6.41266551e-06</span><span class="s2">, </span><span class="s4">3.81141202e-06</span><span class="s2">,</span>
        <span class="s4">4.72462327e-08</span><span class="s2">, </span><span class="s4">4.45291473e-06</span><span class="s1">])</span>
    <span class="s1">res = m.smooth(params)</span>

    <span class="s2">assert not </span><span class="s1">np.any(np.isnan(res.predicted_joint_probabilities))</span>
    <span class="s2">assert not </span><span class="s1">np.any(np.isnan(res.filtered_joint_probabilities))</span>
    <span class="s2">assert not </span><span class="s1">np.any(np.isnan(res.smoothed_joint_probabilities))</span>


<span class="s2">def </span><span class="s1">test_exog_tvtp():</span>
    <span class="s1">exog = np.ones_like(fedfunds)</span>

    <span class="s1">mod1 = markov_regression.MarkovRegression(fedfunds</span><span class="s2">, </span><span class="s1">k_regimes=</span><span class="s4">2</span><span class="s1">)</span>
    <span class="s1">mod2 = markov_regression.MarkovRegression(fedfunds</span><span class="s2">, </span><span class="s1">k_regimes=</span><span class="s4">2</span><span class="s2">,</span>
                                              <span class="s1">exog_tvtp=exog)</span>

    <span class="s1">params = np.r_[</span><span class="s4">0.98209618</span><span class="s2">, </span><span class="s4">0.05036498</span><span class="s2">, </span><span class="s4">3.70877542</span><span class="s2">, </span><span class="s4">9.55676298</span><span class="s2">, </span><span class="s4">4.44181911</span><span class="s1">]</span>
    <span class="s1">params_tvtp = params.copy()</span>
    <span class="s1">params_tvtp[</span><span class="s4">0</span><span class="s1">] = np.squeeze(</span>
        <span class="s1">mod2._untransform_logistic(np.r_[</span><span class="s4">0.</span><span class="s1">]</span><span class="s2">, </span><span class="s1">np.r_[</span><span class="s4">1 </span><span class="s1">- params[</span><span class="s4">0</span><span class="s1">]])</span>
    <span class="s1">)</span>
    <span class="s1">params_tvtp[</span><span class="s4">1</span><span class="s1">] = np.squeeze(</span>
        <span class="s1">mod2._untransform_logistic(np.r_[</span><span class="s4">0.</span><span class="s1">]</span><span class="s2">, </span><span class="s1">np.r_[</span><span class="s4">1 </span><span class="s1">- params[</span><span class="s4">1</span><span class="s1">]])</span>
    <span class="s1">)</span>

    <span class="s1">res1 = mod1.smooth(params)</span>
    <span class="s1">res2 = mod2.smooth(params_tvtp)</span>

    <span class="s1">assert_allclose(res2.llf_obs</span><span class="s2">, </span><span class="s1">res1.llf_obs)</span>
    <span class="s1">assert_allclose(res2.regime_transition - res1.regime_transition</span><span class="s2">, </span><span class="s4">0</span><span class="s2">,</span>
                    <span class="s1">atol=</span><span class="s4">1e-15</span><span class="s1">)</span>
    <span class="s1">assert_allclose(res2.predicted_joint_probabilities</span><span class="s2">,</span>
                    <span class="s1">res1.predicted_joint_probabilities)</span>
    <span class="s1">assert_allclose(res2.filtered_joint_probabilities</span><span class="s2">,</span>
                    <span class="s1">res1.filtered_joint_probabilities)</span>
    <span class="s1">assert_allclose(res2.smoothed_joint_probabilities</span><span class="s2">,</span>
                    <span class="s1">res1.smoothed_joint_probabilities)</span>
</pre>
</body>
</html>