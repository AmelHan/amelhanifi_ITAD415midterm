<html>
<head>
<title>test_plot.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6897bb;}
.s3 { color: #6a8759;}
.s4 { color: #629755; font-style: italic;}
.s5 { color: #808080;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_plot.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">import </span><span class="s1">pytest</span>

<span class="s0">from </span><span class="s1">sklearn.datasets </span><span class="s0">import </span><span class="s1">load_iris</span>
<span class="s0">from </span><span class="s1">sklearn.model_selection </span><span class="s0">import </span><span class="s1">(</span>
    <span class="s1">LearningCurveDisplay</span><span class="s0">,</span>
    <span class="s1">ValidationCurveDisplay</span><span class="s0">,</span>
    <span class="s1">learning_curve</span><span class="s0">,</span>
    <span class="s1">validation_curve</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">from </span><span class="s1">sklearn.tree </span><span class="s0">import </span><span class="s1">DecisionTreeClassifier</span>
<span class="s0">from </span><span class="s1">sklearn.utils </span><span class="s0">import </span><span class="s1">shuffle</span>
<span class="s0">from </span><span class="s1">sklearn.utils._testing </span><span class="s0">import </span><span class="s1">assert_allclose</span><span class="s0">, </span><span class="s1">assert_array_equal</span>


<span class="s1">@pytest.fixture</span>
<span class="s0">def </span><span class="s1">data():</span>
    <span class="s0">return </span><span class="s1">shuffle(*load_iris(return_X_y=</span><span class="s0">True</span><span class="s1">)</span><span class="s0">, </span><span class="s1">random_state=</span><span class="s2">0</span><span class="s1">)</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s3">&quot;params, err_type, err_msg&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">({</span><span class="s3">&quot;std_display_style&quot;</span><span class="s1">: </span><span class="s3">&quot;invalid&quot;</span><span class="s1">}</span><span class="s0">, </span><span class="s1">ValueError</span><span class="s0">, </span><span class="s3">&quot;Unknown std_display_style:&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">({</span><span class="s3">&quot;score_type&quot;</span><span class="s1">: </span><span class="s3">&quot;invalid&quot;</span><span class="s1">}</span><span class="s0">, </span><span class="s1">ValueError</span><span class="s0">, </span><span class="s3">&quot;Unknown score_type:&quot;</span><span class="s1">)</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s3">&quot;CurveDisplay, specific_params&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(ValidationCurveDisplay</span><span class="s0">, </span><span class="s1">{</span><span class="s3">&quot;param_name&quot;</span><span class="s1">: </span><span class="s3">&quot;max_depth&quot;</span><span class="s0">, </span><span class="s3">&quot;param_range&quot;</span><span class="s1">: [</span><span class="s2">1</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">5</span><span class="s1">]})</span><span class="s0">,</span>
        <span class="s1">(LearningCurveDisplay</span><span class="s0">, </span><span class="s1">{</span><span class="s3">&quot;train_sizes&quot;</span><span class="s1">: [</span><span class="s2">0.3</span><span class="s0">, </span><span class="s2">0.6</span><span class="s0">, </span><span class="s2">0.9</span><span class="s1">]})</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_curve_display_parameters_validation(</span>
    <span class="s1">pyplot</span><span class="s0">, </span><span class="s1">data</span><span class="s0">, </span><span class="s1">params</span><span class="s0">, </span><span class="s1">err_type</span><span class="s0">, </span><span class="s1">err_msg</span><span class="s0">, </span><span class="s1">CurveDisplay</span><span class="s0">, </span><span class="s1">specific_params</span>
<span class="s1">):</span>
    <span class="s4">&quot;&quot;&quot;Check that we raise a proper error when passing invalid parameters.&quot;&quot;&quot;</span>
    <span class="s1">X</span><span class="s0">, </span><span class="s1">y = data</span>
    <span class="s1">estimator = DecisionTreeClassifier(random_state=</span><span class="s2">0</span><span class="s1">)</span>

    <span class="s0">with </span><span class="s1">pytest.raises(err_type</span><span class="s0">, </span><span class="s1">match=err_msg):</span>
        <span class="s1">CurveDisplay.from_estimator(estimator</span><span class="s0">, </span><span class="s1">X</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s1">**specific_params</span><span class="s0">, </span><span class="s1">**params)</span>


<span class="s0">def </span><span class="s1">test_learning_curve_display_default_usage(pyplot</span><span class="s0">, </span><span class="s1">data):</span>
    <span class="s4">&quot;&quot;&quot;Check the default usage of the LearningCurveDisplay class.&quot;&quot;&quot;</span>
    <span class="s1">X</span><span class="s0">, </span><span class="s1">y = data</span>
    <span class="s1">estimator = DecisionTreeClassifier(random_state=</span><span class="s2">0</span><span class="s1">)</span>

    <span class="s1">train_sizes = [</span><span class="s2">0.3</span><span class="s0">, </span><span class="s2">0.6</span><span class="s0">, </span><span class="s2">0.9</span><span class="s1">]</span>
    <span class="s1">display = LearningCurveDisplay.from_estimator(</span>
        <span class="s1">estimator</span><span class="s0">, </span><span class="s1">X</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s1">train_sizes=train_sizes</span>
    <span class="s1">)</span>

    <span class="s0">import </span><span class="s1">matplotlib </span><span class="s0">as </span><span class="s1">mpl</span>

    <span class="s0">assert </span><span class="s1">display.errorbar_ </span><span class="s0">is None</span>

    <span class="s0">assert </span><span class="s1">isinstance(display.lines_</span><span class="s0">, </span><span class="s1">list)</span>
    <span class="s0">for </span><span class="s1">line </span><span class="s0">in </span><span class="s1">display.lines_:</span>
        <span class="s0">assert </span><span class="s1">isinstance(line</span><span class="s0">, </span><span class="s1">mpl.lines.Line2D)</span>

    <span class="s0">assert </span><span class="s1">isinstance(display.fill_between_</span><span class="s0">, </span><span class="s1">list)</span>
    <span class="s0">for </span><span class="s1">fill </span><span class="s0">in </span><span class="s1">display.fill_between_:</span>
        <span class="s0">assert </span><span class="s1">isinstance(fill</span><span class="s0">, </span><span class="s1">mpl.collections.PolyCollection)</span>
        <span class="s0">assert </span><span class="s1">fill.get_alpha() == </span><span class="s2">0.5</span>

    <span class="s0">assert </span><span class="s1">display.score_name == </span><span class="s3">&quot;Score&quot;</span>
    <span class="s0">assert </span><span class="s1">display.ax_.get_xlabel() == </span><span class="s3">&quot;Number of samples in the training set&quot;</span>
    <span class="s0">assert </span><span class="s1">display.ax_.get_ylabel() == </span><span class="s3">&quot;Score&quot;</span>

    <span class="s1">_</span><span class="s0">, </span><span class="s1">legend_labels = display.ax_.get_legend_handles_labels()</span>
    <span class="s0">assert </span><span class="s1">legend_labels == [</span><span class="s3">&quot;Train&quot;</span><span class="s0">, </span><span class="s3">&quot;Test&quot;</span><span class="s1">]</span>

    <span class="s1">train_sizes_abs</span><span class="s0">, </span><span class="s1">train_scores</span><span class="s0">, </span><span class="s1">test_scores = learning_curve(</span>
        <span class="s1">estimator</span><span class="s0">, </span><span class="s1">X</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s1">train_sizes=train_sizes</span>
    <span class="s1">)</span>

    <span class="s1">assert_array_equal(display.train_sizes</span><span class="s0">, </span><span class="s1">train_sizes_abs)</span>
    <span class="s1">assert_allclose(display.train_scores</span><span class="s0">, </span><span class="s1">train_scores)</span>
    <span class="s1">assert_allclose(display.test_scores</span><span class="s0">, </span><span class="s1">test_scores)</span>


<span class="s0">def </span><span class="s1">test_validation_curve_display_default_usage(pyplot</span><span class="s0">, </span><span class="s1">data):</span>
    <span class="s4">&quot;&quot;&quot;Check the default usage of the ValidationCurveDisplay class.&quot;&quot;&quot;</span>
    <span class="s1">X</span><span class="s0">, </span><span class="s1">y = data</span>
    <span class="s1">estimator = DecisionTreeClassifier(random_state=</span><span class="s2">0</span><span class="s1">)</span>

    <span class="s1">param_name</span><span class="s0">, </span><span class="s1">param_range = </span><span class="s3">&quot;max_depth&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">5</span><span class="s1">]</span>
    <span class="s1">display = ValidationCurveDisplay.from_estimator(</span>
        <span class="s1">estimator</span><span class="s0">, </span><span class="s1">X</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s1">param_name=param_name</span><span class="s0">, </span><span class="s1">param_range=param_range</span>
    <span class="s1">)</span>

    <span class="s0">import </span><span class="s1">matplotlib </span><span class="s0">as </span><span class="s1">mpl</span>

    <span class="s0">assert </span><span class="s1">display.errorbar_ </span><span class="s0">is None</span>

    <span class="s0">assert </span><span class="s1">isinstance(display.lines_</span><span class="s0">, </span><span class="s1">list)</span>
    <span class="s0">for </span><span class="s1">line </span><span class="s0">in </span><span class="s1">display.lines_:</span>
        <span class="s0">assert </span><span class="s1">isinstance(line</span><span class="s0">, </span><span class="s1">mpl.lines.Line2D)</span>

    <span class="s0">assert </span><span class="s1">isinstance(display.fill_between_</span><span class="s0">, </span><span class="s1">list)</span>
    <span class="s0">for </span><span class="s1">fill </span><span class="s0">in </span><span class="s1">display.fill_between_:</span>
        <span class="s0">assert </span><span class="s1">isinstance(fill</span><span class="s0">, </span><span class="s1">mpl.collections.PolyCollection)</span>
        <span class="s0">assert </span><span class="s1">fill.get_alpha() == </span><span class="s2">0.5</span>

    <span class="s0">assert </span><span class="s1">display.score_name == </span><span class="s3">&quot;Score&quot;</span>
    <span class="s0">assert </span><span class="s1">display.ax_.get_xlabel() == </span><span class="s3">f&quot;</span><span class="s0">{</span><span class="s1">param_name</span><span class="s0">}</span><span class="s3">&quot;</span>
    <span class="s0">assert </span><span class="s1">display.ax_.get_ylabel() == </span><span class="s3">&quot;Score&quot;</span>

    <span class="s1">_</span><span class="s0">, </span><span class="s1">legend_labels = display.ax_.get_legend_handles_labels()</span>
    <span class="s0">assert </span><span class="s1">legend_labels == [</span><span class="s3">&quot;Train&quot;</span><span class="s0">, </span><span class="s3">&quot;Test&quot;</span><span class="s1">]</span>

    <span class="s1">train_scores</span><span class="s0">, </span><span class="s1">test_scores = validation_curve(</span>
        <span class="s1">estimator</span><span class="s0">, </span><span class="s1">X</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s1">param_name=param_name</span><span class="s0">, </span><span class="s1">param_range=param_range</span>
    <span class="s1">)</span>

    <span class="s1">assert_array_equal(display.param_range</span><span class="s0">, </span><span class="s1">param_range)</span>
    <span class="s1">assert_allclose(display.train_scores</span><span class="s0">, </span><span class="s1">train_scores)</span>
    <span class="s1">assert_allclose(display.test_scores</span><span class="s0">, </span><span class="s1">test_scores)</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s3">&quot;CurveDisplay, specific_params&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(ValidationCurveDisplay</span><span class="s0">, </span><span class="s1">{</span><span class="s3">&quot;param_name&quot;</span><span class="s1">: </span><span class="s3">&quot;max_depth&quot;</span><span class="s0">, </span><span class="s3">&quot;param_range&quot;</span><span class="s1">: [</span><span class="s2">1</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">5</span><span class="s1">]})</span><span class="s0">,</span>
        <span class="s1">(LearningCurveDisplay</span><span class="s0">, </span><span class="s1">{</span><span class="s3">&quot;train_sizes&quot;</span><span class="s1">: [</span><span class="s2">0.3</span><span class="s0">, </span><span class="s2">0.6</span><span class="s0">, </span><span class="s2">0.9</span><span class="s1">]})</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_curve_display_negate_score(pyplot</span><span class="s0">, </span><span class="s1">data</span><span class="s0">, </span><span class="s1">CurveDisplay</span><span class="s0">, </span><span class="s1">specific_params):</span>
    <span class="s4">&quot;&quot;&quot;Check the behaviour of the `negate_score` parameter calling `from_estimator` and 
    `plot`. 
    &quot;&quot;&quot;</span>
    <span class="s1">X</span><span class="s0">, </span><span class="s1">y = data</span>
    <span class="s1">estimator = DecisionTreeClassifier(max_depth=</span><span class="s2">1</span><span class="s0">, </span><span class="s1">random_state=</span><span class="s2">0</span><span class="s1">)</span>

    <span class="s1">negate_score = </span><span class="s0">False</span>
    <span class="s1">display = CurveDisplay.from_estimator(</span>
        <span class="s1">estimator</span><span class="s0">, </span><span class="s1">X</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s1">**specific_params</span><span class="s0">, </span><span class="s1">negate_score=negate_score</span>
    <span class="s1">)</span>

    <span class="s1">positive_scores = display.lines_[</span><span class="s2">0</span><span class="s1">].get_data()[</span><span class="s2">1</span><span class="s1">]</span>
    <span class="s0">assert </span><span class="s1">(positive_scores &gt;= </span><span class="s2">0</span><span class="s1">).all()</span>
    <span class="s0">assert </span><span class="s1">display.ax_.get_ylabel() == </span><span class="s3">&quot;Score&quot;</span>

    <span class="s1">negate_score = </span><span class="s0">True</span>
    <span class="s1">display = CurveDisplay.from_estimator(</span>
        <span class="s1">estimator</span><span class="s0">, </span><span class="s1">X</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s1">**specific_params</span><span class="s0">, </span><span class="s1">negate_score=negate_score</span>
    <span class="s1">)</span>

    <span class="s1">negative_scores = display.lines_[</span><span class="s2">0</span><span class="s1">].get_data()[</span><span class="s2">1</span><span class="s1">]</span>
    <span class="s0">assert </span><span class="s1">(negative_scores &lt;= </span><span class="s2">0</span><span class="s1">).all()</span>
    <span class="s1">assert_allclose(negative_scores</span><span class="s0">, </span><span class="s1">-positive_scores)</span>
    <span class="s0">assert </span><span class="s1">display.ax_.get_ylabel() == </span><span class="s3">&quot;Negative score&quot;</span>

    <span class="s1">negate_score = </span><span class="s0">False</span>
    <span class="s1">display = CurveDisplay.from_estimator(</span>
        <span class="s1">estimator</span><span class="s0">, </span><span class="s1">X</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s1">**specific_params</span><span class="s0">, </span><span class="s1">negate_score=negate_score</span>
    <span class="s1">)</span>
    <span class="s0">assert </span><span class="s1">display.ax_.get_ylabel() == </span><span class="s3">&quot;Score&quot;</span>
    <span class="s1">display.plot(negate_score=</span><span class="s0">not </span><span class="s1">negate_score)</span>
    <span class="s0">assert </span><span class="s1">display.ax_.get_ylabel() == </span><span class="s3">&quot;Score&quot;</span>
    <span class="s0">assert </span><span class="s1">(display.lines_[</span><span class="s2">0</span><span class="s1">].get_data()[</span><span class="s2">1</span><span class="s1">] &lt; </span><span class="s2">0</span><span class="s1">).all()</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s3">&quot;score_name, ylabel&quot;</span><span class="s0">, </span><span class="s1">[(</span><span class="s0">None, </span><span class="s3">&quot;Score&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">&quot;Accuracy&quot;</span><span class="s0">, </span><span class="s3">&quot;Accuracy&quot;</span><span class="s1">)]</span>
<span class="s1">)</span>
<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s3">&quot;CurveDisplay, specific_params&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(ValidationCurveDisplay</span><span class="s0">, </span><span class="s1">{</span><span class="s3">&quot;param_name&quot;</span><span class="s1">: </span><span class="s3">&quot;max_depth&quot;</span><span class="s0">, </span><span class="s3">&quot;param_range&quot;</span><span class="s1">: [</span><span class="s2">1</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">5</span><span class="s1">]})</span><span class="s0">,</span>
        <span class="s1">(LearningCurveDisplay</span><span class="s0">, </span><span class="s1">{</span><span class="s3">&quot;train_sizes&quot;</span><span class="s1">: [</span><span class="s2">0.3</span><span class="s0">, </span><span class="s2">0.6</span><span class="s0">, </span><span class="s2">0.9</span><span class="s1">]})</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_curve_display_score_name(</span>
    <span class="s1">pyplot</span><span class="s0">, </span><span class="s1">data</span><span class="s0">, </span><span class="s1">score_name</span><span class="s0">, </span><span class="s1">ylabel</span><span class="s0">, </span><span class="s1">CurveDisplay</span><span class="s0">, </span><span class="s1">specific_params</span>
<span class="s1">):</span>
    <span class="s4">&quot;&quot;&quot;Check that we can overwrite the default score name shown on the y-axis.&quot;&quot;&quot;</span>
    <span class="s1">X</span><span class="s0">, </span><span class="s1">y = data</span>
    <span class="s1">estimator = DecisionTreeClassifier(random_state=</span><span class="s2">0</span><span class="s1">)</span>

    <span class="s1">display = CurveDisplay.from_estimator(</span>
        <span class="s1">estimator</span><span class="s0">, </span><span class="s1">X</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s1">**specific_params</span><span class="s0">, </span><span class="s1">score_name=score_name</span>
    <span class="s1">)</span>

    <span class="s0">assert </span><span class="s1">display.ax_.get_ylabel() == ylabel</span>
    <span class="s1">X</span><span class="s0">, </span><span class="s1">y = data</span>
    <span class="s1">estimator = DecisionTreeClassifier(max_depth=</span><span class="s2">1</span><span class="s0">, </span><span class="s1">random_state=</span><span class="s2">0</span><span class="s1">)</span>

    <span class="s1">display = CurveDisplay.from_estimator(</span>
        <span class="s1">estimator</span><span class="s0">, </span><span class="s1">X</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s1">**specific_params</span><span class="s0">, </span><span class="s1">score_name=score_name</span>
    <span class="s1">)</span>

    <span class="s0">assert </span><span class="s1">display.score_name == ylabel</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;std_display_style&quot;</span><span class="s0">, </span><span class="s1">(</span><span class="s0">None, </span><span class="s3">&quot;errorbar&quot;</span><span class="s1">))</span>
<span class="s0">def </span><span class="s1">test_learning_curve_display_score_type(pyplot</span><span class="s0">, </span><span class="s1">data</span><span class="s0">, </span><span class="s1">std_display_style):</span>
    <span class="s4">&quot;&quot;&quot;Check the behaviour of setting the `score_type` parameter.&quot;&quot;&quot;</span>
    <span class="s1">X</span><span class="s0">, </span><span class="s1">y = data</span>
    <span class="s1">estimator = DecisionTreeClassifier(random_state=</span><span class="s2">0</span><span class="s1">)</span>

    <span class="s1">train_sizes = [</span><span class="s2">0.3</span><span class="s0">, </span><span class="s2">0.6</span><span class="s0">, </span><span class="s2">0.9</span><span class="s1">]</span>
    <span class="s1">train_sizes_abs</span><span class="s0">, </span><span class="s1">train_scores</span><span class="s0">, </span><span class="s1">test_scores = learning_curve(</span>
        <span class="s1">estimator</span><span class="s0">, </span><span class="s1">X</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s1">train_sizes=train_sizes</span>
    <span class="s1">)</span>

    <span class="s1">score_type = </span><span class="s3">&quot;train&quot;</span>
    <span class="s1">display = LearningCurveDisplay.from_estimator(</span>
        <span class="s1">estimator</span><span class="s0">,</span>
        <span class="s1">X</span><span class="s0">,</span>
        <span class="s1">y</span><span class="s0">,</span>
        <span class="s1">train_sizes=train_sizes</span><span class="s0">,</span>
        <span class="s1">score_type=score_type</span><span class="s0">,</span>
        <span class="s1">std_display_style=std_display_style</span><span class="s0">,</span>
    <span class="s1">)</span>

    <span class="s1">_</span><span class="s0">, </span><span class="s1">legend_label = display.ax_.get_legend_handles_labels()</span>
    <span class="s0">assert </span><span class="s1">legend_label == [</span><span class="s3">&quot;Train&quot;</span><span class="s1">]</span>

    <span class="s0">if </span><span class="s1">std_display_style </span><span class="s0">is None</span><span class="s1">:</span>
        <span class="s0">assert </span><span class="s1">len(display.lines_) == </span><span class="s2">1</span>
        <span class="s0">assert </span><span class="s1">display.errorbar_ </span><span class="s0">is None</span>
        <span class="s1">x_data</span><span class="s0">, </span><span class="s1">y_data = display.lines_[</span><span class="s2">0</span><span class="s1">].get_data()</span>
    <span class="s0">else</span><span class="s1">:</span>
        <span class="s0">assert </span><span class="s1">display.lines_ </span><span class="s0">is None</span>
        <span class="s0">assert </span><span class="s1">len(display.errorbar_) == </span><span class="s2">1</span>
        <span class="s1">x_data</span><span class="s0">, </span><span class="s1">y_data = display.errorbar_[</span><span class="s2">0</span><span class="s1">].lines[</span><span class="s2">0</span><span class="s1">].get_data()</span>

    <span class="s1">assert_array_equal(x_data</span><span class="s0">, </span><span class="s1">train_sizes_abs)</span>
    <span class="s1">assert_allclose(y_data</span><span class="s0">, </span><span class="s1">train_scores.mean(axis=</span><span class="s2">1</span><span class="s1">))</span>

    <span class="s1">score_type = </span><span class="s3">&quot;test&quot;</span>
    <span class="s1">display = LearningCurveDisplay.from_estimator(</span>
        <span class="s1">estimator</span><span class="s0">,</span>
        <span class="s1">X</span><span class="s0">,</span>
        <span class="s1">y</span><span class="s0">,</span>
        <span class="s1">train_sizes=train_sizes</span><span class="s0">,</span>
        <span class="s1">score_type=score_type</span><span class="s0">,</span>
        <span class="s1">std_display_style=std_display_style</span><span class="s0">,</span>
    <span class="s1">)</span>

    <span class="s1">_</span><span class="s0">, </span><span class="s1">legend_label = display.ax_.get_legend_handles_labels()</span>
    <span class="s0">assert </span><span class="s1">legend_label == [</span><span class="s3">&quot;Test&quot;</span><span class="s1">]</span>

    <span class="s0">if </span><span class="s1">std_display_style </span><span class="s0">is None</span><span class="s1">:</span>
        <span class="s0">assert </span><span class="s1">len(display.lines_) == </span><span class="s2">1</span>
        <span class="s0">assert </span><span class="s1">display.errorbar_ </span><span class="s0">is None</span>
        <span class="s1">x_data</span><span class="s0">, </span><span class="s1">y_data = display.lines_[</span><span class="s2">0</span><span class="s1">].get_data()</span>
    <span class="s0">else</span><span class="s1">:</span>
        <span class="s0">assert </span><span class="s1">display.lines_ </span><span class="s0">is None</span>
        <span class="s0">assert </span><span class="s1">len(display.errorbar_) == </span><span class="s2">1</span>
        <span class="s1">x_data</span><span class="s0">, </span><span class="s1">y_data = display.errorbar_[</span><span class="s2">0</span><span class="s1">].lines[</span><span class="s2">0</span><span class="s1">].get_data()</span>

    <span class="s1">assert_array_equal(x_data</span><span class="s0">, </span><span class="s1">train_sizes_abs)</span>
    <span class="s1">assert_allclose(y_data</span><span class="s0">, </span><span class="s1">test_scores.mean(axis=</span><span class="s2">1</span><span class="s1">))</span>

    <span class="s1">score_type = </span><span class="s3">&quot;both&quot;</span>
    <span class="s1">display = LearningCurveDisplay.from_estimator(</span>
        <span class="s1">estimator</span><span class="s0">,</span>
        <span class="s1">X</span><span class="s0">,</span>
        <span class="s1">y</span><span class="s0">,</span>
        <span class="s1">train_sizes=train_sizes</span><span class="s0">,</span>
        <span class="s1">score_type=score_type</span><span class="s0">,</span>
        <span class="s1">std_display_style=std_display_style</span><span class="s0">,</span>
    <span class="s1">)</span>

    <span class="s1">_</span><span class="s0">, </span><span class="s1">legend_label = display.ax_.get_legend_handles_labels()</span>
    <span class="s0">assert </span><span class="s1">legend_label == [</span><span class="s3">&quot;Train&quot;</span><span class="s0">, </span><span class="s3">&quot;Test&quot;</span><span class="s1">]</span>

    <span class="s0">if </span><span class="s1">std_display_style </span><span class="s0">is None</span><span class="s1">:</span>
        <span class="s0">assert </span><span class="s1">len(display.lines_) == </span><span class="s2">2</span>
        <span class="s0">assert </span><span class="s1">display.errorbar_ </span><span class="s0">is None</span>
        <span class="s1">x_data_train</span><span class="s0">, </span><span class="s1">y_data_train = display.lines_[</span><span class="s2">0</span><span class="s1">].get_data()</span>
        <span class="s1">x_data_test</span><span class="s0">, </span><span class="s1">y_data_test = display.lines_[</span><span class="s2">1</span><span class="s1">].get_data()</span>
    <span class="s0">else</span><span class="s1">:</span>
        <span class="s0">assert </span><span class="s1">display.lines_ </span><span class="s0">is None</span>
        <span class="s0">assert </span><span class="s1">len(display.errorbar_) == </span><span class="s2">2</span>
        <span class="s1">x_data_train</span><span class="s0">, </span><span class="s1">y_data_train = display.errorbar_[</span><span class="s2">0</span><span class="s1">].lines[</span><span class="s2">0</span><span class="s1">].get_data()</span>
        <span class="s1">x_data_test</span><span class="s0">, </span><span class="s1">y_data_test = display.errorbar_[</span><span class="s2">1</span><span class="s1">].lines[</span><span class="s2">0</span><span class="s1">].get_data()</span>

    <span class="s1">assert_array_equal(x_data_train</span><span class="s0">, </span><span class="s1">train_sizes_abs)</span>
    <span class="s1">assert_allclose(y_data_train</span><span class="s0">, </span><span class="s1">train_scores.mean(axis=</span><span class="s2">1</span><span class="s1">))</span>
    <span class="s1">assert_array_equal(x_data_test</span><span class="s0">, </span><span class="s1">train_sizes_abs)</span>
    <span class="s1">assert_allclose(y_data_test</span><span class="s0">, </span><span class="s1">test_scores.mean(axis=</span><span class="s2">1</span><span class="s1">))</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;std_display_style&quot;</span><span class="s0">, </span><span class="s1">(</span><span class="s0">None, </span><span class="s3">&quot;errorbar&quot;</span><span class="s1">))</span>
<span class="s0">def </span><span class="s1">test_validation_curve_display_score_type(pyplot</span><span class="s0">, </span><span class="s1">data</span><span class="s0">, </span><span class="s1">std_display_style):</span>
    <span class="s4">&quot;&quot;&quot;Check the behaviour of setting the `score_type` parameter.&quot;&quot;&quot;</span>
    <span class="s1">X</span><span class="s0">, </span><span class="s1">y = data</span>
    <span class="s1">estimator = DecisionTreeClassifier(random_state=</span><span class="s2">0</span><span class="s1">)</span>

    <span class="s1">param_name</span><span class="s0">, </span><span class="s1">param_range = </span><span class="s3">&quot;max_depth&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">5</span><span class="s1">]</span>
    <span class="s1">train_scores</span><span class="s0">, </span><span class="s1">test_scores = validation_curve(</span>
        <span class="s1">estimator</span><span class="s0">, </span><span class="s1">X</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s1">param_name=param_name</span><span class="s0">, </span><span class="s1">param_range=param_range</span>
    <span class="s1">)</span>

    <span class="s1">score_type = </span><span class="s3">&quot;train&quot;</span>
    <span class="s1">display = ValidationCurveDisplay.from_estimator(</span>
        <span class="s1">estimator</span><span class="s0">,</span>
        <span class="s1">X</span><span class="s0">,</span>
        <span class="s1">y</span><span class="s0">,</span>
        <span class="s1">param_name=param_name</span><span class="s0">,</span>
        <span class="s1">param_range=param_range</span><span class="s0">,</span>
        <span class="s1">score_type=score_type</span><span class="s0">,</span>
        <span class="s1">std_display_style=std_display_style</span><span class="s0">,</span>
    <span class="s1">)</span>

    <span class="s1">_</span><span class="s0">, </span><span class="s1">legend_label = display.ax_.get_legend_handles_labels()</span>
    <span class="s0">assert </span><span class="s1">legend_label == [</span><span class="s3">&quot;Train&quot;</span><span class="s1">]</span>

    <span class="s0">if </span><span class="s1">std_display_style </span><span class="s0">is None</span><span class="s1">:</span>
        <span class="s0">assert </span><span class="s1">len(display.lines_) == </span><span class="s2">1</span>
        <span class="s0">assert </span><span class="s1">display.errorbar_ </span><span class="s0">is None</span>
        <span class="s1">x_data</span><span class="s0">, </span><span class="s1">y_data = display.lines_[</span><span class="s2">0</span><span class="s1">].get_data()</span>
    <span class="s0">else</span><span class="s1">:</span>
        <span class="s0">assert </span><span class="s1">display.lines_ </span><span class="s0">is None</span>
        <span class="s0">assert </span><span class="s1">len(display.errorbar_) == </span><span class="s2">1</span>
        <span class="s1">x_data</span><span class="s0">, </span><span class="s1">y_data = display.errorbar_[</span><span class="s2">0</span><span class="s1">].lines[</span><span class="s2">0</span><span class="s1">].get_data()</span>

    <span class="s1">assert_array_equal(x_data</span><span class="s0">, </span><span class="s1">param_range)</span>
    <span class="s1">assert_allclose(y_data</span><span class="s0">, </span><span class="s1">train_scores.mean(axis=</span><span class="s2">1</span><span class="s1">))</span>

    <span class="s1">score_type = </span><span class="s3">&quot;test&quot;</span>
    <span class="s1">display = ValidationCurveDisplay.from_estimator(</span>
        <span class="s1">estimator</span><span class="s0">,</span>
        <span class="s1">X</span><span class="s0">,</span>
        <span class="s1">y</span><span class="s0">,</span>
        <span class="s1">param_name=param_name</span><span class="s0">,</span>
        <span class="s1">param_range=param_range</span><span class="s0">,</span>
        <span class="s1">score_type=score_type</span><span class="s0">,</span>
        <span class="s1">std_display_style=std_display_style</span><span class="s0">,</span>
    <span class="s1">)</span>

    <span class="s1">_</span><span class="s0">, </span><span class="s1">legend_label = display.ax_.get_legend_handles_labels()</span>
    <span class="s0">assert </span><span class="s1">legend_label == [</span><span class="s3">&quot;Test&quot;</span><span class="s1">]</span>

    <span class="s0">if </span><span class="s1">std_display_style </span><span class="s0">is None</span><span class="s1">:</span>
        <span class="s0">assert </span><span class="s1">len(display.lines_) == </span><span class="s2">1</span>
        <span class="s0">assert </span><span class="s1">display.errorbar_ </span><span class="s0">is None</span>
        <span class="s1">x_data</span><span class="s0">, </span><span class="s1">y_data = display.lines_[</span><span class="s2">0</span><span class="s1">].get_data()</span>
    <span class="s0">else</span><span class="s1">:</span>
        <span class="s0">assert </span><span class="s1">display.lines_ </span><span class="s0">is None</span>
        <span class="s0">assert </span><span class="s1">len(display.errorbar_) == </span><span class="s2">1</span>
        <span class="s1">x_data</span><span class="s0">, </span><span class="s1">y_data = display.errorbar_[</span><span class="s2">0</span><span class="s1">].lines[</span><span class="s2">0</span><span class="s1">].get_data()</span>

    <span class="s1">assert_array_equal(x_data</span><span class="s0">, </span><span class="s1">param_range)</span>
    <span class="s1">assert_allclose(y_data</span><span class="s0">, </span><span class="s1">test_scores.mean(axis=</span><span class="s2">1</span><span class="s1">))</span>

    <span class="s1">score_type = </span><span class="s3">&quot;both&quot;</span>
    <span class="s1">display = ValidationCurveDisplay.from_estimator(</span>
        <span class="s1">estimator</span><span class="s0">,</span>
        <span class="s1">X</span><span class="s0">,</span>
        <span class="s1">y</span><span class="s0">,</span>
        <span class="s1">param_name=param_name</span><span class="s0">,</span>
        <span class="s1">param_range=param_range</span><span class="s0">,</span>
        <span class="s1">score_type=score_type</span><span class="s0">,</span>
        <span class="s1">std_display_style=std_display_style</span><span class="s0">,</span>
    <span class="s1">)</span>

    <span class="s1">_</span><span class="s0">, </span><span class="s1">legend_label = display.ax_.get_legend_handles_labels()</span>
    <span class="s0">assert </span><span class="s1">legend_label == [</span><span class="s3">&quot;Train&quot;</span><span class="s0">, </span><span class="s3">&quot;Test&quot;</span><span class="s1">]</span>

    <span class="s0">if </span><span class="s1">std_display_style </span><span class="s0">is None</span><span class="s1">:</span>
        <span class="s0">assert </span><span class="s1">len(display.lines_) == </span><span class="s2">2</span>
        <span class="s0">assert </span><span class="s1">display.errorbar_ </span><span class="s0">is None</span>
        <span class="s1">x_data_train</span><span class="s0">, </span><span class="s1">y_data_train = display.lines_[</span><span class="s2">0</span><span class="s1">].get_data()</span>
        <span class="s1">x_data_test</span><span class="s0">, </span><span class="s1">y_data_test = display.lines_[</span><span class="s2">1</span><span class="s1">].get_data()</span>
    <span class="s0">else</span><span class="s1">:</span>
        <span class="s0">assert </span><span class="s1">display.lines_ </span><span class="s0">is None</span>
        <span class="s0">assert </span><span class="s1">len(display.errorbar_) == </span><span class="s2">2</span>
        <span class="s1">x_data_train</span><span class="s0">, </span><span class="s1">y_data_train = display.errorbar_[</span><span class="s2">0</span><span class="s1">].lines[</span><span class="s2">0</span><span class="s1">].get_data()</span>
        <span class="s1">x_data_test</span><span class="s0">, </span><span class="s1">y_data_test = display.errorbar_[</span><span class="s2">1</span><span class="s1">].lines[</span><span class="s2">0</span><span class="s1">].get_data()</span>

    <span class="s1">assert_array_equal(x_data_train</span><span class="s0">, </span><span class="s1">param_range)</span>
    <span class="s1">assert_allclose(y_data_train</span><span class="s0">, </span><span class="s1">train_scores.mean(axis=</span><span class="s2">1</span><span class="s1">))</span>
    <span class="s1">assert_array_equal(x_data_test</span><span class="s0">, </span><span class="s1">param_range)</span>
    <span class="s1">assert_allclose(y_data_test</span><span class="s0">, </span><span class="s1">test_scores.mean(axis=</span><span class="s2">1</span><span class="s1">))</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s3">&quot;CurveDisplay, specific_params, expected_xscale&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(</span>
            <span class="s1">ValidationCurveDisplay</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s3">&quot;param_name&quot;</span><span class="s1">: </span><span class="s3">&quot;max_depth&quot;</span><span class="s0">, </span><span class="s3">&quot;param_range&quot;</span><span class="s1">: np.arange(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)}</span><span class="s0">,</span>
            <span class="s3">&quot;linear&quot;</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(LearningCurveDisplay</span><span class="s0">, </span><span class="s1">{</span><span class="s3">&quot;train_sizes&quot;</span><span class="s1">: np.linspace(</span><span class="s2">0.1</span><span class="s0">, </span><span class="s2">0.9</span><span class="s0">, </span><span class="s1">num=</span><span class="s2">5</span><span class="s1">)}</span><span class="s0">, </span><span class="s3">&quot;linear&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span>
            <span class="s1">ValidationCurveDisplay</span><span class="s0">,</span>
            <span class="s1">{</span>
                <span class="s3">&quot;param_name&quot;</span><span class="s1">: </span><span class="s3">&quot;max_depth&quot;</span><span class="s0">,</span>
                <span class="s3">&quot;param_range&quot;</span><span class="s1">: np.round(np.logspace(</span><span class="s2">0</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s1">num=</span><span class="s2">5</span><span class="s1">)).astype(np.int64)</span><span class="s0">,</span>
            <span class="s1">}</span><span class="s0">,</span>
            <span class="s3">&quot;log&quot;</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(LearningCurveDisplay</span><span class="s0">, </span><span class="s1">{</span><span class="s3">&quot;train_sizes&quot;</span><span class="s1">: np.logspace(-</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s1">num=</span><span class="s2">5</span><span class="s1">)}</span><span class="s0">, </span><span class="s3">&quot;log&quot;</span><span class="s1">)</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_curve_display_xscale_auto(</span>
    <span class="s1">pyplot</span><span class="s0">, </span><span class="s1">data</span><span class="s0">, </span><span class="s1">CurveDisplay</span><span class="s0">, </span><span class="s1">specific_params</span><span class="s0">, </span><span class="s1">expected_xscale</span>
<span class="s1">):</span>
    <span class="s4">&quot;&quot;&quot;Check the behaviour of the x-axis scaling depending on the data provided.&quot;&quot;&quot;</span>
    <span class="s1">X</span><span class="s0">, </span><span class="s1">y = data</span>
    <span class="s1">estimator = DecisionTreeClassifier(random_state=</span><span class="s2">0</span><span class="s1">)</span>

    <span class="s1">display = CurveDisplay.from_estimator(estimator</span><span class="s0">, </span><span class="s1">X</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s1">**specific_params)</span>
    <span class="s0">assert </span><span class="s1">display.ax_.get_xscale() == expected_xscale</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s3">&quot;CurveDisplay, specific_params&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(ValidationCurveDisplay</span><span class="s0">, </span><span class="s1">{</span><span class="s3">&quot;param_name&quot;</span><span class="s1">: </span><span class="s3">&quot;max_depth&quot;</span><span class="s0">, </span><span class="s3">&quot;param_range&quot;</span><span class="s1">: [</span><span class="s2">1</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">5</span><span class="s1">]})</span><span class="s0">,</span>
        <span class="s1">(LearningCurveDisplay</span><span class="s0">, </span><span class="s1">{</span><span class="s3">&quot;train_sizes&quot;</span><span class="s1">: [</span><span class="s2">0.3</span><span class="s0">, </span><span class="s2">0.6</span><span class="s0">, </span><span class="s2">0.9</span><span class="s1">]})</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_curve_display_std_display_style(pyplot</span><span class="s0">, </span><span class="s1">data</span><span class="s0">, </span><span class="s1">CurveDisplay</span><span class="s0">, </span><span class="s1">specific_params):</span>
    <span class="s4">&quot;&quot;&quot;Check the behaviour of the parameter `std_display_style`.&quot;&quot;&quot;</span>
    <span class="s1">X</span><span class="s0">, </span><span class="s1">y = data</span>
    <span class="s1">estimator = DecisionTreeClassifier(random_state=</span><span class="s2">0</span><span class="s1">)</span>

    <span class="s0">import </span><span class="s1">matplotlib </span><span class="s0">as </span><span class="s1">mpl</span>

    <span class="s1">std_display_style = </span><span class="s0">None</span>
    <span class="s1">display = CurveDisplay.from_estimator(</span>
        <span class="s1">estimator</span><span class="s0">,</span>
        <span class="s1">X</span><span class="s0">,</span>
        <span class="s1">y</span><span class="s0">,</span>
        <span class="s1">**specific_params</span><span class="s0">,</span>
        <span class="s1">std_display_style=std_display_style</span><span class="s0">,</span>
    <span class="s1">)</span>

    <span class="s0">assert </span><span class="s1">len(display.lines_) == </span><span class="s2">2</span>
    <span class="s0">for </span><span class="s1">line </span><span class="s0">in </span><span class="s1">display.lines_:</span>
        <span class="s0">assert </span><span class="s1">isinstance(line</span><span class="s0">, </span><span class="s1">mpl.lines.Line2D)</span>
    <span class="s0">assert </span><span class="s1">display.errorbar_ </span><span class="s0">is None</span>
    <span class="s0">assert </span><span class="s1">display.fill_between_ </span><span class="s0">is None</span>
    <span class="s1">_</span><span class="s0">, </span><span class="s1">legend_label = display.ax_.get_legend_handles_labels()</span>
    <span class="s0">assert </span><span class="s1">len(legend_label) == </span><span class="s2">2</span>

    <span class="s1">std_display_style = </span><span class="s3">&quot;fill_between&quot;</span>
    <span class="s1">display = CurveDisplay.from_estimator(</span>
        <span class="s1">estimator</span><span class="s0">,</span>
        <span class="s1">X</span><span class="s0">,</span>
        <span class="s1">y</span><span class="s0">,</span>
        <span class="s1">**specific_params</span><span class="s0">,</span>
        <span class="s1">std_display_style=std_display_style</span><span class="s0">,</span>
    <span class="s1">)</span>

    <span class="s0">assert </span><span class="s1">len(display.lines_) == </span><span class="s2">2</span>
    <span class="s0">for </span><span class="s1">line </span><span class="s0">in </span><span class="s1">display.lines_:</span>
        <span class="s0">assert </span><span class="s1">isinstance(line</span><span class="s0">, </span><span class="s1">mpl.lines.Line2D)</span>
    <span class="s0">assert </span><span class="s1">display.errorbar_ </span><span class="s0">is None</span>
    <span class="s0">assert </span><span class="s1">len(display.fill_between_) == </span><span class="s2">2</span>
    <span class="s0">for </span><span class="s1">fill_between </span><span class="s0">in </span><span class="s1">display.fill_between_:</span>
        <span class="s0">assert </span><span class="s1">isinstance(fill_between</span><span class="s0">, </span><span class="s1">mpl.collections.PolyCollection)</span>
    <span class="s1">_</span><span class="s0">, </span><span class="s1">legend_label = display.ax_.get_legend_handles_labels()</span>
    <span class="s0">assert </span><span class="s1">len(legend_label) == </span><span class="s2">2</span>

    <span class="s1">std_display_style = </span><span class="s3">&quot;errorbar&quot;</span>
    <span class="s1">display = CurveDisplay.from_estimator(</span>
        <span class="s1">estimator</span><span class="s0">,</span>
        <span class="s1">X</span><span class="s0">,</span>
        <span class="s1">y</span><span class="s0">,</span>
        <span class="s1">**specific_params</span><span class="s0">,</span>
        <span class="s1">std_display_style=std_display_style</span><span class="s0">,</span>
    <span class="s1">)</span>

    <span class="s0">assert </span><span class="s1">display.lines_ </span><span class="s0">is None</span>
    <span class="s0">assert </span><span class="s1">len(display.errorbar_) == </span><span class="s2">2</span>
    <span class="s0">for </span><span class="s1">errorbar </span><span class="s0">in </span><span class="s1">display.errorbar_:</span>
        <span class="s0">assert </span><span class="s1">isinstance(errorbar</span><span class="s0">, </span><span class="s1">mpl.container.ErrorbarContainer)</span>
    <span class="s0">assert </span><span class="s1">display.fill_between_ </span><span class="s0">is None</span>
    <span class="s1">_</span><span class="s0">, </span><span class="s1">legend_label = display.ax_.get_legend_handles_labels()</span>
    <span class="s0">assert </span><span class="s1">len(legend_label) == </span><span class="s2">2</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s3">&quot;CurveDisplay, specific_params&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(ValidationCurveDisplay</span><span class="s0">, </span><span class="s1">{</span><span class="s3">&quot;param_name&quot;</span><span class="s1">: </span><span class="s3">&quot;max_depth&quot;</span><span class="s0">, </span><span class="s3">&quot;param_range&quot;</span><span class="s1">: [</span><span class="s2">1</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">5</span><span class="s1">]})</span><span class="s0">,</span>
        <span class="s1">(LearningCurveDisplay</span><span class="s0">, </span><span class="s1">{</span><span class="s3">&quot;train_sizes&quot;</span><span class="s1">: [</span><span class="s2">0.3</span><span class="s0">, </span><span class="s2">0.6</span><span class="s0">, </span><span class="s2">0.9</span><span class="s1">]})</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_curve_display_plot_kwargs(pyplot</span><span class="s0">, </span><span class="s1">data</span><span class="s0">, </span><span class="s1">CurveDisplay</span><span class="s0">, </span><span class="s1">specific_params):</span>
    <span class="s4">&quot;&quot;&quot;Check the behaviour of the different plotting keyword arguments: `line_kw`, 
    `fill_between_kw`, and `errorbar_kw`.&quot;&quot;&quot;</span>
    <span class="s1">X</span><span class="s0">, </span><span class="s1">y = data</span>
    <span class="s1">estimator = DecisionTreeClassifier(random_state=</span><span class="s2">0</span><span class="s1">)</span>

    <span class="s1">std_display_style = </span><span class="s3">&quot;fill_between&quot;</span>
    <span class="s1">line_kw = {</span><span class="s3">&quot;color&quot;</span><span class="s1">: </span><span class="s3">&quot;red&quot;</span><span class="s1">}</span>
    <span class="s1">fill_between_kw = {</span><span class="s3">&quot;color&quot;</span><span class="s1">: </span><span class="s3">&quot;red&quot;</span><span class="s0">, </span><span class="s3">&quot;alpha&quot;</span><span class="s1">: </span><span class="s2">1.0</span><span class="s1">}</span>
    <span class="s1">display = CurveDisplay.from_estimator(</span>
        <span class="s1">estimator</span><span class="s0">,</span>
        <span class="s1">X</span><span class="s0">,</span>
        <span class="s1">y</span><span class="s0">,</span>
        <span class="s1">**specific_params</span><span class="s0">,</span>
        <span class="s1">std_display_style=std_display_style</span><span class="s0">,</span>
        <span class="s1">line_kw=line_kw</span><span class="s0">,</span>
        <span class="s1">fill_between_kw=fill_between_kw</span><span class="s0">,</span>
    <span class="s1">)</span>

    <span class="s0">assert </span><span class="s1">display.lines_[</span><span class="s2">0</span><span class="s1">].get_color() == </span><span class="s3">&quot;red&quot;</span>
    <span class="s1">assert_allclose(</span>
        <span class="s1">display.fill_between_[</span><span class="s2">0</span><span class="s1">].get_facecolor()</span><span class="s0">,</span>
        <span class="s1">[[</span><span class="s2">1.0</span><span class="s0">, </span><span class="s2">0.0</span><span class="s0">, </span><span class="s2">0.0</span><span class="s0">, </span><span class="s2">1.0</span><span class="s1">]]</span><span class="s0">,  </span><span class="s5"># trust me, it's red</span>
    <span class="s1">)</span>

    <span class="s1">std_display_style = </span><span class="s3">&quot;errorbar&quot;</span>
    <span class="s1">errorbar_kw = {</span><span class="s3">&quot;color&quot;</span><span class="s1">: </span><span class="s3">&quot;red&quot;</span><span class="s1">}</span>
    <span class="s1">display = CurveDisplay.from_estimator(</span>
        <span class="s1">estimator</span><span class="s0">,</span>
        <span class="s1">X</span><span class="s0">,</span>
        <span class="s1">y</span><span class="s0">,</span>
        <span class="s1">**specific_params</span><span class="s0">,</span>
        <span class="s1">std_display_style=std_display_style</span><span class="s0">,</span>
        <span class="s1">errorbar_kw=errorbar_kw</span><span class="s0">,</span>
    <span class="s1">)</span>

    <span class="s0">assert </span><span class="s1">display.errorbar_[</span><span class="s2">0</span><span class="s1">].lines[</span><span class="s2">0</span><span class="s1">].get_color() == </span><span class="s3">&quot;red&quot;</span>


<span class="s5"># TODO(1.5): to be removed</span>
<span class="s0">def </span><span class="s1">test_learning_curve_display_deprecate_log_scale(data</span><span class="s0">, </span><span class="s1">pyplot):</span>
    <span class="s4">&quot;&quot;&quot;Check that we warn for the deprecated parameter `log_scale`.&quot;&quot;&quot;</span>
    <span class="s1">X</span><span class="s0">, </span><span class="s1">y = data</span>
    <span class="s1">estimator = DecisionTreeClassifier(random_state=</span><span class="s2">0</span><span class="s1">)</span>

    <span class="s0">with </span><span class="s1">pytest.warns(FutureWarning</span><span class="s0">, </span><span class="s1">match=</span><span class="s3">&quot;`log_scale` parameter is deprecated&quot;</span><span class="s1">):</span>
        <span class="s1">display = LearningCurveDisplay.from_estimator(</span>
            <span class="s1">estimator</span><span class="s0">, </span><span class="s1">X</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s1">train_sizes=[</span><span class="s2">0.3</span><span class="s0">, </span><span class="s2">0.6</span><span class="s0">, </span><span class="s2">0.9</span><span class="s1">]</span><span class="s0">, </span><span class="s1">log_scale=</span><span class="s0">True</span>
        <span class="s1">)</span>

    <span class="s0">assert </span><span class="s1">display.ax_.get_xscale() == </span><span class="s3">&quot;log&quot;</span>
    <span class="s0">assert </span><span class="s1">display.ax_.get_yscale() == </span><span class="s3">&quot;linear&quot;</span>

    <span class="s0">with </span><span class="s1">pytest.warns(FutureWarning</span><span class="s0">, </span><span class="s1">match=</span><span class="s3">&quot;`log_scale` parameter is deprecated&quot;</span><span class="s1">):</span>
        <span class="s1">display = LearningCurveDisplay.from_estimator(</span>
            <span class="s1">estimator</span><span class="s0">, </span><span class="s1">X</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s1">train_sizes=[</span><span class="s2">0.3</span><span class="s0">, </span><span class="s2">0.6</span><span class="s0">, </span><span class="s2">0.9</span><span class="s1">]</span><span class="s0">, </span><span class="s1">log_scale=</span><span class="s0">False</span>
        <span class="s1">)</span>

    <span class="s0">assert </span><span class="s1">display.ax_.get_xscale() == </span><span class="s3">&quot;linear&quot;</span>
    <span class="s0">assert </span><span class="s1">display.ax_.get_yscale() == </span><span class="s3">&quot;linear&quot;</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s3">&quot;param_range, xscale&quot;</span><span class="s0">,</span>
    <span class="s1">[([</span><span class="s2">5</span><span class="s0">, </span><span class="s2">10</span><span class="s0">, </span><span class="s2">15</span><span class="s1">]</span><span class="s0">, </span><span class="s3">&quot;linear&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">([-</span><span class="s2">50</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s2">50</span><span class="s0">, </span><span class="s2">500</span><span class="s1">]</span><span class="s0">, </span><span class="s3">&quot;symlog&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">([</span><span class="s2">5</span><span class="s0">, </span><span class="s2">50</span><span class="s0">, </span><span class="s2">500</span><span class="s1">]</span><span class="s0">, </span><span class="s3">&quot;log&quot;</span><span class="s1">)]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_validation_curve_xscale_from_param_range_provided_as_a_list(</span>
    <span class="s1">pyplot</span><span class="s0">, </span><span class="s1">data</span><span class="s0">, </span><span class="s1">param_range</span><span class="s0">, </span><span class="s1">xscale</span>
<span class="s1">):</span>
    <span class="s4">&quot;&quot;&quot;Check the induced xscale from the provided param_range values.&quot;&quot;&quot;</span>
    <span class="s1">X</span><span class="s0">, </span><span class="s1">y = data</span>
    <span class="s1">estimator = DecisionTreeClassifier(random_state=</span><span class="s2">0</span><span class="s1">)</span>

    <span class="s1">param_name = </span><span class="s3">&quot;max_depth&quot;</span>
    <span class="s1">display = ValidationCurveDisplay.from_estimator(</span>
        <span class="s1">estimator</span><span class="s0">,</span>
        <span class="s1">X</span><span class="s0">,</span>
        <span class="s1">y</span><span class="s0">,</span>
        <span class="s1">param_name=param_name</span><span class="s0">,</span>
        <span class="s1">param_range=param_range</span><span class="s0">,</span>
    <span class="s1">)</span>

    <span class="s0">assert </span><span class="s1">display.ax_.get_xscale() == xscale</span>
</pre>
</body>
</html>