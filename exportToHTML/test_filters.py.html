<html>
<head>
<title>test_filters.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #808080;}
.s3 { color: #6897bb;}
.s4 { color: #6a8759;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_filters.py</font>
</center></td></tr></table>
<pre><span class="s0">from </span><span class="s1">statsmodels.compat.pandas </span><span class="s0">import </span><span class="s1">assert_frame_equal</span><span class="s0">, </span><span class="s1">make_dataframe</span>

<span class="s0">from </span><span class="s1">datetime </span><span class="s0">import </span><span class="s1">datetime</span>

<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">from </span><span class="s1">numpy </span><span class="s0">import </span><span class="s1">array</span><span class="s0">, </span><span class="s1">column_stack</span>
<span class="s0">from </span><span class="s1">numpy.testing </span><span class="s0">import </span><span class="s1">(</span>
    <span class="s1">assert_</span><span class="s0">,</span>
    <span class="s1">assert_allclose</span><span class="s0">,</span>
    <span class="s1">assert_almost_equal</span><span class="s0">,</span>
    <span class="s1">assert_equal</span><span class="s0">,</span>
    <span class="s1">assert_raises</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">from </span><span class="s1">pandas </span><span class="s0">import </span><span class="s1">DataFrame</span><span class="s0">, </span><span class="s1">concat</span><span class="s0">, </span><span class="s1">date_range</span>

<span class="s0">from </span><span class="s1">statsmodels.datasets </span><span class="s0">import </span><span class="s1">macrodata</span>
<span class="s0">from </span><span class="s1">statsmodels.tsa.filters._utils </span><span class="s0">import </span><span class="s1">pandas_wrapper</span>
<span class="s0">from </span><span class="s1">statsmodels.tsa.filters.bk_filter </span><span class="s0">import </span><span class="s1">bkfilter</span>
<span class="s0">from </span><span class="s1">statsmodels.tsa.filters.cf_filter </span><span class="s0">import </span><span class="s1">cffilter</span>
<span class="s0">from </span><span class="s1">statsmodels.tsa.filters.filtertools </span><span class="s0">import </span><span class="s1">(</span>
    <span class="s1">convolution_filter</span><span class="s0">,</span>
    <span class="s1">recursive_filter</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">from </span><span class="s1">statsmodels.tsa.filters.hp_filter </span><span class="s0">import </span><span class="s1">hpfilter</span>


<span class="s0">def </span><span class="s1">test_bking1d():</span>
    <span class="s2"># Test Baxter King band-pass filter. Results are taken from Stata</span>
    <span class="s1">bking_results = array([</span>
        <span class="s3">7.320813</span><span class="s0">, </span><span class="s3">2.886914</span><span class="s0">, </span><span class="s1">-</span><span class="s3">6.818976</span><span class="s0">, </span><span class="s1">-</span><span class="s3">13.49436</span><span class="s0">,</span>
        <span class="s1">-</span><span class="s3">13.27936</span><span class="s0">, </span><span class="s1">-</span><span class="s3">9.405913</span><span class="s0">, </span><span class="s1">-</span><span class="s3">5.691091</span><span class="s0">, </span><span class="s1">-</span><span class="s3">5.133076</span><span class="s0">, </span><span class="s1">-</span><span class="s3">7.273468</span><span class="s0">,</span>
        <span class="s1">-</span><span class="s3">9.243364</span><span class="s0">, </span><span class="s1">-</span><span class="s3">8.482916</span><span class="s0">, </span><span class="s1">-</span><span class="s3">4.447764</span><span class="s0">, </span><span class="s3">2.406559</span><span class="s0">, </span><span class="s3">10.68433</span><span class="s0">,</span>
        <span class="s3">19.46414</span><span class="s0">, </span><span class="s3">28.09749</span><span class="s0">, </span><span class="s3">34.11066</span><span class="s0">, </span><span class="s3">33.48468</span><span class="s0">, </span><span class="s3">24.64598</span><span class="s0">, </span><span class="s3">9.952399</span><span class="s0">,</span>
        <span class="s1">-</span><span class="s3">4.265528</span><span class="s0">, </span><span class="s1">-</span><span class="s3">12.59471</span><span class="s0">, </span><span class="s1">-</span><span class="s3">13.46714</span><span class="s0">, </span><span class="s1">-</span><span class="s3">9.049501</span><span class="s0">, </span><span class="s1">-</span><span class="s3">3.011248</span><span class="s0">,</span>
        <span class="s3">.5655082</span><span class="s0">, </span><span class="s3">2.897976</span><span class="s0">, </span><span class="s3">7.406077</span><span class="s0">, </span><span class="s3">14.67959</span><span class="s0">, </span><span class="s3">18.651</span><span class="s0">, </span><span class="s3">13.05891</span><span class="s0">,</span>
        <span class="s1">-</span><span class="s3">2.945415</span><span class="s0">, </span><span class="s1">-</span><span class="s3">24.08659</span><span class="s0">, </span><span class="s1">-</span><span class="s3">41.86147</span><span class="s0">, </span><span class="s1">-</span><span class="s3">48.68383</span><span class="s0">, </span><span class="s1">-</span><span class="s3">43.32689</span><span class="s0">,</span>
        <span class="s1">-</span><span class="s3">31.66654</span><span class="s0">, </span><span class="s1">-</span><span class="s3">20.38356</span><span class="s0">, </span><span class="s1">-</span><span class="s3">13.76411</span><span class="s0">, </span><span class="s1">-</span><span class="s3">9.978693</span><span class="s0">, </span><span class="s1">-</span><span class="s3">3.7704</span><span class="s0">, </span><span class="s3">10.27108</span><span class="s0">,</span>
        <span class="s3">31.02847</span><span class="s0">, </span><span class="s3">51.87613</span><span class="s0">, </span><span class="s3">66.93117</span><span class="s0">, </span><span class="s3">73.51951</span><span class="s0">, </span><span class="s3">73.4053</span><span class="s0">, </span><span class="s3">69.17468</span><span class="s0">,</span>
        <span class="s3">59.8543</span><span class="s0">, </span><span class="s3">38.23899</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.2604809</span><span class="s0">, </span><span class="s1">-</span><span class="s3">49.0107</span><span class="s0">, </span><span class="s1">-</span><span class="s3">91.1128</span><span class="s0">, </span><span class="s1">-</span><span class="s3">112.1574</span><span class="s0">,</span>
        <span class="s1">-</span><span class="s3">108.3227</span><span class="s0">, </span><span class="s1">-</span><span class="s3">86.51453</span><span class="s0">, </span><span class="s1">-</span><span class="s3">59.91258</span><span class="s0">, </span><span class="s1">-</span><span class="s3">40.01185</span><span class="s0">, </span><span class="s1">-</span><span class="s3">29.70265</span><span class="s0">,</span>
        <span class="s1">-</span><span class="s3">22.76396</span><span class="s0">, </span><span class="s1">-</span><span class="s3">13.08037</span><span class="s0">, </span><span class="s3">1.913622</span><span class="s0">, </span><span class="s3">20.44045</span><span class="s0">, </span><span class="s3">37.32873</span><span class="s0">, </span><span class="s3">46.79802</span><span class="s0">,</span>
        <span class="s3">51.95937</span><span class="s0">, </span><span class="s3">59.67393</span><span class="s0">, </span><span class="s3">70.50803</span><span class="s0">, </span><span class="s3">81.27311</span><span class="s0">, </span><span class="s3">83.53191</span><span class="s0">, </span><span class="s3">67.72536</span><span class="s0">,</span>
        <span class="s3">33.78039</span><span class="s0">, </span><span class="s1">-</span><span class="s3">6.509092</span><span class="s0">, </span><span class="s1">-</span><span class="s3">37.31579</span><span class="s0">, </span><span class="s1">-</span><span class="s3">46.05207</span><span class="s0">, </span><span class="s1">-</span><span class="s3">29.81496</span><span class="s0">, </span><span class="s3">1.416417</span><span class="s0">,</span>
        <span class="s3">28.31503</span><span class="s0">,</span>
        <span class="s3">32.90134</span><span class="s0">, </span><span class="s3">8.949259</span><span class="s0">, </span><span class="s1">-</span><span class="s3">35.41895</span><span class="s0">, </span><span class="s1">-</span><span class="s3">84.65775</span><span class="s0">, </span><span class="s1">-</span><span class="s3">124.4288</span><span class="s0">, </span><span class="s1">-</span><span class="s3">144.6036</span><span class="s0">,</span>
        <span class="s1">-</span><span class="s3">140.2204</span><span class="s0">, </span><span class="s1">-</span><span class="s3">109.2624</span><span class="s0">, </span><span class="s1">-</span><span class="s3">53.6901</span><span class="s0">, </span><span class="s3">15.07415</span><span class="s0">, </span><span class="s3">74.44268</span><span class="s0">, </span><span class="s3">104.0403</span><span class="s0">,</span>
        <span class="s3">101.0725</span><span class="s0">, </span><span class="s3">76.58291</span><span class="s0">, </span><span class="s3">49.27925</span><span class="s0">, </span><span class="s3">36.15751</span><span class="s0">, </span><span class="s3">36.48799</span><span class="s0">, </span><span class="s3">37.60897</span><span class="s0">,</span>
        <span class="s3">27.75998</span><span class="s0">, </span><span class="s3">4.216643</span><span class="s0">, </span><span class="s1">-</span><span class="s3">23.20579</span><span class="s0">, </span><span class="s1">-</span><span class="s3">39.33292</span><span class="s0">, </span><span class="s1">-</span><span class="s3">36.6134</span><span class="s0">, </span><span class="s1">-</span><span class="s3">20.90161</span><span class="s0">,</span>
        <span class="s1">-</span><span class="s3">4.143123</span><span class="s0">, </span><span class="s3">5.48432</span><span class="s0">, </span><span class="s3">9.270075</span><span class="s0">, </span><span class="s3">13.69573</span><span class="s0">, </span><span class="s3">22.16675</span><span class="s0">, </span><span class="s3">33.01987</span><span class="s0">,</span>
        <span class="s3">41.93186</span><span class="s0">, </span><span class="s3">47.12222</span><span class="s0">, </span><span class="s3">48.62164</span><span class="s0">, </span><span class="s3">47.30701</span><span class="s0">, </span><span class="s3">40.20537</span><span class="s0">, </span><span class="s3">22.37898</span><span class="s0">,</span>
        <span class="s1">-</span><span class="s3">7.133002</span><span class="s0">, </span><span class="s1">-</span><span class="s3">43.3339</span><span class="s0">, </span><span class="s1">-</span><span class="s3">78.51229</span><span class="s0">, </span><span class="s1">-</span><span class="s3">101.3684</span><span class="s0">, </span><span class="s1">-</span><span class="s3">105.2179</span><span class="s0">,</span>
        <span class="s1">-</span><span class="s3">90.97147</span><span class="s0">,</span>
        <span class="s1">-</span><span class="s3">68.30824</span><span class="s0">, </span><span class="s1">-</span><span class="s3">48.10113</span><span class="s0">, </span><span class="s1">-</span><span class="s3">35.60709</span><span class="s0">, </span><span class="s1">-</span><span class="s3">31.15775</span><span class="s0">, </span><span class="s1">-</span><span class="s3">31.82346</span><span class="s0">,</span>
        <span class="s1">-</span><span class="s3">32.49278</span><span class="s0">, </span><span class="s1">-</span><span class="s3">28.22499</span><span class="s0">, </span><span class="s1">-</span><span class="s3">14.42852</span><span class="s0">, </span><span class="s3">10.1827</span><span class="s0">, </span><span class="s3">36.64189</span><span class="s0">, </span><span class="s3">49.43468</span><span class="s0">,</span>
        <span class="s3">38.75517</span><span class="s0">, </span><span class="s3">6.447761</span><span class="s0">, </span><span class="s1">-</span><span class="s3">33.15883</span><span class="s0">, </span><span class="s1">-</span><span class="s3">62.60446</span><span class="s0">, </span><span class="s1">-</span><span class="s3">72.87829</span><span class="s0">, </span><span class="s1">-</span><span class="s3">66.54629</span><span class="s0">,</span>
        <span class="s1">-</span><span class="s3">52.61205</span><span class="s0">, </span><span class="s1">-</span><span class="s3">38.06676</span><span class="s0">, </span><span class="s1">-</span><span class="s3">26.19963</span><span class="s0">, </span><span class="s1">-</span><span class="s3">16.51492</span><span class="s0">, </span><span class="s1">-</span><span class="s3">7.007577</span><span class="s0">,</span>
        <span class="s3">.6125674</span><span class="s0">,</span>
        <span class="s3">7.866972</span><span class="s0">, </span><span class="s3">14.8123</span><span class="s0">, </span><span class="s3">22.52388</span><span class="s0">, </span><span class="s3">30.65265</span><span class="s0">, </span><span class="s3">39.47801</span><span class="s0">, </span><span class="s3">49.05027</span><span class="s0">,</span>
        <span class="s3">59.02925</span><span class="s0">,</span>
        <span class="s3">72.88999</span><span class="s0">, </span><span class="s3">95.08865</span><span class="s0">, </span><span class="s3">125.8983</span><span class="s0">, </span><span class="s3">154.4283</span><span class="s0">, </span><span class="s3">160.7638</span><span class="s0">, </span><span class="s3">130.6092</span><span class="s0">,</span>
        <span class="s3">67.84406</span><span class="s0">, </span><span class="s1">-</span><span class="s3">7.070272</span><span class="s0">, </span><span class="s1">-</span><span class="s3">68.08128</span><span class="s0">, </span><span class="s1">-</span><span class="s3">99.39944</span><span class="s0">, </span><span class="s1">-</span><span class="s3">104.911</span><span class="s0">,</span>
        <span class="s1">-</span><span class="s3">100.2372</span><span class="s0">, </span><span class="s1">-</span><span class="s3">98.11596</span><span class="s0">, </span><span class="s1">-</span><span class="s3">104.2051</span><span class="s0">, </span><span class="s1">-</span><span class="s3">114.0125</span><span class="s0">, </span><span class="s1">-</span><span class="s3">113.3475</span><span class="s0">,</span>
        <span class="s1">-</span><span class="s3">92.98669</span><span class="s0">, </span><span class="s1">-</span><span class="s3">51.91707</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.7313812</span><span class="s0">, </span><span class="s3">43.22938</span><span class="s0">, </span><span class="s3">64.62762</span><span class="s0">, </span><span class="s3">64.07226</span><span class="s0">,</span>
        <span class="s3">59.35707</span><span class="s0">, </span><span class="s3">67.06026</span><span class="s0">, </span><span class="s3">91.87247</span><span class="s0">, </span><span class="s3">124.4591</span><span class="s0">, </span><span class="s3">151.2402</span><span class="s0">, </span><span class="s3">163.0648</span><span class="s0">,</span>
        <span class="s3">154.6432</span><span class="s1">])</span>
    <span class="s1">X = macrodata.load_pandas().data[</span><span class="s4">'realinv'</span><span class="s1">].values</span>
    <span class="s1">Y = bkfilter(X</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">32</span><span class="s0">, </span><span class="s3">12</span><span class="s1">)</span>
    <span class="s1">assert_almost_equal(Y</span><span class="s0">, </span><span class="s1">bking_results</span><span class="s0">, </span><span class="s3">4</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_bking2d():</span>
    <span class="s2"># Test Baxter-King band-pass filter with 2d input</span>
    <span class="s1">bking_results = array([</span>
        <span class="s1">[</span><span class="s3">7.320813</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.0374475</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2.886914</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.0430094</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">6.818976</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.053456</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">13.49436</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.0620739</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">13.27936</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.0626929</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">9.405913</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.0603022</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">5.691091</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.0630016</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">5.133076</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.0832268</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">7.273468</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.1186448</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">9.243364</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.1619868</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">8.482916</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.2116604</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">4.447764</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.2670747</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2.406559</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.3209931</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">10.68433</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.3583075</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">19.46414</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.3626742</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">28.09749</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.3294618</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">34.11066</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.2773388</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">33.48468</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.2436127</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">24.64598</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.2605531</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">9.952399</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.3305166</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">4.265528</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.4275561</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">12.59471</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.5076068</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">13.46714</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.537573</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">9.049501</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.5205845</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">3.011248</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.481673</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.5655082</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.4403994</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">2.897976</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.4039957</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">7.406077</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.3537394</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">14.67959</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.2687359</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">18.651</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.1459743</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">13.05891</span><span class="s0">, </span><span class="s3">.0014926</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">2.945415</span><span class="s0">, </span><span class="s3">.1424277</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">24.08659</span><span class="s0">, </span><span class="s3">.2451936</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">41.86147</span><span class="s0">, </span><span class="s3">.288541</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">48.68383</span><span class="s0">, </span><span class="s3">.2727282</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">43.32689</span><span class="s0">, </span><span class="s3">.1959127</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">31.66654</span><span class="s0">, </span><span class="s3">.0644874</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">20.38356</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.1158372</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">13.76411</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.3518627</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">9.978693</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.6557535</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">3.7704</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.003754</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">10.27108</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.341632</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">31.02847</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.614486</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">51.87613</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.779089</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">66.93117</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.807459</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">73.51951</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.679688</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">73.4053</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.401012</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">69.17468</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.9954996</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">59.8543</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.511261</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">38.23899</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.0146745</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">.2604809</span><span class="s0">, </span><span class="s3">.4261311</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">49.0107</span><span class="s0">, </span><span class="s3">.7452514</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">91.1128</span><span class="s0">, </span><span class="s3">.8879492</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">112.1574</span><span class="s0">, </span><span class="s3">.8282748</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">108.3227</span><span class="s0">, </span><span class="s3">.5851508</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">86.51453</span><span class="s0">, </span><span class="s3">.2351699</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">59.91258</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.1208998</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">40.01185</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.4297895</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">29.70265</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.6821963</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">22.76396</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.9234254</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">13.08037</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.217539</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1.913622</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.57367</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">20.44045</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.927008</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">37.32873</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.229565</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">46.79802</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.463154</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">51.95937</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.614697</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">59.67393</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.681357</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">70.50803</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.609654</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">81.27311</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.301618</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">83.53191</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.720974</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">67.72536</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.9837123</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">33.78039</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.2261613</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">6.509092</span><span class="s0">, </span><span class="s3">.4546985</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">37.31579</span><span class="s0">, </span><span class="s3">1.005751</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">46.05207</span><span class="s0">, </span><span class="s3">1.457224</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">29.81496</span><span class="s0">, </span><span class="s3">1.870815</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1.416417</span><span class="s0">, </span><span class="s3">2.263313</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">28.31503</span><span class="s0">, </span><span class="s3">2.599906</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">32.90134</span><span class="s0">, </span><span class="s3">2.812282</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">8.949259</span><span class="s0">, </span><span class="s3">2.83358</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">35.41895</span><span class="s0">, </span><span class="s3">2.632667</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">84.65775</span><span class="s0">, </span><span class="s3">2.201077</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">124.4288</span><span class="s0">, </span><span class="s3">1.598951</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">144.6036</span><span class="s0">, </span><span class="s3">.9504762</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">140.2204</span><span class="s0">, </span><span class="s3">.4187932</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">109.2624</span><span class="s0">, </span><span class="s3">.1646726</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">53.6901</span><span class="s0">, </span><span class="s3">.2034265</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">15.07415</span><span class="s0">, </span><span class="s3">.398165</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">74.44268</span><span class="s0">, </span><span class="s3">.5427476</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">104.0403</span><span class="s0">, </span><span class="s3">.5454975</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">101.0725</span><span class="s0">, </span><span class="s3">.4723354</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">76.58291</span><span class="s0">, </span><span class="s3">.4626823</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">49.27925</span><span class="s0">, </span><span class="s3">.5840143</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">36.15751</span><span class="s0">, </span><span class="s3">.7187981</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">36.48799</span><span class="s0">, </span><span class="s3">.6058422</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">37.60897</span><span class="s0">, </span><span class="s3">.1221227</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">27.75998</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.5891272</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">4.216643</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.249841</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">23.20579</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.594972</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">39.33292</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.545968</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">36.6134</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.275494</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">20.90161</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.035783</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">4.143123</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.9971732</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">5.48432</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.154264</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">9.270075</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.29987</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">13.69573</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.240559</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">22.16675</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.9662656</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">33.01987</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.6420301</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">41.93186</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.4698712</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">47.12222</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.4527797</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">48.62164</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.4407153</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">47.30701</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.2416076</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">40.20537</span><span class="s0">, </span><span class="s3">.2317583</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">22.37898</span><span class="s0">, </span><span class="s3">.8710276</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">7.133002</span><span class="s0">, </span><span class="s3">1.426177</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">43.3339</span><span class="s0">, </span><span class="s3">1.652785</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">78.51229</span><span class="s0">, </span><span class="s3">1.488021</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">101.3684</span><span class="s0">, </span><span class="s3">1.072096</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">105.2179</span><span class="s0">, </span><span class="s3">.6496446</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">90.97147</span><span class="s0">, </span><span class="s3">.4193682</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">68.30824</span><span class="s0">, </span><span class="s3">.41847</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">48.10113</span><span class="s0">, </span><span class="s3">.5253419</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">35.60709</span><span class="s0">, </span><span class="s3">.595076</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">31.15775</span><span class="s0">, </span><span class="s3">.5509905</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">31.82346</span><span class="s0">, </span><span class="s3">.3755519</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">32.49278</span><span class="s0">, </span><span class="s3">.1297979</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">28.22499</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.0916165</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">14.42852</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.2531037</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">10.1827</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.3220784</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">36.64189</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.2660561</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">49.43468</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.1358522</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">38.75517</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.0279508</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">6.447761</span><span class="s0">, </span><span class="s3">.0168735</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">33.15883</span><span class="s0">, </span><span class="s3">.0315687</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">62.60446</span><span class="s0">, </span><span class="s3">.0819507</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">72.87829</span><span class="s0">, </span><span class="s3">.2274033</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">66.54629</span><span class="s0">, </span><span class="s3">.4641401</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">52.61205</span><span class="s0">, </span><span class="s3">.7211093</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">38.06676</span><span class="s0">, </span><span class="s3">.907773</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">26.19963</span><span class="s0">, </span><span class="s3">.9387103</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">16.51492</span><span class="s0">, </span><span class="s3">.7940786</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">7.007577</span><span class="s0">, </span><span class="s3">.5026631</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.6125674</span><span class="s0">, </span><span class="s3">.1224996</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">7.866972</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.2714422</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">14.8123</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.6273921</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">22.52388</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.9124271</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">30.65265</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.108861</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">39.47801</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.199206</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">49.05027</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.19908</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">59.02925</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.139046</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">72.88999</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.9775021</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">95.08865</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.6592603</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">125.8983</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.1609712</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">154.4283</span><span class="s0">, </span><span class="s3">.4796201</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">160.7638</span><span class="s0">, </span><span class="s3">1.100565</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">130.6092</span><span class="s0">, </span><span class="s3">1.447148</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">67.84406</span><span class="s0">, </span><span class="s3">1.359608</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">7.070272</span><span class="s0">, </span><span class="s3">.8931825</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">68.08128</span><span class="s0">, </span><span class="s3">.2619787</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">99.39944</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.252208</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">104.911</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.4703874</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">100.2372</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.4430657</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">98.11596</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.390683</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">104.2051</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.5647846</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">114.0125</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.9397582</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">113.3475</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.341633</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">92.98669</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.567337</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">51.91707</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.504943</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">.7313812</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.30576</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">43.22938</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.17151</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">64.62762</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.136151</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">64.07226</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.050555</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">59.35707</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.7308369</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">67.06026</span><span class="s0">, </span><span class="s1">-</span><span class="s3">.1766731</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">91.87247</span><span class="s0">, </span><span class="s3">.3898467</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">124.4591</span><span class="s0">, </span><span class="s3">.8135461</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">151.2402</span><span class="s0">, </span><span class="s3">.9644226</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">163.0648</span><span class="s0">, </span><span class="s3">.6865934</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">154.6432</span><span class="s0">, </span><span class="s3">.0115685</span><span class="s1">]])</span>

    <span class="s1">mdata = macrodata.load_pandas()</span>
    <span class="s1">X = mdata.data[[</span><span class="s4">'realinv'</span><span class="s0">, </span><span class="s4">'cpi'</span><span class="s1">]].values.astype(float)</span>
    <span class="s1">Y = bkfilter(X</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">32</span><span class="s0">, </span><span class="s3">12</span><span class="s1">)</span>
    <span class="s1">assert_almost_equal(Y</span><span class="s0">, </span><span class="s1">bking_results</span><span class="s0">, </span><span class="s3">4</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_hpfilter():</span>
    <span class="s2"># Test Hodrick-Prescott Filter. Results taken from Stata.</span>
    <span class="s1">hpfilt_res = array([</span>
        <span class="s1">[</span><span class="s3">3.951191484487844718e+01</span><span class="s0">, </span><span class="s3">2.670837085155121713e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">8.008853245681075350e+01</span><span class="s0">, </span><span class="s3">2.698712467543189177e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">4.887545512195401898e+01</span><span class="s0">, </span><span class="s3">2.726612544878045810e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">3.059193256079834100e+01</span><span class="s0">, </span><span class="s3">2.754612067439201837e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">6.488266733421960453e+01</span><span class="s0">, </span><span class="s3">2.782816332665780465e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">2.304024204546703913e+01</span><span class="s0">, </span><span class="s3">2.811349757954532834e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.355312369487364776e+00</span><span class="s0">, </span><span class="s3">2.840377312369487299e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">6.746236512580753697e+01</span><span class="s0">, </span><span class="s3">2.870078365125807522e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">8.136743836853429457e+01</span><span class="s0">, </span><span class="s3">2.900631438368534418e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">6.016789026443257171e+01</span><span class="s0">, </span><span class="s3">2.932172890264432681e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">4.636922433138215638e+01</span><span class="s0">, </span><span class="s3">2.964788224331382025e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">2.069533915570400495e+01</span><span class="s0">, </span><span class="s3">2.998525339155703932e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">2.162152558595607843e+00</span><span class="s0">, </span><span class="s3">3.033403152558595593e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">4.718647774311648391e+00</span><span class="s0">, </span><span class="s3">3.069427647774311481e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.355645669169007306e+01</span><span class="s0">, </span><span class="s3">3.106603456691690099e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">4.436926204475639679e+01</span><span class="s0">, </span><span class="s3">3.144932262044756499e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">4.332027378211660107e+01</span><span class="s0">, </span><span class="s3">3.184407273782116590e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">4.454697106352068658e+01</span><span class="s0">, </span><span class="s3">3.224993971063520803e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">2.629875787765286077e+01</span><span class="s0">, </span><span class="s3">3.266630757877652741e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">4.426119635629265758e+01</span><span class="s0">, </span><span class="s3">3.309228196356292756e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.443441190762496262e+01</span><span class="s0">, </span><span class="s3">3.352680411907625057e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">2.026686669186437939e+01</span><span class="s0">, </span><span class="s3">3.396853866691864368e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.913700136208899494e+01</span><span class="s0">, </span><span class="s3">3.441606001362089046e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">5.482458977940950717e+01</span><span class="s0">, </span><span class="s3">3.486781589779409387e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.596244517937793717e+01</span><span class="s0">, </span><span class="s3">3.532213445179378141e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.374011542874541192e+01</span><span class="s0">, </span><span class="s3">3.577700115428745448e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.325482813403914406e+01</span><span class="s0">, </span><span class="s3">3.623030171865960710e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">5.603040174253828809e+01</span><span class="s0">, </span><span class="s3">3.667983598257461836e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.030743373627105939e+02</span><span class="s0">, </span><span class="s3">3.712348662637289181e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">7.217534795943993231e+01</span><span class="s0">, </span><span class="s3">3.755948652040559864e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">5.462972503693208637e+01</span><span class="s0">, </span><span class="s3">3.798671274963067845e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">4.407065050666142270e+01</span><span class="s0">, </span><span class="s3">3.840449349493338559e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">3.749016270204992907e+01</span><span class="s0">, </span><span class="s3">3.881249837297949853e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.511244199923112319e+00</span><span class="s0">, </span><span class="s3">3.921067244199923152e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">9.093507374079763395e+00</span><span class="s0">, </span><span class="s3">3.959919507374079785e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.685361946760258434e+01</span><span class="s0">, </span><span class="s3">3.997823619467602384e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">2.822211031434289907e+01</span><span class="s0">, </span><span class="s3">4.034790889685657021e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">6.117590627896424849e+01</span><span class="s0">, </span><span class="s3">4.070822093721035344e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">5.433135391434370831e+01</span><span class="s0">, </span><span class="s3">4.105935646085656117e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">3.810480376716623141e+01</span><span class="s0">, </span><span class="s3">4.140188196232833434e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">7.042964928802848590e+01</span><span class="s0">, </span><span class="s3">4.173670350711971878e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">4.996346842507591646e+01</span><span class="s0">, </span><span class="s3">4.206496531574924120e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">4.455282059571254649e+01</span><span class="s0">, </span><span class="s3">4.238825179404287155e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">7.584961950576143863e+00</span><span class="s0">, </span><span class="s3">4.270845961950576566e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">4.620339247697120300e+01</span><span class="s0">, </span><span class="s3">4.302776392476971523e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">7.054024364552969928e+01</span><span class="s0">, </span><span class="s3">4.334829243645529459e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">6.492941099801464588e+01</span><span class="s0">, </span><span class="s3">4.367188410998014660e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.433567024239555394e+02</span><span class="s0">, </span><span class="s3">4.399993702423955256e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">5.932834493089012540e+01</span><span class="s0">, </span><span class="s3">4.433344344930889747e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">6.842096758743628016e+01</span><span class="s0">, </span><span class="s3">4.467249967587436004e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">6.774011924654860195e+01</span><span class="s0">, </span><span class="s3">4.501683119246548813e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">9.030958565658056614e+01</span><span class="s0">, </span><span class="s3">4.536573585656580690e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">4.603981499136807543e+01</span><span class="s0">, </span><span class="s3">4.571808814991368308e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">2.588118806672991923e+01</span><span class="s0">, </span><span class="s3">4.607219811933269739e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">3.489419371912299539e+01</span><span class="s0">, </span><span class="s3">4.642608806280876706e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">7.675179642495095322e+01</span><span class="s0">, </span><span class="s3">4.677794203575049323e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.635497817724171910e+02</span><span class="s0">, </span><span class="s3">4.712616218227582976e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.856079654765617306e+02</span><span class="s0">, </span><span class="s3">4.746963034523438182e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.254269446392718237e+02</span><span class="s0">, </span><span class="s3">4.780825055360728584e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.387413113837174024e+02</span><span class="s0">, </span><span class="s3">4.814308688616282780e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">6.201826599282230745e+01</span><span class="s0">, </span><span class="s3">4.847598734007177882e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">4.122129542972197669e+01</span><span class="s0">, </span><span class="s3">4.880966704570278125e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">4.120287475842360436e+01</span><span class="s0">, </span><span class="s3">4.914722874758424041e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">9.486328233441963675e+01</span><span class="s0">, </span><span class="s3">4.949203282334419782e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.894232132641573116e+02</span><span class="s0">, </span><span class="s3">4.984718213264157384e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.895766639620087517e+02</span><span class="s0">, </span><span class="s3">5.021518663962008759e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.464092413342650616e+02</span><span class="s0">, </span><span class="s3">5.059737241334265491e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.218770668721217589e+02</span><span class="s0">, </span><span class="s3">5.099388066872122181e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">4.973075629078175552e+01</span><span class="s0">, </span><span class="s3">5.140393756290781312e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">5.365375213897277717e+01</span><span class="s0">, </span><span class="s3">5.182600752138972894e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">7.175241524251214287e+01</span><span class="s0">, </span><span class="s3">5.225824415242512259e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">7.834757283225462743e+01</span><span class="s0">, </span><span class="s3">5.269846572832254424e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">6.264220687943907251e+01</span><span class="s0">, </span><span class="s3">5.314404206879438789e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">3.054332122210325906e+00</span><span class="s0">, </span><span class="s3">5.359185332122210639e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">4.808218808024685131e+01</span><span class="s0">, </span><span class="s3">5.403838811919753425e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">2.781399326736391231e+00</span><span class="s0">, </span><span class="s3">5.448011600673263274e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">2.197570415173231595e+01</span><span class="s0">, </span><span class="s3">5.491380704151732061e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.509441335012807031e+02</span><span class="s0">, </span><span class="s3">5.533624866498719712e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.658909029574851957e+02</span><span class="s0">, </span><span class="s3">5.574409097042514986e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">2.027292548049981633e+02</span><span class="s0">, </span><span class="s3">5.613492745195001589e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.752101578176061594e+02</span><span class="s0">, </span><span class="s3">5.650738842182393455e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.452808749847536092e+02</span><span class="s0">, </span><span class="s3">5.686137125015246056e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.535481629475025329e+02</span><span class="s0">, </span><span class="s3">5.719786837052497503e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.376169777998875361e+02</span><span class="s0">, </span><span class="s3">5.751878022200112355e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.257703080340770612e+02</span><span class="s0">, </span><span class="s3">5.782696691965922582e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">2.524186846895645431e+01</span><span class="s0">, </span><span class="s3">5.812614868468956047e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">6.546618027042404719e+01</span><span class="s0">, </span><span class="s3">5.842083180270424236e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.192352023580315290e+01</span><span class="s0">, </span><span class="s3">5.871536479764196883e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.043482970188742911e+02</span><span class="s0">, </span><span class="s3">5.901368702981125352e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">2.581376184768396342e+01</span><span class="s0">, </span><span class="s3">5.931981238152316109e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">6.634330880534071184e+01</span><span class="s0">, </span><span class="s3">5.963840691194659485e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">4.236780162594641297e+01</span><span class="s0">, </span><span class="s3">5.997429801625946311e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.759397735321817891e+02</span><span class="s0">, </span><span class="s3">6.033272773532181418e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.827933311233055065e+02</span><span class="s0">, </span><span class="s3">6.071867331123305121e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">2.472312362505917918e+02</span><span class="s0">, </span><span class="s3">6.113601236250591683e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">2.877470049336488955e+02</span><span class="s0">, </span><span class="s3">6.158748004933649099e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">2.634066336693540507e+02</span><span class="s0">, </span><span class="s3">6.207426633669354487e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.819572770763625158e+02</span><span class="s0">, </span><span class="s3">6.259576277076362203e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.175034606274621183e+02</span><span class="s0">, </span><span class="s3">6.314971460627461965e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">4.769898649718379602e+01</span><span class="s0">, </span><span class="s3">6.373272986497183410e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.419578280287896632e+01</span><span class="s0">, </span><span class="s3">6.434068217197121157e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">6.267929662760798237e+01</span><span class="s0">, </span><span class="s3">6.496914703372392069e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">6.196413196753746888e+01</span><span class="s0">, </span><span class="s3">6.561378868032462378e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">5.019769125317907310e+01</span><span class="s0">, </span><span class="s3">6.627066308746821051e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">4.665364933213822951e+01</span><span class="s0">, </span><span class="s3">6.693621350667861407e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">3.662430749527266016e+01</span><span class="s0">, </span><span class="s3">6.760719692504727391e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">7.545680850246480986e+01</span><span class="s0">, </span><span class="s3">6.828066191497535328e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">6.052940492147536133e+01</span><span class="s0">, </span><span class="s3">6.895388595078524304e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">6.029518881462354329e+01</span><span class="s0">, </span><span class="s3">6.962461811185376064e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">2.187042136652689805e+01</span><span class="s0">, </span><span class="s3">7.029098578633473153e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">2.380067926824722235e+01</span><span class="s0">, </span><span class="s3">7.095149320731752596e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">7.119129802169481991e+00</span><span class="s0">, </span><span class="s3">7.160478129802169860e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">3.194497359120850888e+01</span><span class="s0">, </span><span class="s3">7.224963973591208742e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.897137038934124575e+01</span><span class="s0">, </span><span class="s3">7.288481370389341464e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.832687287845146784e+01</span><span class="s0">, </span><span class="s3">7.350884872878451461e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">4.600482336597542599e+01</span><span class="s0">, </span><span class="s3">7.412017176634024509e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">2.489047706403016491e+01</span><span class="s0">, </span><span class="s3">7.471709522935970199e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">6.305909392127250612e+01</span><span class="s0">, </span><span class="s3">7.529821906078727807e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">4.585212309498183458e+01</span><span class="s0">, </span><span class="s3">7.586229876905018500e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">9.314260180878318351e+01</span><span class="s0">, </span><span class="s3">7.640848398191216802e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.129819097095369216e+02</span><span class="s0">, </span><span class="s3">7.693621090290463144e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.204662123176703972e+02</span><span class="s0">, </span><span class="s3">7.744549787682329224e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.336860614601246198e+02</span><span class="s0">, </span><span class="s3">7.793706938539875409e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.034567175813735957e+02</span><span class="s0">, </span><span class="s3">7.841240282418626521e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.403118873372050075e+02</span><span class="s0">, </span><span class="s3">7.887381112662795204e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.271726169351004501e+02</span><span class="s0">, </span><span class="s3">7.932425383064899506e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">8.271925765282139764e+01</span><span class="s0">, </span><span class="s3">7.976756742347178260e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">3.197432211752584408e+01</span><span class="s0">, </span><span class="s3">8.020838322117525422e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.150209535194062482e+02</span><span class="s0">, </span><span class="s3">8.065184953519406008e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.064694837456772802e+02</span><span class="s0">, </span><span class="s3">8.110291483745677397e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.190428718925368230e+02</span><span class="s0">, </span><span class="s3">8.156580871892536379e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.353635336292991269e+02</span><span class="s0">, </span><span class="s3">8.204409533629299403e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">9.644348283027102298e+01</span><span class="s0">, </span><span class="s3">8.254059482830271008e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">6.143413116116607853e+01</span><span class="s0">, </span><span class="s3">8.305728131161165948e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">3.019161311097923317e+01</span><span class="s0">, </span><span class="s3">8.359552613110980019e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.384333163552582846e+00</span><span class="s0">, </span><span class="s3">8.415631666836447039e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">4.156016073666614830e+01</span><span class="s0">, </span><span class="s3">8.474045160736666730e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">4.843882841860977351e+01</span><span class="s0">, </span><span class="s3">8.534873828418609264e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">6.706442838867042155e+01</span><span class="s0">, </span><span class="s3">8.598172428388670596e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">2.019644488579979225e+01</span><span class="s0">, </span><span class="s3">8.663965444885800025e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">4.316446881084630149e+00</span><span class="s0">, </span><span class="s3">8.732235446881084499e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">4.435061943264736328e+01</span><span class="s0">, </span><span class="s3">8.802952380567352520e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">2.820550564155564643e+01</span><span class="s0">, </span><span class="s3">8.876083494358445023e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">5.155624419490777655e+01</span><span class="s0">, </span><span class="s3">8.951623755805092514e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">4.318760899315748247e+00</span><span class="s0">, </span><span class="s3">9.029585760899315574e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">6.534632828542271454e+01</span><span class="s0">, </span><span class="s3">9.110014328285422380e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">7.226757738268497633e+01</span><span class="s0">, </span><span class="s3">9.192951577382684263e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">9.412378615444868046e+01</span><span class="s0">, </span><span class="s3">9.278398786154448317e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.191240653288368776e+02</span><span class="s0">, </span><span class="s3">9.366312065328836979e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">4.953669826751865912e+01</span><span class="s0">, </span><span class="s3">9.456588698267518339e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">6.017251579067487910e+01</span><span class="s0">, </span><span class="s3">9.549051515790675694e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">5.103438828313483100e+01</span><span class="s0">, </span><span class="s3">9.643492388283135369e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">7.343057830678117170e+01</span><span class="s0">, </span><span class="s3">9.739665578306781754e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">2.774245193054957781e+01</span><span class="s0">, </span><span class="s3">9.837293451930549054e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">3.380481112519191811e+00</span><span class="s0">, </span><span class="s3">9.936052481112519672e+03</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">2.672779877794346248e+01</span><span class="s0">, </span><span class="s3">1.003560179877794326e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">3.217342505148371856e+01</span><span class="s0">, </span><span class="s3">1.013559842505148299e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">4.140567518359966925e+01</span><span class="s0">, </span><span class="s3">1.023568267518359971e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">6.687756033938057953e+00</span><span class="s0">, </span><span class="s3">1.033547475603393832e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">7.300600408459467872e+01</span><span class="s0">, </span><span class="s3">1.043456899591540605e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">6.862345670680042531e+01</span><span class="s0">, </span><span class="s3">1.053255554329319966e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">5.497882461487461114e+01</span><span class="s0">, </span><span class="s3">1.062907017538512628e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">9.612244093055960548e+01</span><span class="s0">, </span><span class="s3">1.072379155906944106e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.978212770103891671e+02</span><span class="s0">, </span><span class="s3">1.081643272298961165e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.362772276848754700e+02</span><span class="s0">, </span><span class="s3">1.090676677231512440e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">2.637635494867263333e+02</span><span class="s0">, </span><span class="s3">1.099469045051327339e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.876813256815166824e+02</span><span class="s0">, </span><span class="s3">1.108018567431848351e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.711447873158413131e+02</span><span class="s0">, </span><span class="s3">1.116339921268415856e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">5.257586460826678376e+01</span><span class="s0">, </span><span class="s3">1.124459513539173349e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">4.710652228531762375e+01</span><span class="s0">, </span><span class="s3">1.132414447771468258e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">6.237613484241046535e+01</span><span class="s0">, </span><span class="s3">1.140245113484241119e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">9.982044354035315337e+01</span><span class="s0">, </span><span class="s3">1.147994844354035376e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">7.916275548997509759e+01</span><span class="s0">, </span><span class="s3">1.155703075548997549e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">9.526003459472303803e+01</span><span class="s0">, </span><span class="s3">1.163403003459472347e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.147987680369169539e+02</span><span class="s0">, </span><span class="s3">1.171122876803691724e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.900259054765901965e+02</span><span class="s0">, </span><span class="s3">1.178884990547659072e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">2.212256473439556430e+02</span><span class="s0">, </span><span class="s3">1.186704464734395515e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">2.071394278781845060e+02</span><span class="s0">, </span><span class="s3">1.194584542787818464e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">8.968541528904825100e+01</span><span class="s0">, </span><span class="s3">1.202514641528904758e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">6.189531564415665343e+01</span><span class="s0">, </span><span class="s3">1.210471231564415575e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">5.662878162551714922e+01</span><span class="s0">, </span><span class="s3">1.218425178162551674e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">4.961678134413705266e+01</span><span class="s0">, </span><span class="s3">1.226343478134413635e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">3.836288992144181975e+01</span><span class="s0">, </span><span class="s3">1.234189588992144127e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">8.956671991456460091e+00</span><span class="s0">, </span><span class="s3">1.241923867199145570e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">3.907028461866866564e+01</span><span class="s0">, </span><span class="s3">1.249504271538133071e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.865299000184495526e+01</span><span class="s0">, </span><span class="s3">1.256888200999815490e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">4.279803532226833340e+01</span><span class="s0">, </span><span class="s3">1.264035496467773191e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">3.962735362631610769e+01</span><span class="s0">, </span><span class="s3">1.270907164637368442e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.412691291877854383e+02</span><span class="s0">, </span><span class="s3">1.277466887081221466e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.256537791844366438e+02</span><span class="s0">, </span><span class="s3">1.283680822081556289e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">7.067642758858892194e+01</span><span class="s0">, </span><span class="s3">1.289523957241141034e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.108876647603192396e+02</span><span class="s0">, </span><span class="s3">1.294979133523968085e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">9.956490829291760747e+01</span><span class="s0">, </span><span class="s3">1.300033609170708223e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.571612709880937473e+02</span><span class="s0">, </span><span class="s3">1.304681572901190702e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">2.318746375812715996e+02</span><span class="s0">, </span><span class="s3">1.308923436241872878e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">2.635546670125277160e+02</span><span class="s0">, </span><span class="s3">1.312769433298747208e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">2.044220965739259555e+02</span><span class="s0">, </span><span class="s3">1.316244290342607383e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">2.213739418903714977e+02</span><span class="s0">, </span><span class="s3">1.319389205810962812e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.020184547767112235e+02</span><span class="s0">, </span><span class="s3">1.322258154522328914e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.072694716663390864e+02</span><span class="s0">, </span><span class="s3">1.324918947166633916e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">3.490477058718843182e+02</span><span class="s0">, </span><span class="s3">1.327445770587188417e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">3.975570728533530200e+02</span><span class="s0">, </span><span class="s3">1.329906107285335383e+04</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">3.331152428080622485e+02</span><span class="s0">, </span><span class="s3">1.332345624280806260e+04</span><span class="s1">]])</span>
    <span class="s1">dta = macrodata.load_pandas().data[</span><span class="s4">'realgdp'</span><span class="s1">].values</span>
    <span class="s1">res = column_stack((hpfilter(dta</span><span class="s0">, </span><span class="s3">1600</span><span class="s1">)))</span>
    <span class="s1">assert_almost_equal(res</span><span class="s0">, </span><span class="s1">hpfilt_res</span><span class="s0">, </span><span class="s3">6</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_cfitz_filter():</span>
    <span class="s2"># Test Christiano-Fitzgerald Filter. Results taken from R.</span>
    <span class="s2"># NOTE: The Stata mata code and the matlab code it's based on are wrong.</span>
    <span class="s1">cfilt_res = array([</span>
        <span class="s1">[</span><span class="s3">0.712599537179426</span><span class="s0">, </span><span class="s3">0.439563468233128</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.06824041304411</span><span class="s0">, </span><span class="s3">0.352886666575907</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.19422467791128</span><span class="s0">, </span><span class="s3">0.257297004260607</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.970845473140327</span><span class="s0">, </span><span class="s3">0.114504692143872</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.467026976628563</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.070734782329146</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.089153511514031</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.238609685132605</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.452339254128573</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.32376584042956</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.513231214461187</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.314288554228112</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.352372578720063</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.258815055101336</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.160282602521333</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.215076844089567</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.0918782593827686</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.194120745417214</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.168083823205437</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.158327420072693</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.291595204965808</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.0742727139742986</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.348638756841307</span><span class="s0">, </span><span class="s3">0.037008291163602</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.304328040874631</span><span class="s0">, </span><span class="s3">0.108196527328748</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.215933150969686</span><span class="s0">, </span><span class="s3">0.0869231107437175</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.165632621390694</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.0130556619786275</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.182326839507151</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.126570926191824</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.223737786804725</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.205535321806185</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.228939291453403</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.269110078201836</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.185518327227038</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.375976507132174</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.143900152461529</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.53760115656157</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.162749541550174</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.660065018626038</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.236263634756884</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.588542352053736</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.275785854309211</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.236867929421996</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.173666515108109</span><span class="s0">, </span><span class="s3">0.303436335579219</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.0963135720251639</span><span class="s0">, </span><span class="s3">0.779772338801993</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.427070069032285</span><span class="s0">, </span><span class="s3">0.929108075350647</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.629034743259998</span><span class="s0">, </span><span class="s3">0.658330841002647</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.557941248993624</span><span class="s0">, </span><span class="s3">0.118500049361018</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.227866624051603</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.385048321099911</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.179878859883227</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.582223992561493</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.428263000051965</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.394053702908091</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.381640684645912</span><span class="s0">, </span><span class="s3">0.0445437406977307</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.0942745548364887</span><span class="s0">, </span><span class="s3">0.493997792757968</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.238132391504895</span><span class="s0">, </span><span class="s3">0.764519811304315</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.431293754256291</span><span class="s0">, </span><span class="s3">0.814755206427316</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.455010435813661</span><span class="s0">, </span><span class="s3">0.745567043101108</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.452800768971269</span><span class="s0">, </span><span class="s3">0.709401694610443</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.615754619329312</span><span class="s0">, </span><span class="s3">0.798293251119636</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.00256335412457</span><span class="s0">, </span><span class="s3">0.975856845059388</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.44841039351691</span><span class="s0">, </span><span class="s3">1.09097252730799</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.64651971120370</span><span class="s0">, </span><span class="s3">0.967823457118036</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.35534532901802</span><span class="s0">, </span><span class="s3">0.522397724737059</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.580492790312048</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.16941343361609</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.410746188031773</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.90760401289056</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.26148406066881</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.49592867122591</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.75784179124566</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.87404167409849</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.94478553960064</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.14586210891112</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">2.03751202708559</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.465855239868</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">2.20376059354166</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.86294187189049</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">2.39722338315852</span><span class="s0">, </span><span class="s1">-</span><span class="s3">3.15004697654831</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">2.38032366161537</span><span class="s0">, </span><span class="s1">-</span><span class="s3">3.01390466643222</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.91798022532025</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.23395210271226</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.982318490353716</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.861346053067472</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.199047030343412</span><span class="s0">, </span><span class="s3">0.790266582335616</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.28582776574786</span><span class="s0">, </span><span class="s3">2.33731327460104</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">2.03565905376430</span><span class="s0">, </span><span class="s3">3.54085486821911</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">2.41201557412526</span><span class="s0">, </span><span class="s3">4.36519456268955</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">2.52011070482927</span><span class="s0">, </span><span class="s3">4.84810517685452</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">2.45618479815452</span><span class="s0">, </span><span class="s3">4.92906708807477</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">2.22272146945388</span><span class="s0">, </span><span class="s3">4.42591058990048</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.78307567169034</span><span class="s0">, </span><span class="s3">3.20962906108388</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.18234431860844</span><span class="s0">, </span><span class="s3">1.42568060336985</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.590069172333348</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.461896808688991</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.19662302949837</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.89020992539465</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.048307034171166</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.53490571941987</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.0141956981899000</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.50020338531674</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.230505187108187</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.20625973569823</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.700947410386801</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.06643697511048</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.27085123163060</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.21536883679783</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.64082547897928</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.49016921117735</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.62286182971254</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.63948740221362</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.31609762181362</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.54685250637904</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.03085567704873</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.27157435428923</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.01100120380112</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.90404507430561</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.19823958399826</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.4123209792214</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.26398933608383</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.654000086153317</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.904710628949692</span><span class="s0">, </span><span class="s3">0.447960016248203</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.151340093679588</span><span class="s0">, </span><span class="s3">1.73970411237156</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.592926881165989</span><span class="s0">, </span><span class="s3">2.85741581650685</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.851660587507523</span><span class="s0">, </span><span class="s3">3.4410446351716</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.480324393352127</span><span class="s0">, </span><span class="s3">3.36870271362297</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.165153230782417</span><span class="s0">, </span><span class="s3">2.82003806696544</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.459235919375844</span><span class="s0">, </span><span class="s3">2.12858991660866</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.0271158842479935</span><span class="s0">, </span><span class="s3">1.55840980891556</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.18759188180671</span><span class="s0">, </span><span class="s3">1.17980298478623</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">2.43238266962309</span><span class="s0">, </span><span class="s3">0.904011534980672</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">3.08277213720132</span><span class="s0">, </span><span class="s3">0.595286911949837</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">2.79953663720953</span><span class="s0">, </span><span class="s3">0.148014782859571</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.73694442845833</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.496297332023011</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.357638079951977</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.33108149877570</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.891418825216945</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.22650083183366</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.77646467793627</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.89359299718574</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">2.24614790863088</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.97921619243347</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">2.29048879096607</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.30003092779280</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.87929656465888</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.05298381273274</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.04510101454788</span><span class="s0">, </span><span class="s3">0.215837488618531</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.00413338508394524</span><span class="s0">, </span><span class="s3">0.937866257924888</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.906870625251025</span><span class="s0">, </span><span class="s3">0.92664365343019</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.33869057593416</span><span class="s0">, </span><span class="s3">0.518564571494679</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.22659678454440</span><span class="s0">, </span><span class="s3">0.288096869652890</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.79380139656044</span><span class="s0">, </span><span class="s3">0.541053084632774</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.38029431865832</span><span class="s0">, </span><span class="s3">1.01905199983437</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.183929413600038</span><span class="s0">, </span><span class="s3">1.10529586616777</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.140045425897033</span><span class="s0">, </span><span class="s3">0.393618564826736</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.0337313182352219</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.86431819007665</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.269208622829813</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.85638085246792</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.687276639992166</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.82275359004533</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.00161592325614</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.692695765071617</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.06320089194036</span><span class="s0">, </span><span class="s3">0.803577361347341</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.927152307196776</span><span class="s0">, </span><span class="s3">1.67366338751788</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.786802101366614</span><span class="s0">, </span><span class="s3">1.42564362251793</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.772970884572502</span><span class="s0">, </span><span class="s3">0.426446388877964</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.81275662801789</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.437721213831647</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.686831250382476</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.504255468075149</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.237936463020255</span><span class="s0">, </span><span class="s3">0.148656301898438</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.459631879129522</span><span class="s0">, </span><span class="s3">0.832925905720478</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.12717379822508</span><span class="s0">, </span><span class="s3">0.889455302576383</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.48640453200855</span><span class="s0">, </span><span class="s3">0.268042676202216</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.46515245776211</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.446505038539178</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.22993484959115</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.563868578181134</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.0272100765927</span><span class="s0">, </span><span class="s3">0.0996849952196907</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.979191212438404</span><span class="s0">, </span><span class="s3">1.05053652824665</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.00733490030391</span><span class="s0">, </span><span class="s3">1.51658415000556</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.932192535457706</span><span class="s0">, </span><span class="s3">1.06262774912638</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.643374300839414</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.0865180803476065</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.186885168954461</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.24799408923277</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.290842337365465</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.80035611156538</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.669446735516495</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.58847333561510</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.928915624595538</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.932116966867929</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.11758635926997</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.307879396807850</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.26832454569756</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.00856199983957032</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.35755577149251</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.0303537516690989</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.34244112665546</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.196807620887435</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.22227976023299</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.342062643495923</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.04601473486818</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.390474392372016</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.85158508717846</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.322164402093596</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.605033439160543</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.126930141915954</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.218304303942818</span><span class="s0">, </span><span class="s3">0.179551077808122</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.352173017779006</span><span class="s0">, </span><span class="s3">0.512327303000081</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.01389600097229</span><span class="s0">, </span><span class="s3">0.733397490572755</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.55149778750607</span><span class="s0">, </span><span class="s3">0.748740387440165</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.75499674757591</span><span class="s0">, </span><span class="s3">0.601759717901009</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.56636057468633</span><span class="s0">, </span><span class="s3">0.457705308377562</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.12239792537274</span><span class="s0">, </span><span class="s3">0.470849913286519</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.655802600286141</span><span class="s0">, </span><span class="s3">0.646142040378738</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.335285115340180</span><span class="s0">, </span><span class="s3">0.824103600255079</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.173454596506888</span><span class="s0">, </span><span class="s3">0.808068498175582</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.0666753011315252</span><span class="s0">, </span><span class="s3">0.521488214487996</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.0842367474816212</span><span class="s0">, </span><span class="s3">0.0583493276173476</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.285604762631464</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.405958418332253</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.465735422869919</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.747800086512926</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.563586691231348</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.94982272350799</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.598110322024572</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.04736894794361</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.65216025756061</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.04858365218822</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.789663117801624</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.924145633093637</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.984704045337959</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.670740724179446</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.12449565589348</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.359476803003931</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.07878318723543</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.092290938944355</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.775555435407062</span><span class="s0">, </span><span class="s3">0.102132527529259</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.231610677329856</span><span class="s0">, </span><span class="s3">0.314409560305622</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.463192794235131</span><span class="s0">, </span><span class="s3">0.663523546243286</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.17416973448423</span><span class="s0">, </span><span class="s3">1.13156902460931</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.74112278814906</span><span class="s0">, </span><span class="s3">1.48967153067024</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">2.00320855757084</span><span class="s0">, </span><span class="s3">1.42571085941843</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.8529912317336</span><span class="s0">, </span><span class="s3">0.802460519079555</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.30747261947211</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.169219078629572</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.540237070403222</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.01621539672694</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.177136817092375</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.3130784867977</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.611981468823591</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.982477824460773</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.700240028737747</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.344919609255406</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.572396497740112</span><span class="s0">, </span><span class="s3">0.125083535035390</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.450934466600975</span><span class="s0">, </span><span class="s3">0.142553112732280</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.494020014254326</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.211429053871656</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.701707589094918</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.599602868825992</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.94721339346157</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.710669870591623</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.09297139748946</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.47846194092245</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.08850658866583</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.082258450179988</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.976082880696692</span><span class="s0">, </span><span class="s3">0.235758921309309</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.81885695346771</span><span class="s0">, </span><span class="s3">0.365298185204303</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.63165529525553</span><span class="s0">, </span><span class="s3">0.384725179378064</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.37983149226421</span><span class="s0">, </span><span class="s3">0.460240196164378</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.0375551354277652</span><span class="s0">, </span><span class="s3">0.68580913832794</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.361996927427804</span><span class="s0">, </span><span class="s3">0.984470835955107</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.739920615366072</span><span class="s0">, </span><span class="s3">1.13195975020298</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.03583478061534</span><span class="s0">, </span><span class="s3">0.88812510421667</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.25614938962160</span><span class="s0">, </span><span class="s3">0.172561520611839</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.45295030231799</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.804979390544485</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.64887158748426</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.55662011197859</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.78022721495313</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.52921975346218</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.71945683859668</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.462240366424548</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1.36728880239190</span><span class="s0">, </span><span class="s3">1.31213774341268</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0.740173894315912</span><span class="s0">, </span><span class="s3">2.88362740582926</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.0205364331835904</span><span class="s0">, </span><span class="s3">3.20319080963167</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">0.725643970956428</span><span class="s0">, </span><span class="s3">1.75222466531151</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.23900506689782</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.998432917440275</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.52651897508678</span><span class="s0">, </span><span class="s1">-</span><span class="s3">3.72752870885448</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.62857516631435</span><span class="s0">, </span><span class="s1">-</span><span class="s3">5.00551707196292</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.59657420180451</span><span class="s0">, </span><span class="s1">-</span><span class="s3">4.18499132634584</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.45489013276495</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.81759097305637</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s3">1.21309542313047</span><span class="s0">, </span><span class="s3">0.722029457352468</span><span class="s1">]])</span>
    <span class="s1">dta = macrodata.load_pandas().data[[</span><span class="s4">'tbilrate'</span><span class="s0">, </span><span class="s4">'infl'</span><span class="s1">]].values[</span><span class="s3">1</span><span class="s1">:]</span>
    <span class="s1">cyc</span><span class="s0">, </span><span class="s1">trend = cffilter(dta)</span>
    <span class="s1">assert_almost_equal(cyc</span><span class="s0">, </span><span class="s1">cfilt_res</span><span class="s0">, </span><span class="s3">8</span><span class="s1">)</span>
    <span class="s2"># do 1d</span>
    <span class="s1">cyc</span><span class="s0">, </span><span class="s1">trend = cffilter(dta[:</span><span class="s0">, </span><span class="s3">1</span><span class="s1">])</span>
    <span class="s1">assert_almost_equal(cyc</span><span class="s0">, </span><span class="s1">cfilt_res[:</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s3">8</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_bking_pandas():</span>
    <span class="s2"># 1d</span>
    <span class="s1">dta = macrodata.load_pandas().data</span>
    <span class="s1">index = date_range(start=</span><span class="s4">'1959-01-01'</span><span class="s0">, </span><span class="s1">end=</span><span class="s4">'2009-10-01'</span><span class="s0">, </span><span class="s1">freq=</span><span class="s4">'Q'</span><span class="s1">)</span>
    <span class="s1">dta.index = index</span>
    <span class="s1">filtered = bkfilter(dta[</span><span class="s4">&quot;infl&quot;</span><span class="s1">])</span>
    <span class="s1">nd_filtered = bkfilter(dta[</span><span class="s4">'infl'</span><span class="s1">].values)</span>
    <span class="s1">assert_equal(filtered.values</span><span class="s0">, </span><span class="s1">nd_filtered)</span>
    <span class="s1">assert_equal(filtered.index[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">datetime(</span><span class="s3">1962</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">31</span><span class="s1">))</span>
    <span class="s1">assert_equal(filtered.index[-</span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">datetime(</span><span class="s3">2006</span><span class="s0">, </span><span class="s3">9</span><span class="s0">, </span><span class="s3">30</span><span class="s1">))</span>
    <span class="s1">assert_equal(filtered.name</span><span class="s0">, </span><span class="s4">&quot;infl_cycle&quot;</span><span class="s1">)</span>

    <span class="s2"># 2d</span>
    <span class="s1">filtered = bkfilter(dta[[</span><span class="s4">&quot;infl&quot;</span><span class="s0">, </span><span class="s4">&quot;unemp&quot;</span><span class="s1">]])</span>
    <span class="s1">nd_filtered = bkfilter(dta[[</span><span class="s4">'infl'</span><span class="s0">, </span><span class="s4">'unemp'</span><span class="s1">]].values)</span>
    <span class="s1">assert_equal(filtered.values</span><span class="s0">, </span><span class="s1">nd_filtered)</span>
    <span class="s1">assert_equal(filtered.index[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">datetime(</span><span class="s3">1962</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">31</span><span class="s1">))</span>
    <span class="s1">assert_equal(filtered.index[-</span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">datetime(</span><span class="s3">2006</span><span class="s0">, </span><span class="s3">9</span><span class="s0">, </span><span class="s3">30</span><span class="s1">))</span>
    <span class="s1">assert_equal(filtered.columns.values</span><span class="s0">, </span><span class="s1">[</span><span class="s4">&quot;infl_cycle&quot;</span><span class="s0">, </span><span class="s4">&quot;unemp_cycle&quot;</span><span class="s1">])</span>


<span class="s0">def </span><span class="s1">test_cfitz_pandas():</span>
    <span class="s2"># 1d</span>
    <span class="s1">dta = macrodata.load_pandas().data</span>
    <span class="s1">index = date_range(start=</span><span class="s4">'1959-01-01'</span><span class="s0">, </span><span class="s1">end=</span><span class="s4">'2009-10-01'</span><span class="s0">, </span><span class="s1">freq=</span><span class="s4">'Q'</span><span class="s1">)</span>
    <span class="s1">dta.index = index</span>
    <span class="s1">cycle</span><span class="s0">, </span><span class="s1">trend = cffilter(dta[</span><span class="s4">&quot;infl&quot;</span><span class="s1">])</span>
    <span class="s1">ndcycle</span><span class="s0">, </span><span class="s1">ndtrend = cffilter(dta[</span><span class="s4">'infl'</span><span class="s1">].values)</span>
    <span class="s1">assert_allclose(cycle.values</span><span class="s0">, </span><span class="s1">ndcycle</span><span class="s0">, </span><span class="s1">rtol=</span><span class="s3">1e-14</span><span class="s1">)</span>
    <span class="s1">assert_equal(cycle.index[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">datetime(</span><span class="s3">1959</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">31</span><span class="s1">))</span>
    <span class="s1">assert_equal(cycle.index[-</span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">datetime(</span><span class="s3">2009</span><span class="s0">, </span><span class="s3">9</span><span class="s0">, </span><span class="s3">30</span><span class="s1">))</span>
    <span class="s1">assert_equal(cycle.name</span><span class="s0">, </span><span class="s4">&quot;infl_cycle&quot;</span><span class="s1">)</span>

    <span class="s2"># 2d</span>
    <span class="s1">cycle</span><span class="s0">, </span><span class="s1">trend = cffilter(dta[[</span><span class="s4">&quot;infl&quot;</span><span class="s0">, </span><span class="s4">&quot;unemp&quot;</span><span class="s1">]])</span>
    <span class="s1">ndcycle</span><span class="s0">, </span><span class="s1">ndtrend = cffilter(dta[[</span><span class="s4">'infl'</span><span class="s0">, </span><span class="s4">'unemp'</span><span class="s1">]].values)</span>
    <span class="s1">assert_allclose(cycle.values</span><span class="s0">, </span><span class="s1">ndcycle</span><span class="s0">, </span><span class="s1">rtol=</span><span class="s3">1e-14</span><span class="s1">)</span>
    <span class="s1">assert_equal(cycle.index[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">datetime(</span><span class="s3">1959</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">31</span><span class="s1">))</span>
    <span class="s1">assert_equal(cycle.index[-</span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">datetime(</span><span class="s3">2009</span><span class="s0">, </span><span class="s3">9</span><span class="s0">, </span><span class="s3">30</span><span class="s1">))</span>
    <span class="s1">assert_equal(cycle.columns.values</span><span class="s0">, </span><span class="s1">[</span><span class="s4">&quot;infl_cycle&quot;</span><span class="s0">, </span><span class="s4">&quot;unemp_cycle&quot;</span><span class="s1">])</span>


<span class="s0">def </span><span class="s1">test_hpfilter_pandas():</span>
    <span class="s1">dta = macrodata.load_pandas().data</span>
    <span class="s1">index = date_range(start=</span><span class="s4">'1959-01-01'</span><span class="s0">, </span><span class="s1">end=</span><span class="s4">'2009-10-01'</span><span class="s0">, </span><span class="s1">freq=</span><span class="s4">'Q'</span><span class="s1">)</span>
    <span class="s1">dta.index = index</span>
    <span class="s1">cycle</span><span class="s0">, </span><span class="s1">trend = hpfilter(dta[</span><span class="s4">&quot;realgdp&quot;</span><span class="s1">])</span>
    <span class="s1">ndcycle</span><span class="s0">, </span><span class="s1">ndtrend = hpfilter(dta[</span><span class="s4">'realgdp'</span><span class="s1">].values)</span>
    <span class="s1">assert_equal(cycle.values</span><span class="s0">, </span><span class="s1">ndcycle)</span>
    <span class="s1">assert_equal(cycle.index[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">datetime(</span><span class="s3">1959</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">31</span><span class="s1">))</span>
    <span class="s1">assert_equal(cycle.index[-</span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">datetime(</span><span class="s3">2009</span><span class="s0">, </span><span class="s3">9</span><span class="s0">, </span><span class="s3">30</span><span class="s1">))</span>
    <span class="s1">assert_equal(cycle.name</span><span class="s0">, </span><span class="s4">&quot;realgdp_cycle&quot;</span><span class="s1">)</span>


<span class="s0">class </span><span class="s1">TestFilters:</span>
    <span class="s1">@classmethod</span>
    <span class="s0">def </span><span class="s1">setup_class(cls):</span>
        <span class="s2"># even</span>
        <span class="s1">data = [-</span><span class="s3">50</span><span class="s0">, </span><span class="s3">175</span><span class="s0">, </span><span class="s3">149</span><span class="s0">, </span><span class="s3">214</span><span class="s0">, </span><span class="s3">247</span><span class="s0">, </span><span class="s3">237</span><span class="s0">, </span><span class="s3">225</span><span class="s0">, </span><span class="s3">329</span><span class="s0">, </span><span class="s3">729</span><span class="s0">, </span><span class="s3">809</span><span class="s0">,</span>
                <span class="s3">530</span><span class="s0">, </span><span class="s3">489</span><span class="s0">, </span><span class="s3">540</span><span class="s0">, </span><span class="s3">457</span><span class="s0">, </span><span class="s3">195</span><span class="s0">, </span><span class="s3">176</span><span class="s0">, </span><span class="s3">337</span><span class="s0">, </span><span class="s3">239</span><span class="s0">, </span><span class="s3">128</span><span class="s0">, </span><span class="s3">102</span><span class="s0">,</span>
                <span class="s3">232</span><span class="s0">, </span><span class="s3">429</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">98</span><span class="s0">, </span><span class="s3">43</span><span class="s0">, </span><span class="s1">-</span><span class="s3">141</span><span class="s0">, </span><span class="s1">-</span><span class="s3">77</span><span class="s0">, </span><span class="s1">-</span><span class="s3">13</span><span class="s0">, </span><span class="s3">125</span><span class="s0">, </span><span class="s3">361</span><span class="s0">, </span><span class="s1">-</span><span class="s3">45</span><span class="s0">, </span><span class="s3">184</span><span class="s1">]</span>
        <span class="s1">cls.data = DataFrame(data</span><span class="s0">, </span><span class="s1">date_range(start=</span><span class="s4">'1/1/1951'</span><span class="s0">,</span>
                                              <span class="s1">periods=len(data)</span><span class="s0">,</span>
                                              <span class="s1">freq=</span><span class="s4">'Q'</span><span class="s1">))</span>
        <span class="s1">data[</span><span class="s3">9</span><span class="s1">] = np.nan</span>
        <span class="s1">cls.datana = DataFrame(data</span><span class="s0">, </span><span class="s1">date_range(start=</span><span class="s4">'1/1/1951'</span><span class="s0">,</span>
                                                <span class="s1">periods=len(data)</span><span class="s0">,</span>
                                                <span class="s1">freq=</span><span class="s4">'Q'</span><span class="s1">))</span>
        <span class="s0">from </span><span class="s1">.results </span><span class="s0">import </span><span class="s1">filter_results</span>
        <span class="s1">cls.expected = filter_results</span>

    <span class="s0">def </span><span class="s1">test_convolution(self):</span>
        <span class="s1">x = self.data.values.squeeze()</span>
        <span class="s1">res = convolution_filter(x</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.75</span><span class="s0">, </span><span class="s3">.25</span><span class="s1">])</span>
        <span class="s1">expected = self.expected.conv2</span>
        <span class="s1">np.testing.assert_almost_equal(res</span><span class="s0">, </span><span class="s1">expected)</span>

        <span class="s1">res = convolution_filter(x</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.75</span><span class="s0">, </span><span class="s3">.25</span><span class="s1">]</span><span class="s0">, </span><span class="s1">nsides=</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">expected = self.expected.conv1</span>
        <span class="s1">np.testing.assert_almost_equal(res</span><span class="s0">, </span><span class="s1">expected)</span>

        <span class="s1">x = self.datana.values.squeeze()</span>
        <span class="s1">res = convolution_filter(x</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.75</span><span class="s0">, </span><span class="s3">.25</span><span class="s1">])</span>
        <span class="s1">expected = self.expected.conv2_na</span>
        <span class="s1">np.testing.assert_almost_equal(res</span><span class="s0">, </span><span class="s1">expected)</span>

        <span class="s1">res = convolution_filter(x</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.75</span><span class="s0">, </span><span class="s3">.25</span><span class="s1">]</span><span class="s0">, </span><span class="s1">nsides=</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">expected = self.expected.conv1_na</span>
        <span class="s1">np.testing.assert_almost_equal(res</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s0">def </span><span class="s1">test_convolution2d(self):</span>
        <span class="s1">x = self.data.values</span>
        <span class="s1">res = convolution_filter(x</span><span class="s0">, </span><span class="s1">[[</span><span class="s3">.75</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.25</span><span class="s1">]])</span>
        <span class="s1">expected = self.expected.conv2</span>
        <span class="s1">np.testing.assert_almost_equal(res</span><span class="s0">, </span><span class="s1">expected[:</span><span class="s0">, None</span><span class="s1">])</span>
        <span class="s1">res = convolution_filter(np.c_[x</span><span class="s0">, </span><span class="s1">x]</span><span class="s0">, </span><span class="s1">[[</span><span class="s3">.75</span><span class="s0">, </span><span class="s3">.75</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.25</span><span class="s0">, </span><span class="s3">.25</span><span class="s1">]])</span>
        <span class="s1">np.testing.assert_almost_equal(res</span><span class="s0">, </span><span class="s1">np.c_[expected</span><span class="s0">, </span><span class="s1">expected])</span>

        <span class="s1">res = convolution_filter(x</span><span class="s0">, </span><span class="s1">[[</span><span class="s3">.75</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.25</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">nsides=</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">expected = self.expected.conv1</span>
        <span class="s1">np.testing.assert_almost_equal(res</span><span class="s0">, </span><span class="s1">expected[:</span><span class="s0">, None</span><span class="s1">])</span>

        <span class="s1">x = self.datana.values</span>
        <span class="s1">res = convolution_filter(x</span><span class="s0">, </span><span class="s1">[[</span><span class="s3">.75</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.25</span><span class="s1">]])</span>
        <span class="s1">expected = self.expected.conv2_na</span>
        <span class="s1">np.testing.assert_almost_equal(res</span><span class="s0">, </span><span class="s1">expected[:</span><span class="s0">, None</span><span class="s1">])</span>

        <span class="s1">res = convolution_filter(x</span><span class="s0">, </span><span class="s1">[[</span><span class="s3">.75</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.25</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">nsides=</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">expected = self.expected.conv1_na</span>
        <span class="s1">np.testing.assert_almost_equal(res</span><span class="s0">, </span><span class="s1">expected[:</span><span class="s0">, None</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_recursive(self):</span>
        <span class="s1">x = self.data.values.squeeze()</span>
        <span class="s1">res = recursive_filter(x</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.75</span><span class="s0">, </span><span class="s3">.25</span><span class="s1">])</span>
        <span class="s1">expected = self.expected.recurse</span>
        <span class="s1">np.testing.assert_almost_equal(res</span><span class="s0">, </span><span class="s1">expected)</span>

        <span class="s1">res = recursive_filter(x</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.75</span><span class="s0">, </span><span class="s3">.25</span><span class="s1">]</span><span class="s0">, </span><span class="s1">init=[</span><span class="s3">150</span><span class="s0">, </span><span class="s3">100</span><span class="s1">])</span>
        <span class="s1">expected = self.expected.recurse_init</span>
        <span class="s1">np.testing.assert_almost_equal(res</span><span class="s0">, </span><span class="s1">expected)</span>

        <span class="s1">x = self.datana.values.squeeze()</span>
        <span class="s1">res = recursive_filter(x</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.75</span><span class="s0">, </span><span class="s3">.25</span><span class="s1">])</span>
        <span class="s1">expected = self.expected.recurse_na</span>
        <span class="s1">np.testing.assert_almost_equal(res</span><span class="s0">, </span><span class="s1">expected)</span>

        <span class="s1">res = recursive_filter(x</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.75</span><span class="s0">, </span><span class="s3">.25</span><span class="s1">]</span><span class="s0">, </span><span class="s1">init=[</span><span class="s3">150</span><span class="s0">, </span><span class="s3">100</span><span class="s1">])</span>
        <span class="s1">expected = self.expected.recurse_init_na</span>
        <span class="s1">np.testing.assert_almost_equal(res</span><span class="s0">, </span><span class="s1">expected)</span>

        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">recursive_filter</span><span class="s0">, </span><span class="s1">x</span><span class="s0">,</span>
                      <span class="s1">[</span><span class="s3">.75</span><span class="s0">, </span><span class="s3">.25</span><span class="s0">, </span><span class="s3">.5</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">150</span><span class="s0">, </span><span class="s3">100</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_pandas(self):</span>
        <span class="s1">start = datetime(</span><span class="s3">1951</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">31</span><span class="s1">)</span>
        <span class="s1">end = datetime(</span><span class="s3">1958</span><span class="s0">, </span><span class="s3">12</span><span class="s0">, </span><span class="s3">31</span><span class="s1">)</span>
        <span class="s1">x = self.data[</span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">res = convolution_filter(x</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.75</span><span class="s0">, </span><span class="s3">.25</span><span class="s1">])</span>
        <span class="s1">assert_(res.index[</span><span class="s3">0</span><span class="s1">] == start)</span>
        <span class="s1">assert_(res.index[-</span><span class="s3">1</span><span class="s1">] == end)</span>

        <span class="s1">res = convolution_filter(x</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.75</span><span class="s0">, </span><span class="s3">.25</span><span class="s1">]</span><span class="s0">, </span><span class="s1">nsides=</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">assert_(res.index[</span><span class="s3">0</span><span class="s1">] == start)</span>
        <span class="s2"># with no nan-padding q1 if not</span>
        <span class="s1">assert_(res.index[-</span><span class="s3">1</span><span class="s1">] == end)</span>

        <span class="s1">res = recursive_filter(x</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.75</span><span class="s0">, </span><span class="s3">.25</span><span class="s1">])</span>
        <span class="s1">assert_(res.index[</span><span class="s3">0</span><span class="s1">] == start)</span>
        <span class="s1">assert_(res.index[-</span><span class="s3">1</span><span class="s1">] == end)</span>

        <span class="s1">x = self.datana</span>
        <span class="s1">res = recursive_filter(x</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.75</span><span class="s0">, </span><span class="s3">.25</span><span class="s1">])</span>
        <span class="s1">assert_(res.index[</span><span class="s3">0</span><span class="s1">] == start)</span>
        <span class="s1">assert_(res.index[-</span><span class="s3">1</span><span class="s1">] == end)</span>

    <span class="s0">def </span><span class="s1">test_pandas2d(self):</span>
        <span class="s1">start = datetime(</span><span class="s3">1951</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">31</span><span class="s1">)</span>
        <span class="s1">end = datetime(</span><span class="s3">1958</span><span class="s0">, </span><span class="s3">12</span><span class="s0">, </span><span class="s3">31</span><span class="s1">)</span>
        <span class="s1">x = concat((self.data[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">self.data[</span><span class="s3">0</span><span class="s1">])</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">res = convolution_filter(x</span><span class="s0">, </span><span class="s1">[[</span><span class="s3">.75</span><span class="s0">, </span><span class="s3">.75</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.25</span><span class="s0">, </span><span class="s3">.25</span><span class="s1">]])</span>
        <span class="s1">assert_(res.index[</span><span class="s3">0</span><span class="s1">] == start)</span>
        <span class="s1">assert_(res.index[-</span><span class="s3">1</span><span class="s1">] == end)</span>

    <span class="s0">def </span><span class="s1">test_odd_length_filter(self):</span>
        <span class="s1">start = datetime(</span><span class="s3">1951</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">31</span><span class="s1">)</span>
        <span class="s1">end = datetime(</span><span class="s3">1958</span><span class="s0">, </span><span class="s3">12</span><span class="s0">, </span><span class="s3">31</span><span class="s1">)</span>
        <span class="s1">x = self.data[</span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">res = convolution_filter(x</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.75</span><span class="s0">, </span><span class="s3">.5</span><span class="s0">, </span><span class="s3">.3</span><span class="s0">, </span><span class="s3">.2</span><span class="s0">, </span><span class="s3">.1</span><span class="s1">])</span>
        <span class="s1">expected = self.expected.conv2_odd</span>
        <span class="s1">np.testing.assert_almost_equal(res.values.squeeze()</span><span class="s0">, </span><span class="s1">expected)</span>
        <span class="s1">np.testing.assert_(res.index[</span><span class="s3">0</span><span class="s1">] == start)</span>
        <span class="s1">np.testing.assert_(res.index[-</span><span class="s3">1</span><span class="s1">] == end)</span>

        <span class="s1">res = convolution_filter(x</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.75</span><span class="s0">, </span><span class="s3">.5</span><span class="s0">, </span><span class="s3">.3</span><span class="s0">, </span><span class="s3">.2</span><span class="s0">, </span><span class="s3">.1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">nsides=</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">expected = self.expected.conv1_odd</span>
        <span class="s1">np.testing.assert_almost_equal(res.values.squeeze()</span><span class="s0">, </span><span class="s1">expected)</span>
        <span class="s1">np.testing.assert_(res.index[</span><span class="s3">0</span><span class="s1">] == start)</span>
        <span class="s1">np.testing.assert_(res.index[-</span><span class="s3">1</span><span class="s1">] == end)</span>
        <span class="s2"># with no NAs</span>

        <span class="s2"># not a stable filter</span>
        <span class="s1">res = recursive_filter(x</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.75</span><span class="s0">, </span><span class="s3">.5</span><span class="s0">, </span><span class="s3">.3</span><span class="s0">, </span><span class="s3">.2</span><span class="s0">, </span><span class="s3">.1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">init=[</span><span class="s3">150</span><span class="s0">, </span><span class="s3">100</span><span class="s0">,</span>
                                                               <span class="s3">125</span><span class="s0">, </span><span class="s3">135</span><span class="s0">,</span>
                                                               <span class="s3">145</span><span class="s1">])</span>
        <span class="s1">expected = self.expected.recurse_odd</span>
        <span class="s2"># only have 12 characters in R and this blows up and gets big</span>
        <span class="s1">np.testing.assert_almost_equal(res.values.squeeze()</span><span class="s0">, </span><span class="s1">expected</span><span class="s0">, </span><span class="s3">4</span><span class="s1">)</span>
        <span class="s1">np.testing.assert_(res.index[</span><span class="s3">0</span><span class="s1">] == start)</span>
        <span class="s1">np.testing.assert_(res.index[-</span><span class="s3">1</span><span class="s1">] == end)</span>


<span class="s0">def </span><span class="s1">dummy_func(x):</span>
    <span class="s0">return </span><span class="s1">x</span>


<span class="s0">def </span><span class="s1">dummy_func_array(x):</span>
    <span class="s0">return </span><span class="s1">x.values</span>


<span class="s0">def </span><span class="s1">dummy_func_pandas_columns(x):</span>
    <span class="s0">return </span><span class="s1">x.values</span>


<span class="s0">def </span><span class="s1">dummy_func_pandas_series(x):</span>
    <span class="s0">return </span><span class="s1">x[</span><span class="s4">'A'</span><span class="s1">]</span>


<span class="s0">def </span><span class="s1">test_pandas_freq_decorator():</span>
    <span class="s1">x = make_dataframe()</span>
    <span class="s2"># in x, get a function back that returns an x with the same columns</span>
    <span class="s1">func = pandas_wrapper(dummy_func)</span>

    <span class="s1">np.testing.assert_equal(func(x.values)</span><span class="s0">, </span><span class="s1">x)</span>

    <span class="s1">func = pandas_wrapper(dummy_func_array)</span>
    <span class="s1">assert_frame_equal(func(x)</span><span class="s0">, </span><span class="s1">x)</span>

    <span class="s1">expected = x.rename(columns=dict(zip(</span><span class="s4">'ABCD'</span><span class="s0">, </span><span class="s4">'EFGH'</span><span class="s1">)))</span>
    <span class="s1">func = pandas_wrapper(dummy_func_array</span><span class="s0">, </span><span class="s1">names=list(</span><span class="s4">'EFGH'</span><span class="s1">))</span>
    <span class="s1">assert_frame_equal(func(x)</span><span class="s0">, </span><span class="s1">expected)</span>
</pre>
</body>
</html>