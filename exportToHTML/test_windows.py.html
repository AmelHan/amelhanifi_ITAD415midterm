<html>
<head>
<title>test_windows.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6a8759;}
.s3 { color: #6897bb;}
.s4 { color: #629755; font-style: italic;}
.s5 { color: #808080;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_windows.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">pickle</span>

<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">from </span><span class="s1">numpy </span><span class="s0">import </span><span class="s1">array</span>
<span class="s0">from </span><span class="s1">numpy.testing </span><span class="s0">import </span><span class="s1">(assert_array_almost_equal</span><span class="s0">, </span><span class="s1">assert_array_equal</span><span class="s0">,</span>
                           <span class="s1">assert_allclose</span><span class="s0">,</span>
                           <span class="s1">assert_equal</span><span class="s0">, </span><span class="s1">assert_</span><span class="s0">, </span><span class="s1">assert_array_less</span><span class="s0">,</span>
                           <span class="s1">suppress_warnings)</span>
<span class="s0">import </span><span class="s1">pytest</span>
<span class="s0">from </span><span class="s1">pytest </span><span class="s0">import </span><span class="s1">raises </span><span class="s0">as </span><span class="s1">assert_raises</span>

<span class="s0">from </span><span class="s1">scipy.fft </span><span class="s0">import </span><span class="s1">fft</span>
<span class="s0">from </span><span class="s1">scipy.signal </span><span class="s0">import </span><span class="s1">windows</span><span class="s0">, </span><span class="s1">get_window</span><span class="s0">, </span><span class="s1">resample</span><span class="s0">, </span><span class="s1">hann </span><span class="s0">as </span><span class="s1">dep_hann</span>
<span class="s0">from </span><span class="s1">scipy </span><span class="s0">import </span><span class="s1">signal</span>


<span class="s1">window_funcs = [</span>
    <span class="s1">(</span><span class="s2">'boxcar'</span><span class="s0">, </span><span class="s1">())</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s2">'triang'</span><span class="s0">, </span><span class="s1">())</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s2">'parzen'</span><span class="s0">, </span><span class="s1">())</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s2">'bohman'</span><span class="s0">, </span><span class="s1">())</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s2">'blackman'</span><span class="s0">, </span><span class="s1">())</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s2">'nuttall'</span><span class="s0">, </span><span class="s1">())</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s2">'blackmanharris'</span><span class="s0">, </span><span class="s1">())</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s2">'flattop'</span><span class="s0">, </span><span class="s1">())</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s2">'bartlett'</span><span class="s0">, </span><span class="s1">())</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s2">'barthann'</span><span class="s0">, </span><span class="s1">())</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s2">'hamming'</span><span class="s0">, </span><span class="s1">())</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s2">'kaiser'</span><span class="s0">, </span><span class="s1">(</span><span class="s3">1</span><span class="s0">,</span><span class="s1">))</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s2">'dpss'</span><span class="s0">, </span><span class="s1">(</span><span class="s3">2</span><span class="s0">,</span><span class="s1">))</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s2">'gaussian'</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0.5</span><span class="s0">,</span><span class="s1">))</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s2">'general_gaussian'</span><span class="s0">, </span><span class="s1">(</span><span class="s3">1.5</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s2">'chebwin'</span><span class="s0">, </span><span class="s1">(</span><span class="s3">1</span><span class="s0">,</span><span class="s1">))</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s2">'cosine'</span><span class="s0">, </span><span class="s1">())</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s2">'hann'</span><span class="s0">, </span><span class="s1">())</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s2">'exponential'</span><span class="s0">, </span><span class="s1">())</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s2">'taylor'</span><span class="s0">, </span><span class="s1">())</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s2">'tukey'</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0.5</span><span class="s0">,</span><span class="s1">))</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s2">'lanczos'</span><span class="s0">, </span><span class="s1">())</span><span class="s0">,</span>
    <span class="s1">]</span>

<span class="s1">@pytest.mark.parametrize([</span><span class="s2">&quot;method&quot;</span><span class="s0">, </span><span class="s2">&quot;args&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">window_funcs)</span>
<span class="s0">def </span><span class="s1">test_deprecated_import(method</span><span class="s0">, </span><span class="s1">args):</span>
    <span class="s0">if </span><span class="s1">method </span><span class="s0">in </span><span class="s1">(</span><span class="s2">'taylor'</span><span class="s0">, </span><span class="s2">'lanczos'</span><span class="s0">, </span><span class="s2">'dpss'</span><span class="s1">):</span>
        <span class="s1">pytest.skip(</span><span class="s2">&quot;Deprecation test not applicable&quot;</span><span class="s1">)</span>
    <span class="s1">func = getattr(signal</span><span class="s0">, </span><span class="s1">method)</span>
    <span class="s1">msg = </span><span class="s2">f&quot;Importing </span><span class="s0">{</span><span class="s1">method</span><span class="s0">}</span><span class="s2">&quot;</span>
    <span class="s0">with </span><span class="s1">pytest.deprecated_call(match=msg):</span>
        <span class="s1">func(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">*args)</span>
        

<span class="s0">class </span><span class="s1">TestBartHann:</span>

    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s1">assert_allclose(windows.barthann(</span><span class="s3">6</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">True</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.35857354213752</span><span class="s0">, </span><span class="s3">0.8794264578624801</span><span class="s0">,</span>
                         <span class="s3">0.8794264578624801</span><span class="s0">, </span><span class="s3">0.3585735421375199</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                        <span class="s1">rtol=</span><span class="s3">1e-15</span><span class="s0">, </span><span class="s1">atol=</span><span class="s3">1e-15</span><span class="s1">)</span>
        <span class="s1">assert_allclose(windows.barthann(</span><span class="s3">7</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.27</span><span class="s0">, </span><span class="s3">0.73</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.73</span><span class="s0">, </span><span class="s3">0.27</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                        <span class="s1">rtol=</span><span class="s3">1e-15</span><span class="s0">, </span><span class="s1">atol=</span><span class="s3">1e-15</span><span class="s1">)</span>
        <span class="s1">assert_allclose(windows.barthann(</span><span class="s3">6</span><span class="s0">, False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.27</span><span class="s0">, </span><span class="s3">0.73</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.73</span><span class="s0">, </span><span class="s3">0.27</span><span class="s1">]</span><span class="s0">,</span>
                        <span class="s1">rtol=</span><span class="s3">1e-15</span><span class="s0">, </span><span class="s1">atol=</span><span class="s3">1e-15</span><span class="s1">)</span>


<span class="s0">class </span><span class="s1">TestBartlett:</span>

    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s1">assert_allclose(windows.bartlett(</span><span class="s3">6</span><span class="s1">)</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.4</span><span class="s0">, </span><span class="s3">0.8</span><span class="s0">, </span><span class="s3">0.8</span><span class="s0">, </span><span class="s3">0.4</span><span class="s0">, </span><span class="s3">0</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.bartlett(</span><span class="s3">7</span><span class="s1">)</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">/</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">/</span><span class="s3">3</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">2</span><span class="s1">/</span><span class="s3">3</span><span class="s0">, </span><span class="s3">1</span><span class="s1">/</span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.bartlett(</span><span class="s3">6</span><span class="s0">, False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">/</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">/</span><span class="s3">3</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">2</span><span class="s1">/</span><span class="s3">3</span><span class="s0">, </span><span class="s3">1</span><span class="s1">/</span><span class="s3">3</span><span class="s1">])</span>


<span class="s0">class </span><span class="s1">TestBlackman:</span>

    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s1">assert_allclose(windows.blackman(</span><span class="s3">6</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.13</span><span class="s0">, </span><span class="s3">0.63</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.63</span><span class="s0">, </span><span class="s3">0.13</span><span class="s1">]</span><span class="s0">, </span><span class="s1">atol=</span><span class="s3">1e-14</span><span class="s1">)</span>
        <span class="s1">assert_allclose(windows.blackman(</span><span class="s3">7</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.09045342435412804</span><span class="s0">, </span><span class="s3">0.4591829575459636</span><span class="s0">,</span>
                         <span class="s3">0.9203636180999081</span><span class="s0">, </span><span class="s3">0.9203636180999081</span><span class="s0">,</span>
                         <span class="s3">0.4591829575459636</span><span class="s0">, </span><span class="s3">0.09045342435412804</span><span class="s1">]</span><span class="s0">, </span><span class="s1">atol=</span><span class="s3">1e-8</span><span class="s1">)</span>
        <span class="s1">assert_allclose(windows.blackman(</span><span class="s3">6</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.2007701432625305</span><span class="s0">, </span><span class="s3">0.8492298567374694</span><span class="s0">,</span>
                         <span class="s3">0.8492298567374694</span><span class="s0">, </span><span class="s3">0.2007701432625305</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                        <span class="s1">atol=</span><span class="s3">1e-14</span><span class="s1">)</span>
        <span class="s1">assert_allclose(windows.blackman(</span><span class="s3">7</span><span class="s0">, True</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.13</span><span class="s0">, </span><span class="s3">0.63</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.63</span><span class="s0">, </span><span class="s3">0.13</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">atol=</span><span class="s3">1e-14</span><span class="s1">)</span>


<span class="s0">class </span><span class="s1">TestBlackmanHarris:</span>

    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s1">assert_allclose(windows.blackmanharris(</span><span class="s3">6</span><span class="s0">, False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">6.0e-05</span><span class="s0">, </span><span class="s3">0.055645</span><span class="s0">, </span><span class="s3">0.520575</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.520575</span><span class="s0">, </span><span class="s3">0.055645</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.blackmanharris(</span><span class="s3">7</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">6.0e-05</span><span class="s0">, </span><span class="s3">0.03339172347815117</span><span class="s0">, </span><span class="s3">0.332833504298565</span><span class="s0">,</span>
                         <span class="s3">0.8893697722232837</span><span class="s0">, </span><span class="s3">0.8893697722232838</span><span class="s0">,</span>
                         <span class="s3">0.3328335042985652</span><span class="s0">, </span><span class="s3">0.03339172347815122</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.blackmanharris(</span><span class="s3">6</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">6.0e-05</span><span class="s0">, </span><span class="s3">0.1030114893456638</span><span class="s0">, </span><span class="s3">0.7938335106543362</span><span class="s0">,</span>
                         <span class="s3">0.7938335106543364</span><span class="s0">, </span><span class="s3">0.1030114893456638</span><span class="s0">, </span><span class="s3">6.0e-05</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.blackmanharris(</span><span class="s3">7</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">True</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">6.0e-05</span><span class="s0">, </span><span class="s3">0.055645</span><span class="s0">, </span><span class="s3">0.520575</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.520575</span><span class="s0">, </span><span class="s3">0.055645</span><span class="s0">,</span>
                         <span class="s3">6.0e-05</span><span class="s1">])</span>


<span class="s0">class </span><span class="s1">TestTaylor:</span>

    <span class="s0">def </span><span class="s1">test_normalized(self):</span>
        <span class="s4">&quot;&quot;&quot;Tests windows of small length that are normalized to 1. See the 
        documentation for the Taylor window for more information on 
        normalization. 
        &quot;&quot;&quot;</span>
        <span class="s1">assert_allclose(windows.taylor(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">15</span><span class="s1">)</span><span class="s0">, </span><span class="s3">1.0</span><span class="s1">)</span>
        <span class="s1">assert_allclose(</span>
            <span class="s1">windows.taylor(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">15</span><span class="s1">)</span><span class="s0">,</span>
            <span class="s1">np.array([</span><span class="s3">0.75803341</span><span class="s0">, </span><span class="s3">0.90757699</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.90757699</span><span class="s0">, </span><span class="s3">0.75803341</span><span class="s1">])</span>
        <span class="s1">)</span>
        <span class="s1">assert_allclose(</span>
            <span class="s1">windows.taylor(</span><span class="s3">6</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">15</span><span class="s1">)</span><span class="s0">,</span>
            <span class="s1">np.array([</span>
                <span class="s3">0.7504082</span><span class="s0">, </span><span class="s3">0.86624416</span><span class="s0">, </span><span class="s3">0.98208011</span><span class="s0">, </span><span class="s3">0.98208011</span><span class="s0">, </span><span class="s3">0.86624416</span><span class="s0">,</span>
                <span class="s3">0.7504082</span>
            <span class="s1">])</span>
        <span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_non_normalized(self):</span>
        <span class="s4">&quot;&quot;&quot;Test windows of small length that are not normalized to 1. See 
        the documentation for the Taylor window for more information on 
        normalization. 
        &quot;&quot;&quot;</span>
        <span class="s1">assert_allclose(</span>
            <span class="s1">windows.taylor(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">15</span><span class="s0">, </span><span class="s1">norm=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">,</span>
            <span class="s1">np.array([</span>
                <span class="s3">0.87508054</span><span class="s0">, </span><span class="s3">1.04771499</span><span class="s0">, </span><span class="s3">1.15440894</span><span class="s0">, </span><span class="s3">1.04771499</span><span class="s0">, </span><span class="s3">0.87508054</span>
            <span class="s1">])</span>
        <span class="s1">)</span>
        <span class="s1">assert_allclose(</span>
            <span class="s1">windows.taylor(</span><span class="s3">6</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">15</span><span class="s0">, </span><span class="s1">norm=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">,</span>
            <span class="s1">np.array([</span>
                <span class="s3">0.86627793</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.13372207</span><span class="s0">, </span><span class="s3">1.13372207</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.86627793</span>
            <span class="s1">])</span>
        <span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_correctness(self):</span>
        <span class="s4">&quot;&quot;&quot;This test ensures the correctness of the implemented Taylor 
        Windowing function. A Taylor Window of 1024 points is created, its FFT 
        is taken, and the Peak Sidelobe Level (PSLL) and 3dB and 18dB bandwidth 
        are found and checked. 
 
        A publication from Sandia National Laboratories was used as reference 
        for the correctness values [1]_. 
 
        References 
        ----- 
        .. [1] Armin Doerry, &quot;Catalog of Window Taper Functions for 
               Sidelobe Control&quot;, 2017. 
               https://www.researchgate.net/profile/Armin_Doerry/publication/316281181_Catalog_of_Window_Taper_Functions_for_Sidelobe_Control/links/58f92cb2a6fdccb121c9d54d/Catalog-of-Window-Taper-Functions-for-Sidelobe-Control.pdf 
        &quot;&quot;&quot;</span>
        <span class="s1">M_win = </span><span class="s3">1024</span>
        <span class="s1">N_fft = </span><span class="s3">131072</span>
        <span class="s5"># Set norm=False for correctness as the values obtained from the</span>
        <span class="s5"># scientific publication do not normalize the values. Normalizing</span>
        <span class="s5"># changes the sidelobe level from the desired value.</span>
        <span class="s1">w = windows.taylor(M_win</span><span class="s0">, </span><span class="s1">nbar=</span><span class="s3">4</span><span class="s0">, </span><span class="s1">sll=</span><span class="s3">35</span><span class="s0">, </span><span class="s1">norm=</span><span class="s0">False, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s1">f = fft(w</span><span class="s0">, </span><span class="s1">N_fft)</span>
        <span class="s1">spec = </span><span class="s3">20 </span><span class="s1">* np.log10(np.abs(f / np.amax(f)))</span>

        <span class="s1">first_zero = np.argmax(np.diff(spec) &gt; </span><span class="s3">0</span><span class="s1">)</span>

        <span class="s1">PSLL = np.amax(spec[first_zero:-first_zero])</span>

        <span class="s1">BW_3dB = </span><span class="s3">2</span><span class="s1">*np.argmax(spec &lt;= -</span><span class="s3">3.0102999566398121</span><span class="s1">) / N_fft * M_win</span>
        <span class="s1">BW_18dB = </span><span class="s3">2</span><span class="s1">*np.argmax(spec &lt;= -</span><span class="s3">18.061799739838872</span><span class="s1">) / N_fft * M_win</span>

        <span class="s1">assert_allclose(PSLL</span><span class="s0">, </span><span class="s1">-</span><span class="s3">35.1672</span><span class="s0">, </span><span class="s1">atol=</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">assert_allclose(BW_3dB</span><span class="s0">, </span><span class="s3">1.1822</span><span class="s0">, </span><span class="s1">atol=</span><span class="s3">0.1</span><span class="s1">)</span>
        <span class="s1">assert_allclose(BW_18dB</span><span class="s0">, </span><span class="s3">2.6112</span><span class="s0">, </span><span class="s1">atol=</span><span class="s3">0.1</span><span class="s1">)</span>


<span class="s0">class </span><span class="s1">TestBohman:</span>

    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s1">assert_allclose(windows.bohman(</span><span class="s3">6</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.1791238937062839</span><span class="s0">, </span><span class="s3">0.8343114522576858</span><span class="s0">,</span>
                         <span class="s3">0.8343114522576858</span><span class="s0">, </span><span class="s3">0.1791238937062838</span><span class="s0">, </span><span class="s3">0</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.bohman(</span><span class="s3">7</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">True</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.1089977810442293</span><span class="s0">, </span><span class="s3">0.6089977810442293</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">,</span>
                         <span class="s3">0.6089977810442295</span><span class="s0">, </span><span class="s3">0.1089977810442293</span><span class="s0">, </span><span class="s3">0</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.bohman(</span><span class="s3">6</span><span class="s0">, False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.1089977810442293</span><span class="s0">, </span><span class="s3">0.6089977810442293</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">,</span>
                         <span class="s3">0.6089977810442295</span><span class="s0">, </span><span class="s3">0.1089977810442293</span><span class="s1">])</span>


<span class="s0">class </span><span class="s1">TestBoxcar:</span>

    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s1">assert_allclose(windows.boxcar(</span><span class="s3">6</span><span class="s1">)</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.boxcar(</span><span class="s3">7</span><span class="s1">)</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.boxcar(</span><span class="s3">6</span><span class="s0">, False</span><span class="s1">)</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">])</span>


<span class="s1">cheb_odd_true = array([</span><span class="s3">0.200938</span><span class="s0">, </span><span class="s3">0.107729</span><span class="s0">, </span><span class="s3">0.134941</span><span class="s0">, </span><span class="s3">0.165348</span><span class="s0">,</span>
                       <span class="s3">0.198891</span><span class="s0">, </span><span class="s3">0.235450</span><span class="s0">, </span><span class="s3">0.274846</span><span class="s0">, </span><span class="s3">0.316836</span><span class="s0">,</span>
                       <span class="s3">0.361119</span><span class="s0">, </span><span class="s3">0.407338</span><span class="s0">, </span><span class="s3">0.455079</span><span class="s0">, </span><span class="s3">0.503883</span><span class="s0">,</span>
                       <span class="s3">0.553248</span><span class="s0">, </span><span class="s3">0.602637</span><span class="s0">, </span><span class="s3">0.651489</span><span class="s0">, </span><span class="s3">0.699227</span><span class="s0">,</span>
                       <span class="s3">0.745266</span><span class="s0">, </span><span class="s3">0.789028</span><span class="s0">, </span><span class="s3">0.829947</span><span class="s0">, </span><span class="s3">0.867485</span><span class="s0">,</span>
                       <span class="s3">0.901138</span><span class="s0">, </span><span class="s3">0.930448</span><span class="s0">, </span><span class="s3">0.955010</span><span class="s0">, </span><span class="s3">0.974482</span><span class="s0">,</span>
                       <span class="s3">0.988591</span><span class="s0">, </span><span class="s3">0.997138</span><span class="s0">, </span><span class="s3">1.000000</span><span class="s0">, </span><span class="s3">0.997138</span><span class="s0">,</span>
                       <span class="s3">0.988591</span><span class="s0">, </span><span class="s3">0.974482</span><span class="s0">, </span><span class="s3">0.955010</span><span class="s0">, </span><span class="s3">0.930448</span><span class="s0">,</span>
                       <span class="s3">0.901138</span><span class="s0">, </span><span class="s3">0.867485</span><span class="s0">, </span><span class="s3">0.829947</span><span class="s0">, </span><span class="s3">0.789028</span><span class="s0">,</span>
                       <span class="s3">0.745266</span><span class="s0">, </span><span class="s3">0.699227</span><span class="s0">, </span><span class="s3">0.651489</span><span class="s0">, </span><span class="s3">0.602637</span><span class="s0">,</span>
                       <span class="s3">0.553248</span><span class="s0">, </span><span class="s3">0.503883</span><span class="s0">, </span><span class="s3">0.455079</span><span class="s0">, </span><span class="s3">0.407338</span><span class="s0">,</span>
                       <span class="s3">0.361119</span><span class="s0">, </span><span class="s3">0.316836</span><span class="s0">, </span><span class="s3">0.274846</span><span class="s0">, </span><span class="s3">0.235450</span><span class="s0">,</span>
                       <span class="s3">0.198891</span><span class="s0">, </span><span class="s3">0.165348</span><span class="s0">, </span><span class="s3">0.134941</span><span class="s0">, </span><span class="s3">0.107729</span><span class="s0">,</span>
                       <span class="s3">0.200938</span><span class="s1">])</span>

<span class="s1">cheb_even_true = array([</span><span class="s3">0.203894</span><span class="s0">, </span><span class="s3">0.107279</span><span class="s0">, </span><span class="s3">0.133904</span><span class="s0">,</span>
                        <span class="s3">0.163608</span><span class="s0">, </span><span class="s3">0.196338</span><span class="s0">, </span><span class="s3">0.231986</span><span class="s0">,</span>
                        <span class="s3">0.270385</span><span class="s0">, </span><span class="s3">0.311313</span><span class="s0">, </span><span class="s3">0.354493</span><span class="s0">,</span>
                        <span class="s3">0.399594</span><span class="s0">, </span><span class="s3">0.446233</span><span class="s0">, </span><span class="s3">0.493983</span><span class="s0">,</span>
                        <span class="s3">0.542378</span><span class="s0">, </span><span class="s3">0.590916</span><span class="s0">, </span><span class="s3">0.639071</span><span class="s0">,</span>
                        <span class="s3">0.686302</span><span class="s0">, </span><span class="s3">0.732055</span><span class="s0">, </span><span class="s3">0.775783</span><span class="s0">,</span>
                        <span class="s3">0.816944</span><span class="s0">, </span><span class="s3">0.855021</span><span class="s0">, </span><span class="s3">0.889525</span><span class="s0">,</span>
                        <span class="s3">0.920006</span><span class="s0">, </span><span class="s3">0.946060</span><span class="s0">, </span><span class="s3">0.967339</span><span class="s0">,</span>
                        <span class="s3">0.983557</span><span class="s0">, </span><span class="s3">0.994494</span><span class="s0">, </span><span class="s3">1.000000</span><span class="s0">,</span>
                        <span class="s3">1.000000</span><span class="s0">, </span><span class="s3">0.994494</span><span class="s0">, </span><span class="s3">0.983557</span><span class="s0">,</span>
                        <span class="s3">0.967339</span><span class="s0">, </span><span class="s3">0.946060</span><span class="s0">, </span><span class="s3">0.920006</span><span class="s0">,</span>
                        <span class="s3">0.889525</span><span class="s0">, </span><span class="s3">0.855021</span><span class="s0">, </span><span class="s3">0.816944</span><span class="s0">,</span>
                        <span class="s3">0.775783</span><span class="s0">, </span><span class="s3">0.732055</span><span class="s0">, </span><span class="s3">0.686302</span><span class="s0">,</span>
                        <span class="s3">0.639071</span><span class="s0">, </span><span class="s3">0.590916</span><span class="s0">, </span><span class="s3">0.542378</span><span class="s0">,</span>
                        <span class="s3">0.493983</span><span class="s0">, </span><span class="s3">0.446233</span><span class="s0">, </span><span class="s3">0.399594</span><span class="s0">,</span>
                        <span class="s3">0.354493</span><span class="s0">, </span><span class="s3">0.311313</span><span class="s0">, </span><span class="s3">0.270385</span><span class="s0">,</span>
                        <span class="s3">0.231986</span><span class="s0">, </span><span class="s3">0.196338</span><span class="s0">, </span><span class="s3">0.163608</span><span class="s0">,</span>
                        <span class="s3">0.133904</span><span class="s0">, </span><span class="s3">0.107279</span><span class="s0">, </span><span class="s3">0.203894</span><span class="s1">])</span>


<span class="s0">class </span><span class="s1">TestChebWin:</span>

    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s0">with </span><span class="s1">suppress_warnings() </span><span class="s0">as </span><span class="s1">sup:</span>
            <span class="s1">sup.filter(UserWarning</span><span class="s0">, </span><span class="s2">&quot;This window is not suitable&quot;</span><span class="s1">)</span>
            <span class="s1">assert_allclose(windows.chebwin(</span><span class="s3">6</span><span class="s0">, </span><span class="s3">100</span><span class="s1">)</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.1046401879356917</span><span class="s0">, </span><span class="s3">0.5075781475823447</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">,</span>
                             <span class="s3">0.5075781475823447</span><span class="s0">, </span><span class="s3">0.1046401879356917</span><span class="s1">])</span>
            <span class="s1">assert_allclose(windows.chebwin(</span><span class="s3">7</span><span class="s0">, </span><span class="s3">100</span><span class="s1">)</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.05650405062850233</span><span class="s0">, </span><span class="s3">0.316608530648474</span><span class="s0">,</span>
                             <span class="s3">0.7601208123539079</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.7601208123539079</span><span class="s0">,</span>
                             <span class="s3">0.316608530648474</span><span class="s0">, </span><span class="s3">0.05650405062850233</span><span class="s1">])</span>
            <span class="s1">assert_allclose(windows.chebwin(</span><span class="s3">6</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.6071201674458373</span><span class="s0">, </span><span class="s3">0.6808391469897297</span><span class="s0">,</span>
                             <span class="s3">0.6808391469897297</span><span class="s0">, </span><span class="s3">0.6071201674458373</span><span class="s0">, </span><span class="s3">1.0</span><span class="s1">])</span>
            <span class="s1">assert_allclose(windows.chebwin(</span><span class="s3">7</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.5190521247588651</span><span class="s0">, </span><span class="s3">0.5864059018130382</span><span class="s0">,</span>
                             <span class="s3">0.6101519801307441</span><span class="s0">, </span><span class="s3">0.5864059018130382</span><span class="s0">,</span>
                             <span class="s3">0.5190521247588651</span><span class="s0">, </span><span class="s3">1.0</span><span class="s1">])</span>
            <span class="s1">assert_allclose(windows.chebwin(</span><span class="s3">6</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, False</span><span class="s1">)</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.5190521247588651</span><span class="s0">, </span><span class="s3">0.5864059018130382</span><span class="s0">,</span>
                             <span class="s3">0.6101519801307441</span><span class="s0">, </span><span class="s3">0.5864059018130382</span><span class="s0">,</span>
                             <span class="s3">0.5190521247588651</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_cheb_odd_high_attenuation(self):</span>
        <span class="s0">with </span><span class="s1">suppress_warnings() </span><span class="s0">as </span><span class="s1">sup:</span>
            <span class="s1">sup.filter(UserWarning</span><span class="s0">, </span><span class="s2">&quot;This window is not suitable&quot;</span><span class="s1">)</span>
            <span class="s1">cheb_odd = windows.chebwin(</span><span class="s3">53</span><span class="s0">, </span><span class="s1">at=-</span><span class="s3">40</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(cheb_odd</span><span class="s0">, </span><span class="s1">cheb_odd_true</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">4</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_cheb_even_high_attenuation(self):</span>
        <span class="s0">with </span><span class="s1">suppress_warnings() </span><span class="s0">as </span><span class="s1">sup:</span>
            <span class="s1">sup.filter(UserWarning</span><span class="s0">, </span><span class="s2">&quot;This window is not suitable&quot;</span><span class="s1">)</span>
            <span class="s1">cheb_even = windows.chebwin(</span><span class="s3">54</span><span class="s0">, </span><span class="s1">at=</span><span class="s3">40</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(cheb_even</span><span class="s0">, </span><span class="s1">cheb_even_true</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">4</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_cheb_odd_low_attenuation(self):</span>
        <span class="s1">cheb_odd_low_at_true = array([</span><span class="s3">1.000000</span><span class="s0">, </span><span class="s3">0.519052</span><span class="s0">, </span><span class="s3">0.586405</span><span class="s0">,</span>
                                      <span class="s3">0.610151</span><span class="s0">, </span><span class="s3">0.586405</span><span class="s0">, </span><span class="s3">0.519052</span><span class="s0">,</span>
                                      <span class="s3">1.000000</span><span class="s1">])</span>
        <span class="s0">with </span><span class="s1">suppress_warnings() </span><span class="s0">as </span><span class="s1">sup:</span>
            <span class="s1">sup.filter(UserWarning</span><span class="s0">, </span><span class="s2">&quot;This window is not suitable&quot;</span><span class="s1">)</span>
            <span class="s1">cheb_odd = windows.chebwin(</span><span class="s3">7</span><span class="s0">, </span><span class="s1">at=</span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(cheb_odd</span><span class="s0">, </span><span class="s1">cheb_odd_low_at_true</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">4</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_cheb_even_low_attenuation(self):</span>
        <span class="s1">cheb_even_low_at_true = array([</span><span class="s3">1.000000</span><span class="s0">, </span><span class="s3">0.451924</span><span class="s0">, </span><span class="s3">0.51027</span><span class="s0">,</span>
                                       <span class="s3">0.541338</span><span class="s0">, </span><span class="s3">0.541338</span><span class="s0">, </span><span class="s3">0.51027</span><span class="s0">,</span>
                                       <span class="s3">0.451924</span><span class="s0">, </span><span class="s3">1.000000</span><span class="s1">])</span>
        <span class="s0">with </span><span class="s1">suppress_warnings() </span><span class="s0">as </span><span class="s1">sup:</span>
            <span class="s1">sup.filter(UserWarning</span><span class="s0">, </span><span class="s2">&quot;This window is not suitable&quot;</span><span class="s1">)</span>
            <span class="s1">cheb_even = windows.chebwin(</span><span class="s3">8</span><span class="s0">, </span><span class="s1">at=-</span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(cheb_even</span><span class="s0">, </span><span class="s1">cheb_even_low_at_true</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">4</span><span class="s1">)</span>


<span class="s1">exponential_data = {</span>
    <span class="s1">(</span><span class="s3">4</span><span class="s0">, None, </span><span class="s3">0.2</span><span class="s0">, False</span><span class="s1">):</span>
        <span class="s1">array([</span><span class="s3">4.53999297624848542e-05</span><span class="s0">,</span>
               <span class="s3">6.73794699908546700e-03</span><span class="s0">, </span><span class="s3">1.00000000000000000e+00</span><span class="s0">,</span>
               <span class="s3">6.73794699908546700e-03</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">4</span><span class="s0">, None, </span><span class="s3">0.2</span><span class="s0">, True</span><span class="s1">): array([</span><span class="s3">0.00055308437014783</span><span class="s0">, </span><span class="s3">0.0820849986238988</span><span class="s0">,</span>
                                 <span class="s3">0.0820849986238988</span><span class="s0">, </span><span class="s3">0.00055308437014783</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">4</span><span class="s0">, None, </span><span class="s3">1.0</span><span class="s0">, False</span><span class="s1">): array([</span><span class="s3">0.1353352832366127</span><span class="s0">, </span><span class="s3">0.36787944117144233</span><span class="s0">, </span><span class="s3">1.</span><span class="s0">,</span>
                                  <span class="s3">0.36787944117144233</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">4</span><span class="s0">, None, </span><span class="s3">1.0</span><span class="s0">, True</span><span class="s1">): array([</span><span class="s3">0.22313016014842982</span><span class="s0">, </span><span class="s3">0.60653065971263342</span><span class="s0">,</span>
                                 <span class="s3">0.60653065971263342</span><span class="s0">, </span><span class="s3">0.22313016014842982</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">0.2</span><span class="s0">, False</span><span class="s1">):</span>
        <span class="s1">array([</span><span class="s3">4.53999297624848542e-05</span><span class="s0">, </span><span class="s3">6.73794699908546700e-03</span><span class="s0">,</span>
               <span class="s3">1.00000000000000000e+00</span><span class="s0">, </span><span class="s3">6.73794699908546700e-03</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">0.2</span><span class="s0">, True</span><span class="s1">): </span><span class="s0">None,</span>
    <span class="s1">(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, False</span><span class="s1">): array([</span><span class="s3">0.1353352832366127</span><span class="s0">, </span><span class="s3">0.36787944117144233</span><span class="s0">, </span><span class="s3">1.</span><span class="s0">,</span>
                               <span class="s3">0.36787944117144233</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, True</span><span class="s1">): </span><span class="s0">None,</span>
    <span class="s1">(</span><span class="s3">5</span><span class="s0">, None, </span><span class="s3">0.2</span><span class="s0">, True</span><span class="s1">):</span>
        <span class="s1">array([</span><span class="s3">4.53999297624848542e-05</span><span class="s0">,</span>
               <span class="s3">6.73794699908546700e-03</span><span class="s0">, </span><span class="s3">1.00000000000000000e+00</span><span class="s0">,</span>
               <span class="s3">6.73794699908546700e-03</span><span class="s0">, </span><span class="s3">4.53999297624848542e-05</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">5</span><span class="s0">, None, </span><span class="s3">1.0</span><span class="s0">, True</span><span class="s1">): array([</span><span class="s3">0.1353352832366127</span><span class="s0">, </span><span class="s3">0.36787944117144233</span><span class="s0">, </span><span class="s3">1.</span><span class="s0">,</span>
                                 <span class="s3">0.36787944117144233</span><span class="s0">, </span><span class="s3">0.1353352832366127</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">0.2</span><span class="s0">, True</span><span class="s1">): </span><span class="s0">None,</span>
    <span class="s1">(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, True</span><span class="s1">): </span><span class="s0">None</span>
<span class="s1">}</span>


<span class="s0">def </span><span class="s1">test_exponential():</span>
    <span class="s0">for </span><span class="s1">k</span><span class="s0">, </span><span class="s1">v </span><span class="s0">in </span><span class="s1">exponential_data.items():</span>
        <span class="s0">if </span><span class="s1">v </span><span class="s0">is None</span><span class="s1">:</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">windows.exponential</span><span class="s0">, </span><span class="s1">*k)</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">win = windows.exponential(*k)</span>
            <span class="s1">assert_allclose(win</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s1">rtol=</span><span class="s3">1e-14</span><span class="s1">)</span>


<span class="s0">class </span><span class="s1">TestFlatTop:</span>

    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s1">assert_allclose(windows.flattop(</span><span class="s3">6</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[-</span><span class="s3">0.000421051</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.051263156</span><span class="s0">, </span><span class="s3">0.19821053</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">,</span>
                         <span class="s3">0.19821053</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.051263156</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.flattop(</span><span class="s3">7</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[-</span><span class="s3">0.000421051</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.03684078115492348</span><span class="s0">,</span>
                         <span class="s3">0.01070371671615342</span><span class="s0">, </span><span class="s3">0.7808739149387698</span><span class="s0">,</span>
                         <span class="s3">0.7808739149387698</span><span class="s0">, </span><span class="s3">0.01070371671615342</span><span class="s0">,</span>
                         <span class="s1">-</span><span class="s3">0.03684078115492348</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.flattop(</span><span class="s3">6</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[-</span><span class="s3">0.000421051</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.0677142520762119</span><span class="s0">, </span><span class="s3">0.6068721525762117</span><span class="s0">,</span>
                         <span class="s3">0.6068721525762117</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.0677142520762119</span><span class="s0">,</span>
                         <span class="s1">-</span><span class="s3">0.000421051</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.flattop(</span><span class="s3">7</span><span class="s0">, True</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[-</span><span class="s3">0.000421051</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.051263156</span><span class="s0">, </span><span class="s3">0.19821053</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">,</span>
                         <span class="s3">0.19821053</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.051263156</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.000421051</span><span class="s1">])</span>


<span class="s0">class </span><span class="s1">TestGaussian:</span>

    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s1">assert_allclose(windows.gaussian(</span><span class="s3">6</span><span class="s0">, </span><span class="s3">1.0</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.04393693362340742</span><span class="s0">, </span><span class="s3">0.3246524673583497</span><span class="s0">,</span>
                         <span class="s3">0.8824969025845955</span><span class="s0">, </span><span class="s3">0.8824969025845955</span><span class="s0">,</span>
                         <span class="s3">0.3246524673583497</span><span class="s0">, </span><span class="s3">0.04393693362340742</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.gaussian(</span><span class="s3">7</span><span class="s0">, </span><span class="s3">1.2</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.04393693362340742</span><span class="s0">, </span><span class="s3">0.2493522087772962</span><span class="s0">,</span>
                         <span class="s3">0.7066482778577162</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.7066482778577162</span><span class="s0">,</span>
                         <span class="s3">0.2493522087772962</span><span class="s0">, </span><span class="s3">0.04393693362340742</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.gaussian(</span><span class="s3">7</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.6065306597126334</span><span class="s0">, </span><span class="s3">0.8007374029168081</span><span class="s0">,</span>
                         <span class="s3">0.9459594689067654</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.9459594689067654</span><span class="s0">,</span>
                         <span class="s3">0.8007374029168081</span><span class="s0">, </span><span class="s3">0.6065306597126334</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.gaussian(</span><span class="s3">6</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.6065306597126334</span><span class="s0">, </span><span class="s3">0.8007374029168081</span><span class="s0">,</span>
                         <span class="s3">0.9459594689067654</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.9459594689067654</span><span class="s0">,</span>
                         <span class="s3">0.8007374029168081</span><span class="s1">])</span>


<span class="s0">class </span><span class="s1">TestGeneralCosine:</span>

    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s1">assert_allclose(windows.general_cosine(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.3</span><span class="s0">, </span><span class="s3">0.2</span><span class="s1">])</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.4</span><span class="s0">, </span><span class="s3">0.3</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0.3</span><span class="s0">, </span><span class="s3">0.4</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.general_cosine(</span><span class="s3">4</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.3</span><span class="s0">, </span><span class="s3">0.2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.4</span><span class="s0">, </span><span class="s3">0.3</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0.3</span><span class="s1">])</span>


<span class="s0">class </span><span class="s1">TestGeneralHamming:</span>

    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s1">assert_allclose(windows.general_hamming(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">0.7</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.4</span><span class="s0">, </span><span class="s3">0.7</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.7</span><span class="s0">, </span><span class="s3">0.4</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.general_hamming(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">0.75</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.6727457514</span><span class="s0">, </span><span class="s3">0.9522542486</span><span class="s0">,</span>
                         <span class="s3">0.9522542486</span><span class="s0">, </span><span class="s3">0.6727457514</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.general_hamming(</span><span class="s3">6</span><span class="s0">, </span><span class="s3">0.75</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">True</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.6727457514</span><span class="s0">, </span><span class="s3">0.9522542486</span><span class="s0">,</span>
                        <span class="s3">0.9522542486</span><span class="s0">, </span><span class="s3">0.6727457514</span><span class="s0">, </span><span class="s3">0.5</span><span class="s1">])</span>


<span class="s0">class </span><span class="s1">TestHamming:</span>

    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s1">assert_allclose(windows.hamming(</span><span class="s3">6</span><span class="s0">, False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.08</span><span class="s0">, </span><span class="s3">0.31</span><span class="s0">, </span><span class="s3">0.77</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.77</span><span class="s0">, </span><span class="s3">0.31</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.hamming(</span><span class="s3">7</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.08</span><span class="s0">, </span><span class="s3">0.2531946911449826</span><span class="s0">, </span><span class="s3">0.6423596296199047</span><span class="s0">,</span>
                         <span class="s3">0.9544456792351128</span><span class="s0">, </span><span class="s3">0.9544456792351128</span><span class="s0">,</span>
                         <span class="s3">0.6423596296199047</span><span class="s0">, </span><span class="s3">0.2531946911449826</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.hamming(</span><span class="s3">6</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.08</span><span class="s0">, </span><span class="s3">0.3978521825875242</span><span class="s0">, </span><span class="s3">0.9121478174124757</span><span class="s0">,</span>
                         <span class="s3">0.9121478174124757</span><span class="s0">, </span><span class="s3">0.3978521825875242</span><span class="s0">, </span><span class="s3">0.08</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.hamming(</span><span class="s3">7</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">True</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.08</span><span class="s0">, </span><span class="s3">0.31</span><span class="s0">, </span><span class="s3">0.77</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.77</span><span class="s0">, </span><span class="s3">0.31</span><span class="s0">, </span><span class="s3">0.08</span><span class="s1">])</span>


<span class="s0">class </span><span class="s1">TestHann:</span>

    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s1">assert_allclose(windows.hann(</span><span class="s3">6</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.25</span><span class="s0">, </span><span class="s3">0.75</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.75</span><span class="s0">, </span><span class="s3">0.25</span><span class="s1">]</span><span class="s0">,</span>
                        <span class="s1">rtol=</span><span class="s3">1e-15</span><span class="s0">, </span><span class="s1">atol=</span><span class="s3">1e-15</span><span class="s1">)</span>
        <span class="s1">assert_allclose(windows.hann(</span><span class="s3">7</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.1882550990706332</span><span class="s0">, </span><span class="s3">0.6112604669781572</span><span class="s0">,</span>
                         <span class="s3">0.9504844339512095</span><span class="s0">, </span><span class="s3">0.9504844339512095</span><span class="s0">,</span>
                         <span class="s3">0.6112604669781572</span><span class="s0">, </span><span class="s3">0.1882550990706332</span><span class="s1">]</span><span class="s0">,</span>
                        <span class="s1">rtol=</span><span class="s3">1e-15</span><span class="s0">, </span><span class="s1">atol=</span><span class="s3">1e-15</span><span class="s1">)</span>
        <span class="s1">assert_allclose(windows.hann(</span><span class="s3">6</span><span class="s0">, True</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.3454915028125263</span><span class="s0">, </span><span class="s3">0.9045084971874737</span><span class="s0">,</span>
                         <span class="s3">0.9045084971874737</span><span class="s0">, </span><span class="s3">0.3454915028125263</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                        <span class="s1">rtol=</span><span class="s3">1e-15</span><span class="s0">, </span><span class="s1">atol=</span><span class="s3">1e-15</span><span class="s1">)</span>
        <span class="s1">assert_allclose(windows.hann(</span><span class="s3">7</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.25</span><span class="s0">, </span><span class="s3">0.75</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.75</span><span class="s0">, </span><span class="s3">0.25</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                        <span class="s1">rtol=</span><span class="s3">1e-15</span><span class="s0">, </span><span class="s1">atol=</span><span class="s3">1e-15</span><span class="s1">)</span>


<span class="s0">class </span><span class="s1">TestKaiser:</span>

    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s1">assert_allclose(windows.kaiser(</span><span class="s3">6</span><span class="s0">, </span><span class="s3">0.5</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.9403061933191572</span><span class="s0">, </span><span class="s3">0.9782962393705389</span><span class="s0">,</span>
                         <span class="s3">0.9975765035372042</span><span class="s0">, </span><span class="s3">0.9975765035372042</span><span class="s0">,</span>
                         <span class="s3">0.9782962393705389</span><span class="s0">, </span><span class="s3">0.9403061933191572</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.kaiser(</span><span class="s3">7</span><span class="s0">, </span><span class="s3">0.5</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.9403061933191572</span><span class="s0">, </span><span class="s3">0.9732402256999829</span><span class="s0">,</span>
                         <span class="s3">0.9932754654413773</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.9932754654413773</span><span class="s0">,</span>
                         <span class="s3">0.9732402256999829</span><span class="s0">, </span><span class="s3">0.9403061933191572</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.kaiser(</span><span class="s3">6</span><span class="s0">, </span><span class="s3">2.7</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.2603047507678832</span><span class="s0">, </span><span class="s3">0.6648106293528054</span><span class="s0">,</span>
                         <span class="s3">0.9582099802511439</span><span class="s0">, </span><span class="s3">0.9582099802511439</span><span class="s0">,</span>
                         <span class="s3">0.6648106293528054</span><span class="s0">, </span><span class="s3">0.2603047507678832</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.kaiser(</span><span class="s3">7</span><span class="s0">, </span><span class="s3">2.7</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.2603047507678832</span><span class="s0">, </span><span class="s3">0.5985765418119844</span><span class="s0">,</span>
                         <span class="s3">0.8868495172060835</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.8868495172060835</span><span class="s0">,</span>
                         <span class="s3">0.5985765418119844</span><span class="s0">, </span><span class="s3">0.2603047507678832</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.kaiser(</span><span class="s3">6</span><span class="s0">, </span><span class="s3">2.7</span><span class="s0">, False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.2603047507678832</span><span class="s0">, </span><span class="s3">0.5985765418119844</span><span class="s0">,</span>
                         <span class="s3">0.8868495172060835</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.8868495172060835</span><span class="s0">,</span>
                         <span class="s3">0.5985765418119844</span><span class="s1">])</span>


<span class="s0">class </span><span class="s1">TestKaiserBesselDerived:</span>

    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s1">M = </span><span class="s3">100</span>
        <span class="s1">w = windows.kaiser_bessel_derived(M</span><span class="s0">, </span><span class="s1">beta=</span><span class="s3">4.0</span><span class="s1">)</span>
        <span class="s1">w2 = windows.get_window((</span><span class="s2">'kaiser bessel derived'</span><span class="s0">, </span><span class="s3">4.0</span><span class="s1">)</span><span class="s0">,</span>
                                <span class="s1">M</span><span class="s0">, </span><span class="s1">fftbins=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s1">assert_allclose(w</span><span class="s0">, </span><span class="s1">w2)</span>

        <span class="s5"># Test for Princen-Bradley condition</span>
        <span class="s1">assert_allclose(w[:M // </span><span class="s3">2</span><span class="s1">] ** </span><span class="s3">2 </span><span class="s1">+ w[-M // </span><span class="s3">2</span><span class="s1">:] ** </span><span class="s3">2</span><span class="s0">, </span><span class="s3">1.</span><span class="s1">)</span>

        <span class="s5"># Test actual values from other implementations</span>
        <span class="s5"># M = 2:  sqrt(2) / 2</span>
        <span class="s5"># M = 4:  0.518562710536, 0.855039598640</span>
        <span class="s5"># M = 6:  0.436168993154, 0.707106781187, 0.899864772847</span>
        <span class="s5"># Ref:https://github.com/scipy/scipy/pull/4747#issuecomment-172849418</span>
        <span class="s1">assert_allclose(windows.kaiser_bessel_derived(</span><span class="s3">2</span><span class="s0">, </span><span class="s1">beta=np.pi / </span><span class="s3">2</span><span class="s1">)[:</span><span class="s3">1</span><span class="s1">]</span><span class="s0">,</span>
                        <span class="s1">np.sqrt(</span><span class="s3">2</span><span class="s1">) / </span><span class="s3">2</span><span class="s1">)</span>

        <span class="s1">assert_allclose(windows.kaiser_bessel_derived(</span><span class="s3">4</span><span class="s0">, </span><span class="s1">beta=np.pi / </span><span class="s3">2</span><span class="s1">)[:</span><span class="s3">2</span><span class="s1">]</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.518562710536</span><span class="s0">, </span><span class="s3">0.855039598640</span><span class="s1">])</span>

        <span class="s1">assert_allclose(windows.kaiser_bessel_derived(</span><span class="s3">6</span><span class="s0">, </span><span class="s1">beta=np.pi / </span><span class="s3">2</span><span class="s1">)[:</span><span class="s3">3</span><span class="s1">]</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.436168993154</span><span class="s0">, </span><span class="s3">0.707106781187</span><span class="s0">, </span><span class="s3">0.899864772847</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_exceptions(self):</span>
        <span class="s1">M = </span><span class="s3">100</span>
        <span class="s5"># Assert ValueError for odd window length</span>
        <span class="s1">msg = (</span><span class="s2">&quot;Kaiser-Bessel Derived windows are only defined for even &quot;</span>
               <span class="s2">&quot;number of points&quot;</span><span class="s1">)</span>
        <span class="s0">with </span><span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">match=msg):</span>
            <span class="s1">windows.kaiser_bessel_derived(M + </span><span class="s3">1</span><span class="s0">, </span><span class="s1">beta=</span><span class="s3">4.</span><span class="s1">)</span>

        <span class="s5"># Assert ValueError for non-symmetric setting</span>
        <span class="s1">msg = (</span><span class="s2">&quot;Kaiser-Bessel Derived windows are only defined for &quot;</span>
               <span class="s2">&quot;symmetric shapes&quot;</span><span class="s1">)</span>
        <span class="s0">with </span><span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">match=msg):</span>
            <span class="s1">windows.kaiser_bessel_derived(M + </span><span class="s3">1</span><span class="s0">, </span><span class="s1">beta=</span><span class="s3">4.</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">)</span>


<span class="s0">class </span><span class="s1">TestNuttall:</span>

    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s1">assert_allclose(windows.nuttall(</span><span class="s3">6</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.0003628</span><span class="s0">, </span><span class="s3">0.0613345</span><span class="s0">, </span><span class="s3">0.5292298</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.5292298</span><span class="s0">,</span>
                         <span class="s3">0.0613345</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.nuttall(</span><span class="s3">7</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.0003628</span><span class="s0">, </span><span class="s3">0.03777576895352025</span><span class="s0">, </span><span class="s3">0.3427276199688195</span><span class="s0">,</span>
                         <span class="s3">0.8918518610776603</span><span class="s0">, </span><span class="s3">0.8918518610776603</span><span class="s0">,</span>
                         <span class="s3">0.3427276199688196</span><span class="s0">, </span><span class="s3">0.0377757689535203</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.nuttall(</span><span class="s3">6</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.0003628</span><span class="s0">, </span><span class="s3">0.1105152530498718</span><span class="s0">, </span><span class="s3">0.7982580969501282</span><span class="s0">,</span>
                         <span class="s3">0.7982580969501283</span><span class="s0">, </span><span class="s3">0.1105152530498719</span><span class="s0">, </span><span class="s3">0.0003628</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.nuttall(</span><span class="s3">7</span><span class="s0">, True</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.0003628</span><span class="s0">, </span><span class="s3">0.0613345</span><span class="s0">, </span><span class="s3">0.5292298</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.5292298</span><span class="s0">,</span>
                         <span class="s3">0.0613345</span><span class="s0">, </span><span class="s3">0.0003628</span><span class="s1">])</span>


<span class="s0">class </span><span class="s1">TestParzen:</span>

    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s1">assert_allclose(windows.parzen(</span><span class="s3">6</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.009259259259259254</span><span class="s0">, </span><span class="s3">0.25</span><span class="s0">, </span><span class="s3">0.8611111111111112</span><span class="s0">,</span>
                         <span class="s3">0.8611111111111112</span><span class="s0">, </span><span class="s3">0.25</span><span class="s0">, </span><span class="s3">0.009259259259259254</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.parzen(</span><span class="s3">7</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">True</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.00583090379008747</span><span class="s0">, </span><span class="s3">0.1574344023323616</span><span class="s0">,</span>
                         <span class="s3">0.6501457725947521</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.6501457725947521</span><span class="s0">,</span>
                         <span class="s3">0.1574344023323616</span><span class="s0">, </span><span class="s3">0.00583090379008747</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.parzen(</span><span class="s3">6</span><span class="s0">, False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.00583090379008747</span><span class="s0">, </span><span class="s3">0.1574344023323616</span><span class="s0">,</span>
                         <span class="s3">0.6501457725947521</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.6501457725947521</span><span class="s0">,</span>
                         <span class="s3">0.1574344023323616</span><span class="s1">])</span>


<span class="s0">class </span><span class="s1">TestTriang:</span>

    <span class="s0">def </span><span class="s1">test_basic(self):</span>

        <span class="s1">assert_allclose(windows.triang(</span><span class="s3">6</span><span class="s0">, True</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">1</span><span class="s1">/</span><span class="s3">6</span><span class="s0">, </span><span class="s3">1</span><span class="s1">/</span><span class="s3">2</span><span class="s0">, </span><span class="s3">5</span><span class="s1">/</span><span class="s3">6</span><span class="s0">, </span><span class="s3">5</span><span class="s1">/</span><span class="s3">6</span><span class="s0">, </span><span class="s3">1</span><span class="s1">/</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s1">/</span><span class="s3">6</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.triang(</span><span class="s3">7</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">1</span><span class="s1">/</span><span class="s3">4</span><span class="s0">, </span><span class="s3">1</span><span class="s1">/</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">/</span><span class="s3">4</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">3</span><span class="s1">/</span><span class="s3">4</span><span class="s0">, </span><span class="s3">1</span><span class="s1">/</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s1">/</span><span class="s3">4</span><span class="s1">])</span>
        <span class="s1">assert_allclose(windows.triang(</span><span class="s3">6</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">1</span><span class="s1">/</span><span class="s3">4</span><span class="s0">, </span><span class="s3">1</span><span class="s1">/</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">/</span><span class="s3">4</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">3</span><span class="s1">/</span><span class="s3">4</span><span class="s0">, </span><span class="s3">1</span><span class="s1">/</span><span class="s3">2</span><span class="s1">])</span>


<span class="s1">tukey_data = {</span>
    <span class="s1">(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, True</span><span class="s1">): array([</span><span class="s3">0.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.0</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">0.9</span><span class="s0">, True</span><span class="s1">): array([</span><span class="s3">0.0</span><span class="s0">, </span><span class="s3">0.84312081893436686</span><span class="s0">,</span>
                           <span class="s3">0.84312081893436686</span><span class="s0">, </span><span class="s3">0.0</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, True</span><span class="s1">): array([</span><span class="s3">0.0</span><span class="s0">, </span><span class="s3">0.75</span><span class="s0">, </span><span class="s3">0.75</span><span class="s0">, </span><span class="s3">0.0</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, False</span><span class="s1">): array([</span><span class="s3">0.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">0.9</span><span class="s0">, False</span><span class="s1">): array([</span><span class="s3">0.0</span><span class="s0">, </span><span class="s3">0.58682408883346526</span><span class="s0">,</span>
                            <span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.58682408883346526</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, False</span><span class="s1">): array([</span><span class="s3">0.0</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.5</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">0.0</span><span class="s0">, True</span><span class="s1">): array([</span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">0.8</span><span class="s0">, True</span><span class="s1">): array([</span><span class="s3">0.0</span><span class="s0">, </span><span class="s3">0.69134171618254492</span><span class="s0">,</span>
                           <span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.69134171618254492</span><span class="s0">, </span><span class="s3">0.0</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, True</span><span class="s1">): array([</span><span class="s3">0.0</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.0</span><span class="s1">])</span><span class="s0">,</span>

    <span class="s1">(</span><span class="s3">6</span><span class="s0">, </span><span class="s3">0</span><span class="s1">): [</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">7</span><span class="s0">, </span><span class="s3">0</span><span class="s1">): [</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">6</span><span class="s0">, </span><span class="s3">.25</span><span class="s1">): [</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">7</span><span class="s0">, </span><span class="s3">.25</span><span class="s1">): [</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">6</span><span class="s0">,</span><span class="s1">): [</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.9045084971874737</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.9045084971874735</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">7</span><span class="s0">,</span><span class="s1">): [</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.75</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.75</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">6</span><span class="s0">, </span><span class="s3">.75</span><span class="s1">): [</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.5522642316338269</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.5522642316338267</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">7</span><span class="s0">, </span><span class="s3">.75</span><span class="s1">): [</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.4131759111665348</span><span class="s0">, </span><span class="s3">0.9698463103929542</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">,</span>
               <span class="s3">0.9698463103929542</span><span class="s0">, </span><span class="s3">0.4131759111665347</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">6</span><span class="s0">, </span><span class="s3">1</span><span class="s1">): [</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.3454915028125263</span><span class="s0">, </span><span class="s3">0.9045084971874737</span><span class="s0">, </span><span class="s3">0.9045084971874737</span><span class="s0">,</span>
             <span class="s3">0.3454915028125263</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s3">7</span><span class="s0">, </span><span class="s3">1</span><span class="s1">): [</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.25</span><span class="s0">, </span><span class="s3">0.75</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.75</span><span class="s0">, </span><span class="s3">0.25</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
<span class="s1">}</span>


<span class="s0">class </span><span class="s1">TestTukey:</span>

    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s5"># Test against hardcoded data</span>
        <span class="s0">for </span><span class="s1">k</span><span class="s0">, </span><span class="s1">v </span><span class="s0">in </span><span class="s1">tukey_data.items():</span>
            <span class="s0">if </span><span class="s1">v </span><span class="s0">is None</span><span class="s1">:</span>
                <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">windows.tukey</span><span class="s0">, </span><span class="s1">*k)</span>
            <span class="s0">else</span><span class="s1">:</span>
                <span class="s1">win = windows.tukey(*k)</span>
                <span class="s1">assert_allclose(win</span><span class="s0">, </span><span class="s1">v</span><span class="s0">, </span><span class="s1">rtol=</span><span class="s3">1e-15</span><span class="s0">, </span><span class="s1">atol=</span><span class="s3">1e-15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_extremes(self):</span>
        <span class="s5"># Test extremes of alpha correspond to boxcar and hann</span>
        <span class="s1">tuk0 = windows.tukey(</span><span class="s3">100</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">box0 = windows.boxcar(</span><span class="s3">100</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(tuk0</span><span class="s0">, </span><span class="s1">box0)</span>

        <span class="s1">tuk1 = windows.tukey(</span><span class="s3">100</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">han1 = windows.hann(</span><span class="s3">100</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(tuk1</span><span class="s0">, </span><span class="s1">han1)</span>


<span class="s1">dpss_data = {</span>
    <span class="s5"># All values from MATLAB:</span>
    <span class="s5"># * taper[1] of (3, 1.4, 3) sign-flipped</span>
    <span class="s5"># * taper[3] of (5, 1.5, 5) sign-flipped</span>
    <span class="s1">(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">): ([[</span><span class="s3">0.497943898</span><span class="s0">, </span><span class="s3">0.502047681</span><span class="s0">, </span><span class="s3">0.502047681</span><span class="s0">, </span><span class="s3">0.497943898</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.670487993</span><span class="s0">, </span><span class="s3">0.224601537</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.224601537</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.670487993</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.197961815</span><span class="s0">, </span><span class="s3">0.002035474</span><span class="s1">])</span><span class="s0">,  </span><span class="s5"># noqa</span>
    <span class="s1">(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">1.4</span><span class="s0">, </span><span class="s3">3</span><span class="s1">): ([[</span><span class="s3">0.410233151</span><span class="s0">, </span><span class="s3">0.814504464</span><span class="s0">, </span><span class="s3">0.410233151</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.707106781</span><span class="s0">, </span><span class="s3">0.0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.707106781</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.575941629</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.580157287</span><span class="s0">, </span><span class="s3">0.575941629</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.999998093</span><span class="s0">, </span><span class="s3">0.998067480</span><span class="s0">, </span><span class="s3">0.801934426</span><span class="s1">])</span><span class="s0">,  </span><span class="s5"># noqa</span>
    <span class="s1">(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">1.5</span><span class="s0">, </span><span class="s3">5</span><span class="s1">): ([[</span><span class="s3">0.1745071052</span><span class="s0">, </span><span class="s3">0.4956749177</span><span class="s0">, </span><span class="s3">0.669109327</span><span class="s0">, </span><span class="s3">0.495674917</span><span class="s0">, </span><span class="s3">0.174507105</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.4399493348</span><span class="s0">, </span><span class="s3">0.553574369</span><span class="s0">, </span><span class="s3">0.0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.553574369</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.439949334</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.631452756</span><span class="s0">, </span><span class="s3">0.073280238</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.437943884</span><span class="s0">, </span><span class="s3">0.073280238</span><span class="s0">, </span><span class="s3">0.631452756</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.553574369</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.439949334</span><span class="s0">, </span><span class="s3">0.0</span><span class="s0">, </span><span class="s3">0.439949334</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.553574369</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.266110290</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.498935248</span><span class="s0">, </span><span class="s3">0.600414741</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.498935248</span><span class="s0">, </span><span class="s3">0.266110290147157</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.999728571</span><span class="s0">, </span><span class="s3">0.983706916</span><span class="s0">, </span><span class="s3">0.768457889</span><span class="s0">, </span><span class="s3">0.234159338</span><span class="s0">, </span><span class="s3">0.013947282907567</span><span class="s1">])</span><span class="s0">,  </span><span class="s5"># noqa: E501</span>
    <span class="s1">(</span><span class="s3">100</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">4</span><span class="s1">): ([[</span><span class="s3">0.0030914414</span><span class="s0">, </span><span class="s3">0.0041266922</span><span class="s0">, </span><span class="s3">0.005315076</span><span class="s0">, </span><span class="s3">0.006665149</span><span class="s0">, </span><span class="s3">0.008184854</span><span class="s0">, </span><span class="s3">0.0098814158</span><span class="s0">, </span><span class="s3">0.011761239</span><span class="s0">, </span><span class="s3">0.013829809</span><span class="s0">, </span><span class="s3">0.016091597</span><span class="s0">, </span><span class="s3">0.018549973</span><span class="s0">, </span><span class="s3">0.02120712</span><span class="s0">, </span><span class="s3">0.02406396</span><span class="s0">, </span><span class="s3">0.027120092</span><span class="s0">, </span><span class="s3">0.030373728</span><span class="s0">, </span><span class="s3">0.033821651</span><span class="s0">, </span><span class="s3">0.037459181</span><span class="s0">, </span><span class="s3">0.041280145</span><span class="s0">, </span><span class="s3">0.045276872</span><span class="s0">, </span><span class="s3">0.049440192</span><span class="s0">, </span><span class="s3">0.053759447</span><span class="s0">, </span><span class="s3">0.058222524</span><span class="s0">, </span><span class="s3">0.062815894</span><span class="s0">, </span><span class="s3">0.067524661</span><span class="s0">, </span><span class="s3">0.072332638</span><span class="s0">, </span><span class="s3">0.077222418</span><span class="s0">, </span><span class="s3">0.082175473</span><span class="s0">, </span><span class="s3">0.087172252</span><span class="s0">, </span><span class="s3">0.092192299</span><span class="s0">, </span><span class="s3">0.097214376</span><span class="s0">, </span><span class="s3">0.1022166</span><span class="s0">, </span><span class="s3">0.10717657</span><span class="s0">, </span><span class="s3">0.11207154</span><span class="s0">, </span><span class="s3">0.11687856</span><span class="s0">, </span><span class="s3">0.12157463</span><span class="s0">, </span><span class="s3">0.12613686</span><span class="s0">, </span><span class="s3">0.13054266</span><span class="s0">, </span><span class="s3">0.13476986</span><span class="s0">, </span><span class="s3">0.13879691</span><span class="s0">, </span><span class="s3">0.14260302</span><span class="s0">, </span><span class="s3">0.14616832</span><span class="s0">, </span><span class="s3">0.14947401</span><span class="s0">, </span><span class="s3">0.1525025</span><span class="s0">, </span><span class="s3">0.15523755</span><span class="s0">, </span><span class="s3">0.15766438</span><span class="s0">, </span><span class="s3">0.15976981</span><span class="s0">, </span><span class="s3">0.16154233</span><span class="s0">, </span><span class="s3">0.16297223</span><span class="s0">, </span><span class="s3">0.16405162</span><span class="s0">, </span><span class="s3">0.16477455</span><span class="s0">, </span><span class="s3">0.16513702</span><span class="s0">, </span><span class="s3">0.16513702</span><span class="s0">, </span><span class="s3">0.16477455</span><span class="s0">, </span><span class="s3">0.16405162</span><span class="s0">, </span><span class="s3">0.16297223</span><span class="s0">, </span><span class="s3">0.16154233</span><span class="s0">, </span><span class="s3">0.15976981</span><span class="s0">, </span><span class="s3">0.15766438</span><span class="s0">, </span><span class="s3">0.15523755</span><span class="s0">, </span><span class="s3">0.1525025</span><span class="s0">, </span><span class="s3">0.14947401</span><span class="s0">, </span><span class="s3">0.14616832</span><span class="s0">, </span><span class="s3">0.14260302</span><span class="s0">, </span><span class="s3">0.13879691</span><span class="s0">, </span><span class="s3">0.13476986</span><span class="s0">, </span><span class="s3">0.13054266</span><span class="s0">, </span><span class="s3">0.12613686</span><span class="s0">, </span><span class="s3">0.12157463</span><span class="s0">, </span><span class="s3">0.11687856</span><span class="s0">, </span><span class="s3">0.11207154</span><span class="s0">, </span><span class="s3">0.10717657</span><span class="s0">, </span><span class="s3">0.1022166</span><span class="s0">, </span><span class="s3">0.097214376</span><span class="s0">, </span><span class="s3">0.092192299</span><span class="s0">, </span><span class="s3">0.087172252</span><span class="s0">, </span><span class="s3">0.082175473</span><span class="s0">, </span><span class="s3">0.077222418</span><span class="s0">, </span><span class="s3">0.072332638</span><span class="s0">, </span><span class="s3">0.067524661</span><span class="s0">, </span><span class="s3">0.062815894</span><span class="s0">, </span><span class="s3">0.058222524</span><span class="s0">, </span><span class="s3">0.053759447</span><span class="s0">, </span><span class="s3">0.049440192</span><span class="s0">, </span><span class="s3">0.045276872</span><span class="s0">, </span><span class="s3">0.041280145</span><span class="s0">, </span><span class="s3">0.037459181</span><span class="s0">, </span><span class="s3">0.033821651</span><span class="s0">, </span><span class="s3">0.030373728</span><span class="s0">, </span><span class="s3">0.027120092</span><span class="s0">, </span><span class="s3">0.02406396</span><span class="s0">, </span><span class="s3">0.02120712</span><span class="s0">, </span><span class="s3">0.018549973</span><span class="s0">, </span><span class="s3">0.016091597</span><span class="s0">, </span><span class="s3">0.013829809</span><span class="s0">, </span><span class="s3">0.011761239</span><span class="s0">, </span><span class="s3">0.0098814158</span><span class="s0">, </span><span class="s3">0.008184854</span><span class="s0">, </span><span class="s3">0.006665149</span><span class="s0">, </span><span class="s3">0.005315076</span><span class="s0">, </span><span class="s3">0.0041266922</span><span class="s0">, </span><span class="s3">0.0030914414</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.018064449</span><span class="s0">, </span><span class="s3">0.022040342</span><span class="s0">, </span><span class="s3">0.026325013</span><span class="s0">, </span><span class="s3">0.030905288</span><span class="s0">, </span><span class="s3">0.035764398</span><span class="s0">, </span><span class="s3">0.040881982</span><span class="s0">, </span><span class="s3">0.046234148</span><span class="s0">, </span><span class="s3">0.051793558</span><span class="s0">, </span><span class="s3">0.057529559</span><span class="s0">, </span><span class="s3">0.063408356</span><span class="s0">, </span><span class="s3">0.069393216</span><span class="s0">, </span><span class="s3">0.075444716</span><span class="s0">, </span><span class="s3">0.081521022</span><span class="s0">, </span><span class="s3">0.087578202</span><span class="s0">, </span><span class="s3">0.093570567</span><span class="s0">, </span><span class="s3">0.099451049</span><span class="s0">, </span><span class="s3">0.10517159</span><span class="s0">, </span><span class="s3">0.11068356</span><span class="s0">, </span><span class="s3">0.11593818</span><span class="s0">, </span><span class="s3">0.12088699</span><span class="s0">, </span><span class="s3">0.12548227</span><span class="s0">, </span><span class="s3">0.12967752</span><span class="s0">, </span><span class="s3">0.1334279</span><span class="s0">, </span><span class="s3">0.13669069</span><span class="s0">, </span><span class="s3">0.13942569</span><span class="s0">, </span><span class="s3">0.1415957</span><span class="s0">, </span><span class="s3">0.14316686</span><span class="s0">, </span><span class="s3">0.14410905</span><span class="s0">, </span><span class="s3">0.14439626</span><span class="s0">, </span><span class="s3">0.14400686</span><span class="s0">, </span><span class="s3">0.14292389</span><span class="s0">, </span><span class="s3">0.1411353</span><span class="s0">, </span><span class="s3">0.13863416</span><span class="s0">, </span><span class="s3">0.13541876</span><span class="s0">, </span><span class="s3">0.13149274</span><span class="s0">, </span><span class="s3">0.12686516</span><span class="s0">, </span><span class="s3">0.12155045</span><span class="s0">, </span><span class="s3">0.1155684</span><span class="s0">, </span><span class="s3">0.10894403</span><span class="s0">, </span><span class="s3">0.10170748</span><span class="s0">, </span><span class="s3">0.093893752</span><span class="s0">, </span><span class="s3">0.08554251</span><span class="s0">, </span><span class="s3">0.076697768</span><span class="s0">, </span><span class="s3">0.067407559</span><span class="s0">, </span><span class="s3">0.057723559</span><span class="s0">, </span><span class="s3">0.04770068</span><span class="s0">, </span><span class="s3">0.037396627</span><span class="s0">, </span><span class="s3">0.026871428</span><span class="s0">, </span><span class="s3">0.016186944</span><span class="s0">, </span><span class="s3">0.0054063557</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.0054063557</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.016186944</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.026871428</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.037396627</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.04770068</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.057723559</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.067407559</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.076697768</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.08554251</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.093893752</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.10170748</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.10894403</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.1155684</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.12155045</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.12686516</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.13149274</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.13541876</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.13863416</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.1411353</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.14292389</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.14400686</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.14439626</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.14410905</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.14316686</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.1415957</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.13942569</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.13669069</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.1334279</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.12967752</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.12548227</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.12088699</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.11593818</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.11068356</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.10517159</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.099451049</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.093570567</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.087578202</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.081521022</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.075444716</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.069393216</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.063408356</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.057529559</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.051793558</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.046234148</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.040881982</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.035764398</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.030905288</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.026325013</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.022040342</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.018064449</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.064817553</span><span class="s0">, </span><span class="s3">0.072567801</span><span class="s0">, </span><span class="s3">0.080292992</span><span class="s0">, </span><span class="s3">0.087918235</span><span class="s0">, </span><span class="s3">0.095367076</span><span class="s0">, </span><span class="s3">0.10256232</span><span class="s0">, </span><span class="s3">0.10942687</span><span class="s0">, </span><span class="s3">0.1158846</span><span class="s0">, </span><span class="s3">0.12186124</span><span class="s0">, </span><span class="s3">0.12728523</span><span class="s0">, </span><span class="s3">0.13208858</span><span class="s0">, </span><span class="s3">0.13620771</span><span class="s0">, </span><span class="s3">0.13958427</span><span class="s0">, </span><span class="s3">0.14216587</span><span class="s0">, </span><span class="s3">0.14390678</span><span class="s0">, </span><span class="s3">0.14476863</span><span class="s0">, </span><span class="s3">0.1447209</span><span class="s0">, </span><span class="s3">0.14374148</span><span class="s0">, </span><span class="s3">0.14181704</span><span class="s0">, </span><span class="s3">0.13894336</span><span class="s0">, </span><span class="s3">0.13512554</span><span class="s0">, </span><span class="s3">0.13037812</span><span class="s0">, </span><span class="s3">0.1247251</span><span class="s0">, </span><span class="s3">0.11819984</span><span class="s0">, </span><span class="s3">0.11084487</span><span class="s0">, </span><span class="s3">0.10271159</span><span class="s0">, </span><span class="s3">0.093859853</span><span class="s0">, </span><span class="s3">0.084357497</span><span class="s0">, </span><span class="s3">0.074279719</span><span class="s0">, </span><span class="s3">0.063708406</span><span class="s0">, </span><span class="s3">0.052731374</span><span class="s0">, </span><span class="s3">0.041441525</span><span class="s0">, </span><span class="s3">0.029935953</span><span class="s0">, </span><span class="s3">0.018314987</span><span class="s0">, </span><span class="s3">0.0066811877</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.0048616765</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.016209689</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.027259848</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.037911124</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.048065512</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.05762905</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.066512804</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.0746338</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.081915903</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.088290621</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.09369783</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.098086416</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.10141482</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.10365146</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.10477512</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.10477512</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.10365146</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.10141482</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.098086416</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.09369783</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.088290621</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.081915903</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.0746338</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.066512804</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.05762905</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.048065512</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.037911124</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.027259848</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.016209689</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.0048616765</span><span class="s0">, </span><span class="s3">0.0066811877</span><span class="s0">, </span><span class="s3">0.018314987</span><span class="s0">, </span><span class="s3">0.029935953</span><span class="s0">, </span><span class="s3">0.041441525</span><span class="s0">, </span><span class="s3">0.052731374</span><span class="s0">, </span><span class="s3">0.063708406</span><span class="s0">, </span><span class="s3">0.074279719</span><span class="s0">, </span><span class="s3">0.084357497</span><span class="s0">, </span><span class="s3">0.093859853</span><span class="s0">, </span><span class="s3">0.10271159</span><span class="s0">, </span><span class="s3">0.11084487</span><span class="s0">, </span><span class="s3">0.11819984</span><span class="s0">, </span><span class="s3">0.1247251</span><span class="s0">, </span><span class="s3">0.13037812</span><span class="s0">, </span><span class="s3">0.13512554</span><span class="s0">, </span><span class="s3">0.13894336</span><span class="s0">, </span><span class="s3">0.14181704</span><span class="s0">, </span><span class="s3">0.14374148</span><span class="s0">, </span><span class="s3">0.1447209</span><span class="s0">, </span><span class="s3">0.14476863</span><span class="s0">, </span><span class="s3">0.14390678</span><span class="s0">, </span><span class="s3">0.14216587</span><span class="s0">, </span><span class="s3">0.13958427</span><span class="s0">, </span><span class="s3">0.13620771</span><span class="s0">, </span><span class="s3">0.13208858</span><span class="s0">, </span><span class="s3">0.12728523</span><span class="s0">, </span><span class="s3">0.12186124</span><span class="s0">, </span><span class="s3">0.1158846</span><span class="s0">, </span><span class="s3">0.10942687</span><span class="s0">, </span><span class="s3">0.10256232</span><span class="s0">, </span><span class="s3">0.095367076</span><span class="s0">, </span><span class="s3">0.087918235</span><span class="s0">, </span><span class="s3">0.080292992</span><span class="s0">, </span><span class="s3">0.072567801</span><span class="s0">, </span><span class="s3">0.064817553</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.14985551</span><span class="s0">, </span><span class="s3">0.15512305</span><span class="s0">, </span><span class="s3">0.15931467</span><span class="s0">, </span><span class="s3">0.16236806</span><span class="s0">, </span><span class="s3">0.16423291</span><span class="s0">, </span><span class="s3">0.16487165</span><span class="s0">, </span><span class="s3">0.16426009</span><span class="s0">, </span><span class="s3">0.1623879</span><span class="s0">, </span><span class="s3">0.1592589</span><span class="s0">, </span><span class="s3">0.15489114</span><span class="s0">, </span><span class="s3">0.14931693</span><span class="s0">, </span><span class="s3">0.14258255</span><span class="s0">, </span><span class="s3">0.13474785</span><span class="s0">, </span><span class="s3">0.1258857</span><span class="s0">, </span><span class="s3">0.11608124</span><span class="s0">, </span><span class="s3">0.10543095</span><span class="s0">, </span><span class="s3">0.094041635</span><span class="s0">, </span><span class="s3">0.082029213</span><span class="s0">, </span><span class="s3">0.069517411</span><span class="s0">, </span><span class="s3">0.056636348</span><span class="s0">, </span><span class="s3">0.043521028</span><span class="s0">, </span><span class="s3">0.030309756</span><span class="s0">, </span><span class="s3">0.017142511</span><span class="s0">, </span><span class="s3">0.0041592774</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.0085016282</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.020705223</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.032321494</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.043226982</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.053306291</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.062453515</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.070573544</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.077583253</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.083412547</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.088005244</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.091319802</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.093329861</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.094024602</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.093408915</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.091503383</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.08834406</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.08398207</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.078483012</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.071926192</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.064403681</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.056019215</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.046886954</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.037130106</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.026879442</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.016271713</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.005448</span><span class="s0">, </span><span class="s3">0.005448</span><span class="s0">, </span><span class="s3">0.016271713</span><span class="s0">, </span><span class="s3">0.026879442</span><span class="s0">, </span><span class="s3">0.037130106</span><span class="s0">, </span><span class="s3">0.046886954</span><span class="s0">, </span><span class="s3">0.056019215</span><span class="s0">, </span><span class="s3">0.064403681</span><span class="s0">, </span><span class="s3">0.071926192</span><span class="s0">, </span><span class="s3">0.078483012</span><span class="s0">, </span><span class="s3">0.08398207</span><span class="s0">, </span><span class="s3">0.08834406</span><span class="s0">, </span><span class="s3">0.091503383</span><span class="s0">, </span><span class="s3">0.093408915</span><span class="s0">, </span><span class="s3">0.094024602</span><span class="s0">, </span><span class="s3">0.093329861</span><span class="s0">, </span><span class="s3">0.091319802</span><span class="s0">, </span><span class="s3">0.088005244</span><span class="s0">, </span><span class="s3">0.083412547</span><span class="s0">, </span><span class="s3">0.077583253</span><span class="s0">, </span><span class="s3">0.070573544</span><span class="s0">, </span><span class="s3">0.062453515</span><span class="s0">, </span><span class="s3">0.053306291</span><span class="s0">, </span><span class="s3">0.043226982</span><span class="s0">, </span><span class="s3">0.032321494</span><span class="s0">, </span><span class="s3">0.020705223</span><span class="s0">, </span><span class="s3">0.0085016282</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.0041592774</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.017142511</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.030309756</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.043521028</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.056636348</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.069517411</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.082029213</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.094041635</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.10543095</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.11608124</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.1258857</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.13474785</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.14258255</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.14931693</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.15489114</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.1592589</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.1623879</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.16426009</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.16487165</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.16423291</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.16236806</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.15931467</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.15512305</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.14985551</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.999943140</span><span class="s0">, </span><span class="s3">0.997571533</span><span class="s0">, </span><span class="s3">0.959465463</span><span class="s0">, </span><span class="s3">0.721862496</span><span class="s1">])</span><span class="s0">,  </span><span class="s5"># noqa: E501</span>
<span class="s1">}</span>


<span class="s0">class </span><span class="s1">TestDPSS:</span>

    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s5"># Test against hardcoded data</span>
        <span class="s0">for </span><span class="s1">k</span><span class="s0">, </span><span class="s1">v </span><span class="s0">in </span><span class="s1">dpss_data.items():</span>
            <span class="s1">win</span><span class="s0">, </span><span class="s1">ratios = windows.dpss(*k</span><span class="s0">, </span><span class="s1">return_ratios=</span><span class="s0">True</span><span class="s1">)</span>
            <span class="s1">assert_allclose(win</span><span class="s0">, </span><span class="s1">v[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">atol=</span><span class="s3">1e-7</span><span class="s0">, </span><span class="s1">err_msg=k)</span>
            <span class="s1">assert_allclose(ratios</span><span class="s0">, </span><span class="s1">v[</span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">rtol=</span><span class="s3">1e-5</span><span class="s0">, </span><span class="s1">atol=</span><span class="s3">1e-7</span><span class="s0">, </span><span class="s1">err_msg=k)</span>

    <span class="s0">def </span><span class="s1">test_unity(self):</span>
        <span class="s5"># Test unity value handling (gh-2221)</span>
        <span class="s0">for </span><span class="s1">M </span><span class="s0">in </span><span class="s1">range(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">21</span><span class="s1">):</span>
            <span class="s5"># corrected w/approximation (default)</span>
            <span class="s1">win = windows.dpss(M</span><span class="s0">, </span><span class="s1">M / </span><span class="s3">2.1</span><span class="s1">)</span>
            <span class="s1">expected = M % </span><span class="s3">2  </span><span class="s5"># one for odd, none for even</span>
            <span class="s1">assert_equal(np.isclose(win</span><span class="s0">, </span><span class="s3">1.</span><span class="s1">).sum()</span><span class="s0">, </span><span class="s1">expected</span><span class="s0">,</span>
                         <span class="s1">err_msg=</span><span class="s2">f'</span><span class="s0">{</span><span class="s1">win</span><span class="s0">}</span><span class="s2">'</span><span class="s1">)</span>
            <span class="s5"># corrected w/subsample delay (slower)</span>
            <span class="s1">win_sub = windows.dpss(M</span><span class="s0">, </span><span class="s1">M / </span><span class="s3">2.1</span><span class="s0">, </span><span class="s1">norm=</span><span class="s2">'subsample'</span><span class="s1">)</span>
            <span class="s0">if </span><span class="s1">M &gt; </span><span class="s3">2</span><span class="s1">:</span>
                <span class="s5"># @M=2 the subsample doesn't do anything</span>
                <span class="s1">assert_equal(np.isclose(win_sub</span><span class="s0">, </span><span class="s3">1.</span><span class="s1">).sum()</span><span class="s0">, </span><span class="s1">expected</span><span class="s0">,</span>
                             <span class="s1">err_msg=</span><span class="s2">f'</span><span class="s0">{</span><span class="s1">win_sub</span><span class="s0">}</span><span class="s2">'</span><span class="s1">)</span>
                <span class="s1">assert_allclose(win</span><span class="s0">, </span><span class="s1">win_sub</span><span class="s0">, </span><span class="s1">rtol=</span><span class="s3">0.03</span><span class="s1">)  </span><span class="s5"># within 3%</span>
            <span class="s5"># not the same, l2-norm</span>
            <span class="s1">win_2 = windows.dpss(M</span><span class="s0">, </span><span class="s1">M / </span><span class="s3">2.1</span><span class="s0">, </span><span class="s1">norm=</span><span class="s3">2</span><span class="s1">)</span>
            <span class="s1">expected = </span><span class="s3">1 </span><span class="s0">if </span><span class="s1">M == </span><span class="s3">1 </span><span class="s0">else </span><span class="s3">0</span>
            <span class="s1">assert_equal(np.isclose(win_2</span><span class="s0">, </span><span class="s3">1.</span><span class="s1">).sum()</span><span class="s0">, </span><span class="s1">expected</span><span class="s0">,</span>
                         <span class="s1">err_msg=</span><span class="s2">f'</span><span class="s0">{</span><span class="s1">win_2</span><span class="s0">}</span><span class="s2">'</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_extremes(self):</span>
        <span class="s5"># Test extremes of alpha</span>
        <span class="s1">lam = windows.dpss(</span><span class="s3">31</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s1">return_ratios=</span><span class="s0">True</span><span class="s1">)[</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">assert_array_almost_equal(lam</span><span class="s0">, </span><span class="s3">1.</span><span class="s1">)</span>
        <span class="s1">lam = windows.dpss(</span><span class="s3">31</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s1">return_ratios=</span><span class="s0">True</span><span class="s1">)[</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">assert_array_almost_equal(lam</span><span class="s0">, </span><span class="s3">1.</span><span class="s1">)</span>
        <span class="s1">lam = windows.dpss(</span><span class="s3">31</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s1">return_ratios=</span><span class="s0">True</span><span class="s1">)[</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">assert_array_almost_equal(lam</span><span class="s0">, </span><span class="s3">1.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_degenerate(self):</span>
        <span class="s5"># Test failures</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">windows.dpss</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">1.5</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s1">)  </span><span class="s5"># Bad Kmax</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">windows.dpss</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">1.5</span><span class="s0">, </span><span class="s1">-</span><span class="s3">5</span><span class="s1">)</span>
        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">windows.dpss</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">1.5</span><span class="s0">, </span><span class="s3">1.1</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">windows.dpss</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">1.5</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)  </span><span class="s5"># NW must be &lt; N/2.</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">windows.dpss</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)  </span><span class="s5"># NW must be pos</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">windows.dpss</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">windows.dpss</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)  </span><span class="s5"># negative M</span>


<span class="s0">class </span><span class="s1">TestLanczos:</span>

    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s5"># Analytical results:</span>
        <span class="s5"># sinc(x) = sinc(-x)</span>
        <span class="s5"># sinc(pi) = 0, sinc(0) = 1</span>
        <span class="s5"># Hand computation on WolframAlpha:</span>
        <span class="s5"># sinc(2 pi / 3) = 0.413496672</span>
        <span class="s5"># sinc(pi / 3) = 0.826993343</span>
        <span class="s5"># sinc(3 pi / 5) = 0.504551152</span>
        <span class="s5"># sinc(pi / 5) = 0.935489284</span>
        <span class="s1">assert_allclose(windows.lanczos(</span><span class="s3">6</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.</span><span class="s0">, </span><span class="s3">0.413496672</span><span class="s0">,</span>
                         <span class="s3">0.826993343</span><span class="s0">, </span><span class="s3">1.</span><span class="s0">, </span><span class="s3">0.826993343</span><span class="s0">,</span>
                         <span class="s3">0.413496672</span><span class="s1">]</span><span class="s0">,</span>
                        <span class="s1">atol=</span><span class="s3">1e-9</span><span class="s1">)</span>
        <span class="s1">assert_allclose(windows.lanczos(</span><span class="s3">6</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.</span><span class="s0">, </span><span class="s3">0.504551152</span><span class="s0">,</span>
                         <span class="s3">0.935489284</span><span class="s0">, </span><span class="s3">0.935489284</span><span class="s0">,</span>
                         <span class="s3">0.504551152</span><span class="s0">, </span><span class="s3">0.</span><span class="s1">]</span><span class="s0">,</span>
                        <span class="s1">atol=</span><span class="s3">1e-9</span><span class="s1">)</span>
        <span class="s1">assert_allclose(windows.lanczos(</span><span class="s3">7</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">True</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.</span><span class="s0">, </span><span class="s3">0.413496672</span><span class="s0">,</span>
                         <span class="s3">0.826993343</span><span class="s0">, </span><span class="s3">1.</span><span class="s0">, </span><span class="s3">0.826993343</span><span class="s0">,</span>
                         <span class="s3">0.413496672</span><span class="s0">, </span><span class="s3">0.</span><span class="s1">]</span><span class="s0">,</span>
                        <span class="s1">atol=</span><span class="s3">1e-9</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_array_size(self):</span>
        <span class="s0">for </span><span class="s1">n </span><span class="s0">in </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">11</span><span class="s1">]:</span>
            <span class="s1">assert_equal(len(windows.lanczos(n</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">))</span><span class="s0">, </span><span class="s1">n)</span>
            <span class="s1">assert_equal(len(windows.lanczos(n</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">True</span><span class="s1">))</span><span class="s0">, </span><span class="s1">n)</span>


<span class="s0">class </span><span class="s1">TestGetWindow:</span>

    <span class="s0">def </span><span class="s1">test_boxcar(self):</span>
        <span class="s1">w = windows.get_window(</span><span class="s2">'boxcar'</span><span class="s0">, </span><span class="s3">12</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(w</span><span class="s0">, </span><span class="s1">np.ones_like(w))</span>

        <span class="s5"># window is a tuple of len 1</span>
        <span class="s1">w = windows.get_window((</span><span class="s2">'boxcar'</span><span class="s0">,</span><span class="s1">)</span><span class="s0">, </span><span class="s3">16</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(w</span><span class="s0">, </span><span class="s1">np.ones_like(w))</span>

    <span class="s0">def </span><span class="s1">test_cheb_odd(self):</span>
        <span class="s0">with </span><span class="s1">suppress_warnings() </span><span class="s0">as </span><span class="s1">sup:</span>
            <span class="s1">sup.filter(UserWarning</span><span class="s0">, </span><span class="s2">&quot;This window is not suitable&quot;</span><span class="s1">)</span>
            <span class="s1">w = windows.get_window((</span><span class="s2">'chebwin'</span><span class="s0">, </span><span class="s1">-</span><span class="s3">40</span><span class="s1">)</span><span class="s0">, </span><span class="s3">53</span><span class="s0">, </span><span class="s1">fftbins=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(w</span><span class="s0">, </span><span class="s1">cheb_odd_true</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">4</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_cheb_even(self):</span>
        <span class="s0">with </span><span class="s1">suppress_warnings() </span><span class="s0">as </span><span class="s1">sup:</span>
            <span class="s1">sup.filter(UserWarning</span><span class="s0">, </span><span class="s2">&quot;This window is not suitable&quot;</span><span class="s1">)</span>
            <span class="s1">w = windows.get_window((</span><span class="s2">'chebwin'</span><span class="s0">, </span><span class="s3">40</span><span class="s1">)</span><span class="s0">, </span><span class="s3">54</span><span class="s0">, </span><span class="s1">fftbins=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(w</span><span class="s0">, </span><span class="s1">cheb_even_true</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">4</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_dpss(self):</span>
        <span class="s1">win1 = windows.get_window((</span><span class="s2">'dpss'</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span><span class="s0">, </span><span class="s3">64</span><span class="s0">, </span><span class="s1">fftbins=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s1">win2 = windows.dpss(</span><span class="s3">64</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(win1</span><span class="s0">, </span><span class="s1">win2</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">4</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_kaiser_float(self):</span>
        <span class="s1">win1 = windows.get_window(</span><span class="s3">7.2</span><span class="s0">, </span><span class="s3">64</span><span class="s1">)</span>
        <span class="s1">win2 = windows.kaiser(</span><span class="s3">64</span><span class="s0">, </span><span class="s3">7.2</span><span class="s0">, False</span><span class="s1">)</span>
        <span class="s1">assert_allclose(win1</span><span class="s0">, </span><span class="s1">win2)</span>

    <span class="s0">def </span><span class="s1">test_invalid_inputs(self):</span>
        <span class="s5"># Window is not a float, tuple, or string</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">windows.get_window</span><span class="s0">, </span><span class="s1">set(</span><span class="s2">'hann'</span><span class="s1">)</span><span class="s0">, </span><span class="s3">8</span><span class="s1">)</span>

        <span class="s5"># Unknown window type error</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">windows.get_window</span><span class="s0">, </span><span class="s2">'broken'</span><span class="s0">, </span><span class="s3">4</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_array_as_window(self):</span>
        <span class="s5"># github issue 3603</span>
        <span class="s1">osfactor = </span><span class="s3">128</span>
        <span class="s1">sig = np.arange(</span><span class="s3">128</span><span class="s1">)</span>

        <span class="s1">win = windows.get_window((</span><span class="s2">'kaiser'</span><span class="s0">, </span><span class="s3">8.0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">osfactor // </span><span class="s3">2</span><span class="s1">)</span>
        <span class="s0">with </span><span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">match=</span><span class="s2">'must have the same length'</span><span class="s1">):</span>
            <span class="s1">resample(sig</span><span class="s0">, </span><span class="s1">len(sig) * osfactor</span><span class="s0">, </span><span class="s1">window=win)</span>

    <span class="s0">def </span><span class="s1">test_general_cosine(self):</span>
        <span class="s1">assert_allclose(get_window((</span><span class="s2">'general_cosine'</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.3</span><span class="s0">, </span><span class="s3">0.2</span><span class="s1">])</span><span class="s0">, </span><span class="s3">4</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.4</span><span class="s0">, </span><span class="s3">0.3</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0.3</span><span class="s1">])</span>
        <span class="s1">assert_allclose(get_window((</span><span class="s2">'general_cosine'</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.3</span><span class="s0">, </span><span class="s3">0.2</span><span class="s1">])</span><span class="s0">, </span><span class="s3">4</span><span class="s0">,</span>
                                   <span class="s1">fftbins=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.4</span><span class="s0">, </span><span class="s3">0.55</span><span class="s0">, </span><span class="s3">0.55</span><span class="s0">, </span><span class="s3">0.4</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_general_hamming(self):</span>
        <span class="s1">assert_allclose(get_window((</span><span class="s2">'general_hamming'</span><span class="s0">, </span><span class="s3">0.7</span><span class="s1">)</span><span class="s0">, </span><span class="s3">5</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.4</span><span class="s0">, </span><span class="s3">0.6072949</span><span class="s0">, </span><span class="s3">0.9427051</span><span class="s0">, </span><span class="s3">0.9427051</span><span class="s0">, </span><span class="s3">0.6072949</span><span class="s1">])</span>
        <span class="s1">assert_allclose(get_window((</span><span class="s2">'general_hamming'</span><span class="s0">, </span><span class="s3">0.7</span><span class="s1">)</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s1">fftbins=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.4</span><span class="s0">, </span><span class="s3">0.7</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.7</span><span class="s0">, </span><span class="s3">0.4</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_lanczos(self):</span>
        <span class="s1">assert_allclose(get_window(</span><span class="s2">'lanczos'</span><span class="s0">, </span><span class="s3">6</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.</span><span class="s0">, </span><span class="s3">0.413496672</span><span class="s0">, </span><span class="s3">0.826993343</span><span class="s0">, </span><span class="s3">1.</span><span class="s0">, </span><span class="s3">0.826993343</span><span class="s0">,</span>
                         <span class="s3">0.413496672</span><span class="s1">]</span><span class="s0">, </span><span class="s1">atol=</span><span class="s3">1e-9</span><span class="s1">)</span>
        <span class="s1">assert_allclose(get_window(</span><span class="s2">'lanczos'</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s1">fftbins=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">[</span><span class="s3">0.</span><span class="s0">, </span><span class="s3">0.504551152</span><span class="s0">, </span><span class="s3">0.935489284</span><span class="s0">, </span><span class="s3">0.935489284</span><span class="s0">,</span>
                         <span class="s3">0.504551152</span><span class="s0">, </span><span class="s3">0.</span><span class="s1">]</span><span class="s0">, </span><span class="s1">atol=</span><span class="s3">1e-9</span><span class="s1">)</span>
        <span class="s1">assert_allclose(get_window(</span><span class="s2">'lanczos'</span><span class="s0">, </span><span class="s3">6</span><span class="s1">)</span><span class="s0">, </span><span class="s1">get_window(</span><span class="s2">'sinc'</span><span class="s0">, </span><span class="s3">6</span><span class="s1">))</span>


<span class="s0">def </span><span class="s1">test_windowfunc_basics():</span>
    <span class="s0">for </span><span class="s1">window_name</span><span class="s0">, </span><span class="s1">params </span><span class="s0">in </span><span class="s1">window_funcs:</span>
        <span class="s1">window = getattr(windows</span><span class="s0">, </span><span class="s1">window_name)</span>
        <span class="s0">with </span><span class="s1">suppress_warnings() </span><span class="s0">as </span><span class="s1">sup:</span>
            <span class="s1">sup.filter(UserWarning</span><span class="s0">, </span><span class="s2">&quot;This window is not suitable&quot;</span><span class="s1">)</span>
            <span class="s5"># Check symmetry for odd and even lengths</span>
            <span class="s1">w1 = window(</span><span class="s3">8</span><span class="s0">, </span><span class="s1">*params</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">True</span><span class="s1">)</span>
            <span class="s1">w2 = window(</span><span class="s3">7</span><span class="s0">, </span><span class="s1">*params</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">)</span>
            <span class="s1">assert_array_almost_equal(w1[:-</span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">w2)</span>

            <span class="s1">w1 = window(</span><span class="s3">9</span><span class="s0">, </span><span class="s1">*params</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">True</span><span class="s1">)</span>
            <span class="s1">w2 = window(</span><span class="s3">8</span><span class="s0">, </span><span class="s1">*params</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">)</span>
            <span class="s1">assert_array_almost_equal(w1[:-</span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">w2)</span>

            <span class="s5"># Check that functions run and output lengths are correct</span>
            <span class="s1">assert_equal(len(window(</span><span class="s3">6</span><span class="s0">, </span><span class="s1">*params</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">True</span><span class="s1">))</span><span class="s0">, </span><span class="s3">6</span><span class="s1">)</span>
            <span class="s1">assert_equal(len(window(</span><span class="s3">6</span><span class="s0">, </span><span class="s1">*params</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">))</span><span class="s0">, </span><span class="s3">6</span><span class="s1">)</span>
            <span class="s1">assert_equal(len(window(</span><span class="s3">7</span><span class="s0">, </span><span class="s1">*params</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">True</span><span class="s1">))</span><span class="s0">, </span><span class="s3">7</span><span class="s1">)</span>
            <span class="s1">assert_equal(len(window(</span><span class="s3">7</span><span class="s0">, </span><span class="s1">*params</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">))</span><span class="s0">, </span><span class="s3">7</span><span class="s1">)</span>

            <span class="s5"># Check invalid lengths</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">window</span><span class="s0">, </span><span class="s3">5.5</span><span class="s0">, </span><span class="s1">*params)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">window</span><span class="s0">, </span><span class="s1">-</span><span class="s3">7</span><span class="s0">, </span><span class="s1">*params)</span>

            <span class="s5"># Check degenerate cases</span>
            <span class="s1">assert_array_equal(window(</span><span class="s3">0</span><span class="s0">, </span><span class="s1">*params</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">True</span><span class="s1">)</span><span class="s0">, </span><span class="s1">[])</span>
            <span class="s1">assert_array_equal(window(</span><span class="s3">0</span><span class="s0">, </span><span class="s1">*params</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">, </span><span class="s1">[])</span>
            <span class="s1">assert_array_equal(window(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">*params</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">True</span><span class="s1">)</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s1">])</span>
            <span class="s1">assert_array_equal(window(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">*params</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s1">])</span>

            <span class="s5"># Check dtype</span>
            <span class="s1">assert_(window(</span><span class="s3">0</span><span class="s0">, </span><span class="s1">*params</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">True</span><span class="s1">).dtype == </span><span class="s2">'float'</span><span class="s1">)</span>
            <span class="s1">assert_(window(</span><span class="s3">0</span><span class="s0">, </span><span class="s1">*params</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">).dtype == </span><span class="s2">'float'</span><span class="s1">)</span>
            <span class="s1">assert_(window(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">*params</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">True</span><span class="s1">).dtype == </span><span class="s2">'float'</span><span class="s1">)</span>
            <span class="s1">assert_(window(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">*params</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">).dtype == </span><span class="s2">'float'</span><span class="s1">)</span>
            <span class="s1">assert_(window(</span><span class="s3">6</span><span class="s0">, </span><span class="s1">*params</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">True</span><span class="s1">).dtype == </span><span class="s2">'float'</span><span class="s1">)</span>
            <span class="s1">assert_(window(</span><span class="s3">6</span><span class="s0">, </span><span class="s1">*params</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">).dtype == </span><span class="s2">'float'</span><span class="s1">)</span>

            <span class="s5"># Check normalization</span>
            <span class="s1">assert_array_less(window(</span><span class="s3">10</span><span class="s0">, </span><span class="s1">*params</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">True</span><span class="s1">)</span><span class="s0">, </span><span class="s3">1.01</span><span class="s1">)</span>
            <span class="s1">assert_array_less(window(</span><span class="s3">10</span><span class="s0">, </span><span class="s1">*params</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">, </span><span class="s3">1.01</span><span class="s1">)</span>
            <span class="s1">assert_array_less(window(</span><span class="s3">9</span><span class="s0">, </span><span class="s1">*params</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">True</span><span class="s1">)</span><span class="s0">, </span><span class="s3">1.01</span><span class="s1">)</span>
            <span class="s1">assert_array_less(window(</span><span class="s3">9</span><span class="s0">, </span><span class="s1">*params</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">, </span><span class="s3">1.01</span><span class="s1">)</span>

            <span class="s5"># Check that DFT-even spectrum is purely real for odd and even</span>
            <span class="s1">assert_allclose(fft(window(</span><span class="s3">10</span><span class="s0">, </span><span class="s1">*params</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">)).imag</span><span class="s0">,</span>
                            <span class="s3">0</span><span class="s0">, </span><span class="s1">atol=</span><span class="s3">1e-14</span><span class="s1">)</span>
            <span class="s1">assert_allclose(fft(window(</span><span class="s3">11</span><span class="s0">, </span><span class="s1">*params</span><span class="s0">, </span><span class="s1">sym=</span><span class="s0">False</span><span class="s1">)).imag</span><span class="s0">,</span>
                            <span class="s3">0</span><span class="s0">, </span><span class="s1">atol=</span><span class="s3">1e-14</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_needs_params():</span>
    <span class="s0">for </span><span class="s1">winstr </span><span class="s0">in </span><span class="s1">[</span><span class="s2">'kaiser'</span><span class="s0">, </span><span class="s2">'ksr'</span><span class="s0">, </span><span class="s2">'kaiser_bessel_derived'</span><span class="s0">, </span><span class="s2">'kbd'</span><span class="s0">,</span>
                   <span class="s2">'gaussian'</span><span class="s0">, </span><span class="s2">'gauss'</span><span class="s0">, </span><span class="s2">'gss'</span><span class="s0">,</span>
                   <span class="s2">'general gaussian'</span><span class="s0">, </span><span class="s2">'general_gaussian'</span><span class="s0">,</span>
                   <span class="s2">'general gauss'</span><span class="s0">, </span><span class="s2">'general_gauss'</span><span class="s0">, </span><span class="s2">'ggs'</span><span class="s0">,</span>
                   <span class="s2">'dss'</span><span class="s0">, </span><span class="s2">'dpss'</span><span class="s0">, </span><span class="s2">'general cosine'</span><span class="s0">, </span><span class="s2">'general_cosine'</span><span class="s0">,</span>
                   <span class="s2">'chebwin'</span><span class="s0">, </span><span class="s2">'cheb'</span><span class="s0">, </span><span class="s2">'general hamming'</span><span class="s0">, </span><span class="s2">'general_hamming'</span><span class="s0">,</span>
                   <span class="s1">]:</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">get_window</span><span class="s0">, </span><span class="s1">winstr</span><span class="s0">, </span><span class="s3">7</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_not_needs_params():</span>
    <span class="s0">for </span><span class="s1">winstr </span><span class="s0">in </span><span class="s1">[</span><span class="s2">'barthann'</span><span class="s0">,</span>
                   <span class="s2">'bartlett'</span><span class="s0">,</span>
                   <span class="s2">'blackman'</span><span class="s0">,</span>
                   <span class="s2">'blackmanharris'</span><span class="s0">,</span>
                   <span class="s2">'bohman'</span><span class="s0">,</span>
                   <span class="s2">'boxcar'</span><span class="s0">,</span>
                   <span class="s2">'cosine'</span><span class="s0">,</span>
                   <span class="s2">'flattop'</span><span class="s0">,</span>
                   <span class="s2">'hamming'</span><span class="s0">,</span>
                   <span class="s2">'nuttall'</span><span class="s0">,</span>
                   <span class="s2">'parzen'</span><span class="s0">,</span>
                   <span class="s2">'taylor'</span><span class="s0">,</span>
                   <span class="s2">'exponential'</span><span class="s0">,</span>
                   <span class="s2">'poisson'</span><span class="s0">,</span>
                   <span class="s2">'tukey'</span><span class="s0">,</span>
                   <span class="s2">'tuk'</span><span class="s0">,</span>
                   <span class="s2">'triangle'</span><span class="s0">,</span>
                   <span class="s2">'lanczos'</span><span class="s0">,</span>
                   <span class="s2">'sinc'</span><span class="s0">,</span>
                   <span class="s1">]:</span>
        <span class="s1">win = get_window(winstr</span><span class="s0">, </span><span class="s3">7</span><span class="s1">)</span>
        <span class="s1">assert_equal(len(win)</span><span class="s0">, </span><span class="s3">7</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_deprecation():</span>
    <span class="s0">if </span><span class="s1">dep_hann.__doc__ </span><span class="s0">is not None</span><span class="s1">:  </span><span class="s5"># can be None with `-OO` mode</span>
        <span class="s1">assert_(</span><span class="s2">'signal.hann is deprecated' </span><span class="s0">in </span><span class="s1">dep_hann.__doc__)</span>
        <span class="s1">assert_(</span><span class="s2">'deprecated' </span><span class="s0">not in </span><span class="s1">windows.hann.__doc__)</span>


<span class="s0">def </span><span class="s1">test_deprecated_pickleable():</span>
    <span class="s1">dep_hann2 = pickle.loads(pickle.dumps(dep_hann))</span>
    <span class="s1">assert_(dep_hann2 </span><span class="s0">is </span><span class="s1">dep_hann)</span>


<span class="s0">def </span><span class="s1">test_symmetric():</span>

    <span class="s0">for </span><span class="s1">win </span><span class="s0">in </span><span class="s1">[windows.lanczos]:</span>
        <span class="s5"># Even sampling points</span>
        <span class="s1">w = win(</span><span class="s3">4096</span><span class="s1">)</span>
        <span class="s1">error = np.max(np.abs(w-np.flip(w)))</span>
        <span class="s1">assert_equal(error</span><span class="s0">, </span><span class="s3">0.0</span><span class="s1">)</span>

        <span class="s5"># Odd sampling points</span>
        <span class="s1">w = win(</span><span class="s3">4097</span><span class="s1">)</span>
        <span class="s1">error = np.max(np.abs(w-np.flip(w)))</span>
        <span class="s1">assert_equal(error</span><span class="s0">, </span><span class="s3">0.0</span><span class="s1">)</span>
</pre>
</body>
</html>