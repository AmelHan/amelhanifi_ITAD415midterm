<html>
<head>
<title>movstat.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #629755; font-style: italic;}
.s1 { color: #a9b7c6;}
.s2 { color: #cc7832;}
.s3 { color: #808080;}
.s4 { color: #6897bb;}
.s5 { color: #6a8759;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
movstat.py</font>
</center></td></tr></table>
<pre><span class="s0">'''using scipy signal and numpy correlate to calculate some time series 
statistics 
 
original developer notes 
 
see also scikits.timeseries  (movstat is partially inspired by it) 
added 2009-08-29 
timeseries moving stats are in c, autocorrelation similar to here 
I thought I saw moving stats somewhere in python, maybe not) 
 
 
TODO 
 
moving statistics 
- filters do not handle boundary conditions nicely (correctly ?) 
e.g. minimum order filter uses 0 for out of bounds value 
-&gt; append and prepend with last resp. first value 
- enhance for nd arrays, with axis = 0 
 
 
 
Note: Equivalence for 1D signals 
&gt;&gt;&gt; np.all(signal.correlate(x,[1,1,1],'valid')==np.correlate(x,[1,1,1])) 
True 
&gt;&gt;&gt; np.all(ndimage.filters.correlate(x,[1,1,1], origin = -1)[:-3+1]==np.correlate(x,[1,1,1])) 
True 
 
# multidimensional, but, it looks like it uses common filter across time series, no VAR 
ndimage.filters.correlate(np.vstack([x,x]),np.array([[1,1,1],[0,0,0]]), origin = 1) 
ndimage.filters.correlate(x,[1,1,1],origin = 1)) 
ndimage.filters.correlate(np.vstack([x,x]),np.array([[0.5,0.5,0.5],[0.5,0.5,0.5]]), \ 
origin = 1) 
 
&gt;&gt;&gt; np.all(ndimage.filters.correlate(np.vstack([x,x]),np.array([[1,1,1],[0,0,0]]), origin = 1)[0]==\ 
ndimage.filters.correlate(x,[1,1,1],origin = 1)) 
True 
&gt;&gt;&gt; np.all(ndimage.filters.correlate(np.vstack([x,x]),np.array([[0.5,0.5,0.5],[0.5,0.5,0.5]]), \ 
origin = 1)[0]==ndimage.filters.correlate(x,[1,1,1],origin = 1)) 
 
 
update 
2009-09-06: cosmetic changes, rearrangements 
'''</span>

<span class="s2">import </span><span class="s1">numpy </span><span class="s2">as </span><span class="s1">np</span>
<span class="s2">from </span><span class="s1">scipy </span><span class="s2">import </span><span class="s1">signal</span>

<span class="s2">from </span><span class="s1">numpy.testing </span><span class="s2">import </span><span class="s1">assert_array_equal</span><span class="s2">, </span><span class="s1">assert_array_almost_equal</span>


<span class="s2">def </span><span class="s1">expandarr(x</span><span class="s2">,</span><span class="s1">k):</span>
    <span class="s3">#make it work for 2D or nD with axis</span>
    <span class="s1">kadd = k</span>
    <span class="s2">if </span><span class="s1">np.ndim(x) == </span><span class="s4">2</span><span class="s1">:</span>
        <span class="s1">kadd = (kadd</span><span class="s2">, </span><span class="s1">np.shape(x)[</span><span class="s4">1</span><span class="s1">])</span>
    <span class="s2">return </span><span class="s1">np.r_[np.ones(kadd)*x[</span><span class="s4">0</span><span class="s1">]</span><span class="s2">,</span><span class="s1">x</span><span class="s2">,</span><span class="s1">np.ones(kadd)*x[-</span><span class="s4">1</span><span class="s1">]]</span>

<span class="s2">def </span><span class="s1">movorder(x</span><span class="s2">, </span><span class="s1">order = </span><span class="s5">'med'</span><span class="s2">, </span><span class="s1">windsize=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">lag=</span><span class="s5">'lagged'</span><span class="s1">):</span>
    <span class="s0">'''moving order statistics 
 
    Parameters 
    ---------- 
    x : ndarray 
       time series data 
    order : float or 'med', 'min', 'max' 
       which order statistic to calculate 
    windsize : int 
       window size 
    lag : 'lagged', 'centered', or 'leading' 
       location of window relative to current position 
 
    Returns 
    ------- 
    filtered array 
 
 
    '''</span>

    <span class="s3">#if windsize is even should it raise ValueError</span>
    <span class="s2">if </span><span class="s1">lag == </span><span class="s5">'lagged'</span><span class="s1">:</span>
        <span class="s1">lead = windsize//</span><span class="s4">2</span>
    <span class="s2">elif </span><span class="s1">lag == </span><span class="s5">'centered'</span><span class="s1">:</span>
        <span class="s1">lead = </span><span class="s4">0</span>
    <span class="s2">elif </span><span class="s1">lag == </span><span class="s5">'leading'</span><span class="s1">:</span>
        <span class="s1">lead = -windsize//</span><span class="s4">2 </span><span class="s1">+</span><span class="s4">1</span>
    <span class="s2">else</span><span class="s1">:</span>
        <span class="s2">raise </span><span class="s1">ValueError</span>
    <span class="s2">if </span><span class="s1">np.isfinite(order): </span><span class="s3">#if np.isnumber(order):</span>
        <span class="s1">ord = order   </span><span class="s3"># note: ord is a builtin function</span>
    <span class="s2">elif </span><span class="s1">order == </span><span class="s5">'med'</span><span class="s1">:</span>
        <span class="s1">ord = (windsize - </span><span class="s4">1</span><span class="s1">)/</span><span class="s4">2</span>
    <span class="s2">elif </span><span class="s1">order == </span><span class="s5">'min'</span><span class="s1">:</span>
        <span class="s1">ord = </span><span class="s4">0</span>
    <span class="s2">elif </span><span class="s1">order == </span><span class="s5">'max'</span><span class="s1">:</span>
        <span class="s1">ord = windsize - </span><span class="s4">1</span>
    <span class="s2">else</span><span class="s1">:</span>
        <span class="s2">raise </span><span class="s1">ValueError</span>

    <span class="s3">#return signal.order_filter(x,np.ones(windsize),ord)[:-lead]</span>
    <span class="s1">xext = expandarr(x</span><span class="s2">, </span><span class="s1">windsize)</span>
    <span class="s3">#np.r_[np.ones(windsize)*x[0],x,np.ones(windsize)*x[-1]]</span>
    <span class="s2">return </span><span class="s1">signal.order_filter(xext</span><span class="s2">,</span><span class="s1">np.ones(windsize)</span><span class="s2">,</span><span class="s1">ord)[windsize-lead:-(windsize+lead)]</span>

<span class="s2">def </span><span class="s1">check_movorder():</span>
    <span class="s0">'''graphical test for movorder'''</span>
    <span class="s2">import </span><span class="s1">matplotlib.pylab </span><span class="s2">as </span><span class="s1">plt</span>
    <span class="s1">x = np.arange(</span><span class="s4">1</span><span class="s2">,</span><span class="s4">10</span><span class="s1">)</span>
    <span class="s1">xo = movorder(x</span><span class="s2">, </span><span class="s1">order=</span><span class="s5">'max'</span><span class="s1">)</span>
    <span class="s1">assert_array_equal(xo</span><span class="s2">, </span><span class="s1">x)</span>
    <span class="s1">x = np.arange(</span><span class="s4">10</span><span class="s2">,</span><span class="s4">1</span><span class="s2">,</span><span class="s1">-</span><span class="s4">1</span><span class="s1">)</span>
    <span class="s1">xo = movorder(x</span><span class="s2">, </span><span class="s1">order=</span><span class="s5">'min'</span><span class="s1">)</span>
    <span class="s1">assert_array_equal(xo</span><span class="s2">, </span><span class="s1">x)</span>
    <span class="s1">assert_array_equal(movorder(x</span><span class="s2">, </span><span class="s1">order=</span><span class="s5">'min'</span><span class="s2">, </span><span class="s1">lag=</span><span class="s5">'centered'</span><span class="s1">)[:-</span><span class="s4">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">x[</span><span class="s4">1</span><span class="s1">:])</span>

    <span class="s1">tt = np.linspace(</span><span class="s4">0</span><span class="s2">,</span><span class="s4">2</span><span class="s1">*np.pi</span><span class="s2">,</span><span class="s4">15</span><span class="s1">)</span>
    <span class="s1">x = np.sin(tt) + </span><span class="s4">1</span>
    <span class="s1">xo = movorder(x</span><span class="s2">, </span><span class="s1">order=</span><span class="s5">'max'</span><span class="s1">)</span>
    <span class="s1">plt.figure()</span>
    <span class="s1">plt.plot(tt</span><span class="s2">,</span><span class="s1">x</span><span class="s2">,</span><span class="s5">'.-'</span><span class="s2">,</span><span class="s1">tt</span><span class="s2">,</span><span class="s1">xo</span><span class="s2">,</span><span class="s5">'.-'</span><span class="s1">)</span>
    <span class="s1">plt.title(</span><span class="s5">'moving max lagged'</span><span class="s1">)</span>
    <span class="s1">xo = movorder(x</span><span class="s2">, </span><span class="s1">order=</span><span class="s5">'max'</span><span class="s2">, </span><span class="s1">lag=</span><span class="s5">'centered'</span><span class="s1">)</span>
    <span class="s1">plt.figure()</span>
    <span class="s1">plt.plot(tt</span><span class="s2">,</span><span class="s1">x</span><span class="s2">,</span><span class="s5">'.-'</span><span class="s2">,</span><span class="s1">tt</span><span class="s2">,</span><span class="s1">xo</span><span class="s2">,</span><span class="s5">'.-'</span><span class="s1">)</span>
    <span class="s1">plt.title(</span><span class="s5">'moving max centered'</span><span class="s1">)</span>
    <span class="s1">xo = movorder(x</span><span class="s2">, </span><span class="s1">order=</span><span class="s5">'max'</span><span class="s2">, </span><span class="s1">lag=</span><span class="s5">'leading'</span><span class="s1">)</span>
    <span class="s1">plt.figure()</span>
    <span class="s1">plt.plot(tt</span><span class="s2">,</span><span class="s1">x</span><span class="s2">,</span><span class="s5">'.-'</span><span class="s2">,</span><span class="s1">tt</span><span class="s2">,</span><span class="s1">xo</span><span class="s2">,</span><span class="s5">'.-'</span><span class="s1">)</span>
    <span class="s1">plt.title(</span><span class="s5">'moving max leading'</span><span class="s1">)</span>

<span class="s3"># identity filter</span>
<span class="s3">##&gt;&gt;&gt; signal.order_filter(x,np.ones(1),0)</span>
<span class="s3">##array([ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9.])</span>
<span class="s3"># median filter</span>
<span class="s3">##signal.medfilt(np.sin(x), kernel_size=3)</span>
<span class="s3">##&gt;&gt;&gt; plt.figure()</span>
<span class="s3">##&lt;matplotlib.figure.Figure object at 0x069BBB50&gt;</span>
<span class="s3">##&gt;&gt;&gt; x=np.linspace(0,3,100);plt.plot(x,np.sin(x),x,signal.medfilt(np.sin(x), kernel_size=3))</span>

<span class="s3"># remove old version</span>
<span class="s3">##def movmeanvar(x, windowsize=3, valid='same'):</span>
<span class="s3">##    '''</span>
<span class="s3">##    this should also work along axis or at least for columns</span>
<span class="s3">##    '''</span>
<span class="s3">##    n = x.shape[0]</span>
<span class="s3">##    x = expandarr(x, windowsize - 1)</span>
<span class="s3">##    takeslice = slice(windowsize-1, n + windowsize-1)</span>
<span class="s3">##    avgkern = (np.ones(windowsize)/float(windowsize))</span>
<span class="s3">##    m = np.correlate(x, avgkern, 'same')#[takeslice]</span>
<span class="s3">##    print(m.shape)</span>
<span class="s3">##    print(x.shape)</span>
<span class="s3">##    xm = x - m</span>
<span class="s3">##    v = np.correlate(x*x, avgkern, 'same') - m**2</span>
<span class="s3">##    v1 = np.correlate(xm*xm, avgkern, valid) #not correct for var of window</span>
<span class="s3">###&gt;&gt;&gt; np.correlate(xm*xm,np.array([1,1,1])/3.0,'valid')-np.correlate(xm*xm,np.array([1,1,1])/3.0,'valid')**2</span>
<span class="s3">##    return m[takeslice], v[takeslice], v1</span>

<span class="s2">def </span><span class="s1">movmean(x</span><span class="s2">, </span><span class="s1">windowsize=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">lag=</span><span class="s5">'lagged'</span><span class="s1">):</span>
    <span class="s0">'''moving window mean 
 
 
    Parameters 
    ---------- 
    x : ndarray 
       time series data 
    windsize : int 
       window size 
    lag : 'lagged', 'centered', or 'leading' 
       location of window relative to current position 
 
    Returns 
    ------- 
    mk : ndarray 
        moving mean, with same shape as x 
 
 
    Notes 
    ----- 
    for leading and lagging the data array x is extended by the closest value of the array 
 
 
    '''</span>
    <span class="s2">return </span><span class="s1">movmoment(x</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s1">windowsize=windowsize</span><span class="s2">, </span><span class="s1">lag=lag)</span>

<span class="s2">def </span><span class="s1">movvar(x</span><span class="s2">, </span><span class="s1">windowsize=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">lag=</span><span class="s5">'lagged'</span><span class="s1">):</span>
    <span class="s0">'''moving window variance 
 
 
    Parameters 
    ---------- 
    x : ndarray 
       time series data 
    windsize : int 
       window size 
    lag : 'lagged', 'centered', or 'leading' 
       location of window relative to current position 
 
    Returns 
    ------- 
    mk : ndarray 
        moving variance, with same shape as x 
 
 
    '''</span>
    <span class="s1">m1 = movmoment(x</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s1">windowsize=windowsize</span><span class="s2">, </span><span class="s1">lag=lag)</span>
    <span class="s1">m2 = movmoment(x</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s1">windowsize=windowsize</span><span class="s2">, </span><span class="s1">lag=lag)</span>
    <span class="s2">return </span><span class="s1">m2 - m1*m1</span>

<span class="s2">def </span><span class="s1">movmoment(x</span><span class="s2">, </span><span class="s1">k</span><span class="s2">, </span><span class="s1">windowsize=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">lag=</span><span class="s5">'lagged'</span><span class="s1">):</span>
    <span class="s0">'''non-central moment 
 
 
    Parameters 
    ---------- 
    x : ndarray 
       time series data 
    windsize : int 
       window size 
    lag : 'lagged', 'centered', or 'leading' 
       location of window relative to current position 
 
    Returns 
    ------- 
    mk : ndarray 
        k-th moving non-central moment, with same shape as x 
 
 
    Notes 
    ----- 
    If data x is 2d, then moving moment is calculated for each 
    column. 
 
    '''</span>

    <span class="s1">windsize = windowsize</span>
    <span class="s3">#if windsize is even should it raise ValueError</span>
    <span class="s2">if </span><span class="s1">lag == </span><span class="s5">'lagged'</span><span class="s1">:</span>
        <span class="s3">#lead = -0 + windsize #windsize//2</span>
        <span class="s1">lead = -</span><span class="s4">0</span><span class="s3"># + (windsize-1) + windsize//2</span>
        <span class="s1">sl = slice((windsize-</span><span class="s4">1</span><span class="s1">) </span><span class="s2">or None, </span><span class="s1">-</span><span class="s4">2</span><span class="s1">*(windsize-</span><span class="s4">1</span><span class="s1">) </span><span class="s2">or None</span><span class="s1">)</span>
    <span class="s2">elif </span><span class="s1">lag == </span><span class="s5">'centered'</span><span class="s1">:</span>
        <span class="s1">lead = -windsize//</span><span class="s4">2  </span><span class="s3">#0#-1 #+ #(windsize-1)</span>
        <span class="s1">sl = slice((windsize-</span><span class="s4">1</span><span class="s1">)+windsize//</span><span class="s4">2 </span><span class="s2">or None, </span><span class="s1">-(windsize-</span><span class="s4">1</span><span class="s1">)-windsize//</span><span class="s4">2 </span><span class="s2">or None</span><span class="s1">)</span>
    <span class="s2">elif </span><span class="s1">lag == </span><span class="s5">'leading'</span><span class="s1">:</span>
        <span class="s3">#lead = -windsize +1#+1 #+ (windsize-1)#//2 +1</span>
        <span class="s1">lead = -windsize +</span><span class="s4">2 </span><span class="s3">#-windsize//2 +1</span>
        <span class="s1">sl = slice(</span><span class="s4">2</span><span class="s1">*(windsize-</span><span class="s4">1</span><span class="s1">)+</span><span class="s4">1</span><span class="s1">+lead </span><span class="s2">or None, </span><span class="s1">-(</span><span class="s4">2</span><span class="s1">*(windsize-</span><span class="s4">1</span><span class="s1">)+lead)+</span><span class="s4">1 </span><span class="s2">or None</span><span class="s1">)</span>
    <span class="s2">else</span><span class="s1">:</span>
        <span class="s2">raise </span><span class="s1">ValueError</span>

    <span class="s1">avgkern = (np.ones(windowsize)/float(windowsize))</span>
    <span class="s1">xext = expandarr(x</span><span class="s2">, </span><span class="s1">windsize-</span><span class="s4">1</span><span class="s1">)</span>
    <span class="s3">#Note: expandarr increases the array size by 2*(windsize-1)</span>

    <span class="s3">#sl = slice(2*(windsize-1)+1+lead or None, -(2*(windsize-1)+lead)+1 or None)</span>
    <span class="s1">print(sl)</span>

    <span class="s2">if </span><span class="s1">xext.ndim == </span><span class="s4">1</span><span class="s1">:</span>
        <span class="s2">return </span><span class="s1">np.correlate(xext**k</span><span class="s2">, </span><span class="s1">avgkern</span><span class="s2">, </span><span class="s5">'full'</span><span class="s1">)[sl]</span>
        <span class="s3">#return np.correlate(xext**k, avgkern, 'same')[windsize-lead:-(windsize+lead)]</span>
    <span class="s2">else</span><span class="s1">:</span>
        <span class="s1">print(xext.shape)</span>
        <span class="s1">print(avgkern[:</span><span class="s2">,None</span><span class="s1">].shape)</span>

        <span class="s3"># try first with 2d along columns, possibly ndim with axis</span>
        <span class="s2">return </span><span class="s1">signal.correlate(xext**k</span><span class="s2">, </span><span class="s1">avgkern[:</span><span class="s2">,None</span><span class="s1">]</span><span class="s2">, </span><span class="s5">'full'</span><span class="s1">)[sl</span><span class="s2">,</span><span class="s1">:]</span>







<span class="s3">#x=0.5**np.arange(10);xm=x-x.mean();a=np.correlate(xm,[1],'full')</span>
<span class="s3">#x=0.5**np.arange(3);np.correlate(x,x,'same')</span>
<span class="s3">##&gt;&gt;&gt; x=0.5**np.arange(10);xm=x-x.mean();a=np.correlate(xm,xo,'full')</span>
<span class="s3">##</span>
<span class="s3">##&gt;&gt;&gt; xo=np.ones(10);d=np.correlate(xo,xo,'full')</span>
<span class="s3">##&gt;&gt;&gt; xo</span>
<span class="s3">##xo=np.ones(10);d=np.correlate(xo,xo,'full')</span>
<span class="s3">##&gt;&gt;&gt; x=np.ones(10);xo=x-x.mean();a=np.correlate(xo,xo,'full')</span>
<span class="s3">##&gt;&gt;&gt; xo=np.ones(10);d=np.correlate(xo,xo,'full')</span>
<span class="s3">##&gt;&gt;&gt; d</span>
<span class="s3">##array([  1.,   2.,   3.,   4.,   5.,   6.,   7.,   8.,   9.,  10.,   9.,</span>
<span class="s3">##         8.,   7.,   6.,   5.,   4.,   3.,   2.,   1.])</span>


<span class="s3">##def ccovf():</span>
<span class="s3">##    pass</span>
<span class="s3">##    #x=0.5**np.arange(10);xm=x-x.mean();a=np.correlate(xm,xo,'full')</span>

<span class="s1">__all__ = [</span><span class="s5">'movorder'</span><span class="s2">, </span><span class="s5">'movmean'</span><span class="s2">, </span><span class="s5">'movvar'</span><span class="s2">, </span><span class="s5">'movmoment'</span><span class="s1">]</span>

<span class="s2">if </span><span class="s1">__name__ == </span><span class="s5">'__main__'</span><span class="s1">:</span>

    <span class="s1">print(</span><span class="s5">'</span><span class="s2">\n</span><span class="s5">checkin moving mean and variance'</span><span class="s1">)</span>
    <span class="s1">nobs = </span><span class="s4">10</span>
    <span class="s1">x = np.arange(nobs)</span>
    <span class="s1">ws = </span><span class="s4">3</span>
    <span class="s1">ave = np.array([ </span><span class="s4">0.</span><span class="s2">, </span><span class="s4">1</span><span class="s1">/</span><span class="s4">3.</span><span class="s2">, </span><span class="s4">1.</span><span class="s2">, </span><span class="s4">2.</span><span class="s2">, </span><span class="s4">3.</span><span class="s2">, </span><span class="s4">4.</span><span class="s2">, </span><span class="s4">5.</span><span class="s2">, </span><span class="s4">6.</span><span class="s2">, </span><span class="s4">7.</span><span class="s2">, </span><span class="s4">8.</span><span class="s2">,</span>
                  <span class="s4">26</span><span class="s1">/</span><span class="s4">3.</span><span class="s2">, </span><span class="s4">9</span><span class="s1">])</span>
    <span class="s1">va = np.array([[ </span><span class="s4">0.        </span><span class="s2">,  </span><span class="s4">0.        </span><span class="s1">]</span><span class="s2">,</span>
                   <span class="s1">[ </span><span class="s4">0.22222222</span><span class="s2">,  </span><span class="s4">0.88888889</span><span class="s1">]</span><span class="s2">,</span>
                   <span class="s1">[ </span><span class="s4">0.66666667</span><span class="s2">,  </span><span class="s4">2.66666667</span><span class="s1">]</span><span class="s2">,</span>
                   <span class="s1">[ </span><span class="s4">0.66666667</span><span class="s2">,  </span><span class="s4">2.66666667</span><span class="s1">]</span><span class="s2">,</span>
                   <span class="s1">[ </span><span class="s4">0.66666667</span><span class="s2">,  </span><span class="s4">2.66666667</span><span class="s1">]</span><span class="s2">,</span>
                   <span class="s1">[ </span><span class="s4">0.66666667</span><span class="s2">,  </span><span class="s4">2.66666667</span><span class="s1">]</span><span class="s2">,</span>
                   <span class="s1">[ </span><span class="s4">0.66666667</span><span class="s2">,  </span><span class="s4">2.66666667</span><span class="s1">]</span><span class="s2">,</span>
                   <span class="s1">[ </span><span class="s4">0.66666667</span><span class="s2">,  </span><span class="s4">2.66666667</span><span class="s1">]</span><span class="s2">,</span>
                   <span class="s1">[ </span><span class="s4">0.66666667</span><span class="s2">,  </span><span class="s4">2.66666667</span><span class="s1">]</span><span class="s2">,</span>
                   <span class="s1">[ </span><span class="s4">0.66666667</span><span class="s2">,  </span><span class="s4">2.66666667</span><span class="s1">]</span><span class="s2">,</span>
                   <span class="s1">[ </span><span class="s4">0.22222222</span><span class="s2">,  </span><span class="s4">0.88888889</span><span class="s1">]</span><span class="s2">,</span>
                   <span class="s1">[ </span><span class="s4">0.        </span><span class="s2">,  </span><span class="s4">0.        </span><span class="s1">]])</span>
    <span class="s1">ave2d = np.c_[ave</span><span class="s2">, </span><span class="s4">2</span><span class="s1">*ave]</span>
    <span class="s1">print(movmean(x</span><span class="s2">, </span><span class="s1">windowsize=ws</span><span class="s2">, </span><span class="s1">lag=</span><span class="s5">'lagged'</span><span class="s1">))</span>
    <span class="s1">print(movvar(x</span><span class="s2">, </span><span class="s1">windowsize=ws</span><span class="s2">, </span><span class="s1">lag=</span><span class="s5">'lagged'</span><span class="s1">))</span>
    <span class="s1">print([np.var(x[i-ws:i]) </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range(ws</span><span class="s2">, </span><span class="s1">nobs)])</span>
    <span class="s1">m1 = movmoment(x</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s1">windowsize=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">lag=</span><span class="s5">'lagged'</span><span class="s1">)</span>
    <span class="s1">m2 = movmoment(x</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s1">windowsize=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">lag=</span><span class="s5">'lagged'</span><span class="s1">)</span>
    <span class="s1">print(m1)</span>
    <span class="s1">print(m2)</span>
    <span class="s1">print(m2 - m1*m1)</span>

    <span class="s3"># this implicitly also tests moment</span>
    <span class="s1">assert_array_almost_equal(va[ws-</span><span class="s4">1</span><span class="s1">:</span><span class="s2">,</span><span class="s4">0</span><span class="s1">]</span><span class="s2">,</span>
                    <span class="s1">movvar(x</span><span class="s2">, </span><span class="s1">windowsize=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">lag=</span><span class="s5">'leading'</span><span class="s1">))</span>
    <span class="s1">assert_array_almost_equal(va[ws//</span><span class="s4">2</span><span class="s1">:-ws//</span><span class="s4">2</span><span class="s1">+</span><span class="s4">1</span><span class="s2">,</span><span class="s4">0</span><span class="s1">]</span><span class="s2">,</span>
                    <span class="s1">movvar(x</span><span class="s2">, </span><span class="s1">windowsize=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">lag=</span><span class="s5">'centered'</span><span class="s1">))</span>
    <span class="s1">assert_array_almost_equal(va[:-ws+</span><span class="s4">1</span><span class="s2">,</span><span class="s4">0</span><span class="s1">]</span><span class="s2">,</span>
                    <span class="s1">movvar(x</span><span class="s2">, </span><span class="s1">windowsize=ws</span><span class="s2">, </span><span class="s1">lag=</span><span class="s5">'lagged'</span><span class="s1">))</span>



    <span class="s1">print(</span><span class="s5">'</span><span class="s2">\n</span><span class="s5">checking moving moment for 2d (columns only)'</span><span class="s1">)</span>
    <span class="s1">x2d = np.c_[x</span><span class="s2">, </span><span class="s4">2</span><span class="s1">*x]</span>
    <span class="s1">print(movmoment(x2d</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s1">windowsize=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">lag=</span><span class="s5">'centered'</span><span class="s1">))</span>
    <span class="s1">print(movmean(x2d</span><span class="s2">, </span><span class="s1">windowsize=ws</span><span class="s2">, </span><span class="s1">lag=</span><span class="s5">'lagged'</span><span class="s1">))</span>
    <span class="s1">print(movvar(x2d</span><span class="s2">, </span><span class="s1">windowsize=ws</span><span class="s2">, </span><span class="s1">lag=</span><span class="s5">'lagged'</span><span class="s1">))</span>
    <span class="s1">assert_array_almost_equal(va[ws-</span><span class="s4">1</span><span class="s1">:</span><span class="s2">,</span><span class="s1">:]</span><span class="s2">,</span>
                    <span class="s1">movvar(x2d</span><span class="s2">, </span><span class="s1">windowsize=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">lag=</span><span class="s5">'leading'</span><span class="s1">))</span>
    <span class="s1">assert_array_almost_equal(va[ws//</span><span class="s4">2</span><span class="s1">:-ws//</span><span class="s4">2</span><span class="s1">+</span><span class="s4">1</span><span class="s2">,</span><span class="s1">:]</span><span class="s2">,</span>
                    <span class="s1">movvar(x2d</span><span class="s2">, </span><span class="s1">windowsize=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">lag=</span><span class="s5">'centered'</span><span class="s1">))</span>
    <span class="s1">assert_array_almost_equal(va[:-ws+</span><span class="s4">1</span><span class="s2">,</span><span class="s1">:]</span><span class="s2">,</span>
                    <span class="s1">movvar(x2d</span><span class="s2">, </span><span class="s1">windowsize=ws</span><span class="s2">, </span><span class="s1">lag=</span><span class="s5">'lagged'</span><span class="s1">))</span>

    <span class="s1">assert_array_almost_equal(ave2d[ws-</span><span class="s4">1</span><span class="s1">:]</span><span class="s2">,</span>
                    <span class="s1">movmoment(x2d</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s1">windowsize=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">lag=</span><span class="s5">'leading'</span><span class="s1">))</span>
    <span class="s1">assert_array_almost_equal(ave2d[ws//</span><span class="s4">2</span><span class="s1">:-ws//</span><span class="s4">2</span><span class="s1">+</span><span class="s4">1</span><span class="s1">]</span><span class="s2">,</span>
                    <span class="s1">movmoment(x2d</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s1">windowsize=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">lag=</span><span class="s5">'centered'</span><span class="s1">))</span>
    <span class="s1">assert_array_almost_equal(ave2d[:-ws+</span><span class="s4">1</span><span class="s1">]</span><span class="s2">,</span>
                    <span class="s1">movmean(x2d</span><span class="s2">, </span><span class="s1">windowsize=ws</span><span class="s2">, </span><span class="s1">lag=</span><span class="s5">'lagged'</span><span class="s1">))</span>

    <span class="s2">from </span><span class="s1">scipy </span><span class="s2">import </span><span class="s1">ndimage</span>
    <span class="s1">print(ndimage.filters.correlate1d(x2d</span><span class="s2">, </span><span class="s1">np.array([</span><span class="s4">1</span><span class="s2">,</span><span class="s4">1</span><span class="s2">,</span><span class="s4">1</span><span class="s1">])/</span><span class="s4">3.</span><span class="s2">, </span><span class="s1">axis=</span><span class="s4">0</span><span class="s1">))</span>


    <span class="s3">#regression test check</span>

    <span class="s1">xg = np.array([  </span><span class="s4">0. </span><span class="s2">,   </span><span class="s4">0.1</span><span class="s2">,   </span><span class="s4">0.3</span><span class="s2">,   </span><span class="s4">0.6</span><span class="s2">,   </span><span class="s4">1. </span><span class="s2">,   </span><span class="s4">1.5</span><span class="s2">,   </span><span class="s4">2.1</span><span class="s2">,   </span><span class="s4">2.8</span><span class="s2">,   </span><span class="s4">3.6</span><span class="s2">,</span>
                 <span class="s4">4.5</span><span class="s2">,   </span><span class="s4">5.5</span><span class="s2">,   </span><span class="s4">6.5</span><span class="s2">,   </span><span class="s4">7.5</span><span class="s2">,   </span><span class="s4">8.5</span><span class="s2">,   </span><span class="s4">9.5</span><span class="s2">,  </span><span class="s4">10.5</span><span class="s2">,  </span><span class="s4">11.5</span><span class="s2">,  </span><span class="s4">12.5</span><span class="s2">,</span>
                <span class="s4">13.5</span><span class="s2">,  </span><span class="s4">14.5</span><span class="s2">,  </span><span class="s4">15.5</span><span class="s2">,  </span><span class="s4">16.5</span><span class="s2">,  </span><span class="s4">17.5</span><span class="s2">,  </span><span class="s4">18.5</span><span class="s2">,  </span><span class="s4">19.5</span><span class="s2">,  </span><span class="s4">20.5</span><span class="s2">,  </span><span class="s4">21.5</span><span class="s2">,</span>
                <span class="s4">22.5</span><span class="s2">,  </span><span class="s4">23.5</span><span class="s2">,  </span><span class="s4">24.5</span><span class="s2">,  </span><span class="s4">25.5</span><span class="s2">,  </span><span class="s4">26.5</span><span class="s2">,  </span><span class="s4">27.5</span><span class="s2">,  </span><span class="s4">28.5</span><span class="s2">,  </span><span class="s4">29.5</span><span class="s2">,  </span><span class="s4">30.5</span><span class="s2">,</span>
                <span class="s4">31.5</span><span class="s2">,  </span><span class="s4">32.5</span><span class="s2">,  </span><span class="s4">33.5</span><span class="s2">,  </span><span class="s4">34.5</span><span class="s2">,  </span><span class="s4">35.5</span><span class="s2">,  </span><span class="s4">36.5</span><span class="s2">,  </span><span class="s4">37.5</span><span class="s2">,  </span><span class="s4">38.5</span><span class="s2">,  </span><span class="s4">39.5</span><span class="s2">,</span>
                <span class="s4">40.5</span><span class="s2">,  </span><span class="s4">41.5</span><span class="s2">,  </span><span class="s4">42.5</span><span class="s2">,  </span><span class="s4">43.5</span><span class="s2">,  </span><span class="s4">44.5</span><span class="s2">,  </span><span class="s4">45.5</span><span class="s2">,  </span><span class="s4">46.5</span><span class="s2">,  </span><span class="s4">47.5</span><span class="s2">,  </span><span class="s4">48.5</span><span class="s2">,</span>
                <span class="s4">49.5</span><span class="s2">,  </span><span class="s4">50.5</span><span class="s2">,  </span><span class="s4">51.5</span><span class="s2">,  </span><span class="s4">52.5</span><span class="s2">,  </span><span class="s4">53.5</span><span class="s2">,  </span><span class="s4">54.5</span><span class="s2">,  </span><span class="s4">55.5</span><span class="s2">,  </span><span class="s4">56.5</span><span class="s2">,  </span><span class="s4">57.5</span><span class="s2">,</span>
                <span class="s4">58.5</span><span class="s2">,  </span><span class="s4">59.5</span><span class="s2">,  </span><span class="s4">60.5</span><span class="s2">,  </span><span class="s4">61.5</span><span class="s2">,  </span><span class="s4">62.5</span><span class="s2">,  </span><span class="s4">63.5</span><span class="s2">,  </span><span class="s4">64.5</span><span class="s2">,  </span><span class="s4">65.5</span><span class="s2">,  </span><span class="s4">66.5</span><span class="s2">,</span>
                <span class="s4">67.5</span><span class="s2">,  </span><span class="s4">68.5</span><span class="s2">,  </span><span class="s4">69.5</span><span class="s2">,  </span><span class="s4">70.5</span><span class="s2">,  </span><span class="s4">71.5</span><span class="s2">,  </span><span class="s4">72.5</span><span class="s2">,  </span><span class="s4">73.5</span><span class="s2">,  </span><span class="s4">74.5</span><span class="s2">,  </span><span class="s4">75.5</span><span class="s2">,</span>
                <span class="s4">76.5</span><span class="s2">,  </span><span class="s4">77.5</span><span class="s2">,  </span><span class="s4">78.5</span><span class="s2">,  </span><span class="s4">79.5</span><span class="s2">,  </span><span class="s4">80.5</span><span class="s2">,  </span><span class="s4">81.5</span><span class="s2">,  </span><span class="s4">82.5</span><span class="s2">,  </span><span class="s4">83.5</span><span class="s2">,  </span><span class="s4">84.5</span><span class="s2">,</span>
                <span class="s4">85.5</span><span class="s2">,  </span><span class="s4">86.5</span><span class="s2">,  </span><span class="s4">87.5</span><span class="s2">,  </span><span class="s4">88.5</span><span class="s2">,  </span><span class="s4">89.5</span><span class="s2">,  </span><span class="s4">90.5</span><span class="s2">,  </span><span class="s4">91.5</span><span class="s2">,  </span><span class="s4">92.5</span><span class="s2">,  </span><span class="s4">93.5</span><span class="s2">,</span>
                <span class="s4">94.5</span><span class="s1">])</span>

    <span class="s1">assert_array_almost_equal(xg</span><span class="s2">, </span><span class="s1">movmean(np.arange(</span><span class="s4">100</span><span class="s1">)</span><span class="s2">, </span><span class="s4">10</span><span class="s2">,</span><span class="s5">'lagged'</span><span class="s1">))</span>

    <span class="s1">xd = np.array([  </span><span class="s4">0.3</span><span class="s2">,   </span><span class="s4">0.6</span><span class="s2">,   </span><span class="s4">1. </span><span class="s2">,   </span><span class="s4">1.5</span><span class="s2">,   </span><span class="s4">2.1</span><span class="s2">,   </span><span class="s4">2.8</span><span class="s2">,   </span><span class="s4">3.6</span><span class="s2">,   </span><span class="s4">4.5</span><span class="s2">,   </span><span class="s4">5.5</span><span class="s2">,</span>
                 <span class="s4">6.5</span><span class="s2">,   </span><span class="s4">7.5</span><span class="s2">,   </span><span class="s4">8.5</span><span class="s2">,   </span><span class="s4">9.5</span><span class="s2">,  </span><span class="s4">10.5</span><span class="s2">,  </span><span class="s4">11.5</span><span class="s2">,  </span><span class="s4">12.5</span><span class="s2">,  </span><span class="s4">13.5</span><span class="s2">,  </span><span class="s4">14.5</span><span class="s2">,</span>
                <span class="s4">15.5</span><span class="s2">,  </span><span class="s4">16.5</span><span class="s2">,  </span><span class="s4">17.5</span><span class="s2">,  </span><span class="s4">18.5</span><span class="s2">,  </span><span class="s4">19.5</span><span class="s2">,  </span><span class="s4">20.5</span><span class="s2">,  </span><span class="s4">21.5</span><span class="s2">,  </span><span class="s4">22.5</span><span class="s2">,  </span><span class="s4">23.5</span><span class="s2">,</span>
                <span class="s4">24.5</span><span class="s2">,  </span><span class="s4">25.5</span><span class="s2">,  </span><span class="s4">26.5</span><span class="s2">,  </span><span class="s4">27.5</span><span class="s2">,  </span><span class="s4">28.5</span><span class="s2">,  </span><span class="s4">29.5</span><span class="s2">,  </span><span class="s4">30.5</span><span class="s2">,  </span><span class="s4">31.5</span><span class="s2">,  </span><span class="s4">32.5</span><span class="s2">,</span>
                <span class="s4">33.5</span><span class="s2">,  </span><span class="s4">34.5</span><span class="s2">,  </span><span class="s4">35.5</span><span class="s2">,  </span><span class="s4">36.5</span><span class="s2">,  </span><span class="s4">37.5</span><span class="s2">,  </span><span class="s4">38.5</span><span class="s2">,  </span><span class="s4">39.5</span><span class="s2">,  </span><span class="s4">40.5</span><span class="s2">,  </span><span class="s4">41.5</span><span class="s2">,</span>
                <span class="s4">42.5</span><span class="s2">,  </span><span class="s4">43.5</span><span class="s2">,  </span><span class="s4">44.5</span><span class="s2">,  </span><span class="s4">45.5</span><span class="s2">,  </span><span class="s4">46.5</span><span class="s2">,  </span><span class="s4">47.5</span><span class="s2">,  </span><span class="s4">48.5</span><span class="s2">,  </span><span class="s4">49.5</span><span class="s2">,  </span><span class="s4">50.5</span><span class="s2">,</span>
                <span class="s4">51.5</span><span class="s2">,  </span><span class="s4">52.5</span><span class="s2">,  </span><span class="s4">53.5</span><span class="s2">,  </span><span class="s4">54.5</span><span class="s2">,  </span><span class="s4">55.5</span><span class="s2">,  </span><span class="s4">56.5</span><span class="s2">,  </span><span class="s4">57.5</span><span class="s2">,  </span><span class="s4">58.5</span><span class="s2">,  </span><span class="s4">59.5</span><span class="s2">,</span>
                <span class="s4">60.5</span><span class="s2">,  </span><span class="s4">61.5</span><span class="s2">,  </span><span class="s4">62.5</span><span class="s2">,  </span><span class="s4">63.5</span><span class="s2">,  </span><span class="s4">64.5</span><span class="s2">,  </span><span class="s4">65.5</span><span class="s2">,  </span><span class="s4">66.5</span><span class="s2">,  </span><span class="s4">67.5</span><span class="s2">,  </span><span class="s4">68.5</span><span class="s2">,</span>
                <span class="s4">69.5</span><span class="s2">,  </span><span class="s4">70.5</span><span class="s2">,  </span><span class="s4">71.5</span><span class="s2">,  </span><span class="s4">72.5</span><span class="s2">,  </span><span class="s4">73.5</span><span class="s2">,  </span><span class="s4">74.5</span><span class="s2">,  </span><span class="s4">75.5</span><span class="s2">,  </span><span class="s4">76.5</span><span class="s2">,  </span><span class="s4">77.5</span><span class="s2">,</span>
                <span class="s4">78.5</span><span class="s2">,  </span><span class="s4">79.5</span><span class="s2">,  </span><span class="s4">80.5</span><span class="s2">,  </span><span class="s4">81.5</span><span class="s2">,  </span><span class="s4">82.5</span><span class="s2">,  </span><span class="s4">83.5</span><span class="s2">,  </span><span class="s4">84.5</span><span class="s2">,  </span><span class="s4">85.5</span><span class="s2">,  </span><span class="s4">86.5</span><span class="s2">,</span>
                <span class="s4">87.5</span><span class="s2">,  </span><span class="s4">88.5</span><span class="s2">,  </span><span class="s4">89.5</span><span class="s2">,  </span><span class="s4">90.5</span><span class="s2">,  </span><span class="s4">91.5</span><span class="s2">,  </span><span class="s4">92.5</span><span class="s2">,  </span><span class="s4">93.5</span><span class="s2">,  </span><span class="s4">94.5</span><span class="s2">,  </span><span class="s4">95.4</span><span class="s2">,</span>
                <span class="s4">96.2</span><span class="s2">,  </span><span class="s4">96.9</span><span class="s2">,  </span><span class="s4">97.5</span><span class="s2">,  </span><span class="s4">98. </span><span class="s2">,  </span><span class="s4">98.4</span><span class="s2">,  </span><span class="s4">98.7</span><span class="s2">,  </span><span class="s4">98.9</span><span class="s2">,  </span><span class="s4">99. </span><span class="s1">])</span>
    <span class="s1">assert_array_almost_equal(xd</span><span class="s2">, </span><span class="s1">movmean(np.arange(</span><span class="s4">100</span><span class="s1">)</span><span class="s2">, </span><span class="s4">10</span><span class="s2">,</span><span class="s5">'leading'</span><span class="s1">))</span>

    <span class="s1">xc = np.array([ </span><span class="s4">1.36363636</span><span class="s2">,   </span><span class="s4">1.90909091</span><span class="s2">,   </span><span class="s4">2.54545455</span><span class="s2">,   </span><span class="s4">3.27272727</span><span class="s2">,</span>
                 <span class="s4">4.09090909</span><span class="s2">,   </span><span class="s4">5.        </span><span class="s2">,   </span><span class="s4">6.        </span><span class="s2">,   </span><span class="s4">7.        </span><span class="s2">,</span>
                 <span class="s4">8.        </span><span class="s2">,   </span><span class="s4">9.        </span><span class="s2">,  </span><span class="s4">10.        </span><span class="s2">,  </span><span class="s4">11.        </span><span class="s2">,</span>
                <span class="s4">12.        </span><span class="s2">,  </span><span class="s4">13.        </span><span class="s2">,  </span><span class="s4">14.        </span><span class="s2">,  </span><span class="s4">15.        </span><span class="s2">,</span>
                <span class="s4">16.        </span><span class="s2">,  </span><span class="s4">17.        </span><span class="s2">,  </span><span class="s4">18.        </span><span class="s2">,  </span><span class="s4">19.        </span><span class="s2">,</span>
                <span class="s4">20.        </span><span class="s2">,  </span><span class="s4">21.        </span><span class="s2">,  </span><span class="s4">22.        </span><span class="s2">,  </span><span class="s4">23.        </span><span class="s2">,</span>
                <span class="s4">24.        </span><span class="s2">,  </span><span class="s4">25.        </span><span class="s2">,  </span><span class="s4">26.        </span><span class="s2">,  </span><span class="s4">27.        </span><span class="s2">,</span>
                <span class="s4">28.        </span><span class="s2">,  </span><span class="s4">29.        </span><span class="s2">,  </span><span class="s4">30.        </span><span class="s2">,  </span><span class="s4">31.        </span><span class="s2">,</span>
                <span class="s4">32.        </span><span class="s2">,  </span><span class="s4">33.        </span><span class="s2">,  </span><span class="s4">34.        </span><span class="s2">,  </span><span class="s4">35.        </span><span class="s2">,</span>
                <span class="s4">36.        </span><span class="s2">,  </span><span class="s4">37.        </span><span class="s2">,  </span><span class="s4">38.        </span><span class="s2">,  </span><span class="s4">39.        </span><span class="s2">,</span>
                <span class="s4">40.        </span><span class="s2">,  </span><span class="s4">41.        </span><span class="s2">,  </span><span class="s4">42.        </span><span class="s2">,  </span><span class="s4">43.        </span><span class="s2">,</span>
                <span class="s4">44.        </span><span class="s2">,  </span><span class="s4">45.        </span><span class="s2">,  </span><span class="s4">46.        </span><span class="s2">,  </span><span class="s4">47.        </span><span class="s2">,</span>
                <span class="s4">48.        </span><span class="s2">,  </span><span class="s4">49.        </span><span class="s2">,  </span><span class="s4">50.        </span><span class="s2">,  </span><span class="s4">51.        </span><span class="s2">,</span>
                <span class="s4">52.        </span><span class="s2">,  </span><span class="s4">53.        </span><span class="s2">,  </span><span class="s4">54.        </span><span class="s2">,  </span><span class="s4">55.        </span><span class="s2">,</span>
                <span class="s4">56.        </span><span class="s2">,  </span><span class="s4">57.        </span><span class="s2">,  </span><span class="s4">58.        </span><span class="s2">,  </span><span class="s4">59.        </span><span class="s2">,</span>
                <span class="s4">60.        </span><span class="s2">,  </span><span class="s4">61.        </span><span class="s2">,  </span><span class="s4">62.        </span><span class="s2">,  </span><span class="s4">63.        </span><span class="s2">,</span>
                <span class="s4">64.        </span><span class="s2">,  </span><span class="s4">65.        </span><span class="s2">,  </span><span class="s4">66.        </span><span class="s2">,  </span><span class="s4">67.        </span><span class="s2">,</span>
                <span class="s4">68.        </span><span class="s2">,  </span><span class="s4">69.        </span><span class="s2">,  </span><span class="s4">70.        </span><span class="s2">,  </span><span class="s4">71.        </span><span class="s2">,</span>
                <span class="s4">72.        </span><span class="s2">,  </span><span class="s4">73.        </span><span class="s2">,  </span><span class="s4">74.        </span><span class="s2">,  </span><span class="s4">75.        </span><span class="s2">,</span>
                <span class="s4">76.        </span><span class="s2">,  </span><span class="s4">77.        </span><span class="s2">,  </span><span class="s4">78.        </span><span class="s2">,  </span><span class="s4">79.        </span><span class="s2">,</span>
                <span class="s4">80.        </span><span class="s2">,  </span><span class="s4">81.        </span><span class="s2">,  </span><span class="s4">82.        </span><span class="s2">,  </span><span class="s4">83.        </span><span class="s2">,</span>
                <span class="s4">84.        </span><span class="s2">,  </span><span class="s4">85.        </span><span class="s2">,  </span><span class="s4">86.        </span><span class="s2">,  </span><span class="s4">87.        </span><span class="s2">,</span>
                <span class="s4">88.        </span><span class="s2">,  </span><span class="s4">89.        </span><span class="s2">,  </span><span class="s4">90.        </span><span class="s2">,  </span><span class="s4">91.        </span><span class="s2">,</span>
                <span class="s4">92.        </span><span class="s2">,  </span><span class="s4">93.        </span><span class="s2">,  </span><span class="s4">94.        </span><span class="s2">,  </span><span class="s4">94.90909091</span><span class="s2">,</span>
                <span class="s4">95.72727273</span><span class="s2">,  </span><span class="s4">96.45454545</span><span class="s2">,  </span><span class="s4">97.09090909</span><span class="s2">,  </span><span class="s4">97.63636364</span><span class="s1">])</span>
    <span class="s1">assert_array_almost_equal(xc</span><span class="s2">, </span><span class="s1">movmean(np.arange(</span><span class="s4">100</span><span class="s1">)</span><span class="s2">, </span><span class="s4">11</span><span class="s2">,</span><span class="s5">'centered'</span><span class="s1">))</span>
</pre>
</body>
</html>