<html>
<head>
<title>test_strings.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6a8759;}
.s3 { color: #6897bb;}
.s4 { color: #808080;}
.s5 { color: #a5c261;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_strings.py</font>
</center></td></tr></table>
<pre><span class="s0">from </span><span class="s1">datetime </span><span class="s0">import </span><span class="s1">(</span>
    <span class="s1">datetime</span><span class="s0">,</span>
    <span class="s1">timedelta</span><span class="s0">,</span>
<span class="s1">)</span>

<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">import </span><span class="s1">pytest</span>

<span class="s0">from </span><span class="s1">pandas </span><span class="s0">import </span><span class="s1">(</span>
    <span class="s1">DataFrame</span><span class="s0">,</span>
    <span class="s1">Index</span><span class="s0">,</span>
    <span class="s1">MultiIndex</span><span class="s0">,</span>
    <span class="s1">Series</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">import </span><span class="s1">pandas._testing </span><span class="s0">as </span><span class="s1">tm</span>
<span class="s0">from </span><span class="s1">pandas.core.strings.accessor </span><span class="s0">import </span><span class="s1">StringMethods</span>
<span class="s0">from </span><span class="s1">pandas.tests.strings </span><span class="s0">import </span><span class="s1">object_pyarrow_numpy</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;pattern&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, True, </span><span class="s1">Series([</span><span class="s2">&quot;foo&quot;</span><span class="s0">, </span><span class="s2">&quot;bar&quot;</span><span class="s1">])])</span>
<span class="s0">def </span><span class="s1">test_startswith_endswith_non_str_patterns(pattern):</span>
    <span class="s4"># GH3485</span>
    <span class="s1">ser = Series([</span><span class="s2">&quot;foo&quot;</span><span class="s0">, </span><span class="s2">&quot;bar&quot;</span><span class="s1">])</span>
    <span class="s1">msg = </span><span class="s2">f&quot;expected a string or tuple, not </span><span class="s0">{</span><span class="s1">type(pattern).__name__</span><span class="s0">}</span><span class="s2">&quot;</span>
    <span class="s0">with </span><span class="s1">pytest.raises(TypeError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">ser.str.startswith(pattern)</span>
    <span class="s0">with </span><span class="s1">pytest.raises(TypeError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">ser.str.endswith(pattern)</span>


<span class="s0">def </span><span class="s1">test_iter_raises():</span>
    <span class="s4"># GH 54173</span>
    <span class="s1">ser = Series([</span><span class="s2">&quot;foo&quot;</span><span class="s0">, </span><span class="s2">&quot;bar&quot;</span><span class="s1">])</span>
    <span class="s0">with </span><span class="s1">pytest.raises(TypeError</span><span class="s0">, </span><span class="s1">match=</span><span class="s2">&quot;'StringMethods' object is not iterable&quot;</span><span class="s1">):</span>
        <span class="s1">iter(ser.str)</span>


<span class="s4"># test integer/float dtypes (inferred by constructor) and mixed</span>


<span class="s0">def </span><span class="s1">test_count(any_string_dtype):</span>
    <span class="s1">ser = Series([</span><span class="s2">&quot;foo&quot;</span><span class="s0">, </span><span class="s2">&quot;foofoo&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;foooofooofommmfoo&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">result = ser.str.count(</span><span class="s2">&quot;f[o]+&quot;</span><span class="s1">)</span>
    <span class="s1">expected_dtype = np.float64 </span><span class="s0">if </span><span class="s1">any_string_dtype </span><span class="s0">in </span><span class="s1">object_pyarrow_numpy </span><span class="s0">else </span><span class="s2">&quot;Int64&quot;</span>
    <span class="s1">expected = Series([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s3">4</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=expected_dtype)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_count_mixed_object():</span>
    <span class="s1">ser = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, True, </span><span class="s1">datetime.today()</span><span class="s0">, </span><span class="s2">&quot;foo&quot;</span><span class="s0">, None, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2.0</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">dtype=object</span><span class="s0">,</span>
    <span class="s1">)</span>
    <span class="s1">result = ser.str.count(</span><span class="s2">&quot;a&quot;</span><span class="s1">)</span>
    <span class="s1">expected = Series([</span><span class="s3">1</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan])</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_repeat(any_string_dtype):</span>
    <span class="s1">ser = Series([</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;c&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;d&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>

    <span class="s1">result = ser.str.repeat(</span><span class="s3">3</span><span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;aaa&quot;</span><span class="s0">, </span><span class="s2">&quot;bbb&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;ccc&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;ddd&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s1">result = ser.str.repeat([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">6</span><span class="s1">])</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;bb&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;cccc&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;dddddd&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_repeat_mixed_object():</span>
    <span class="s1">ser = Series([</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, True, </span><span class="s1">datetime.today()</span><span class="s0">, </span><span class="s2">&quot;foo&quot;</span><span class="s0">, None, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2.0</span><span class="s1">])</span>
    <span class="s1">result = ser.str.repeat(</span><span class="s3">3</span><span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;aaa&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;bbb&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;foofoofoo&quot;</span><span class="s0">, None, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;arg, repeat&quot;</span><span class="s0">, </span><span class="s1">[[</span><span class="s0">None, </span><span class="s3">4</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;b&quot;</span><span class="s0">, None</span><span class="s1">]])</span>
<span class="s0">def </span><span class="s1">test_repeat_with_null(any_string_dtype</span><span class="s0">, </span><span class="s1">arg</span><span class="s0">, </span><span class="s1">repeat):</span>
    <span class="s4"># GH: 31632</span>
    <span class="s1">ser = Series([</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s1">arg]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">result = ser.str.repeat([</span><span class="s3">3</span><span class="s0">, </span><span class="s1">repeat])</span>
    <span class="s1">expected = Series([</span><span class="s2">&quot;aaa&quot;</span><span class="s0">, None</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_empty_str_methods(any_string_dtype):</span>
    <span class="s1">empty_str = empty = Series(dtype=any_string_dtype)</span>
    <span class="s0">if </span><span class="s1">any_string_dtype </span><span class="s0">in </span><span class="s1">object_pyarrow_numpy:</span>
        <span class="s1">empty_int = Series(dtype=</span><span class="s2">&quot;int64&quot;</span><span class="s1">)</span>
        <span class="s1">empty_bool = Series(dtype=bool)</span>
    <span class="s0">else</span><span class="s1">:</span>
        <span class="s1">empty_int = Series(dtype=</span><span class="s2">&quot;Int64&quot;</span><span class="s1">)</span>
        <span class="s1">empty_bool = Series(dtype=</span><span class="s2">&quot;boolean&quot;</span><span class="s1">)</span>
    <span class="s1">empty_object = Series(dtype=object)</span>
    <span class="s1">empty_bytes = Series(dtype=object)</span>
    <span class="s1">empty_df = DataFrame()</span>

    <span class="s4"># GH7241</span>
    <span class="s4"># (extract) on empty series</span>

    <span class="s1">tm.assert_series_equal(empty_str</span><span class="s0">, </span><span class="s1">empty.str.cat(empty))</span>
    <span class="s0">assert </span><span class="s2">&quot;&quot; </span><span class="s1">== empty.str.cat()</span>
    <span class="s1">tm.assert_series_equal(empty_str</span><span class="s0">, </span><span class="s1">empty.str.title())</span>
    <span class="s1">tm.assert_series_equal(empty_int</span><span class="s0">, </span><span class="s1">empty.str.count(</span><span class="s2">&quot;a&quot;</span><span class="s1">))</span>
    <span class="s1">tm.assert_series_equal(empty_bool</span><span class="s0">, </span><span class="s1">empty.str.contains(</span><span class="s2">&quot;a&quot;</span><span class="s1">))</span>
    <span class="s1">tm.assert_series_equal(empty_bool</span><span class="s0">, </span><span class="s1">empty.str.startswith(</span><span class="s2">&quot;a&quot;</span><span class="s1">))</span>
    <span class="s1">tm.assert_series_equal(empty_bool</span><span class="s0">, </span><span class="s1">empty.str.endswith(</span><span class="s2">&quot;a&quot;</span><span class="s1">))</span>
    <span class="s1">tm.assert_series_equal(empty_str</span><span class="s0">, </span><span class="s1">empty.str.lower())</span>
    <span class="s1">tm.assert_series_equal(empty_str</span><span class="s0">, </span><span class="s1">empty.str.upper())</span>
    <span class="s1">tm.assert_series_equal(empty_str</span><span class="s0">, </span><span class="s1">empty.str.replace(</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">))</span>
    <span class="s1">tm.assert_series_equal(empty_str</span><span class="s0">, </span><span class="s1">empty.str.repeat(</span><span class="s3">3</span><span class="s1">))</span>
    <span class="s1">tm.assert_series_equal(empty_bool</span><span class="s0">, </span><span class="s1">empty.str.match(</span><span class="s2">&quot;^a&quot;</span><span class="s1">))</span>
    <span class="s1">tm.assert_frame_equal(</span>
        <span class="s1">DataFrame(columns=[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span><span class="s0">,</span>
        <span class="s1">empty.str.extract(</span><span class="s2">&quot;()&quot;</span><span class="s0">, </span><span class="s1">expand=</span><span class="s0">True</span><span class="s1">)</span><span class="s0">,</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_frame_equal(</span>
        <span class="s1">DataFrame(columns=[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span><span class="s0">,</span>
        <span class="s1">empty.str.extract(</span><span class="s2">&quot;()()&quot;</span><span class="s0">, </span><span class="s1">expand=</span><span class="s0">True</span><span class="s1">)</span><span class="s0">,</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(empty_str</span><span class="s0">, </span><span class="s1">empty.str.extract(</span><span class="s2">&quot;()&quot;</span><span class="s0">, </span><span class="s1">expand=</span><span class="s0">False</span><span class="s1">))</span>
    <span class="s1">tm.assert_frame_equal(</span>
        <span class="s1">DataFrame(columns=[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span><span class="s0">,</span>
        <span class="s1">empty.str.extract(</span><span class="s2">&quot;()()&quot;</span><span class="s0">, </span><span class="s1">expand=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">,</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_frame_equal(empty_df.set_axis([]</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">empty.str.get_dummies())</span>
    <span class="s1">tm.assert_series_equal(empty_str</span><span class="s0">, </span><span class="s1">empty_str.str.join(</span><span class="s2">&quot;&quot;</span><span class="s1">))</span>
    <span class="s1">tm.assert_series_equal(empty_int</span><span class="s0">, </span><span class="s1">empty.str.len())</span>
    <span class="s1">tm.assert_series_equal(empty_object</span><span class="s0">, </span><span class="s1">empty_str.str.findall(</span><span class="s2">&quot;a&quot;</span><span class="s1">))</span>
    <span class="s1">tm.assert_series_equal(empty_int</span><span class="s0">, </span><span class="s1">empty.str.find(</span><span class="s2">&quot;a&quot;</span><span class="s1">))</span>
    <span class="s1">tm.assert_series_equal(empty_int</span><span class="s0">, </span><span class="s1">empty.str.rfind(</span><span class="s2">&quot;a&quot;</span><span class="s1">))</span>
    <span class="s1">tm.assert_series_equal(empty_str</span><span class="s0">, </span><span class="s1">empty.str.pad(</span><span class="s3">42</span><span class="s1">))</span>
    <span class="s1">tm.assert_series_equal(empty_str</span><span class="s0">, </span><span class="s1">empty.str.center(</span><span class="s3">42</span><span class="s1">))</span>
    <span class="s1">tm.assert_series_equal(empty_object</span><span class="s0">, </span><span class="s1">empty.str.split(</span><span class="s2">&quot;a&quot;</span><span class="s1">))</span>
    <span class="s1">tm.assert_series_equal(empty_object</span><span class="s0">, </span><span class="s1">empty.str.rsplit(</span><span class="s2">&quot;a&quot;</span><span class="s1">))</span>
    <span class="s1">tm.assert_series_equal(empty_object</span><span class="s0">, </span><span class="s1">empty.str.partition(</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s1">expand=</span><span class="s0">False</span><span class="s1">))</span>
    <span class="s1">tm.assert_frame_equal(empty_df</span><span class="s0">, </span><span class="s1">empty.str.partition(</span><span class="s2">&quot;a&quot;</span><span class="s1">))</span>
    <span class="s1">tm.assert_series_equal(empty_object</span><span class="s0">, </span><span class="s1">empty.str.rpartition(</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s1">expand=</span><span class="s0">False</span><span class="s1">))</span>
    <span class="s1">tm.assert_frame_equal(empty_df</span><span class="s0">, </span><span class="s1">empty.str.rpartition(</span><span class="s2">&quot;a&quot;</span><span class="s1">))</span>
    <span class="s1">tm.assert_series_equal(empty_str</span><span class="s0">, </span><span class="s1">empty.str.slice(stop=</span><span class="s3">1</span><span class="s1">))</span>
    <span class="s1">tm.assert_series_equal(empty_str</span><span class="s0">, </span><span class="s1">empty.str.slice(step=</span><span class="s3">1</span><span class="s1">))</span>
    <span class="s1">tm.assert_series_equal(empty_str</span><span class="s0">, </span><span class="s1">empty.str.strip())</span>
    <span class="s1">tm.assert_series_equal(empty_str</span><span class="s0">, </span><span class="s1">empty.str.lstrip())</span>
    <span class="s1">tm.assert_series_equal(empty_str</span><span class="s0">, </span><span class="s1">empty.str.rstrip())</span>
    <span class="s1">tm.assert_series_equal(empty_str</span><span class="s0">, </span><span class="s1">empty.str.wrap(</span><span class="s3">42</span><span class="s1">))</span>
    <span class="s1">tm.assert_series_equal(empty_str</span><span class="s0">, </span><span class="s1">empty.str.get(</span><span class="s3">0</span><span class="s1">))</span>
    <span class="s1">tm.assert_series_equal(empty_object</span><span class="s0">, </span><span class="s1">empty_bytes.str.decode(</span><span class="s2">&quot;ascii&quot;</span><span class="s1">))</span>
    <span class="s1">tm.assert_series_equal(empty_bytes</span><span class="s0">, </span><span class="s1">empty.str.encode(</span><span class="s2">&quot;ascii&quot;</span><span class="s1">))</span>
    <span class="s4"># ismethods should always return boolean (GH 29624)</span>
    <span class="s1">tm.assert_series_equal(empty_bool</span><span class="s0">, </span><span class="s1">empty.str.isalnum())</span>
    <span class="s1">tm.assert_series_equal(empty_bool</span><span class="s0">, </span><span class="s1">empty.str.isalpha())</span>
    <span class="s1">tm.assert_series_equal(empty_bool</span><span class="s0">, </span><span class="s1">empty.str.isdigit())</span>
    <span class="s1">tm.assert_series_equal(empty_bool</span><span class="s0">, </span><span class="s1">empty.str.isspace())</span>
    <span class="s1">tm.assert_series_equal(empty_bool</span><span class="s0">, </span><span class="s1">empty.str.islower())</span>
    <span class="s1">tm.assert_series_equal(empty_bool</span><span class="s0">, </span><span class="s1">empty.str.isupper())</span>
    <span class="s1">tm.assert_series_equal(empty_bool</span><span class="s0">, </span><span class="s1">empty.str.istitle())</span>
    <span class="s1">tm.assert_series_equal(empty_bool</span><span class="s0">, </span><span class="s1">empty.str.isnumeric())</span>
    <span class="s1">tm.assert_series_equal(empty_bool</span><span class="s0">, </span><span class="s1">empty.str.isdecimal())</span>
    <span class="s1">tm.assert_series_equal(empty_str</span><span class="s0">, </span><span class="s1">empty.str.capitalize())</span>
    <span class="s1">tm.assert_series_equal(empty_str</span><span class="s0">, </span><span class="s1">empty.str.swapcase())</span>
    <span class="s1">tm.assert_series_equal(empty_str</span><span class="s0">, </span><span class="s1">empty.str.normalize(</span><span class="s2">&quot;NFC&quot;</span><span class="s1">))</span>

    <span class="s1">table = str.maketrans(</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(empty_str</span><span class="s0">, </span><span class="s1">empty.str.translate(table))</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;method, expected&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(</span><span class="s2">&quot;isalnum&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s0">True, True, True, True, True, False, True, True, False, False</span><span class="s1">])</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;isalpha&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s0">True, True, True, False, False, False, True, False, False, False</span><span class="s1">])</span><span class="s0">,</span>
        <span class="s1">(</span>
            <span class="s2">&quot;isdigit&quot;</span><span class="s0">,</span>
            <span class="s1">[</span><span class="s0">False, False, False, True, False, False, False, True, False, False</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span>
            <span class="s2">&quot;isnumeric&quot;</span><span class="s0">,</span>
            <span class="s1">[</span><span class="s0">False, False, False, True, False, False, False, True, False, False</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span>
            <span class="s2">&quot;isspace&quot;</span><span class="s0">,</span>
            <span class="s1">[</span><span class="s0">False, False, False, False, False, False, False, False, False, True</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span>
            <span class="s2">&quot;islower&quot;</span><span class="s0">,</span>
            <span class="s1">[</span><span class="s0">False, True, False, False, False, False, False, False, False, False</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span>
            <span class="s2">&quot;isupper&quot;</span><span class="s0">,</span>
            <span class="s1">[</span><span class="s0">True, False, False, False, True, False, True, False, False, False</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span>
            <span class="s2">&quot;istitle&quot;</span><span class="s0">,</span>
            <span class="s1">[</span><span class="s0">True, False, True, False, True, False, False, False, False, False</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_ismethods(method</span><span class="s0">, </span><span class="s1">expected</span><span class="s0">, </span><span class="s1">any_string_dtype):</span>
    <span class="s1">ser = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;A&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s2">&quot;Xy&quot;</span><span class="s0">, </span><span class="s2">&quot;4&quot;</span><span class="s0">, </span><span class="s2">&quot;3A&quot;</span><span class="s0">, </span><span class="s2">&quot;&quot;</span><span class="s0">, </span><span class="s2">&quot;TT&quot;</span><span class="s0">, </span><span class="s2">&quot;55&quot;</span><span class="s0">, </span><span class="s2">&quot;-&quot;</span><span class="s0">, </span><span class="s2">&quot;  &quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype</span>
    <span class="s1">)</span>
    <span class="s1">expected_dtype = </span><span class="s2">&quot;bool&quot; </span><span class="s0">if </span><span class="s1">any_string_dtype </span><span class="s0">in </span><span class="s1">object_pyarrow_numpy </span><span class="s0">else </span><span class="s2">&quot;boolean&quot;</span>
    <span class="s1">expected = Series(expected</span><span class="s0">, </span><span class="s1">dtype=expected_dtype)</span>
    <span class="s1">result = getattr(ser.str</span><span class="s0">, </span><span class="s1">method)()</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s4"># compare with standard library</span>
    <span class="s1">expected = [getattr(item</span><span class="s0">, </span><span class="s1">method)() </span><span class="s0">for </span><span class="s1">item </span><span class="s0">in </span><span class="s1">ser]</span>
    <span class="s0">assert </span><span class="s1">list(result) == expected</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;method, expected&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(</span><span class="s2">&quot;isnumeric&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s0">False, True, True, False, True, True, False</span><span class="s1">])</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;isdecimal&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s0">False, True, False, False, False, True, False</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_isnumeric_unicode(method</span><span class="s0">, </span><span class="s1">expected</span><span class="s0">, </span><span class="s1">any_string_dtype):</span>
    <span class="s4"># 0x00bc: ¼ VULGAR FRACTION ONE QUARTER</span>
    <span class="s4"># 0x2605: ★ not number</span>
    <span class="s4"># 0x1378: ፸ ETHIOPIC NUMBER SEVENTY</span>
    <span class="s4"># 0xFF13: ３ Em 3  # noqa: RUF003</span>
    <span class="s1">ser = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;A&quot;</span><span class="s0">, </span><span class="s2">&quot;3&quot;</span><span class="s0">, </span><span class="s2">&quot;¼&quot;</span><span class="s0">, </span><span class="s2">&quot;★&quot;</span><span class="s0">, </span><span class="s2">&quot;፸&quot;</span><span class="s0">, </span><span class="s2">&quot;３&quot;</span><span class="s0">, </span><span class="s2">&quot;four&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype  </span><span class="s4"># noqa: RUF001</span>
    <span class="s1">)</span>
    <span class="s1">expected_dtype = </span><span class="s2">&quot;bool&quot; </span><span class="s0">if </span><span class="s1">any_string_dtype </span><span class="s0">in </span><span class="s1">object_pyarrow_numpy </span><span class="s0">else </span><span class="s2">&quot;boolean&quot;</span>
    <span class="s1">expected = Series(expected</span><span class="s0">, </span><span class="s1">dtype=expected_dtype)</span>
    <span class="s1">result = getattr(ser.str</span><span class="s0">, </span><span class="s1">method)()</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s4"># compare with standard library</span>
    <span class="s1">expected = [getattr(item</span><span class="s0">, </span><span class="s1">method)() </span><span class="s0">for </span><span class="s1">item </span><span class="s0">in </span><span class="s1">ser]</span>
    <span class="s0">assert </span><span class="s1">list(result) == expected</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;method, expected&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(</span><span class="s2">&quot;isnumeric&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s0">False, </span><span class="s1">np.nan</span><span class="s0">, True, False, </span><span class="s1">np.nan</span><span class="s0">, True, False</span><span class="s1">])</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;isdecimal&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s0">False, </span><span class="s1">np.nan</span><span class="s0">, False, False, </span><span class="s1">np.nan</span><span class="s0">, True, False</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_isnumeric_unicode_missing(method</span><span class="s0">, </span><span class="s1">expected</span><span class="s0">, </span><span class="s1">any_string_dtype):</span>
    <span class="s1">values = [</span><span class="s2">&quot;A&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;¼&quot;</span><span class="s0">, </span><span class="s2">&quot;★&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;３&quot;</span><span class="s0">, </span><span class="s2">&quot;four&quot;</span><span class="s1">]  </span><span class="s4"># noqa: RUF001</span>
    <span class="s1">ser = Series(values</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">expected_dtype = </span><span class="s2">&quot;object&quot; </span><span class="s0">if </span><span class="s1">any_string_dtype </span><span class="s0">in </span><span class="s1">object_pyarrow_numpy </span><span class="s0">else </span><span class="s2">&quot;boolean&quot;</span>
    <span class="s1">expected = Series(expected</span><span class="s0">, </span><span class="s1">dtype=expected_dtype)</span>
    <span class="s1">result = getattr(ser.str</span><span class="s0">, </span><span class="s1">method)()</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_spilt_join_roundtrip(any_string_dtype):</span>
    <span class="s1">ser = Series([</span><span class="s2">&quot;a_b_c&quot;</span><span class="s0">, </span><span class="s2">&quot;c_d_e&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;f_g_h&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">result = ser.str.split(</span><span class="s2">&quot;_&quot;</span><span class="s1">).str.join(</span><span class="s2">&quot;_&quot;</span><span class="s1">)</span>
    <span class="s1">expected = ser.astype(object)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_spilt_join_roundtrip_mixed_object():</span>
    <span class="s1">ser = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;a_b&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;asdf_cas_asdf&quot;</span><span class="s0">, True, </span><span class="s1">datetime.today()</span><span class="s0">, </span><span class="s2">&quot;foo&quot;</span><span class="s0">, None, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2.0</span><span class="s1">]</span>
    <span class="s1">)</span>
    <span class="s1">result = ser.str.split(</span><span class="s2">&quot;_&quot;</span><span class="s1">).str.join(</span><span class="s2">&quot;_&quot;</span><span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;a_b&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;asdf_cas_asdf&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;foo&quot;</span><span class="s0">, None, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_len(any_string_dtype):</span>
    <span class="s1">ser = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;foo&quot;</span><span class="s0">, </span><span class="s2">&quot;fooo&quot;</span><span class="s0">, </span><span class="s2">&quot;fooooo&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;fooooooo&quot;</span><span class="s0">, </span><span class="s2">&quot;foo</span><span class="s0">\n</span><span class="s2">&quot;</span><span class="s0">, </span><span class="s2">&quot;あ&quot;</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">dtype=any_string_dtype</span><span class="s0">,</span>
    <span class="s1">)</span>
    <span class="s1">result = ser.str.len()</span>
    <span class="s1">expected_dtype = </span><span class="s2">&quot;float64&quot; </span><span class="s0">if </span><span class="s1">any_string_dtype </span><span class="s0">in </span><span class="s1">object_pyarrow_numpy </span><span class="s0">else </span><span class="s2">&quot;Int64&quot;</span>
    <span class="s1">expected = Series([</span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=expected_dtype)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_len_mixed():</span>
    <span class="s1">ser = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;a_b&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;asdf_cas_asdf&quot;</span><span class="s0">, True, </span><span class="s1">datetime.today()</span><span class="s0">, </span><span class="s2">&quot;foo&quot;</span><span class="s0">, None, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2.0</span><span class="s1">]</span>
    <span class="s1">)</span>
    <span class="s1">result = ser.str.len()</span>
    <span class="s1">expected = Series([</span><span class="s3">3</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s3">13</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan])</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;method,sub,start,end,expected&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(</span><span class="s2">&quot;index&quot;</span><span class="s0">, </span><span class="s2">&quot;EF&quot;</span><span class="s0">, None, None, </span><span class="s1">[</span><span class="s3">4</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s1">])</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;rindex&quot;</span><span class="s0">, </span><span class="s2">&quot;EF&quot;</span><span class="s0">, None, None, </span><span class="s1">[</span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">4</span><span class="s1">])</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;index&quot;</span><span class="s0">, </span><span class="s2">&quot;EF&quot;</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, None, </span><span class="s1">[</span><span class="s3">4</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">4</span><span class="s1">])</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;rindex&quot;</span><span class="s0">, </span><span class="s2">&quot;EF&quot;</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, None, </span><span class="s1">[</span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">4</span><span class="s1">])</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;index&quot;</span><span class="s0">, </span><span class="s2">&quot;E&quot;</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s1">[</span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">4</span><span class="s1">])</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;rindex&quot;</span><span class="s0">, </span><span class="s2">&quot;E&quot;</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s1">[</span><span class="s3">4</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">4</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_index(method</span><span class="s0">, </span><span class="s1">sub</span><span class="s0">, </span><span class="s1">start</span><span class="s0">, </span><span class="s1">end</span><span class="s0">, </span><span class="s1">index_or_series</span><span class="s0">, </span><span class="s1">any_string_dtype</span><span class="s0">, </span><span class="s1">expected):</span>
    <span class="s1">obj = index_or_series(</span>
        <span class="s1">[</span><span class="s2">&quot;ABCDEFG&quot;</span><span class="s0">, </span><span class="s2">&quot;BCDEFEF&quot;</span><span class="s0">, </span><span class="s2">&quot;DEFGHIJEF&quot;</span><span class="s0">, </span><span class="s2">&quot;EFGHEF&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype</span>
    <span class="s1">)</span>
    <span class="s1">expected_dtype = np.int64 </span><span class="s0">if </span><span class="s1">any_string_dtype </span><span class="s0">in </span><span class="s1">object_pyarrow_numpy </span><span class="s0">else </span><span class="s2">&quot;Int64&quot;</span>
    <span class="s1">expected = index_or_series(expected</span><span class="s0">, </span><span class="s1">dtype=expected_dtype)</span>

    <span class="s1">result = getattr(obj.str</span><span class="s0">, </span><span class="s1">method)(sub</span><span class="s0">, </span><span class="s1">start</span><span class="s0">, </span><span class="s1">end)</span>

    <span class="s0">if </span><span class="s1">index_or_series </span><span class="s0">is </span><span class="s1">Series:</span>
        <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>
    <span class="s0">else</span><span class="s1">:</span>
        <span class="s1">tm.assert_index_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s4"># compare with standard library</span>
    <span class="s1">expected = [getattr(item</span><span class="s0">, </span><span class="s1">method)(sub</span><span class="s0">, </span><span class="s1">start</span><span class="s0">, </span><span class="s1">end) </span><span class="s0">for </span><span class="s1">item </span><span class="s0">in </span><span class="s1">obj]</span>
    <span class="s0">assert </span><span class="s1">list(result) == expected</span>


<span class="s0">def </span><span class="s1">test_index_not_found_raises(index_or_series</span><span class="s0">, </span><span class="s1">any_string_dtype):</span>
    <span class="s1">obj = index_or_series(</span>
        <span class="s1">[</span><span class="s2">&quot;ABCDEFG&quot;</span><span class="s0">, </span><span class="s2">&quot;BCDEFEF&quot;</span><span class="s0">, </span><span class="s2">&quot;DEFGHIJEF&quot;</span><span class="s0">, </span><span class="s2">&quot;EFGHEF&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype</span>
    <span class="s1">)</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">, </span><span class="s1">match=</span><span class="s2">&quot;substring not found&quot;</span><span class="s1">):</span>
        <span class="s1">obj.str.index(</span><span class="s2">&quot;DE&quot;</span><span class="s1">)</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;method&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;index&quot;</span><span class="s0">, </span><span class="s2">&quot;rindex&quot;</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">test_index_wrong_type_raises(index_or_series</span><span class="s0">, </span><span class="s1">any_string_dtype</span><span class="s0">, </span><span class="s1">method):</span>
    <span class="s1">obj = index_or_series([]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">msg = </span><span class="s2">&quot;expected a string object, not int&quot;</span>

    <span class="s0">with </span><span class="s1">pytest.raises(TypeError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">getattr(obj.str</span><span class="s0">, </span><span class="s1">method)(</span><span class="s3">0</span><span class="s1">)</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;method, exp&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">[</span><span class="s2">&quot;index&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s2">&quot;rindex&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s3">3</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]]</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_index_missing(any_string_dtype</span><span class="s0">, </span><span class="s1">method</span><span class="s0">, </span><span class="s1">exp):</span>
    <span class="s1">ser = Series([</span><span class="s2">&quot;abcb&quot;</span><span class="s0">, </span><span class="s2">&quot;ab&quot;</span><span class="s0">, </span><span class="s2">&quot;bcbe&quot;</span><span class="s0">, </span><span class="s1">np.nan]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">expected_dtype = np.float64 </span><span class="s0">if </span><span class="s1">any_string_dtype </span><span class="s0">in </span><span class="s1">object_pyarrow_numpy </span><span class="s0">else </span><span class="s2">&quot;Int64&quot;</span>

    <span class="s1">result = getattr(ser.str</span><span class="s0">, </span><span class="s1">method)(</span><span class="s2">&quot;b&quot;</span><span class="s1">)</span>
    <span class="s1">expected = Series(exp + [np.nan]</span><span class="s0">, </span><span class="s1">dtype=expected_dtype)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_pipe_failures(any_string_dtype):</span>
    <span class="s4"># #2119</span>
    <span class="s1">ser = Series([</span><span class="s2">&quot;A|B|C&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>

    <span class="s1">result = ser.str.split(</span><span class="s2">&quot;|&quot;</span><span class="s1">)</span>
    <span class="s1">expected = Series([[</span><span class="s2">&quot;A&quot;</span><span class="s0">, </span><span class="s2">&quot;B&quot;</span><span class="s0">, </span><span class="s2">&quot;C&quot;</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">dtype=object)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s1">result = ser.str.replace(</span><span class="s2">&quot;|&quot;</span><span class="s0">, </span><span class="s2">&quot; &quot;</span><span class="s0">, </span><span class="s1">regex=</span><span class="s0">False</span><span class="s1">)</span>
    <span class="s1">expected = Series([</span><span class="s2">&quot;A B C&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;start, stop, step, expected&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, None, </span><span class="s1">[</span><span class="s2">&quot;foo&quot;</span><span class="s0">, </span><span class="s2">&quot;bar&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;baz&quot;</span><span class="s1">])</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;&quot;</span><span class="s0">, </span><span class="s2">&quot;&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;&quot;</span><span class="s1">])</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s0">None, None, </span><span class="s1">-</span><span class="s3">1</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;owtoofaa&quot;</span><span class="s0">, </span><span class="s2">&quot;owtrabaa&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;xuqzabaa&quot;</span><span class="s1">])</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;oto&quot;</span><span class="s0">, </span><span class="s2">&quot;ato&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;aqx&quot;</span><span class="s1">])</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;ofa&quot;</span><span class="s0">, </span><span class="s2">&quot;aba&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;aba&quot;</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_slice(start</span><span class="s0">, </span><span class="s1">stop</span><span class="s0">, </span><span class="s1">step</span><span class="s0">, </span><span class="s1">expected</span><span class="s0">, </span><span class="s1">any_string_dtype):</span>
    <span class="s1">ser = Series([</span><span class="s2">&quot;aafootwo&quot;</span><span class="s0">, </span><span class="s2">&quot;aabartwo&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;aabazqux&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">result = ser.str.slice(start</span><span class="s0">, </span><span class="s1">stop</span><span class="s0">, </span><span class="s1">step)</span>
    <span class="s1">expected = Series(expected</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;start, stop, step, expected&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, None, </span><span class="s1">[</span><span class="s2">&quot;foo&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;bar&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, None, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan])</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;oof&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;rab&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, None, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan])</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_slice_mixed_object(start</span><span class="s0">, </span><span class="s1">stop</span><span class="s0">, </span><span class="s1">step</span><span class="s0">, </span><span class="s1">expected):</span>
    <span class="s1">ser = Series([</span><span class="s2">&quot;aafootwo&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;aabartwo&quot;</span><span class="s0">, True, </span><span class="s1">datetime.today()</span><span class="s0">, None, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2.0</span><span class="s1">])</span>
    <span class="s1">result = ser.str.slice(start</span><span class="s0">, </span><span class="s1">stop</span><span class="s0">, </span><span class="s1">step)</span>
    <span class="s1">expected = Series(expected)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;start,stop,repl,expected&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, None, </span><span class="s1">[</span><span class="s2">&quot;shrt&quot;</span><span class="s0">, </span><span class="s2">&quot;a it longer&quot;</span><span class="s0">, </span><span class="s2">&quot;evnlongerthanthat&quot;</span><span class="s0">, </span><span class="s2">&quot;&quot;</span><span class="s0">, </span><span class="s1">np.nan])</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;shzrt&quot;</span><span class="s0">, </span><span class="s2">&quot;a zit longer&quot;</span><span class="s0">, </span><span class="s2">&quot;evznlongerthanthat&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s1">np.nan])</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;shzort&quot;</span><span class="s0">, </span><span class="s2">&quot;a zbit longer&quot;</span><span class="s0">, </span><span class="s2">&quot;evzenlongerthanthat&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s1">np.nan])</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;shzort&quot;</span><span class="s0">, </span><span class="s2">&quot;a zbit longer&quot;</span><span class="s0">, </span><span class="s2">&quot;evzenlongerthanthat&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s1">np.nan])</span><span class="s0">,</span>
        <span class="s1">(-</span><span class="s3">1</span><span class="s0">, None, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;shorz&quot;</span><span class="s0">, </span><span class="s2">&quot;a bit longez&quot;</span><span class="s0">, </span><span class="s2">&quot;evenlongerthanthaz&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s1">np.nan])</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s0">None, </span><span class="s1">-</span><span class="s3">2</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;zrt&quot;</span><span class="s0">, </span><span class="s2">&quot;zer&quot;</span><span class="s0">, </span><span class="s2">&quot;zat&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s1">np.nan])</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s3">6</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;shortz&quot;</span><span class="s0">, </span><span class="s2">&quot;a bit znger&quot;</span><span class="s0">, </span><span class="s2">&quot;evenlozerthanthat&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s1">np.nan])</span><span class="s0">,</span>
        <span class="s1">(-</span><span class="s3">10</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;zrt&quot;</span><span class="s0">, </span><span class="s2">&quot;a zit longer&quot;</span><span class="s0">, </span><span class="s2">&quot;evenlongzerthanthat&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s1">np.nan])</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_slice_replace(start</span><span class="s0">, </span><span class="s1">stop</span><span class="s0">, </span><span class="s1">repl</span><span class="s0">, </span><span class="s1">expected</span><span class="s0">, </span><span class="s1">any_string_dtype):</span>
    <span class="s1">ser = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;short&quot;</span><span class="s0">, </span><span class="s2">&quot;a bit longer&quot;</span><span class="s0">, </span><span class="s2">&quot;evenlongerthanthat&quot;</span><span class="s0">, </span><span class="s2">&quot;&quot;</span><span class="s0">, </span><span class="s1">np.nan]</span><span class="s0">,</span>
        <span class="s1">dtype=any_string_dtype</span><span class="s0">,</span>
    <span class="s1">)</span>
    <span class="s1">expected = Series(expected</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">result = ser.str.slice_replace(start</span><span class="s0">, </span><span class="s1">stop</span><span class="s0">, </span><span class="s1">repl)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;method, exp&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">[</span><span class="s2">&quot;strip&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;aa&quot;</span><span class="s0">, </span><span class="s2">&quot;bb&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;cc&quot;</span><span class="s1">]]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s2">&quot;lstrip&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;aa   &quot;</span><span class="s0">, </span><span class="s2">&quot;bb </span><span class="s0">\n</span><span class="s2">&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;cc  &quot;</span><span class="s1">]]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s2">&quot;rstrip&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;  aa&quot;</span><span class="s0">, </span><span class="s2">&quot; bb&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;cc&quot;</span><span class="s1">]]</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_strip_lstrip_rstrip(any_string_dtype</span><span class="s0">, </span><span class="s1">method</span><span class="s0">, </span><span class="s1">exp):</span>
    <span class="s1">ser = Series([</span><span class="s2">&quot;  aa   &quot;</span><span class="s0">, </span><span class="s2">&quot; bb </span><span class="s0">\n</span><span class="s2">&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;cc  &quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>

    <span class="s1">result = getattr(ser.str</span><span class="s0">, </span><span class="s1">method)()</span>
    <span class="s1">expected = Series(exp</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;method, exp&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">[</span><span class="s2">&quot;strip&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;aa&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;bb&quot;</span><span class="s1">]]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s2">&quot;lstrip&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;aa  &quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;bb </span><span class="s0">\t\n</span><span class="s2">&quot;</span><span class="s1">]]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s2">&quot;rstrip&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;  aa&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot; bb&quot;</span><span class="s1">]]</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_strip_lstrip_rstrip_mixed_object(method</span><span class="s0">, </span><span class="s1">exp):</span>
    <span class="s1">ser = Series([</span><span class="s2">&quot;  aa  &quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot; bb </span><span class="s0">\t\n</span><span class="s2">&quot;</span><span class="s0">, True, </span><span class="s1">datetime.today()</span><span class="s0">, None, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2.0</span><span class="s1">])</span>

    <span class="s1">result = getattr(ser.str</span><span class="s0">, </span><span class="s1">method)()</span>
    <span class="s1">expected = Series(exp + [np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, None, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan])</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;method, exp&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">[</span><span class="s2">&quot;strip&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;ABC&quot;</span><span class="s0">, </span><span class="s2">&quot; BNSD&quot;</span><span class="s0">, </span><span class="s2">&quot;LDFJH &quot;</span><span class="s1">]]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s2">&quot;lstrip&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;ABCxx&quot;</span><span class="s0">, </span><span class="s2">&quot; BNSD&quot;</span><span class="s0">, </span><span class="s2">&quot;LDFJH xx&quot;</span><span class="s1">]]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s2">&quot;rstrip&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;xxABC&quot;</span><span class="s0">, </span><span class="s2">&quot;xx BNSD&quot;</span><span class="s0">, </span><span class="s2">&quot;LDFJH &quot;</span><span class="s1">]]</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_strip_lstrip_rstrip_args(any_string_dtype</span><span class="s0">, </span><span class="s1">method</span><span class="s0">, </span><span class="s1">exp):</span>
    <span class="s1">ser = Series([</span><span class="s2">&quot;xxABCxx&quot;</span><span class="s0">, </span><span class="s2">&quot;xx BNSD&quot;</span><span class="s0">, </span><span class="s2">&quot;LDFJH xx&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>

    <span class="s1">result = getattr(ser.str</span><span class="s0">, </span><span class="s1">method)(</span><span class="s2">&quot;x&quot;</span><span class="s1">)</span>
    <span class="s1">expected = Series(exp</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;prefix, expected&quot;</span><span class="s0">, </span><span class="s1">[(</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s2">&quot; b c&quot;</span><span class="s0">, </span><span class="s2">&quot;bc&quot;</span><span class="s1">])</span><span class="s0">, </span><span class="s1">(</span><span class="s2">&quot;ab&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;&quot;</span><span class="s0">, </span><span class="s2">&quot;a b c&quot;</span><span class="s0">, </span><span class="s2">&quot;bc&quot;</span><span class="s1">])]</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_removeprefix(any_string_dtype</span><span class="s0">, </span><span class="s1">prefix</span><span class="s0">, </span><span class="s1">expected):</span>
    <span class="s1">ser = Series([</span><span class="s2">&quot;ab&quot;</span><span class="s0">, </span><span class="s2">&quot;a b c&quot;</span><span class="s0">, </span><span class="s2">&quot;bc&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">result = ser.str.removeprefix(prefix)</span>
    <span class="s1">ser_expected = Series(expected</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">ser_expected)</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;suffix, expected&quot;</span><span class="s0">, </span><span class="s1">[(</span><span class="s2">&quot;c&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;ab&quot;</span><span class="s0">, </span><span class="s2">&quot;a b &quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">])</span><span class="s0">, </span><span class="s1">(</span><span class="s2">&quot;bc&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;ab&quot;</span><span class="s0">, </span><span class="s2">&quot;a b c&quot;</span><span class="s0">, </span><span class="s2">&quot;&quot;</span><span class="s1">])]</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_removesuffix(any_string_dtype</span><span class="s0">, </span><span class="s1">suffix</span><span class="s0">, </span><span class="s1">expected):</span>
    <span class="s1">ser = Series([</span><span class="s2">&quot;ab&quot;</span><span class="s0">, </span><span class="s2">&quot;a b c&quot;</span><span class="s0">, </span><span class="s2">&quot;bc&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">result = ser.str.removesuffix(suffix)</span>
    <span class="s1">ser_expected = Series(expected</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">ser_expected)</span>


<span class="s0">def </span><span class="s1">test_string_slice_get_syntax(any_string_dtype):</span>
    <span class="s1">ser = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;YYY&quot;</span><span class="s0">, </span><span class="s2">&quot;B&quot;</span><span class="s0">, </span><span class="s2">&quot;C&quot;</span><span class="s0">, </span><span class="s2">&quot;YYYYYYbYYY&quot;</span><span class="s0">, </span><span class="s2">&quot;BYYYcYYY&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;CYYYBYYY&quot;</span><span class="s0">, </span><span class="s2">&quot;dog&quot;</span><span class="s0">, </span><span class="s2">&quot;cYYYt&quot;</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">dtype=any_string_dtype</span><span class="s0">,</span>
    <span class="s1">)</span>

    <span class="s1">result = ser.str[</span><span class="s3">0</span><span class="s1">]</span>
    <span class="s1">expected = ser.str.get(</span><span class="s3">0</span><span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s1">result = ser.str[:</span><span class="s3">3</span><span class="s1">]</span>
    <span class="s1">expected = ser.str.slice(stop=</span><span class="s3">3</span><span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s1">result = ser.str[</span><span class="s3">2</span><span class="s1">::-</span><span class="s3">1</span><span class="s1">]</span>
    <span class="s1">expected = ser.str.slice(start=</span><span class="s3">2</span><span class="s0">, </span><span class="s1">step=-</span><span class="s3">1</span><span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_string_slice_out_of_bounds_nested():</span>
    <span class="s1">ser = Series([(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">1</span><span class="s0">,</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s1">)])</span>
    <span class="s1">result = ser.str[</span><span class="s3">1</span><span class="s1">]</span>
    <span class="s1">expected = Series([</span><span class="s3">2</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s3">4</span><span class="s1">])</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_string_slice_out_of_bounds(any_string_dtype):</span>
    <span class="s1">ser = Series([</span><span class="s2">&quot;foo&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s2">&quot;ba&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">result = ser.str[</span><span class="s3">1</span><span class="s1">]</span>
    <span class="s1">expected = Series([</span><span class="s2">&quot;o&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;a&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_encode_decode(any_string_dtype):</span>
    <span class="s1">ser = Series([</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s2">&quot;a</span><span class="s0">\xe4</span><span class="s2">&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype).str.encode(</span><span class="s2">&quot;utf-8&quot;</span><span class="s1">)</span>
    <span class="s1">result = ser.str.decode(</span><span class="s2">&quot;utf-8&quot;</span><span class="s1">)</span>
    <span class="s1">expected = ser.map(</span><span class="s0">lambda </span><span class="s1">x: x.decode(</span><span class="s2">&quot;utf-8&quot;</span><span class="s1">))</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_encode_errors_kwarg(any_string_dtype):</span>
    <span class="s1">ser = Series([</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s2">&quot;a</span><span class="s0">\x9d</span><span class="s2">&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>

    <span class="s1">msg = (</span>
        <span class="s2">r&quot;'charmap' codec can't encode character '\\x9d' in position 1: &quot;</span>
        <span class="s2">&quot;character maps to &lt;undefined&gt;&quot;</span>
    <span class="s1">)</span>
    <span class="s0">with </span><span class="s1">pytest.raises(UnicodeEncodeError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">ser.str.encode(</span><span class="s2">&quot;cp1252&quot;</span><span class="s1">)</span>

    <span class="s1">result = ser.str.encode(</span><span class="s2">&quot;cp1252&quot;</span><span class="s0">, </span><span class="s2">&quot;ignore&quot;</span><span class="s1">)</span>
    <span class="s1">expected = ser.map(</span><span class="s0">lambda </span><span class="s1">x: x.encode(</span><span class="s2">&quot;cp1252&quot;</span><span class="s0">, </span><span class="s2">&quot;ignore&quot;</span><span class="s1">))</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_decode_errors_kwarg():</span>
    <span class="s1">ser = Series([</span><span class="s5">b&quot;a&quot;</span><span class="s0">, </span><span class="s5">b&quot;b&quot;</span><span class="s0">, </span><span class="s5">b&quot;a</span><span class="s0">\x9d</span><span class="s5">&quot;</span><span class="s1">])</span>

    <span class="s1">msg = (</span>
        <span class="s2">&quot;'charmap' codec can't decode byte 0x9d in position 1: &quot;</span>
        <span class="s2">&quot;character maps to &lt;undefined&gt;&quot;</span>
    <span class="s1">)</span>
    <span class="s0">with </span><span class="s1">pytest.raises(UnicodeDecodeError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">ser.str.decode(</span><span class="s2">&quot;cp1252&quot;</span><span class="s1">)</span>

    <span class="s1">result = ser.str.decode(</span><span class="s2">&quot;cp1252&quot;</span><span class="s0">, </span><span class="s2">&quot;ignore&quot;</span><span class="s1">)</span>
    <span class="s1">expected = ser.map(</span><span class="s0">lambda </span><span class="s1">x: x.decode(</span><span class="s2">&quot;cp1252&quot;</span><span class="s0">, </span><span class="s2">&quot;ignore&quot;</span><span class="s1">))</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;form, expected&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(</span><span class="s2">&quot;NFKC&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;ABC&quot;</span><span class="s0">, </span><span class="s2">&quot;ABC&quot;</span><span class="s0">, </span><span class="s2">&quot;123&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;アイエ&quot;</span><span class="s1">])</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;NFC&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;ABC&quot;</span><span class="s0">, </span><span class="s2">&quot;ＡＢＣ&quot;</span><span class="s0">, </span><span class="s2">&quot;１２３&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;ｱｲｴ&quot;</span><span class="s1">])</span><span class="s0">,  </span><span class="s4"># noqa: RUF001</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_normalize(form</span><span class="s0">, </span><span class="s1">expected</span><span class="s0">, </span><span class="s1">any_string_dtype):</span>
    <span class="s1">ser = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;ABC&quot;</span><span class="s0">, </span><span class="s2">&quot;ＡＢＣ&quot;</span><span class="s0">, </span><span class="s2">&quot;１２３&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;ｱｲｴ&quot;</span><span class="s1">]</span><span class="s0">,  </span><span class="s4"># noqa: RUF001</span>
        <span class="s1">index=[</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s2">&quot;c&quot;</span><span class="s0">, </span><span class="s2">&quot;d&quot;</span><span class="s0">, </span><span class="s2">&quot;e&quot;</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">dtype=any_string_dtype</span><span class="s0">,</span>
    <span class="s1">)</span>
    <span class="s1">expected = Series(expected</span><span class="s0">, </span><span class="s1">index=[</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s2">&quot;c&quot;</span><span class="s0">, </span><span class="s2">&quot;d&quot;</span><span class="s0">, </span><span class="s2">&quot;e&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">result = ser.str.normalize(form)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_normalize_bad_arg_raises(any_string_dtype):</span>
    <span class="s1">ser = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;ABC&quot;</span><span class="s0">, </span><span class="s2">&quot;ＡＢＣ&quot;</span><span class="s0">, </span><span class="s2">&quot;１２３&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;ｱｲｴ&quot;</span><span class="s1">]</span><span class="s0">,  </span><span class="s4"># noqa: RUF001</span>
        <span class="s1">index=[</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s2">&quot;c&quot;</span><span class="s0">, </span><span class="s2">&quot;d&quot;</span><span class="s0">, </span><span class="s2">&quot;e&quot;</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">dtype=any_string_dtype</span><span class="s0">,</span>
    <span class="s1">)</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">, </span><span class="s1">match=</span><span class="s2">&quot;invalid normalization form&quot;</span><span class="s1">):</span>
        <span class="s1">ser.str.normalize(</span><span class="s2">&quot;xxx&quot;</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_normalize_index():</span>
    <span class="s1">idx = Index([</span><span class="s2">&quot;ＡＢＣ&quot;</span><span class="s0">, </span><span class="s2">&quot;１２３&quot;</span><span class="s0">, </span><span class="s2">&quot;ｱｲｴ&quot;</span><span class="s1">])  </span><span class="s4"># noqa: RUF001</span>
    <span class="s1">expected = Index([</span><span class="s2">&quot;ABC&quot;</span><span class="s0">, </span><span class="s2">&quot;123&quot;</span><span class="s0">, </span><span class="s2">&quot;アイエ&quot;</span><span class="s1">])</span>
    <span class="s1">result = idx.str.normalize(</span><span class="s2">&quot;NFKC&quot;</span><span class="s1">)</span>
    <span class="s1">tm.assert_index_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;values,inferred_type&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">([</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s2">&quot;string&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">([</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s2">&quot;mixed-integer&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">([</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s3">1.3</span><span class="s1">]</span><span class="s0">, </span><span class="s2">&quot;mixed&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">([</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s3">1.3</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s2">&quot;mixed-integer&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">([</span><span class="s2">&quot;aa&quot;</span><span class="s0">, </span><span class="s1">datetime(</span><span class="s3">2011</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)]</span><span class="s0">, </span><span class="s2">&quot;mixed&quot;</span><span class="s1">)</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_index_str_accessor_visibility(values</span><span class="s0">, </span><span class="s1">inferred_type</span><span class="s0">, </span><span class="s1">index_or_series):</span>
    <span class="s1">obj = index_or_series(values)</span>
    <span class="s0">if </span><span class="s1">index_or_series </span><span class="s0">is </span><span class="s1">Index:</span>
        <span class="s0">assert </span><span class="s1">obj.inferred_type == inferred_type</span>

    <span class="s0">assert </span><span class="s1">isinstance(obj.str</span><span class="s0">, </span><span class="s1">StringMethods)</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;values,inferred_type&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">([</span><span class="s3">1</span><span class="s0">, </span><span class="s1">np.nan]</span><span class="s0">, </span><span class="s2">&quot;floating&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">([datetime(</span><span class="s3">2011</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)]</span><span class="s0">, </span><span class="s2">&quot;datetime64&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">([timedelta(</span><span class="s3">1</span><span class="s1">)]</span><span class="s0">, </span><span class="s2">&quot;timedelta64&quot;</span><span class="s1">)</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_index_str_accessor_non_string_values_raises(</span>
    <span class="s1">values</span><span class="s0">, </span><span class="s1">inferred_type</span><span class="s0">, </span><span class="s1">index_or_series</span>
<span class="s1">):</span>
    <span class="s1">obj = index_or_series(values)</span>
    <span class="s0">if </span><span class="s1">index_or_series </span><span class="s0">is </span><span class="s1">Index:</span>
        <span class="s0">assert </span><span class="s1">obj.inferred_type == inferred_type</span>

    <span class="s1">msg = </span><span class="s2">&quot;Can only use .str accessor with string values&quot;</span>
    <span class="s0">with </span><span class="s1">pytest.raises(AttributeError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">obj.str</span>


<span class="s0">def </span><span class="s1">test_index_str_accessor_multiindex_raises():</span>
    <span class="s4"># MultiIndex has mixed dtype, but not allow to use accessor</span>
    <span class="s1">idx = MultiIndex.from_tuples([(</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">)])</span>
    <span class="s0">assert </span><span class="s1">idx.inferred_type == </span><span class="s2">&quot;mixed&quot;</span>

    <span class="s1">msg = </span><span class="s2">&quot;Can only use .str accessor with Index, not MultiIndex&quot;</span>
    <span class="s0">with </span><span class="s1">pytest.raises(AttributeError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">idx.str</span>


<span class="s0">def </span><span class="s1">test_str_accessor_no_new_attributes(any_string_dtype):</span>
    <span class="s4"># https://github.com/pandas-dev/pandas/issues/10673</span>
    <span class="s1">ser = Series(list(</span><span class="s2">&quot;aabbcde&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s0">with </span><span class="s1">pytest.raises(AttributeError</span><span class="s0">, </span><span class="s1">match=</span><span class="s2">&quot;You cannot add any new attribute&quot;</span><span class="s1">):</span>
        <span class="s1">ser.str.xlabel = </span><span class="s2">&quot;a&quot;</span>


<span class="s0">def </span><span class="s1">test_cat_on_bytes_raises():</span>
    <span class="s1">lhs = Series(np.array(list(</span><span class="s2">&quot;abc&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s2">&quot;S1&quot;</span><span class="s1">).astype(object))</span>
    <span class="s1">rhs = Series(np.array(list(</span><span class="s2">&quot;def&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s2">&quot;S1&quot;</span><span class="s1">).astype(object))</span>
    <span class="s1">msg = </span><span class="s2">&quot;Cannot use .str.cat with values of inferred dtype 'bytes'&quot;</span>
    <span class="s0">with </span><span class="s1">pytest.raises(TypeError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">lhs.str.cat(rhs)</span>


<span class="s0">def </span><span class="s1">test_str_accessor_in_apply_func():</span>
    <span class="s4"># https://github.com/pandas-dev/pandas/issues/38979</span>
    <span class="s1">df = DataFrame(zip(</span><span class="s2">&quot;abc&quot;</span><span class="s0">, </span><span class="s2">&quot;def&quot;</span><span class="s1">))</span>
    <span class="s1">expected = Series([</span><span class="s2">&quot;A/D&quot;</span><span class="s0">, </span><span class="s2">&quot;B/E&quot;</span><span class="s0">, </span><span class="s2">&quot;C/F&quot;</span><span class="s1">])</span>
    <span class="s1">result = df.apply(</span><span class="s0">lambda </span><span class="s1">f: </span><span class="s2">&quot;/&quot;</span><span class="s1">.join(f.str.upper())</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_zfill():</span>
    <span class="s4"># https://github.com/pandas-dev/pandas/issues/20868</span>
    <span class="s1">value = Series([</span><span class="s2">&quot;-1&quot;</span><span class="s0">, </span><span class="s2">&quot;1&quot;</span><span class="s0">, </span><span class="s2">&quot;1000&quot;</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s1">np.nan])</span>
    <span class="s1">expected = Series([</span><span class="s2">&quot;-01&quot;</span><span class="s0">, </span><span class="s2">&quot;001&quot;</span><span class="s0">, </span><span class="s2">&quot;1000&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan])</span>
    <span class="s1">tm.assert_series_equal(value.str.zfill(</span><span class="s3">3</span><span class="s1">)</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s1">value = Series([</span><span class="s2">&quot;-2&quot;</span><span class="s0">, </span><span class="s2">&quot;+5&quot;</span><span class="s1">])</span>
    <span class="s1">expected = Series([</span><span class="s2">&quot;-0002&quot;</span><span class="s0">, </span><span class="s2">&quot;+0005&quot;</span><span class="s1">])</span>
    <span class="s1">tm.assert_series_equal(value.str.zfill(</span><span class="s3">5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_zfill_with_non_integer_argument():</span>
    <span class="s1">value = Series([</span><span class="s2">&quot;-2&quot;</span><span class="s0">, </span><span class="s2">&quot;+5&quot;</span><span class="s1">])</span>
    <span class="s1">wid = </span><span class="s2">&quot;a&quot;</span>
    <span class="s1">msg = </span><span class="s2">f&quot;width must be of integer type, not </span><span class="s0">{</span><span class="s1">type(wid).__name__</span><span class="s0">}</span><span class="s2">&quot;</span>
    <span class="s0">with </span><span class="s1">pytest.raises(TypeError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">value.str.zfill(wid)</span>


<span class="s0">def </span><span class="s1">test_zfill_with_leading_sign():</span>
    <span class="s1">value = Series([</span><span class="s2">&quot;-cat&quot;</span><span class="s0">, </span><span class="s2">&quot;-1&quot;</span><span class="s0">, </span><span class="s2">&quot;+dog&quot;</span><span class="s1">])</span>
    <span class="s1">expected = Series([</span><span class="s2">&quot;-0cat&quot;</span><span class="s0">, </span><span class="s2">&quot;-0001&quot;</span><span class="s0">, </span><span class="s2">&quot;+0dog&quot;</span><span class="s1">])</span>
    <span class="s1">tm.assert_series_equal(value.str.zfill(</span><span class="s3">5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_get_with_dict_label():</span>
    <span class="s4"># GH47911</span>
    <span class="s1">s = Series(</span>
        <span class="s1">[</span>
            <span class="s1">{</span><span class="s2">&quot;name&quot;</span><span class="s1">: </span><span class="s2">&quot;Hello&quot;</span><span class="s0">, </span><span class="s2">&quot;value&quot;</span><span class="s1">: </span><span class="s2">&quot;World&quot;</span><span class="s1">}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">&quot;name&quot;</span><span class="s1">: </span><span class="s2">&quot;Goodbye&quot;</span><span class="s0">, </span><span class="s2">&quot;value&quot;</span><span class="s1">: </span><span class="s2">&quot;Planet&quot;</span><span class="s1">}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">&quot;value&quot;</span><span class="s1">: </span><span class="s2">&quot;Sea&quot;</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">]</span>
    <span class="s1">)</span>
    <span class="s1">result = s.str.get(</span><span class="s2">&quot;name&quot;</span><span class="s1">)</span>
    <span class="s1">expected = Series([</span><span class="s2">&quot;Hello&quot;</span><span class="s0">, </span><span class="s2">&quot;Goodbye&quot;</span><span class="s0">, None</span><span class="s1">])</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>
    <span class="s1">result = s.str.get(</span><span class="s2">&quot;value&quot;</span><span class="s1">)</span>
    <span class="s1">expected = Series([</span><span class="s2">&quot;World&quot;</span><span class="s0">, </span><span class="s2">&quot;Planet&quot;</span><span class="s0">, </span><span class="s2">&quot;Sea&quot;</span><span class="s1">])</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_series_str_decode():</span>
    <span class="s4"># GH 22613</span>
    <span class="s1">result = Series([</span><span class="s5">b&quot;x&quot;</span><span class="s0">, </span><span class="s5">b&quot;y&quot;</span><span class="s1">]).str.decode(encoding=</span><span class="s2">&quot;UTF-8&quot;</span><span class="s0">, </span><span class="s1">errors=</span><span class="s2">&quot;strict&quot;</span><span class="s1">)</span>
    <span class="s1">expected = Series([</span><span class="s2">&quot;x&quot;</span><span class="s0">, </span><span class="s2">&quot;y&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=</span><span class="s2">&quot;object&quot;</span><span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>
</pre>
</body>
</html>