<html>
<head>
<title>test_params.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #808080;}
.s3 { color: #6897bb;}
.s4 { color: #6a8759;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_params.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">import </span><span class="s1">pandas </span><span class="s0">as </span><span class="s1">pd</span>

<span class="s0">from </span><span class="s1">numpy.testing </span><span class="s0">import </span><span class="s1">assert_</span><span class="s0">, </span><span class="s1">assert_equal</span><span class="s0">, </span><span class="s1">assert_allclose</span><span class="s0">, </span><span class="s1">assert_raises</span>

<span class="s0">from </span><span class="s1">statsmodels.tsa.arima </span><span class="s0">import </span><span class="s1">specification</span><span class="s0">, </span><span class="s1">params</span>


<span class="s0">def </span><span class="s1">test_init():</span>
    <span class="s2"># Test initialization of the params</span>

    <span class="s2"># Basic test, with 1 of each parameter</span>
    <span class="s1">exog = pd.DataFrame([[</span><span class="s3">0</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">columns=[</span><span class="s4">'a'</span><span class="s1">])</span>
    <span class="s1">spec = specification.SARIMAXSpecification(</span>
        <span class="s1">exog=exog</span><span class="s0">, </span><span class="s1">order=(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">seasonal_order=(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">4</span><span class="s1">))</span>
    <span class="s1">p = params.SARIMAXParams(spec=spec)</span>

    <span class="s2"># Test things copied over from spec</span>
    <span class="s1">assert_equal(p.spec</span><span class="s0">, </span><span class="s1">spec)</span>
    <span class="s1">assert_equal(p.exog_names</span><span class="s0">, </span><span class="s1">[</span><span class="s4">'a'</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ar_names</span><span class="s0">, </span><span class="s1">[</span><span class="s4">'ar.L1'</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ma_names</span><span class="s0">, </span><span class="s1">[</span><span class="s4">'ma.L1'</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ar_names</span><span class="s0">, </span><span class="s1">[</span><span class="s4">'ar.S.L4'</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ma_names</span><span class="s0">, </span><span class="s1">[</span><span class="s4">'ma.S.L4'</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.param_names</span><span class="s0">, </span><span class="s1">[</span><span class="s4">'a'</span><span class="s0">, </span><span class="s4">'ar.L1'</span><span class="s0">, </span><span class="s4">'ma.L1'</span><span class="s0">, </span><span class="s4">'ar.S.L4'</span><span class="s0">, </span><span class="s4">'ma.S.L4'</span><span class="s0">,</span>
                                 <span class="s4">'sigma2'</span><span class="s1">])</span>

    <span class="s1">assert_equal(p.k_exog_params</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span>
    <span class="s1">assert_equal(p.k_ar_params</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span>
    <span class="s1">assert_equal(p.k_ma_params</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span>
    <span class="s1">assert_equal(p.k_seasonal_ar_params</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span>
    <span class="s1">assert_equal(p.k_seasonal_ma_params</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span>
    <span class="s1">assert_equal(p.k_params</span><span class="s0">, </span><span class="s3">6</span><span class="s1">)</span>

    <span class="s2"># Initial parameters should all be NaN</span>
    <span class="s1">assert_equal(p.params</span><span class="s0">, </span><span class="s1">np.nan)</span>
    <span class="s1">assert_equal(p.ar_params</span><span class="s0">, </span><span class="s1">[np.nan])</span>
    <span class="s1">assert_equal(p.ma_params</span><span class="s0">, </span><span class="s1">[np.nan])</span>
    <span class="s1">assert_equal(p.seasonal_ar_params</span><span class="s0">, </span><span class="s1">[np.nan])</span>
    <span class="s1">assert_equal(p.seasonal_ma_params</span><span class="s0">, </span><span class="s1">[np.nan])</span>
    <span class="s1">assert_equal(p.sigma2</span><span class="s0">, </span><span class="s1">np.nan)</span>
    <span class="s1">assert_equal(p.ar_poly.coef</span><span class="s0">, </span><span class="s1">np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s1">np.nan])</span>
    <span class="s1">assert_equal(p.ma_poly.coef</span><span class="s0">, </span><span class="s1">np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s1">np.nan])</span>
    <span class="s1">assert_equal(p.seasonal_ar_poly.coef</span><span class="s0">, </span><span class="s1">np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">np.nan])</span>
    <span class="s1">assert_equal(p.seasonal_ma_poly.coef</span><span class="s0">, </span><span class="s1">np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">np.nan])</span>
    <span class="s1">assert_equal(p.reduced_ar_poly.coef</span><span class="s0">, </span><span class="s1">np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s1">[np.nan] * </span><span class="s3">5</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.reduced_ma_poly.coef</span><span class="s0">, </span><span class="s1">np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s1">[np.nan] * </span><span class="s3">5</span><span class="s1">])</span>

    <span class="s2"># Test other properties, methods</span>
    <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">p.is_complete)</span>
    <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">p.is_valid)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__getattribute__</span><span class="s0">, </span><span class="s4">'is_stationary'</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__getattribute__</span><span class="s0">, </span><span class="s4">'is_invertible'</span><span class="s1">)</span>
    <span class="s1">desired = {</span>
        <span class="s4">'exog_params'</span><span class="s1">: [np.nan]</span><span class="s0">,</span>
        <span class="s4">'ar_params'</span><span class="s1">: [np.nan]</span><span class="s0">,</span>
        <span class="s4">'ma_params'</span><span class="s1">: [np.nan]</span><span class="s0">,</span>
        <span class="s4">'seasonal_ar_params'</span><span class="s1">: [np.nan]</span><span class="s0">,</span>
        <span class="s4">'seasonal_ma_params'</span><span class="s1">: [np.nan]</span><span class="s0">,</span>
        <span class="s4">'sigma2'</span><span class="s1">: np.nan}</span>
    <span class="s1">assert_equal(p.to_dict()</span><span class="s0">, </span><span class="s1">desired)</span>
    <span class="s1">desired = pd.Series([np.nan] * spec.k_params</span><span class="s0">, </span><span class="s1">index=spec.param_names)</span>
    <span class="s1">assert_allclose(p.to_pandas()</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s2"># Test with different numbers of parameters for each</span>
    <span class="s1">exog = pd.DataFrame([[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">columns=[</span><span class="s4">'a'</span><span class="s0">, </span><span class="s4">'b'</span><span class="s1">])</span>
    <span class="s1">spec = specification.SARIMAXSpecification(</span>
        <span class="s1">exog=exog</span><span class="s0">, </span><span class="s1">order=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">seasonal_order=(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">4</span><span class="s1">))</span>
    <span class="s1">p = params.SARIMAXParams(spec=spec)</span>
    <span class="s2"># No real need to test names here, since they are already tested above for</span>
    <span class="s2"># the 1-param case, and tested more extensively in test for</span>
    <span class="s2"># SARIMAXSpecification</span>
    <span class="s1">assert_equal(p.k_exog_params</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)</span>
    <span class="s1">assert_equal(p.k_ar_params</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span>
    <span class="s1">assert_equal(p.k_ma_params</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)</span>
    <span class="s1">assert_equal(p.k_seasonal_ar_params</span><span class="s0">, </span><span class="s3">5</span><span class="s1">)</span>
    <span class="s1">assert_equal(p.k_seasonal_ma_params</span><span class="s0">, </span><span class="s3">6</span><span class="s1">)</span>
    <span class="s1">assert_equal(p.k_params</span><span class="s0">, </span><span class="s3">2 </span><span class="s1">+ </span><span class="s3">3 </span><span class="s1">+ </span><span class="s3">2 </span><span class="s1">+ </span><span class="s3">5 </span><span class="s1">+ </span><span class="s3">6 </span><span class="s1">+ </span><span class="s3">1</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_set_params_single():</span>
    <span class="s2"># Test setting parameters directly (i.e. we test setting the AR/MA</span>
    <span class="s2"># parameters by setting the lag polynomials elsewhere)</span>
    <span class="s2"># Here each type has only a single parameters</span>
    <span class="s1">exog = pd.DataFrame([[</span><span class="s3">0</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">columns=[</span><span class="s4">'a'</span><span class="s1">])</span>
    <span class="s1">spec = specification.SARIMAXSpecification(</span>
        <span class="s1">exog=exog</span><span class="s0">, </span><span class="s1">order=(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">seasonal_order=(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">4</span><span class="s1">))</span>
    <span class="s1">p = params.SARIMAXParams(spec=spec)</span>

    <span class="s0">def </span><span class="s1">check(is_stationary=</span><span class="s4">'raise'</span><span class="s0">, </span><span class="s1">is_invertible=</span><span class="s4">'raise'</span><span class="s1">):</span>
        <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">p.is_complete)</span>
        <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">p.is_valid)</span>
        <span class="s0">if </span><span class="s1">is_stationary == </span><span class="s4">'raise'</span><span class="s1">:</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__getattribute__</span><span class="s0">, </span><span class="s4">'is_stationary'</span><span class="s1">)</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">assert_equal(p.is_stationary</span><span class="s0">, </span><span class="s1">is_stationary)</span>
        <span class="s0">if </span><span class="s1">is_invertible == </span><span class="s4">'raise'</span><span class="s1">:</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__getattribute__</span><span class="s0">, </span><span class="s4">'is_invertible'</span><span class="s1">)</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">assert_equal(p.is_invertible</span><span class="s0">, </span><span class="s1">is_invertible)</span>

    <span class="s2"># Set params one at a time, as scalars</span>
    <span class="s1">p.exog_params = -</span><span class="s3">6.</span>
    <span class="s1">check()</span>
    <span class="s1">p.ar_params = -</span><span class="s3">5.</span>
    <span class="s1">check()</span>
    <span class="s1">p.ma_params = -</span><span class="s3">4.</span>
    <span class="s1">check()</span>
    <span class="s1">p.seasonal_ar_params = -</span><span class="s3">3.</span>
    <span class="s1">check(is_stationary=</span><span class="s0">False</span><span class="s1">)</span>
    <span class="s1">p.seasonal_ma_params = -</span><span class="s3">2.</span>
    <span class="s1">check(is_stationary=</span><span class="s0">False, </span><span class="s1">is_invertible=</span><span class="s0">False</span><span class="s1">)</span>
    <span class="s1">p.sigma2 = -</span><span class="s3">1.</span>
    <span class="s2"># Finally, we have a complete set.</span>
    <span class="s1">assert_(p.is_complete)</span>
    <span class="s2"># But still not valid</span>
    <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">p.is_valid)</span>

    <span class="s1">assert_equal(p.params</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">6</span><span class="s0">, </span><span class="s1">-</span><span class="s3">5</span><span class="s0">, </span><span class="s1">-</span><span class="s3">4</span><span class="s0">, </span><span class="s1">-</span><span class="s3">3</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.exog_params</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">6</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ar_params</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">5</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ma_params</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">4</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ar_params</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">3</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ma_params</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">2</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.sigma2</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.</span><span class="s1">)</span>

    <span class="s2"># Lag polynomials</span>
    <span class="s1">assert_equal(p.ar_poly.coef</span><span class="s0">, </span><span class="s1">np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">5</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ma_poly.coef</span><span class="s0">, </span><span class="s1">np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">4</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ar_poly.coef</span><span class="s0">, </span><span class="s1">np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">3</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ma_poly.coef</span><span class="s0">, </span><span class="s1">np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2</span><span class="s1">])</span>
    <span class="s2"># (1 - a L) (1 - b L^4) = (1 - a L - b L^4 + a b L^5)</span>
    <span class="s1">assert_equal(p.reduced_ar_poly.coef</span><span class="s0">, </span><span class="s1">np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">15</span><span class="s1">])</span>
    <span class="s2"># (1 + a L) (1 + b L^4) = (1 + a L + b L^4 + a b L^5)</span>
    <span class="s1">assert_equal(p.reduced_ma_poly.coef</span><span class="s0">, </span><span class="s1">np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">4</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2</span><span class="s0">, </span><span class="s3">8</span><span class="s1">])</span>

    <span class="s2"># Override again, one at a time, now using lists</span>
    <span class="s1">p.exog_params = [</span><span class="s3">1.</span><span class="s1">]</span>
    <span class="s1">p.ar_params = [</span><span class="s3">2.</span><span class="s1">]</span>
    <span class="s1">p.ma_params = [</span><span class="s3">3.</span><span class="s1">]</span>
    <span class="s1">p.seasonal_ar_params = [</span><span class="s3">4.</span><span class="s1">]</span>
    <span class="s1">p.seasonal_ma_params = [</span><span class="s3">5.</span><span class="s1">]</span>
    <span class="s1">p.sigma2 = [</span><span class="s3">6.</span><span class="s1">]</span>

    <span class="s1">p.params = [</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">6</span><span class="s1">]</span>
    <span class="s1">assert_equal(p.params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">6</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.exog_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ar_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ma_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">3</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ar_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">4</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ma_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">5</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.sigma2</span><span class="s0">, </span><span class="s3">6.</span><span class="s1">)</span>

    <span class="s2"># Override again, one at a time, now using arrays</span>
    <span class="s1">p.exog_params = np.array(</span><span class="s3">6.</span><span class="s1">)</span>
    <span class="s1">p.ar_params = np.array(</span><span class="s3">5.</span><span class="s1">)</span>
    <span class="s1">p.ma_params = np.array(</span><span class="s3">4.</span><span class="s1">)</span>
    <span class="s1">p.seasonal_ar_params = np.array(</span><span class="s3">3.</span><span class="s1">)</span>
    <span class="s1">p.seasonal_ma_params = np.array(</span><span class="s3">2.</span><span class="s1">)</span>
    <span class="s1">p.sigma2 = np.array(</span><span class="s3">1.</span><span class="s1">)</span>

    <span class="s1">assert_equal(p.params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">6</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.exog_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">6</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ar_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">5</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ma_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">4</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ar_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">3</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ma_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.sigma2</span><span class="s0">, </span><span class="s3">1.</span><span class="s1">)</span>

    <span class="s2"># Override again, now setting params all at once</span>
    <span class="s1">p.params = [</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">6</span><span class="s1">]</span>
    <span class="s1">assert_equal(p.params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">6</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.exog_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ar_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ma_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">3</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ar_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">4</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ma_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">5</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.sigma2</span><span class="s0">, </span><span class="s3">6.</span><span class="s1">)</span>

    <span class="s2"># Lag polynomials</span>
    <span class="s1">assert_equal(p.ar_poly.coef</span><span class="s0">, </span><span class="s1">np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ma_poly.coef</span><span class="s0">, </span><span class="s1">np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">3</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ar_poly.coef</span><span class="s0">, </span><span class="s1">np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">4</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ma_poly.coef</span><span class="s0">, </span><span class="s1">np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">5</span><span class="s1">])</span>
    <span class="s2"># (1 - a L) (1 - b L^4) = (1 - a L - b L^4 + a b L^5)</span>
    <span class="s1">assert_equal(p.reduced_ar_poly.coef</span><span class="s0">, </span><span class="s1">np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">4</span><span class="s0">, </span><span class="s3">8</span><span class="s1">])</span>
    <span class="s2"># (1 + a L) (1 + b L^4) = (1 + a L + b L^4 + a b L^5)</span>
    <span class="s1">assert_equal(p.reduced_ma_poly.coef</span><span class="s0">, </span><span class="s1">np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">15</span><span class="s1">])</span>


<span class="s0">def </span><span class="s1">test_set_params_single_nonconsecutive():</span>
    <span class="s2"># Test setting parameters directly (i.e. we test setting the AR/MA</span>
    <span class="s2"># parameters by setting the lag polynomials elsewhere)</span>
    <span class="s2"># Here each type has only a single parameters but has non-consecutive</span>
    <span class="s2"># lag orders</span>
    <span class="s1">exog = pd.DataFrame([[</span><span class="s3">0</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">columns=[</span><span class="s4">'a'</span><span class="s1">])</span>
    <span class="s1">spec = specification.SARIMAXSpecification(</span>
        <span class="s1">exog=exog</span><span class="s0">, </span><span class="s1">order=([</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">])</span><span class="s0">,</span>
        <span class="s1">seasonal_order=([</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s3">4</span><span class="s1">))</span>
    <span class="s1">p = params.SARIMAXParams(spec=spec)</span>

    <span class="s0">def </span><span class="s1">check(is_stationary=</span><span class="s4">'raise'</span><span class="s0">, </span><span class="s1">is_invertible=</span><span class="s4">'raise'</span><span class="s1">):</span>
        <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">p.is_complete)</span>
        <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">p.is_valid)</span>
        <span class="s0">if </span><span class="s1">is_stationary == </span><span class="s4">'raise'</span><span class="s1">:</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__getattribute__</span><span class="s0">, </span><span class="s4">'is_stationary'</span><span class="s1">)</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">assert_equal(p.is_stationary</span><span class="s0">, </span><span class="s1">is_stationary)</span>
        <span class="s0">if </span><span class="s1">is_invertible == </span><span class="s4">'raise'</span><span class="s1">:</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__getattribute__</span><span class="s0">, </span><span class="s4">'is_invertible'</span><span class="s1">)</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">assert_equal(p.is_invertible</span><span class="s0">, </span><span class="s1">is_invertible)</span>

    <span class="s2"># Set params one at a time, as scalars</span>
    <span class="s1">p.exog_params = -</span><span class="s3">6.</span>
    <span class="s1">check()</span>
    <span class="s1">p.ar_params = -</span><span class="s3">5.</span>
    <span class="s1">check()</span>
    <span class="s1">p.ma_params = -</span><span class="s3">4.</span>
    <span class="s1">check()</span>
    <span class="s1">p.seasonal_ar_params = -</span><span class="s3">3.</span>
    <span class="s1">check(is_stationary=</span><span class="s0">False</span><span class="s1">)</span>
    <span class="s1">p.seasonal_ma_params = -</span><span class="s3">2.</span>
    <span class="s1">check(is_stationary=</span><span class="s0">False, </span><span class="s1">is_invertible=</span><span class="s0">False</span><span class="s1">)</span>
    <span class="s1">p.sigma2 = -</span><span class="s3">1.</span>
    <span class="s2"># Finally, we have a complete set.</span>
    <span class="s1">assert_(p.is_complete)</span>
    <span class="s2"># But still not valid</span>
    <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">p.is_valid)</span>

    <span class="s1">assert_equal(p.params</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">6</span><span class="s0">, </span><span class="s1">-</span><span class="s3">5</span><span class="s0">, </span><span class="s1">-</span><span class="s3">4</span><span class="s0">, </span><span class="s1">-</span><span class="s3">3</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.exog_params</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">6</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ar_params</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">5</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ma_params</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">4</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ar_params</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">3</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ma_params</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">2</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.sigma2</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.</span><span class="s1">)</span>

    <span class="s2"># Lag polynomials</span>
    <span class="s1">assert_equal(p.ar_poly.coef</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">5</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ma_poly.coef</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">4</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ar_poly.coef</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">3</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ma_poly.coef</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2</span><span class="s1">])</span>
    <span class="s2"># (1 - a L^2) (1 - b L^8) = (1 - a L^2 - b L^8 + a b L^10)</span>
    <span class="s1">assert_equal(p.reduced_ar_poly.coef</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">15</span><span class="s1">])</span>
    <span class="s2"># (1 + a L^2) (1 + b L^4) = (1 + a L^2 + b L^8 + a b L^10)</span>
    <span class="s1">assert_equal(p.reduced_ma_poly.coef</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">4</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">8</span><span class="s1">])</span>

    <span class="s2"># Override again, now setting params all at once</span>
    <span class="s1">p.params = [</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">6</span><span class="s1">]</span>
    <span class="s1">assert_equal(p.params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">6</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.exog_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ar_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ma_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">3</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ar_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">4</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ma_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">5</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.sigma2</span><span class="s0">, </span><span class="s3">6.</span><span class="s1">)</span>

    <span class="s2"># Lag polynomials</span>
    <span class="s1">assert_equal(p.ar_poly.coef</span><span class="s0">, </span><span class="s1">np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ma_poly.coef</span><span class="s0">, </span><span class="s1">np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">3</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ar_poly.coef</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">4</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ma_poly.coef</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">5</span><span class="s1">])</span>
    <span class="s2"># (1 - a L^2) (1 - b L^8) = (1 - a L^2 - b L^8 + a b L^10)</span>
    <span class="s1">assert_equal(p.reduced_ar_poly.coef</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">4</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">8</span><span class="s1">])</span>
    <span class="s2"># (1 + a L^2) (1 + b L^4) = (1 + a L^2 + b L^8 + a b L^10)</span>
    <span class="s1">assert_equal(p.reduced_ma_poly.coef</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">15</span><span class="s1">])</span>


<span class="s0">def </span><span class="s1">test_set_params_multiple():</span>
    <span class="s2"># Test setting parameters directly (i.e. we test setting the AR/MA</span>
    <span class="s2"># parameters by setting the lag polynomials elsewhere)</span>
    <span class="s2"># Here each type has multiple a single parameters</span>
    <span class="s1">exog = pd.DataFrame([[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">columns=[</span><span class="s4">'a'</span><span class="s0">, </span><span class="s4">'b'</span><span class="s1">])</span>
    <span class="s1">spec = specification.SARIMAXSpecification(</span>
        <span class="s1">exog=exog</span><span class="s0">, </span><span class="s1">order=(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">seasonal_order=(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">4</span><span class="s1">))</span>
    <span class="s1">p = params.SARIMAXParams(spec=spec)</span>

    <span class="s1">p.params = [-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s1">-</span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s1">-</span><span class="s3">5</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s1">-</span><span class="s3">7</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s1">-</span><span class="s3">9</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s1">-</span><span class="s3">11</span><span class="s1">]</span>
    <span class="s1">assert_equal(p.params</span><span class="s0">,</span>
                 <span class="s1">[-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s1">-</span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s1">-</span><span class="s3">5</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s1">-</span><span class="s3">7</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s1">-</span><span class="s3">9</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s1">-</span><span class="s3">11</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.exog_params</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ar_params</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ma_params</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">5</span><span class="s0">, </span><span class="s3">6</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ar_params</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">7</span><span class="s0">, </span><span class="s3">8</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ma_params</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">9</span><span class="s0">, </span><span class="s3">10</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.sigma2</span><span class="s0">, </span><span class="s1">-</span><span class="s3">11</span><span class="s1">)</span>

    <span class="s2"># Lag polynomials</span>
    <span class="s1">assert_equal(p.ar_poly.coef</span><span class="s0">, </span><span class="s1">np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">-</span><span class="s3">4</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ma_poly.coef</span><span class="s0">, </span><span class="s1">np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">5</span><span class="s0">, </span><span class="s3">6</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ar_poly.coef</span><span class="s0">, </span><span class="s1">np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">8</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ma_poly.coef</span><span class="s0">, </span><span class="s1">np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">9</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">10</span><span class="s1">])</span>
    <span class="s2"># (1 - a_1 L - a_2 L^2) (1 - b_1 L^4 - b_2 L^8) =</span>
    <span class="s2">#     (1 - b_1 L^4 - b_2 L^8) +</span>
    <span class="s2">#     (-a_1 L + a_1 b_1 L^5 + a_1 b_2 L^9) +</span>
    <span class="s2">#     (-a_2 L^2 + a_2 b_1 L^6 + a_2 b_2 L^10) =</span>
    <span class="s2">#     1 - a_1 L - a_2 L^2 - b_1 L^4 + a_1 b_1 L^5 +</span>
    <span class="s2">#     a_2 b_1 L^6 - b_2 L^8 + a_1 b_2 L^9 + a_2 b_2 L^10</span>
    <span class="s1">assert_equal(p.reduced_ar_poly.coef</span><span class="s0">,</span>
                 <span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">-</span><span class="s3">4</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s1">(-</span><span class="s3">3 </span><span class="s1">* -</span><span class="s3">7</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">4 </span><span class="s1">* -</span><span class="s3">7</span><span class="s1">)</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">8</span><span class="s0">, </span><span class="s1">(-</span><span class="s3">3 </span><span class="s1">* </span><span class="s3">8</span><span class="s1">)</span><span class="s0">, </span><span class="s3">4 </span><span class="s1">* </span><span class="s3">8</span><span class="s1">])</span>
    <span class="s2"># (1 + a_1 L + a_2 L^2) (1 + b_1 L^4 + b_2 L^8) =</span>
    <span class="s2">#     (1 + b_1 L^4 + b_2 L^8) +</span>
    <span class="s2">#     (a_1 L + a_1 b_1 L^5 + a_1 b_2 L^9) +</span>
    <span class="s2">#     (a_2 L^2 + a_2 b_1 L^6 + a_2 b_2 L^10) =</span>
    <span class="s2">#     1 + a_1 L + a_2 L^2 + b_1 L^4 + a_1 b_1 L^5 +</span>
    <span class="s2">#     a_2 b_1 L^6 + b_2 L^8 + a_1 b_2 L^9 + a_2 b_2 L^10</span>
    <span class="s1">assert_equal(p.reduced_ma_poly.coef</span><span class="s0">,</span>
                 <span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">5</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">9</span><span class="s0">, </span><span class="s1">(-</span><span class="s3">5 </span><span class="s1">* -</span><span class="s3">9</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">6 </span><span class="s1">* -</span><span class="s3">9</span><span class="s1">)</span><span class="s0">,</span>
                  <span class="s3">0</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s1">(-</span><span class="s3">5 </span><span class="s1">* </span><span class="s3">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">6 </span><span class="s1">* </span><span class="s3">10</span><span class="s1">)])</span>


<span class="s0">def </span><span class="s1">test_set_poly_short_lags():</span>
    <span class="s2"># Basic example (short lag orders)</span>
    <span class="s1">exog = pd.DataFrame([[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">columns=[</span><span class="s4">'a'</span><span class="s0">, </span><span class="s4">'b'</span><span class="s1">])</span>
    <span class="s1">spec = specification.SARIMAXSpecification(</span>
        <span class="s1">exog=exog</span><span class="s0">, </span><span class="s1">order=(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">seasonal_order=(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">4</span><span class="s1">))</span>
    <span class="s1">p = params.SARIMAXParams(spec=spec)</span>

    <span class="s2"># Valid polynomials</span>
    <span class="s1">p.ar_poly = [</span><span class="s3">1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.5</span><span class="s1">]</span>
    <span class="s1">assert_equal(p.ar_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.5</span><span class="s1">])</span>
    <span class="s1">p.ar_poly = np.polynomial.Polynomial([</span><span class="s3">1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.55</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ar_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.55</span><span class="s1">])</span>
    <span class="s1">p.ma_poly = [</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0.3</span><span class="s1">]</span>
    <span class="s1">assert_equal(p.ma_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.3</span><span class="s1">])</span>
    <span class="s1">p.ma_poly = np.polynomial.Polynomial([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0.35</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ma_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.35</span><span class="s1">])</span>

    <span class="s1">p.seasonal_ar_poly = [</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.2</span><span class="s1">]</span>
    <span class="s1">assert_equal(p.seasonal_ar_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.2</span><span class="s1">])</span>
    <span class="s1">p.seasonal_ar_poly = np.polynomial.Polynomial([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.25</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ar_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.25</span><span class="s1">])</span>
    <span class="s1">p.seasonal_ma_poly = [</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.1</span><span class="s1">]</span>
    <span class="s1">assert_equal(p.seasonal_ma_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.1</span><span class="s1">])</span>
    <span class="s1">p.seasonal_ma_poly = np.polynomial.Polynomial([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.15</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ma_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.15</span><span class="s1">])</span>

    <span class="s2"># Invalid polynomials</span>
    <span class="s2"># Must have 1 in the initial position</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__setattr__</span><span class="s0">, </span><span class="s4">'ar_poly'</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.5</span><span class="s1">])</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__setattr__</span><span class="s0">, </span><span class="s4">'ma_poly'</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">0.3</span><span class="s1">])</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__setattr__</span><span class="s0">, </span><span class="s4">'seasonal_ar_poly'</span><span class="s0">,</span>
                  <span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.2</span><span class="s1">])</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__setattr__</span><span class="s0">, </span><span class="s4">'seasonal_ma_poly'</span><span class="s0">,</span>
                  <span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.1</span><span class="s1">])</span>
    <span class="s2"># Too short</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__setattr__</span><span class="s0">, </span><span class="s4">'ar_poly'</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__setattr__</span><span class="s0">, </span><span class="s4">'ar_poly'</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s1">])</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__setattr__</span><span class="s0">, </span><span class="s4">'ma_poly'</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__setattr__</span><span class="s0">, </span><span class="s4">'ma_poly'</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s1">])</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__setattr__</span><span class="s0">, </span><span class="s4">'seasonal_ar_poly'</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__setattr__</span><span class="s0">, </span><span class="s4">'seasonal_ar_poly'</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s1">])</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__setattr__</span><span class="s0">, </span><span class="s4">'seasonal_ar_poly'</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">])</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__setattr__</span><span class="s0">, </span><span class="s4">'seasonal_ma_poly'</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__setattr__</span><span class="s0">, </span><span class="s4">'seasonal_ma_poly'</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s1">])</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__setattr__</span><span class="s0">, </span><span class="s4">'seasonal_ma_poly'</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">])</span>
    <span class="s2"># Too long</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__setattr__</span><span class="s0">, </span><span class="s4">'ar_poly'</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.2</span><span class="s1">])</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__setattr__</span><span class="s0">, </span><span class="s4">'ma_poly'</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0.3</span><span class="s0">, </span><span class="s3">0.2</span><span class="s1">])</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__setattr__</span><span class="s0">, </span><span class="s4">'seasonal_ar_poly'</span><span class="s0">,</span>
                  <span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0</span><span class="s1">])</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__setattr__</span><span class="s0">, </span><span class="s4">'seasonal_ma_poly'</span><span class="s0">,</span>
                  <span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0</span><span class="s1">])</span>
    <span class="s2"># Number in invalid location (only for seasonal polynomials)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__setattr__</span><span class="s0">, </span><span class="s4">'seasonal_ar_poly'</span><span class="s0">,</span>
                  <span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.2</span><span class="s1">])</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__setattr__</span><span class="s0">, </span><span class="s4">'seasonal_ma_poly'</span><span class="s0">,</span>
                  <span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.1</span><span class="s1">])</span>


<span class="s0">def </span><span class="s1">test_set_poly_short_lags_nonconsecutive():</span>
    <span class="s2"># Short but non-consecutive lag orders</span>
    <span class="s1">exog = pd.DataFrame([[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">columns=[</span><span class="s4">'a'</span><span class="s0">, </span><span class="s4">'b'</span><span class="s1">])</span>
    <span class="s1">spec = specification.SARIMAXSpecification(</span>
        <span class="s1">exog=exog</span><span class="s0">, </span><span class="s1">order=([</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">])</span><span class="s0">,</span>
        <span class="s1">seasonal_order=([</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s3">4</span><span class="s1">))</span>
    <span class="s1">p = params.SARIMAXParams(spec=spec)</span>

    <span class="s2"># Valid polynomials</span>
    <span class="s1">p.ar_poly = [</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.5</span><span class="s1">]</span>
    <span class="s1">assert_equal(p.ar_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.5</span><span class="s1">])</span>
    <span class="s1">p.ar_poly = np.polynomial.Polynomial([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.55</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ar_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.55</span><span class="s1">])</span>
    <span class="s1">p.ma_poly = [</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.3</span><span class="s1">]</span>
    <span class="s1">assert_equal(p.ma_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.3</span><span class="s1">])</span>
    <span class="s1">p.ma_poly = np.polynomial.Polynomial([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.35</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ma_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.35</span><span class="s1">])</span>

    <span class="s1">p.seasonal_ar_poly = [</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.2</span><span class="s1">]</span>
    <span class="s1">assert_equal(p.seasonal_ar_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.2</span><span class="s1">])</span>
    <span class="s1">p.seasonal_ar_poly = (</span>
        <span class="s1">np.polynomial.Polynomial([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.25</span><span class="s1">]))</span>
    <span class="s1">assert_equal(p.seasonal_ar_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.25</span><span class="s1">])</span>
    <span class="s1">p.seasonal_ma_poly = [</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.1</span><span class="s1">]</span>
    <span class="s1">assert_equal(p.seasonal_ma_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.1</span><span class="s1">])</span>
    <span class="s1">p.seasonal_ma_poly = (</span>
        <span class="s1">np.polynomial.Polynomial([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.15</span><span class="s1">]))</span>
    <span class="s1">assert_equal(p.seasonal_ma_params</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.15</span><span class="s1">])</span>

    <span class="s2"># Invalid polynomials</span>
    <span class="s2"># Number in invalid (i.e. an excluded lag) location</span>
    <span class="s2"># (now also for non-seasonal polynomials)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__setattr__</span><span class="s0">, </span><span class="s4">'ar_poly'</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.5</span><span class="s1">])</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__setattr__</span><span class="s0">, </span><span class="s4">'ma_poly'</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0.3</span><span class="s1">])</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__setattr__</span><span class="s0">, </span><span class="s4">'seasonal_ar_poly'</span><span class="s0">,</span>
                  <span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1.</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.2</span><span class="s1">])</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__setattr__</span><span class="s0">, </span><span class="s4">'seasonal_ma_poly'</span><span class="s0">,</span>
                  <span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1.</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.1</span><span class="s1">])</span>


<span class="s0">def </span><span class="s1">test_set_poly_longer_lags():</span>
    <span class="s2"># Test with higher order polynomials</span>
    <span class="s1">exog = pd.DataFrame([[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">columns=[</span><span class="s4">'a'</span><span class="s0">, </span><span class="s4">'b'</span><span class="s1">])</span>
    <span class="s1">spec = specification.SARIMAXSpecification(</span>
        <span class="s1">exog=exog</span><span class="s0">, </span><span class="s1">order=(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">seasonal_order=(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">4</span><span class="s1">))</span>
    <span class="s1">p = params.SARIMAXParams(spec=spec)</span>

    <span class="s2"># Setup the non-AR/MA values</span>
    <span class="s1">p.exog_params = [-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span>
    <span class="s1">p.sigma2 = -</span><span class="s3">11</span>

    <span class="s2"># Lag polynomials</span>
    <span class="s1">p.ar_poly = np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">-</span><span class="s3">4</span><span class="s1">]</span>
    <span class="s1">p.ma_poly = np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">5</span><span class="s0">, </span><span class="s3">6</span><span class="s1">]</span>
    <span class="s1">p.seasonal_ar_poly = np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">8</span><span class="s1">]</span>
    <span class="s1">p.seasonal_ma_poly = np.r_[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">9</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">10</span><span class="s1">]</span>

    <span class="s2"># Test that parameters were set correctly</span>
    <span class="s1">assert_equal(p.params</span><span class="s0">,</span>
                 <span class="s1">[-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s1">-</span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s1">-</span><span class="s3">5</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s1">-</span><span class="s3">7</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s1">-</span><span class="s3">9</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s1">-</span><span class="s3">11</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.exog_params</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ar_params</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.ma_params</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">5</span><span class="s0">, </span><span class="s3">6</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ar_params</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">7</span><span class="s0">, </span><span class="s3">8</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.seasonal_ma_params</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">9</span><span class="s0">, </span><span class="s3">10</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.sigma2</span><span class="s0">, </span><span class="s1">-</span><span class="s3">11</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_is_stationary():</span>
    <span class="s2"># Tests for the `is_stationary` property</span>
    <span class="s1">spec = specification.SARIMAXSpecification(</span>
        <span class="s1">order=(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">seasonal_order=(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">4</span><span class="s1">))</span>
    <span class="s1">p = params.SARIMAXParams(spec=spec)</span>

    <span class="s2"># Test stationarity</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__getattribute__</span><span class="s0">, </span><span class="s4">'is_stationary'</span><span class="s1">)</span>
    <span class="s1">p.ar_params = [</span><span class="s3">0.5</span><span class="s1">]</span>
    <span class="s1">p.seasonal_ar_params = [</span><span class="s3">0</span><span class="s1">]</span>
    <span class="s1">assert_(p.is_stationary)</span>
    <span class="s1">p.ar_params = [</span><span class="s3">1.0</span><span class="s1">]</span>
    <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">p.is_stationary)</span>

    <span class="s1">p.ar_params = [</span><span class="s3">0</span><span class="s1">]</span>
    <span class="s1">p.seasonal_ar_params = [</span><span class="s3">0.5</span><span class="s1">]</span>
    <span class="s1">assert_(p.is_stationary)</span>
    <span class="s1">p.seasonal_ar_params = [</span><span class="s3">1.0</span><span class="s1">]</span>
    <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">p.is_stationary)</span>

    <span class="s1">p.ar_params = [</span><span class="s3">0.2</span><span class="s1">]</span>
    <span class="s1">p.seasonal_ar_params = [</span><span class="s3">0.2</span><span class="s1">]</span>
    <span class="s1">assert_(p.is_stationary)</span>
    <span class="s1">p.ar_params = [</span><span class="s3">0.99</span><span class="s1">]</span>
    <span class="s1">p.seasonal_ar_params = [</span><span class="s3">0.99</span><span class="s1">]</span>
    <span class="s1">assert_(p.is_stationary)</span>
    <span class="s1">p.ar_params = [</span><span class="s3">1.</span><span class="s1">]</span>
    <span class="s1">p.seasonal_ar_params = [</span><span class="s3">1.</span><span class="s1">]</span>
    <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">p.is_stationary)</span>


<span class="s0">def </span><span class="s1">test_is_invertible():</span>
    <span class="s2"># Tests for the `is_invertible` property</span>
    <span class="s1">spec = specification.SARIMAXSpecification(</span>
        <span class="s1">order=(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">seasonal_order=(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">4</span><span class="s1">))</span>
    <span class="s1">p = params.SARIMAXParams(spec=spec)</span>

    <span class="s2"># Test invertibility</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">p.__getattribute__</span><span class="s0">, </span><span class="s4">'is_invertible'</span><span class="s1">)</span>
    <span class="s1">p.ma_params = [</span><span class="s3">0.5</span><span class="s1">]</span>
    <span class="s1">p.seasonal_ma_params = [</span><span class="s3">0</span><span class="s1">]</span>
    <span class="s1">assert_(p.is_invertible)</span>
    <span class="s1">p.ma_params = [</span><span class="s3">1.0</span><span class="s1">]</span>
    <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">p.is_invertible)</span>

    <span class="s1">p.ma_params = [</span><span class="s3">0</span><span class="s1">]</span>
    <span class="s1">p.seasonal_ma_params = [</span><span class="s3">0.5</span><span class="s1">]</span>
    <span class="s1">assert_(p.is_invertible)</span>
    <span class="s1">p.seasonal_ma_params = [</span><span class="s3">1.0</span><span class="s1">]</span>
    <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">p.is_invertible)</span>

    <span class="s1">p.ma_params = [</span><span class="s3">0.2</span><span class="s1">]</span>
    <span class="s1">p.seasonal_ma_params = [</span><span class="s3">0.2</span><span class="s1">]</span>
    <span class="s1">assert_(p.is_invertible)</span>
    <span class="s1">p.ma_params = [</span><span class="s3">0.99</span><span class="s1">]</span>
    <span class="s1">p.seasonal_ma_params = [</span><span class="s3">0.99</span><span class="s1">]</span>
    <span class="s1">assert_(p.is_invertible)</span>
    <span class="s1">p.ma_params = [</span><span class="s3">1.</span><span class="s1">]</span>
    <span class="s1">p.seasonal_ma_params = [</span><span class="s3">1.</span><span class="s1">]</span>
    <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">p.is_invertible)</span>


<span class="s0">def </span><span class="s1">test_is_valid():</span>
    <span class="s2"># Additional tests for the `is_valid` property (tests for NaN checks were</span>
    <span class="s2"># already done in `test_set_params_single`).</span>
    <span class="s1">spec = specification.SARIMAXSpecification(</span>
        <span class="s1">order=(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">seasonal_order=(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">4</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">enforce_stationarity=</span><span class="s0">True, </span><span class="s1">enforce_invertibility=</span><span class="s0">True</span><span class="s1">)</span>
    <span class="s1">p = params.SARIMAXParams(spec=spec)</span>

    <span class="s2"># Doesn't start out as valid</span>
    <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">p.is_valid)</span>
    <span class="s2"># Given stationary / invertible values, it is valid</span>
    <span class="s1">p.params = [</span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">1.</span><span class="s1">]</span>
    <span class="s1">assert_(p.is_valid)</span>
    <span class="s2"># With either non-stationary or non-invertible values, not valid</span>
    <span class="s1">p.params = [</span><span class="s3">1.</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">1.</span><span class="s1">]</span>
    <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">p.is_valid)</span>
    <span class="s1">p.params = [</span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">1.</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">1.</span><span class="s1">]</span>
    <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">p.is_valid)</span>
    <span class="s1">p.params = [</span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">1.</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">1.</span><span class="s1">]</span>
    <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">p.is_valid)</span>
    <span class="s1">p.params = [</span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">1.</span><span class="s0">, </span><span class="s3">1.</span><span class="s1">]</span>
    <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">p.is_valid)</span>


<span class="s0">def </span><span class="s1">test_repr_str():</span>
    <span class="s1">exog = pd.DataFrame([[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">columns=[</span><span class="s4">'a'</span><span class="s0">, </span><span class="s4">'b'</span><span class="s1">])</span>
    <span class="s1">spec = specification.SARIMAXSpecification(</span>
        <span class="s1">exog=exog</span><span class="s0">, </span><span class="s1">order=(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">seasonal_order=(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">4</span><span class="s1">))</span>
    <span class="s1">p = params.SARIMAXParams(spec=spec)</span>

    <span class="s2"># Check when we haven't given any parameters</span>
    <span class="s1">assert_equal(repr(p)</span><span class="s0">, </span><span class="s4">'SARIMAXParams(exog=[nan nan], ar=[nan], ma=[nan],'</span>
                          <span class="s4">' seasonal_ar=[nan], seasonal_ma=[nan], sigma2=nan)'</span><span class="s1">)</span>
    <span class="s2"># assert_equal(str(p), '[nan nan nan nan nan nan nan]')</span>

    <span class="s1">p.exog_params = [</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span>
    <span class="s1">assert_equal(repr(p)</span><span class="s0">, </span><span class="s4">'SARIMAXParams(exog=[1. 2.], ar=[nan], ma=[nan],'</span>
                          <span class="s4">' seasonal_ar=[nan], seasonal_ma=[nan], sigma2=nan)'</span><span class="s1">)</span>
    <span class="s2"># assert_equal(str(p), '[ 1.  2. nan nan nan nan nan]')</span>

    <span class="s1">p.ar_params = [</span><span class="s3">0.5</span><span class="s1">]</span>
    <span class="s1">assert_equal(repr(p)</span><span class="s0">, </span><span class="s4">'SARIMAXParams(exog=[1. 2.], ar=[0.5], ma=[nan],'</span>
                          <span class="s4">' seasonal_ar=[nan], seasonal_ma=[nan], sigma2=nan)'</span><span class="s1">)</span>
    <span class="s2"># assert_equal(str(p), '[1.  2.  0.5 nan nan nan nan]')</span>

    <span class="s1">p.ma_params = [</span><span class="s3">0.2</span><span class="s1">]</span>
    <span class="s1">assert_equal(repr(p)</span><span class="s0">, </span><span class="s4">'SARIMAXParams(exog=[1. 2.], ar=[0.5], ma=[0.2],'</span>
                          <span class="s4">' seasonal_ar=[nan], seasonal_ma=[nan], sigma2=nan)'</span><span class="s1">)</span>
    <span class="s2"># assert_equal(str(p), '[1.  2.  0.5 0.2 nan nan nan]')</span>

    <span class="s1">p.seasonal_ar_params = [</span><span class="s3">0.001</span><span class="s1">]</span>
    <span class="s1">assert_equal(repr(p)</span><span class="s0">, </span><span class="s4">'SARIMAXParams(exog=[1. 2.], ar=[0.5], ma=[0.2],'</span>
                          <span class="s4">' seasonal_ar=[0.001], seasonal_ma=[nan],'</span>
                          <span class="s4">' sigma2=nan)'</span><span class="s1">)</span>
    <span class="s2"># assert_equal(str(p),</span>
    <span class="s2">#              '[1.e+00 2.e+00 5.e-01 2.e-01 1.e-03    nan    nan]')</span>

    <span class="s1">p.seasonal_ma_params = [-</span><span class="s3">0.001</span><span class="s1">]</span>
    <span class="s1">assert_equal(repr(p)</span><span class="s0">, </span><span class="s4">'SARIMAXParams(exog=[1. 2.], ar=[0.5], ma=[0.2],'</span>
                          <span class="s4">' seasonal_ar=[0.001], seasonal_ma=[-0.001],'</span>
                          <span class="s4">' sigma2=nan)'</span><span class="s1">)</span>
    <span class="s2"># assert_equal(str(p), '[ 1.e+00  2.e+00  5.e-01  2.e-01  1.e-03'</span>
    <span class="s2">#                      ' -1.e-03     nan]')</span>

    <span class="s1">p.sigma2 = </span><span class="s3">10.123</span>
    <span class="s1">assert_equal(repr(p)</span><span class="s0">, </span><span class="s4">'SARIMAXParams(exog=[1. 2.], ar=[0.5], ma=[0.2],'</span>
                          <span class="s4">' seasonal_ar=[0.001], seasonal_ma=[-0.001],'</span>
                          <span class="s4">' sigma2=10.123)'</span><span class="s1">)</span>
    <span class="s2"># assert_equal(str(p), '[ 1.0000e+00  2.0000e+00  5.0000e-01  2.0000e-01'</span>
    <span class="s2">#                      '  1.0000e-03 -1.0000e-03\n  1.0123e+01]')</span>
</pre>
</body>
</html>