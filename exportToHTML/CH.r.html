<html>
<head>
<title>CH.r</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #808080;}
.s1 { color: #a9b7c6;}
.s2 { color: #6a8759;}
.s3 { color: #6a8759; font-style: italic;}
.s4 { color: #a9b7c6;}
.s5 { color: #cc7832;}
.s6 { color: #6897bb; font-style: italic;}
.s7 { color: #9876aa; font-style: italic;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
CH.r</font>
</center></td></tr></table>
<pre><span class="s0"># Copyright (c) 2011, Roger Lew BSD [see LICENSE.txt]</span>
<span class="s0"># This software is funded in part by NIH Grant P20 RR016454.</span>


<span class="s0"># This is a collection of scripts used to generate C-H comparisons</span>
<span class="s0"># for qsturng. As you can probably guess, my R's skills are not all that good.</span>

<span class="s1">setwd(</span><span class="s2">'D:</span><span class="s3">\\</span><span class="s2">USERS</span><span class="s3">\\</span><span class="s2">roger</span><span class="s3">\\</span><span class="s2">programming</span><span class="s3">\\</span><span class="s2">python</span><span class="s3">\\</span><span class="s2">development</span><span class="s3">\\</span><span class="s2">qsturng'</span><span class="s1">) 
</span>
<span class="s4">ps </span><span class="s5">= </span><span class="s1">seq(</span><span class="s4">length</span><span class="s5">=</span><span class="s6">100</span><span class="s1">, </span><span class="s4">from</span><span class="s5">=</span><span class="s6">.5</span><span class="s1">, </span><span class="s4">to</span><span class="s5">=</span><span class="s6">.999</span><span class="s1">) 
</span>
<span class="s5">for </span><span class="s1">(</span><span class="s4">r </span><span class="s5">in </span><span class="s1">c(</span><span class="s6">2</span><span class="s1">,</span><span class="s6">3</span><span class="s1">,</span><span class="s6">4</span><span class="s1">,</span><span class="s6">5</span><span class="s1">,</span><span class="s6">6</span><span class="s1">,</span><span class="s6">7</span><span class="s1">,</span><span class="s6">8</span><span class="s1">,</span><span class="s6">9</span><span class="s1">,</span><span class="s6">10</span><span class="s1">,</span><span class="s6">11</span><span class="s1">,</span><span class="s6">12</span><span class="s1">,</span><span class="s6">13</span><span class="s1">,</span><span class="s6">14</span><span class="s1">,</span><span class="s6">15</span><span class="s1">,</span><span class="s6">16</span><span class="s1">,</span><span class="s6">17</span><span class="s1">,</span><span class="s6">18</span><span class="s1">,</span><span class="s6">19</span><span class="s1">,</span><span class="s6">20</span><span class="s1">,</span><span class="s6">21</span><span class="s1">, 
            </span><span class="s6">22</span><span class="s1">,</span><span class="s6">23</span><span class="s1">,</span><span class="s6">24</span><span class="s1">,</span><span class="s6">25</span><span class="s1">,</span><span class="s6">26</span><span class="s1">,</span><span class="s6">27</span><span class="s1">,</span><span class="s6">28</span><span class="s1">,</span><span class="s6">29</span><span class="s1">,</span><span class="s6">30</span><span class="s1">,</span><span class="s6">35</span><span class="s1">,</span><span class="s6">40</span><span class="s1">,</span><span class="s6">50</span><span class="s1">,</span><span class="s6">60</span><span class="s1">,</span><span class="s6">70</span><span class="s1">,</span><span class="s6">80</span><span class="s1">,</span><span class="s6">90</span><span class="s1">,</span><span class="s6">100</span><span class="s1">,</span><span class="s6">200</span><span class="s1">)) {</span>
    <span class="s5">for </span><span class="s1">(</span><span class="s4">v </span><span class="s5">in </span><span class="s1">c(</span><span class="s6">2</span><span class="s1">,</span><span class="s6">3</span><span class="s1">,</span><span class="s6">4</span><span class="s1">,</span><span class="s6">5</span><span class="s1">,</span><span class="s6">6</span><span class="s1">,</span><span class="s6">7</span><span class="s1">,</span><span class="s6">8</span><span class="s1">,</span><span class="s6">9</span><span class="s1">,</span><span class="s6">10</span><span class="s1">,</span><span class="s6">11</span><span class="s1">,</span><span class="s6">12</span><span class="s1">,</span><span class="s6">13</span><span class="s1">,</span><span class="s6">14</span><span class="s1">,</span><span class="s6">15</span><span class="s1">,</span><span class="s6">16</span><span class="s1">,</span><span class="s6">17</span><span class="s1">,</span><span class="s6">18</span><span class="s1">,</span><span class="s6">19</span><span class="s1">,</span><span class="s6">20</span><span class="s1">, 
                </span><span class="s6">22</span><span class="s1">,</span><span class="s6">24</span><span class="s1">,</span><span class="s6">26</span><span class="s1">,</span><span class="s6">30</span><span class="s1">,</span><span class="s6">35</span><span class="s1">,</span><span class="s6">40</span><span class="s1">,</span><span class="s6">50</span><span class="s1">,</span><span class="s6">60</span><span class="s1">,</span><span class="s6">90</span><span class="s1">,</span><span class="s6">120</span><span class="s1">,</span><span class="s6">240</span><span class="s1">,</span><span class="s6">480</span><span class="s1">,</span><span class="s6">1e38</span><span class="s1">)) {</span>
        <span class="s4">m </span><span class="s5">= </span><span class="s1">qtukey(</span><span class="s4">ps</span><span class="s1">, </span><span class="s4">r</span><span class="s1">, </span><span class="s4">v</span><span class="s1">) 
        </span><span class="s4">fname </span><span class="s5">= </span><span class="s1">sprintf(</span><span class="s2">'CH_r=%i,v=%.0f.dat'</span><span class="s1">,</span><span class="s4">r</span><span class="s1">,</span><span class="s4">v</span><span class="s1">) 
        print(</span><span class="s4">fname</span><span class="s1">) 
        write(rbind(</span><span class="s4">ps</span><span class="s1">, </span><span class="s4">m</span><span class="s1">), 
              </span><span class="s4">file</span><span class="s5">=</span><span class="s4">fname</span><span class="s1">, 
              </span><span class="s4">ncolumns</span><span class="s5">=</span><span class="s6">2</span><span class="s1">, 
              </span><span class="s4">append</span><span class="s5">=</span><span class="s7">FALSE</span><span class="s1">, 
              </span><span class="s4">sep</span><span class="s5">=</span><span class="s2">','</span><span class="s1">) 
    }</span>
<span class="s1">}</span>

<span class="s4">rs </span><span class="s5">= </span><span class="s1">c(</span><span class="s6">2</span><span class="s1">,</span><span class="s6">3</span><span class="s1">,</span><span class="s6">4</span><span class="s1">,</span><span class="s6">5</span><span class="s1">,</span><span class="s6">6</span><span class="s1">,</span><span class="s6">7</span><span class="s1">,</span><span class="s6">8</span><span class="s1">,</span><span class="s6">9</span><span class="s1">,</span><span class="s6">10</span><span class="s1">,</span><span class="s6">11</span><span class="s1">,</span><span class="s6">12</span><span class="s1">,</span><span class="s6">13</span><span class="s1">,</span><span class="s6">14</span><span class="s1">,</span><span class="s6">15</span><span class="s1">,</span><span class="s6">16</span><span class="s1">,</span><span class="s6">17</span><span class="s1">,</span><span class="s6">18</span><span class="s1">,</span><span class="s6">19</span><span class="s1">,</span><span class="s6">20</span><span class="s1">,</span><span class="s6">30</span><span class="s1">,</span><span class="s6">40</span><span class="s1">,</span><span class="s6">60</span><span class="s1">,</span><span class="s6">80</span><span class="s1">,</span><span class="s6">100</span><span class="s1">) 
</span>
<span class="s5">for </span><span class="s1">(</span><span class="s4">v </span><span class="s5">in </span><span class="s1">c(</span><span class="s6">2</span><span class="s1">,</span><span class="s6">3</span><span class="s1">,</span><span class="s6">4</span><span class="s1">,</span><span class="s6">5</span><span class="s1">,</span><span class="s6">6</span><span class="s1">,</span><span class="s6">7</span><span class="s1">,</span><span class="s6">8</span><span class="s1">,</span><span class="s6">9</span><span class="s1">,</span><span class="s6">10</span><span class="s1">,</span><span class="s6">11</span><span class="s1">,</span><span class="s6">12</span><span class="s1">,</span><span class="s6">13</span><span class="s1">,</span><span class="s6">14</span><span class="s1">,</span><span class="s6">15</span><span class="s1">,</span><span class="s6">16</span><span class="s1">, 
           </span><span class="s6">17</span><span class="s1">,</span><span class="s6">18</span><span class="s1">,</span><span class="s6">19</span><span class="s1">,</span><span class="s6">20</span><span class="s1">,</span><span class="s6">24</span><span class="s1">,</span><span class="s6">30</span><span class="s1">,</span><span class="s6">40</span><span class="s1">,</span><span class="s6">60</span><span class="s1">,</span><span class="s6">120</span><span class="s1">,</span><span class="s6">1e38</span><span class="s1">)) {</span>
    <span class="s4">m </span><span class="s5">= </span><span class="s1">qtukey(</span><span class="s6">0.30</span><span class="s1">, </span><span class="s4">rs</span><span class="s1">, </span><span class="s4">v</span><span class="s1">) 
    </span><span class="s4">fname </span><span class="s5">= </span><span class="s1">sprintf(</span><span class="s2">'CH_p30.dat'</span><span class="s1">) 
    print(</span><span class="s4">fname</span><span class="s1">) 
    write(rbind(</span><span class="s4">m</span><span class="s1">), 
          </span><span class="s4">file</span><span class="s5">=</span><span class="s4">fname</span><span class="s1">, 
          </span><span class="s4">ncolumns</span><span class="s5">=</span><span class="s6">26</span><span class="s1">, 
          </span><span class="s4">append</span><span class="s5">=</span><span class="s7">TRUE</span><span class="s1">, 
          </span><span class="s4">sep</span><span class="s5">=</span><span class="s2">' '</span><span class="s1">) 
}</span>

<span class="s4">for i </span><span class="s5">in</span>
<span class="s5">for </span><span class="s1">(</span><span class="s4">v </span><span class="s5">in </span><span class="s1">c(</span><span class="s6">2</span><span class="s1">,</span><span class="s6">3</span><span class="s1">,</span><span class="s6">4</span><span class="s1">,</span><span class="s6">5</span><span class="s1">,</span><span class="s6">6</span><span class="s1">,</span><span class="s6">7</span><span class="s1">,</span><span class="s6">8</span><span class="s1">,</span><span class="s6">9</span><span class="s1">,</span><span class="s6">10</span><span class="s1">,</span><span class="s6">11</span><span class="s1">,</span><span class="s6">12</span><span class="s1">,</span><span class="s6">13</span><span class="s1">,</span><span class="s6">14</span><span class="s1">,</span><span class="s6">15</span><span class="s1">,</span><span class="s6">16</span><span class="s1">, 
           </span><span class="s6">17</span><span class="s1">,</span><span class="s6">18</span><span class="s1">,</span><span class="s6">19</span><span class="s1">,</span><span class="s6">20</span><span class="s1">,</span><span class="s6">24</span><span class="s1">,</span><span class="s6">30</span><span class="s1">,</span><span class="s6">40</span><span class="s1">,</span><span class="s6">60</span><span class="s1">,</span><span class="s6">120</span><span class="s1">,</span><span class="s6">1e38</span><span class="s1">)) {</span>
    <span class="s4">m </span><span class="s5">= </span><span class="s1">qtukey(</span><span class="s6">0.675</span><span class="s1">, </span><span class="s4">rs</span><span class="s1">, </span><span class="s4">v</span><span class="s1">) 
    </span><span class="s4">fname </span><span class="s5">= </span><span class="s1">sprintf(</span><span class="s2">'CH_p675.dat'</span><span class="s1">,</span><span class="s4">r</span><span class="s1">,</span><span class="s4">v</span><span class="s1">) 
    print(</span><span class="s4">fname</span><span class="s1">) 
    write(rbind(</span><span class="s4">m</span><span class="s1">), 
          </span><span class="s4">file</span><span class="s5">=</span><span class="s4">fname</span><span class="s1">, 
          </span><span class="s4">ncolumns</span><span class="s5">=</span><span class="s6">26</span><span class="s1">, 
          </span><span class="s4">append</span><span class="s5">=</span><span class="s7">TRUE</span><span class="s1">, 
          </span><span class="s4">sep</span><span class="s5">=</span><span class="s2">' '</span><span class="s1">) 
}</span>

<span class="s5">for </span><span class="s1">(</span><span class="s4">v </span><span class="s5">in </span><span class="s1">c(</span><span class="s6">2</span><span class="s1">,</span><span class="s6">3</span><span class="s1">,</span><span class="s6">4</span><span class="s1">,</span><span class="s6">5</span><span class="s1">,</span><span class="s6">6</span><span class="s1">,</span><span class="s6">7</span><span class="s1">,</span><span class="s6">8</span><span class="s1">,</span><span class="s6">9</span><span class="s1">,</span><span class="s6">10</span><span class="s1">,</span><span class="s6">11</span><span class="s1">,</span><span class="s6">12</span><span class="s1">,</span><span class="s6">13</span><span class="s1">,</span><span class="s6">14</span><span class="s1">,</span><span class="s6">15</span><span class="s1">,</span><span class="s6">16</span><span class="s1">, 
           </span><span class="s6">17</span><span class="s1">,</span><span class="s6">18</span><span class="s1">,</span><span class="s6">19</span><span class="s1">,</span><span class="s6">20</span><span class="s1">,</span><span class="s6">24</span><span class="s1">,</span><span class="s6">30</span><span class="s1">,</span><span class="s6">40</span><span class="s1">,</span><span class="s6">60</span><span class="s1">,</span><span class="s6">120</span><span class="s1">,</span><span class="s6">1e38</span><span class="s1">)) {</span>
    <span class="s4">m </span><span class="s5">= </span><span class="s1">qtukey(</span><span class="s6">0.75</span><span class="s1">, </span><span class="s4">rs</span><span class="s1">, </span><span class="s4">v</span><span class="s1">) 
    </span><span class="s4">fname </span><span class="s5">= </span><span class="s1">sprintf(</span><span class="s2">'CH_p75.dat'</span><span class="s1">,</span><span class="s4">r</span><span class="s1">,</span><span class="s4">v</span><span class="s1">) 
    print(</span><span class="s4">fname</span><span class="s1">) 
    write(rbind(</span><span class="s4">m</span><span class="s1">), 
          </span><span class="s4">file</span><span class="s5">=</span><span class="s4">fname</span><span class="s1">, 
          </span><span class="s4">ncolumns</span><span class="s5">=</span><span class="s6">26</span><span class="s1">, 
          </span><span class="s4">append</span><span class="s5">=</span><span class="s7">TRUE</span><span class="s1">, 
          </span><span class="s4">sep</span><span class="s5">=</span><span class="s2">' '</span><span class="s1">) 
}</span>

<span class="s5">for </span><span class="s1">(</span><span class="s4">v </span><span class="s5">in </span><span class="s1">c(</span><span class="s6">2</span><span class="s1">,</span><span class="s6">3</span><span class="s1">,</span><span class="s6">4</span><span class="s1">,</span><span class="s6">5</span><span class="s1">,</span><span class="s6">6</span><span class="s1">,</span><span class="s6">7</span><span class="s1">,</span><span class="s6">8</span><span class="s1">,</span><span class="s6">9</span><span class="s1">,</span><span class="s6">10</span><span class="s1">,</span><span class="s6">11</span><span class="s1">,</span><span class="s6">12</span><span class="s1">,</span><span class="s6">13</span><span class="s1">,</span><span class="s6">14</span><span class="s1">,</span><span class="s6">15</span><span class="s1">,</span><span class="s6">16</span><span class="s1">, 
           </span><span class="s6">17</span><span class="s1">,</span><span class="s6">18</span><span class="s1">,</span><span class="s6">19</span><span class="s1">,</span><span class="s6">20</span><span class="s1">,</span><span class="s6">24</span><span class="s1">,</span><span class="s6">30</span><span class="s1">,</span><span class="s6">40</span><span class="s1">,</span><span class="s6">60</span><span class="s1">,</span><span class="s6">120</span><span class="s1">,</span><span class="s6">1e38</span><span class="s1">)) {</span>
    <span class="s4">m </span><span class="s5">= </span><span class="s1">qtukey(</span><span class="s6">0.975</span><span class="s1">, </span><span class="s4">rs</span><span class="s1">, </span><span class="s4">v</span><span class="s1">) 
    </span><span class="s4">fname </span><span class="s5">= </span><span class="s1">sprintf(</span><span class="s2">'CH_p975.dat'</span><span class="s1">) 
    print(</span><span class="s4">fname</span><span class="s1">) 
    write(rbind(</span><span class="s4">m</span><span class="s1">), 
          </span><span class="s4">file</span><span class="s5">=</span><span class="s4">fname</span><span class="s1">, 
          </span><span class="s4">ncolumns</span><span class="s5">=</span><span class="s6">26</span><span class="s1">, 
          </span><span class="s4">append</span><span class="s5">=</span><span class="s7">TRUE</span><span class="s1">, 
          </span><span class="s4">sep</span><span class="s5">=</span><span class="s2">' '</span><span class="s1">) 
}</span>

<span class="s4">i </span><span class="s5">= </span><span class="s6">0</span><span class="s1">; 
</span><span class="s5">for </span><span class="s1">(</span><span class="s4">i </span><span class="s5">in </span><span class="s6">0</span><span class="s5">:</span><span class="s6">9999</span><span class="s1">) {</span>
    <span class="s4">p </span><span class="s5">= </span><span class="s1">runif(</span><span class="s6">1</span><span class="s1">, </span><span class="s6">.5</span><span class="s1">, </span><span class="s6">.95</span><span class="s1">); 
    </span><span class="s4">r </span><span class="s5">= </span><span class="s1">sample(</span><span class="s6">2</span><span class="s5">:</span><span class="s6">100</span><span class="s1">, </span><span class="s6">1</span><span class="s1">); 
    </span><span class="s4">v </span><span class="s5">= </span><span class="s1">runif(</span><span class="s6">1</span><span class="s1">, </span><span class="s6">2</span><span class="s1">, </span><span class="s6">1000</span><span class="s1">); 
    </span><span class="s4">q </span><span class="s5">= </span><span class="s1">qtukey(</span><span class="s4">p</span><span class="s1">,</span><span class="s4">r</span><span class="s1">,</span><span class="s4">v</span><span class="s1">); 
    </span><span class="s5">if </span><span class="s1">(</span><span class="s5">!</span><span class="s1">is.nan(</span><span class="s4">q</span><span class="s1">)) {</span>
        <span class="s1">write(c(</span><span class="s4">p</span><span class="s1">,</span><span class="s4">r</span><span class="s1">,</span><span class="s4">v</span><span class="s1">,</span><span class="s4">q</span><span class="s1">), 
              </span><span class="s4">file</span><span class="s5">=</span><span class="s2">'bootleg.dat'</span><span class="s1">, 
              </span><span class="s4">ncolumns</span><span class="s5">=</span><span class="s6">4</span><span class="s1">, 
              </span><span class="s4">append</span><span class="s5">=</span><span class="s7">TRUE</span><span class="s1">, 
              </span><span class="s4">sep</span><span class="s5">=</span><span class="s2">','</span><span class="s1">); 
        </span><span class="s4">i </span><span class="s5">= </span><span class="s4">i </span><span class="s5">+ </span><span class="s6">1</span><span class="s1">; 
    }</span>
<span class="s1">}</span></pre>
</body>
</html>