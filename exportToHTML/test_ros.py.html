<html>
<head>
<title>test_ros.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6a8759;}
.s3 { color: #6897bb;}
.s4 { color: #808080;}
.s5 { color: #629755; font-style: italic;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_ros.py</font>
</center></td></tr></table>
<pre><span class="s0">from </span><span class="s1">statsmodels.compat.pandas </span><span class="s0">import </span><span class="s1">assert_series_equal</span><span class="s0">, </span><span class="s1">assert_frame_equal</span>

<span class="s0">from </span><span class="s1">io </span><span class="s0">import </span><span class="s1">StringIO</span>
<span class="s0">from </span><span class="s1">textwrap </span><span class="s0">import </span><span class="s1">dedent</span>

<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">import </span><span class="s1">numpy.testing </span><span class="s0">as </span><span class="s1">npt</span>

<span class="s0">import </span><span class="s1">numpy</span>
<span class="s0">from </span><span class="s1">numpy.testing </span><span class="s0">import </span><span class="s1">assert_equal</span>
<span class="s0">import </span><span class="s1">pandas</span>
<span class="s0">import </span><span class="s1">pytest</span>

<span class="s0">from </span><span class="s1">statsmodels.imputation </span><span class="s0">import </span><span class="s1">ros</span>


<span class="s0">def </span><span class="s1">load_basic_data():</span>
    <span class="s1">raw_csv = StringIO(</span>
        <span class="s2">&quot;res,qual</span><span class="s0">\n</span><span class="s2">2.00,=</span><span class="s0">\n</span><span class="s2">4.20,=</span><span class="s0">\n</span><span class="s2">4.62,=</span><span class="s0">\n</span><span class="s2">5.00,ND</span><span class="s0">\n</span><span class="s2">5.00,ND</span><span class="s0">\n</span><span class="s2">5.50,ND</span><span class="s0">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;5.57,=</span><span class="s0">\n</span><span class="s2">5.66,=</span><span class="s0">\n</span><span class="s2">5.75,ND</span><span class="s0">\n</span><span class="s2">5.86,=</span><span class="s0">\n</span><span class="s2">6.65,=</span><span class="s0">\n</span><span class="s2">6.78,=</span><span class="s0">\n</span><span class="s2">6.79,=</span><span class="s0">\n</span><span class="s2">7.50,=</span><span class="s0">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;7.50,=</span><span class="s0">\n</span><span class="s2">7.50,=</span><span class="s0">\n</span><span class="s2">8.63,=</span><span class="s0">\n</span><span class="s2">8.71,=</span><span class="s0">\n</span><span class="s2">8.99,=</span><span class="s0">\n</span><span class="s2">9.50,ND</span><span class="s0">\n</span><span class="s2">9.50,ND</span><span class="s0">\n</span><span class="s2">9.85,=</span><span class="s0">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;10.82,=</span><span class="s0">\n</span><span class="s2">11.00,ND</span><span class="s0">\n</span><span class="s2">11.25,=</span><span class="s0">\n</span><span class="s2">11.25,=</span><span class="s0">\n</span><span class="s2">12.20,=</span><span class="s0">\n</span><span class="s2">14.92,=</span><span class="s0">\n</span><span class="s2">16.77,=</span><span class="s0">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;17.81,=</span><span class="s0">\n</span><span class="s2">19.16,=</span><span class="s0">\n</span><span class="s2">19.19,=</span><span class="s0">\n</span><span class="s2">19.64,=</span><span class="s0">\n</span><span class="s2">20.18,=</span><span class="s0">\n</span><span class="s2">22.97,=</span><span class="s0">\n</span><span class="s2">&quot;</span>
    <span class="s1">)</span>
    <span class="s1">df = pandas.read_csv(raw_csv)</span>
    <span class="s1">df.loc[:</span><span class="s0">, </span><span class="s2">'conc'</span><span class="s1">] = df[</span><span class="s2">'res'</span><span class="s1">]</span>
    <span class="s1">df.loc[:</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">] = df[</span><span class="s2">'qual'</span><span class="s1">] == </span><span class="s2">'ND'</span>

    <span class="s0">return </span><span class="s1">df</span>


<span class="s0">def </span><span class="s1">load_intermediate_data():</span>
    <span class="s1">df = pandas.DataFrame([</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">True, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">5.0</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">1</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">1</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">True, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">5.0</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">1</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">2</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">True, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">5.5</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">2</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">1</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">True, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">5.75</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">3</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">1</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">True, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">9.5</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">4</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">1</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">True, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">9.5</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">4</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">2</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">True, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">11.0</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">1</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">2.0</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">0</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">1</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">4.2</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">0</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">2</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">4.62</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">0</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">3</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">5.57</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">2</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">1</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">5.66</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">2</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">2</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">5.86</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">3</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">1</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">6.65</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">3</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">2</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">6.78</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">3</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">3</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">6.79</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">3</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">4</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">7.5</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">3</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">5</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">7.5</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">3</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">6</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">7.5</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">3</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">7</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">8.63</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">3</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">8</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">8.71</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">3</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">9</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">8.99</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">3</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">10</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">9.85</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">4</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">1</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">10.82</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">4</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">2</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">11.25</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">1</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">11.25</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">2</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">12.2</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">3</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">14.92</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">4</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">16.77</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">5</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">17.81</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">6</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">19.16</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">7</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">19.19</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">8</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">19.64</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">9</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">20.18</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">10</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">22.97</span><span class="s0">, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">11</span><span class="s1">}</span>
    <span class="s1">])</span>

    <span class="s0">return </span><span class="s1">df</span>


<span class="s0">def </span><span class="s1">load_advanced_data():</span>
    <span class="s1">df = pandas.DataFrame([</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: -</span><span class="s3">1.4456202174142005</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">True, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">5.0</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">1</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.07414187643020594</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">1</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: -</span><span class="s3">1.2201035333697587</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">True, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">5.0</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">1</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.11121281464530891</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">2</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: -</span><span class="s3">1.043822530159519</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">True, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">5.5</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">2</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.14828375286041187</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">1</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: -</span><span class="s3">1.0438225301595188</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">True, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">5.75</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">3</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.1482837528604119</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">1</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: -</span><span class="s3">0.8109553641377003</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">True, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">9.5</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">4</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.20869565217391303</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">1</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: -</span><span class="s3">0.4046779045300476</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">True, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">9.5</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">4</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.34285714285714286</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">2</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: -</span><span class="s3">0.20857169501420522</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">True, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">11.0</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.41739130434782606</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">1</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: -</span><span class="s3">1.5927654676048002</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">2.0</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">0</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.055606407322654455</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">1</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: -</span><span class="s3">1.2201035333697587</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">4.2</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">0</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.11121281464530891</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">2</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: -</span><span class="s3">0.9668111610681008</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">4.62</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">0</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.16681922196796337</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">3</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: -</span><span class="s3">0.6835186393930371</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">5.57</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">2</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.24713958810068648</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">1</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: -</span><span class="s3">0.6072167256926887</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">5.66</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">2</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.27185354691075514</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">2</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: -</span><span class="s3">0.44953240276543616</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">5.86</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">3</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.3265238194299979</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">1</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: -</span><span class="s3">0.36788328223414807</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">6.65</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">3</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.35648013313917204</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">2</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: -</span><span class="s3">0.28861907892223937</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">6.78</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">3</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.38643644684834616</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">3</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: -</span><span class="s3">0.21113039741112186</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">6.79</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">3</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.4163927605575203</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">4</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: -</span><span class="s3">0.1348908823006299</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">7.5</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">3</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.4463490742666944</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">5</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: -</span><span class="s3">0.05942854708257491</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">7.5</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">3</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.4763053879758685</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">6</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: </span><span class="s3">0.015696403006170083</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">7.5</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">3</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.5062617016850427</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">7</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: </span><span class="s3">0.09091016994359362</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">8.63</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">3</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.5362180153942168</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">8</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: </span><span class="s3">0.16664251178856201</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">8.71</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">3</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.5661743291033909</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">9</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: </span><span class="s3">0.24334426739770573</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">8.99</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">3</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.596130642812565</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">10</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: </span><span class="s3">0.3744432988606558</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">9.85</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">4</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.6459627329192545</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">1</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: </span><span class="s3">0.4284507519609981</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">10.82</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">4</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.6658385093167701</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">2</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: </span><span class="s3">0.5589578655042562</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">11.25</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.7119047619047619</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">1</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: </span><span class="s3">0.6374841609623771</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">11.25</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.7380952380952381</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">2</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: </span><span class="s3">0.7201566171385521</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">12.2</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.7642857142857142</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">3</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: </span><span class="s3">0.8080746339118065</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">14.92</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.7904761904761904</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">4</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: </span><span class="s3">0.9027347916438648</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">16.77</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.8166666666666667</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">5</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: </span><span class="s3">1.0062699858608395</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">17.81</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.8428571428571429</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">6</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: </span><span class="s3">1.1219004674623523</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">19.16</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.8690476190476191</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">7</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: </span><span class="s3">1.2548759122271174</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">19.19</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.8952380952380953</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">8</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: </span><span class="s3">1.414746425534976</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">19.64</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.9214285714285714</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">9</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: </span><span class="s3">1.622193585315426</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">20.18</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.9476190476190476</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">10</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'Zprelim'</span><span class="s1">: </span><span class="s3">1.9399896117517081</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">22.97</span><span class="s0">,</span>
        <span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'plot_pos'</span><span class="s1">: </span><span class="s3">0.9738095238095239</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">11</span><span class="s1">}</span>
    <span class="s1">])</span>

    <span class="s0">return </span><span class="s1">df</span>


<span class="s0">def </span><span class="s1">load_basic_cohn():</span>
    <span class="s1">cohn = pandas.DataFrame([</span>
        <span class="s1">{</span><span class="s2">'lower_dl'</span><span class="s1">: </span><span class="s3">2.0</span><span class="s0">, </span><span class="s2">'ncen_equal'</span><span class="s1">: </span><span class="s3">0.0</span><span class="s0">, </span><span class="s2">'nobs_below'</span><span class="s1">: </span><span class="s3">0.0</span><span class="s0">,</span>
         <span class="s2">'nuncen_above'</span><span class="s1">: </span><span class="s3">3.0</span><span class="s0">, </span><span class="s2">'prob_exceedance'</span><span class="s1">: </span><span class="s3">1.0</span><span class="s0">, </span><span class="s2">'upper_dl'</span><span class="s1">: </span><span class="s3">5.0</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'lower_dl'</span><span class="s1">: </span><span class="s3">5.0</span><span class="s0">, </span><span class="s2">'ncen_equal'</span><span class="s1">: </span><span class="s3">2.0</span><span class="s0">, </span><span class="s2">'nobs_below'</span><span class="s1">: </span><span class="s3">5.0</span><span class="s0">,</span>
         <span class="s2">'nuncen_above'</span><span class="s1">: </span><span class="s3">0.0</span><span class="s0">, </span><span class="s2">'prob_exceedance'</span><span class="s1">: </span><span class="s3">0.77757437070938218</span><span class="s0">, </span><span class="s2">'upper_dl'</span><span class="s1">: </span><span class="s3">5.5</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'lower_dl'</span><span class="s1">: </span><span class="s3">5.5</span><span class="s0">, </span><span class="s2">'ncen_equal'</span><span class="s1">: </span><span class="s3">1.0</span><span class="s0">, </span><span class="s2">'nobs_below'</span><span class="s1">: </span><span class="s3">6.0</span><span class="s0">,</span>
         <span class="s2">'nuncen_above'</span><span class="s1">: </span><span class="s3">2.0</span><span class="s0">, </span><span class="s2">'prob_exceedance'</span><span class="s1">: </span><span class="s3">0.77757437070938218</span><span class="s0">, </span><span class="s2">'upper_dl'</span><span class="s1">: </span><span class="s3">5.75</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'lower_dl'</span><span class="s1">: </span><span class="s3">5.75</span><span class="s0">, </span><span class="s2">'ncen_equal'</span><span class="s1">: </span><span class="s3">1.0</span><span class="s0">, </span><span class="s2">'nobs_below'</span><span class="s1">: </span><span class="s3">9.0</span><span class="s0">,</span>
         <span class="s2">'nuncen_above'</span><span class="s1">: </span><span class="s3">10.0</span><span class="s0">, </span><span class="s2">'prob_exceedance'</span><span class="s1">: </span><span class="s3">0.7034324942791762</span><span class="s0">, </span><span class="s2">'upper_dl'</span><span class="s1">: </span><span class="s3">9.5</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'lower_dl'</span><span class="s1">: </span><span class="s3">9.5</span><span class="s0">, </span><span class="s2">'ncen_equal'</span><span class="s1">: </span><span class="s3">2.0</span><span class="s0">, </span><span class="s2">'nobs_below'</span><span class="s1">: </span><span class="s3">21.0</span><span class="s0">,</span>
         <span class="s2">'nuncen_above'</span><span class="s1">: </span><span class="s3">2.0</span><span class="s0">, </span><span class="s2">'prob_exceedance'</span><span class="s1">: </span><span class="s3">0.37391304347826088</span><span class="s0">, </span><span class="s2">'upper_dl'</span><span class="s1">: </span><span class="s3">11.0</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'lower_dl'</span><span class="s1">: </span><span class="s3">11.0</span><span class="s0">, </span><span class="s2">'ncen_equal'</span><span class="s1">: </span><span class="s3">1.0</span><span class="s0">, </span><span class="s2">'nobs_below'</span><span class="s1">: </span><span class="s3">24.0</span><span class="s0">,</span>
         <span class="s2">'nuncen_above'</span><span class="s1">: </span><span class="s3">11.0</span><span class="s0">, </span><span class="s2">'prob_exceedance'</span><span class="s1">: </span><span class="s3">0.31428571428571428</span><span class="s0">, </span><span class="s2">'upper_dl'</span><span class="s1">: numpy.inf}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">'lower_dl'</span><span class="s1">: numpy.nan</span><span class="s0">, </span><span class="s2">'ncen_equal'</span><span class="s1">: numpy.nan</span><span class="s0">, </span><span class="s2">'nobs_below'</span><span class="s1">: numpy.nan</span><span class="s0">,</span>
         <span class="s2">'nuncen_above'</span><span class="s1">: numpy.nan</span><span class="s0">, </span><span class="s2">'prob_exceedance'</span><span class="s1">: </span><span class="s3">0.0</span><span class="s0">, </span><span class="s2">'upper_dl'</span><span class="s1">: numpy.nan}</span>
    <span class="s1">])</span>
    <span class="s0">return </span><span class="s1">cohn</span>


<span class="s0">class </span><span class="s1">Test__ros_sort:</span>
    <span class="s0">def </span><span class="s1">setup_method(self):</span>
        <span class="s1">self.df = load_basic_data()</span>

        <span class="s1">self.expected_baseline = pandas.DataFrame([</span>
            <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">True,  </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">5.0</span><span class="s1">}</span><span class="s0">,   </span><span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">True,  </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">5.0</span><span class="s1">}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">True,  </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">5.5</span><span class="s1">}</span><span class="s0">,   </span><span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">True,  </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">5.75</span><span class="s1">}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">True,  </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">9.5</span><span class="s1">}</span><span class="s0">,   </span><span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">True,  </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">9.5</span><span class="s1">}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">True,  </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">11.0</span><span class="s1">}</span><span class="s0">,  </span><span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">2.0</span><span class="s1">}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">4.2</span><span class="s1">}</span><span class="s0">,   </span><span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">4.62</span><span class="s1">}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">5.57</span><span class="s1">}</span><span class="s0">,  </span><span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">5.66</span><span class="s1">}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">5.86</span><span class="s1">}</span><span class="s0">,  </span><span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">6.65</span><span class="s1">}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">6.78</span><span class="s1">}</span><span class="s0">,  </span><span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">6.79</span><span class="s1">}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">7.5</span><span class="s1">}</span><span class="s0">,   </span><span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">7.5</span><span class="s1">}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">7.5</span><span class="s1">}</span><span class="s0">,   </span><span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">8.63</span><span class="s1">}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">8.71</span><span class="s1">}</span><span class="s0">,  </span><span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">8.99</span><span class="s1">}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">9.85</span><span class="s1">}</span><span class="s0">,  </span><span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">10.82</span><span class="s1">}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">11.25</span><span class="s1">}</span><span class="s0">, </span><span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">11.25</span><span class="s1">}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">12.2</span><span class="s1">}</span><span class="s0">,  </span><span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">14.92</span><span class="s1">}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">16.77</span><span class="s1">}</span><span class="s0">, </span><span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">17.81</span><span class="s1">}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">19.16</span><span class="s1">}</span><span class="s0">, </span><span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">19.19</span><span class="s1">}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">19.64</span><span class="s1">}</span><span class="s0">, </span><span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">20.18</span><span class="s1">}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'conc'</span><span class="s1">: </span><span class="s3">22.97</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">])[[</span><span class="s2">'conc'</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">]]</span>

        <span class="s1">self.expected_with_warning = self.expected_baseline.iloc[:-</span><span class="s3">1</span><span class="s1">]</span>

    <span class="s0">def </span><span class="s1">test_baseline(self):</span>
        <span class="s1">result = ros._ros_sort(self.df</span><span class="s0">, </span><span class="s2">'conc'</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">)</span>
        <span class="s1">assert_frame_equal(result</span><span class="s0">, </span><span class="s1">self.expected_baseline)</span>

    <span class="s0">def </span><span class="s1">test_censored_greater_than_max(self):</span>
        <span class="s1">df = self.df.copy()</span>
        <span class="s1">max_row = df[</span><span class="s2">'conc'</span><span class="s1">].idxmax()</span>
        <span class="s1">df.loc[max_row</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">] = </span><span class="s0">True</span>
        <span class="s1">result = ros._ros_sort(df</span><span class="s0">, </span><span class="s2">'conc'</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s1">)</span>
        <span class="s1">assert_frame_equal(result</span><span class="s0">, </span><span class="s1">self.expected_with_warning)</span>


<span class="s0">class </span><span class="s1">Test_cohn_numbers:</span>
    <span class="s0">def </span><span class="s1">setup_method(self):</span>
        <span class="s1">self.df = load_basic_data()</span>
        <span class="s1">self.final_cols = [</span><span class="s2">'lower_dl'</span><span class="s0">, </span><span class="s2">'upper_dl'</span><span class="s0">, </span><span class="s2">'nuncen_above'</span><span class="s0">, </span><span class="s2">'nobs_below'</span><span class="s0">,</span>
                           <span class="s2">'ncen_equal'</span><span class="s0">, </span><span class="s2">'prob_exceedance'</span><span class="s1">]</span>

        <span class="s1">self.expected_baseline = pandas.DataFrame([</span>
            <span class="s1">{</span><span class="s2">'lower_dl'</span><span class="s1">: </span><span class="s3">2.0</span><span class="s0">, </span><span class="s2">'ncen_equal'</span><span class="s1">: </span><span class="s3">0.0</span><span class="s0">, </span><span class="s2">'nobs_below'</span><span class="s1">: </span><span class="s3">0.0</span><span class="s0">,</span>
             <span class="s2">'nuncen_above'</span><span class="s1">: </span><span class="s3">3.0</span><span class="s0">, </span><span class="s2">'prob_exceedance'</span><span class="s1">: </span><span class="s3">1.0</span><span class="s0">, </span><span class="s2">'upper_dl'</span><span class="s1">: </span><span class="s3">5.0</span><span class="s1">}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">'lower_dl'</span><span class="s1">: </span><span class="s3">5.0</span><span class="s0">, </span><span class="s2">'ncen_equal'</span><span class="s1">: </span><span class="s3">2.0</span><span class="s0">, </span><span class="s2">'nobs_below'</span><span class="s1">: </span><span class="s3">5.0</span><span class="s0">,</span>
             <span class="s2">'nuncen_above'</span><span class="s1">: </span><span class="s3">0.0</span><span class="s0">, </span><span class="s2">'prob_exceedance'</span><span class="s1">: </span><span class="s3">0.77757437070938218</span><span class="s0">, </span><span class="s2">'upper_dl'</span><span class="s1">: </span><span class="s3">5.5</span><span class="s1">}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">'lower_dl'</span><span class="s1">: </span><span class="s3">5.5</span><span class="s0">, </span><span class="s2">'ncen_equal'</span><span class="s1">: </span><span class="s3">1.0</span><span class="s0">, </span><span class="s2">'nobs_below'</span><span class="s1">: </span><span class="s3">6.0</span><span class="s0">,</span>
             <span class="s2">'nuncen_above'</span><span class="s1">: </span><span class="s3">2.0</span><span class="s0">, </span><span class="s2">'prob_exceedance'</span><span class="s1">: </span><span class="s3">0.77757437070938218</span><span class="s0">, </span><span class="s2">'upper_dl'</span><span class="s1">: </span><span class="s3">5.75</span><span class="s1">}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">'lower_dl'</span><span class="s1">: </span><span class="s3">5.75</span><span class="s0">, </span><span class="s2">'ncen_equal'</span><span class="s1">: </span><span class="s3">1.0</span><span class="s0">, </span><span class="s2">'nobs_below'</span><span class="s1">: </span><span class="s3">9.0</span><span class="s0">,</span>
             <span class="s2">'nuncen_above'</span><span class="s1">: </span><span class="s3">10.0</span><span class="s0">, </span><span class="s2">'prob_exceedance'</span><span class="s1">: </span><span class="s3">0.7034324942791762</span><span class="s0">, </span><span class="s2">'upper_dl'</span><span class="s1">: </span><span class="s3">9.5</span><span class="s1">}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">'lower_dl'</span><span class="s1">: </span><span class="s3">9.5</span><span class="s0">, </span><span class="s2">'ncen_equal'</span><span class="s1">: </span><span class="s3">2.0</span><span class="s0">, </span><span class="s2">'nobs_below'</span><span class="s1">: </span><span class="s3">21.0</span><span class="s0">,</span>
             <span class="s2">'nuncen_above'</span><span class="s1">: </span><span class="s3">2.0</span><span class="s0">, </span><span class="s2">'prob_exceedance'</span><span class="s1">: </span><span class="s3">0.37391304347826088</span><span class="s0">, </span><span class="s2">'upper_dl'</span><span class="s1">: </span><span class="s3">11.0</span><span class="s1">}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">'lower_dl'</span><span class="s1">: </span><span class="s3">11.0</span><span class="s0">, </span><span class="s2">'ncen_equal'</span><span class="s1">: </span><span class="s3">1.0</span><span class="s0">, </span><span class="s2">'nobs_below'</span><span class="s1">: </span><span class="s3">24.0</span><span class="s0">,</span>
             <span class="s2">'nuncen_above'</span><span class="s1">: </span><span class="s3">11.0</span><span class="s0">, </span><span class="s2">'prob_exceedance'</span><span class="s1">: </span><span class="s3">0.31428571428571428</span><span class="s0">, </span><span class="s2">'upper_dl'</span><span class="s1">: numpy.inf}</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">'lower_dl'</span><span class="s1">: numpy.nan</span><span class="s0">, </span><span class="s2">'ncen_equal'</span><span class="s1">: numpy.nan</span><span class="s0">, </span><span class="s2">'nobs_below'</span><span class="s1">: numpy.nan</span><span class="s0">,</span>
             <span class="s2">'nuncen_above'</span><span class="s1">: numpy.nan</span><span class="s0">, </span><span class="s2">'prob_exceedance'</span><span class="s1">: </span><span class="s3">0.0</span><span class="s0">, </span><span class="s2">'upper_dl'</span><span class="s1">: numpy.nan}</span>
        <span class="s1">])[self.final_cols]</span>


    <span class="s0">def </span><span class="s1">test_baseline(self):</span>
        <span class="s1">result = ros.cohn_numbers(self.df</span><span class="s0">, </span><span class="s1">observations=</span><span class="s2">'conc'</span><span class="s0">, </span><span class="s1">censorship=</span><span class="s2">'censored'</span><span class="s1">)</span>
        <span class="s1">assert_frame_equal(result</span><span class="s0">, </span><span class="s1">self.expected_baseline)</span>

    <span class="s0">def </span><span class="s1">test_no_NDs(self):</span>
        <span class="s1">_df = self.df.copy()</span>
        <span class="s1">_df[</span><span class="s2">'qual'</span><span class="s1">] = </span><span class="s0">False</span>
        <span class="s1">result = ros.cohn_numbers(_df</span><span class="s0">, </span><span class="s1">observations=</span><span class="s2">'conc'</span><span class="s0">, </span><span class="s1">censorship=</span><span class="s2">'qual'</span><span class="s1">)</span>
        <span class="s0">assert </span><span class="s1">result.shape == (</span><span class="s3">0</span><span class="s0">, </span><span class="s3">6</span><span class="s1">)</span>


<span class="s0">class </span><span class="s1">Test__detection_limit_index:</span>
    <span class="s0">def </span><span class="s1">setup_method(self):</span>
        <span class="s1">self.cohn = load_basic_cohn()</span>
        <span class="s1">self.empty_cohn = pandas.DataFrame(numpy.empty((</span><span class="s3">0</span><span class="s0">, </span><span class="s3">7</span><span class="s1">)))</span>

    <span class="s0">def </span><span class="s1">test_empty(self):</span>
        <span class="s1">assert_equal(ros._detection_limit_index(</span><span class="s0">None, </span><span class="s1">self.empty_cohn)</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_populated(self):</span>
        <span class="s1">assert_equal(ros._detection_limit_index(</span><span class="s3">3.5</span><span class="s0">, </span><span class="s1">self.cohn)</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">assert_equal(ros._detection_limit_index(</span><span class="s3">6.0</span><span class="s0">, </span><span class="s1">self.cohn)</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_equal(ros._detection_limit_index(</span><span class="s3">12.0</span><span class="s0">, </span><span class="s1">self.cohn)</span><span class="s0">, </span><span class="s3">5</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_out_of_bounds(self):</span>
        <span class="s0">with </span><span class="s1">pytest.raises(IndexError):</span>
            <span class="s1">ros._detection_limit_index(</span><span class="s3">0</span><span class="s0">, </span><span class="s1">self.cohn)</span>


<span class="s0">def </span><span class="s1">test__ros_group_rank():</span>
    <span class="s1">df = pandas.DataFrame({</span>
        <span class="s2">'dl_idx'</span><span class="s1">: [</span><span class="s3">1</span><span class="s1">] * </span><span class="s3">12</span><span class="s0">,</span>
        <span class="s2">'params'</span><span class="s1">: list(</span><span class="s2">'AABCCCDE'</span><span class="s1">) + list(</span><span class="s2">'DCBA'</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s2">'values'</span><span class="s1">: list(range(</span><span class="s3">12</span><span class="s1">))</span>
    <span class="s1">})</span>

    <span class="s1">result = ros._ros_group_rank(df</span><span class="s0">, </span><span class="s2">'dl_idx'</span><span class="s0">, </span><span class="s2">'params'</span><span class="s1">)</span>
    <span class="s1">expected = pandas.Series([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s1">name=</span><span class="s2">'rank'</span><span class="s1">)</span>
    <span class="s1">assert_series_equal(result.astype(int)</span><span class="s0">, </span><span class="s1">expected.astype(int))</span>


<span class="s0">class </span><span class="s1">Test__ros_plot_pos:</span>
    <span class="s0">def </span><span class="s1">setup_method(self):</span>
        <span class="s1">self.cohn = load_basic_cohn()</span>

    <span class="s0">def </span><span class="s1">test_uncensored_1(self):</span>
        <span class="s1">row = {</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">2</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">1</span><span class="s1">}</span>
        <span class="s1">result = ros._ros_plot_pos(row</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s0">, </span><span class="s1">self.cohn)</span>
        <span class="s1">assert_equal(result</span><span class="s0">, </span><span class="s3">0.24713958810068648</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_uncensored_2(self):</span>
        <span class="s1">row = {</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">False, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">2</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">12</span><span class="s1">}</span>
        <span class="s1">result = ros._ros_plot_pos(row</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s0">, </span><span class="s1">self.cohn)</span>
        <span class="s1">assert_equal(result</span><span class="s0">, </span><span class="s3">0.51899313501144173</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_censored_1(self):</span>
        <span class="s1">row = {</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">True, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">5</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">4</span><span class="s1">}</span>
        <span class="s1">result = ros._ros_plot_pos(row</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s0">, </span><span class="s1">self.cohn)</span>
        <span class="s1">assert_equal(result</span><span class="s0">, </span><span class="s3">1.3714285714285714</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_censored_2(self):</span>
        <span class="s1">row = {</span><span class="s2">'censored'</span><span class="s1">: </span><span class="s0">True, </span><span class="s2">'det_limit_index'</span><span class="s1">: </span><span class="s3">4</span><span class="s0">, </span><span class="s2">'rank'</span><span class="s1">: </span><span class="s3">2</span><span class="s1">}</span>
        <span class="s1">result = ros._ros_plot_pos(row</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s0">, </span><span class="s1">self.cohn)</span>
        <span class="s1">assert_equal(result</span><span class="s0">, </span><span class="s3">0.41739130434782606</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test__norm_plot_pos():</span>
    <span class="s1">result = ros._norm_plot_pos([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s1">])</span>
    <span class="s1">expected = numpy.array([ </span><span class="s3">0.159104</span><span class="s0">,  </span><span class="s3">0.385452</span><span class="s0">,  </span><span class="s3">0.614548</span><span class="s0">,  </span><span class="s3">0.840896</span><span class="s1">])</span>
    <span class="s1">npt.assert_array_almost_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_plotting_positions():</span>
    <span class="s1">df = load_intermediate_data()</span>
    <span class="s1">cohn = load_basic_cohn()</span>

    <span class="s1">results = ros.plotting_positions(df</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s0">, </span><span class="s1">cohn)</span>
    <span class="s1">expected = numpy.array([</span>
        <span class="s3">0.07414188</span><span class="s0">,  </span><span class="s3">0.11121281</span><span class="s0">,  </span><span class="s3">0.14828375</span><span class="s0">,  </span><span class="s3">0.14828375</span><span class="s0">,  </span><span class="s3">0.20869565</span><span class="s0">,</span>
        <span class="s3">0.34285714</span><span class="s0">,  </span><span class="s3">0.4173913 </span><span class="s0">,  </span><span class="s3">0.05560641</span><span class="s0">,  </span><span class="s3">0.11121281</span><span class="s0">,  </span><span class="s3">0.16681922</span><span class="s0">,</span>
        <span class="s3">0.24713959</span><span class="s0">,  </span><span class="s3">0.27185355</span><span class="s0">,  </span><span class="s3">0.32652382</span><span class="s0">,  </span><span class="s3">0.35648013</span><span class="s0">,  </span><span class="s3">0.38643645</span><span class="s0">,</span>
        <span class="s3">0.41639276</span><span class="s0">,  </span><span class="s3">0.44634907</span><span class="s0">,  </span><span class="s3">0.47630539</span><span class="s0">,  </span><span class="s3">0.5062617 </span><span class="s0">,  </span><span class="s3">0.53621802</span><span class="s0">,</span>
        <span class="s3">0.56617433</span><span class="s0">,  </span><span class="s3">0.59613064</span><span class="s0">,  </span><span class="s3">0.64596273</span><span class="s0">,  </span><span class="s3">0.66583851</span><span class="s0">,  </span><span class="s3">0.71190476</span><span class="s0">,</span>
        <span class="s3">0.73809524</span><span class="s0">,  </span><span class="s3">0.76428571</span><span class="s0">,  </span><span class="s3">0.79047619</span><span class="s0">,  </span><span class="s3">0.81666667</span><span class="s0">,  </span><span class="s3">0.84285714</span><span class="s0">,</span>
        <span class="s3">0.86904762</span><span class="s0">,  </span><span class="s3">0.8952381 </span><span class="s0">,  </span><span class="s3">0.92142857</span><span class="s0">,  </span><span class="s3">0.94761905</span><span class="s0">,  </span><span class="s3">0.97380952</span>
    <span class="s1">])</span>
    <span class="s1">npt.assert_array_almost_equal(results</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test__impute():</span>
    <span class="s1">expected = numpy.array([</span>
        <span class="s3">3.11279729</span><span class="s0">,   </span><span class="s3">3.60634338</span><span class="s0">,   </span><span class="s3">4.04602788</span><span class="s0">,   </span><span class="s3">4.04602788</span><span class="s0">,</span>
        <span class="s3">4.71008116</span><span class="s0">,   </span><span class="s3">6.14010906</span><span class="s0">,   </span><span class="s3">6.97841457</span><span class="s0">,   </span><span class="s3">2.        </span><span class="s0">,</span>
        <span class="s3">4.2       </span><span class="s0">,   </span><span class="s3">4.62      </span><span class="s0">,   </span><span class="s3">5.57      </span><span class="s0">,   </span><span class="s3">5.66      </span><span class="s0">,</span>
        <span class="s3">5.86      </span><span class="s0">,   </span><span class="s3">6.65      </span><span class="s0">,   </span><span class="s3">6.78      </span><span class="s0">,   </span><span class="s3">6.79      </span><span class="s0">,</span>
        <span class="s3">7.5       </span><span class="s0">,   </span><span class="s3">7.5       </span><span class="s0">,   </span><span class="s3">7.5       </span><span class="s0">,   </span><span class="s3">8.63      </span><span class="s0">,</span>
        <span class="s3">8.71      </span><span class="s0">,   </span><span class="s3">8.99      </span><span class="s0">,   </span><span class="s3">9.85      </span><span class="s0">,  </span><span class="s3">10.82      </span><span class="s0">,</span>
        <span class="s3">11.25      </span><span class="s0">,  </span><span class="s3">11.25      </span><span class="s0">,  </span><span class="s3">12.2       </span><span class="s0">,  </span><span class="s3">14.92      </span><span class="s0">,</span>
        <span class="s3">16.77      </span><span class="s0">,  </span><span class="s3">17.81      </span><span class="s0">,  </span><span class="s3">19.16      </span><span class="s0">,  </span><span class="s3">19.19      </span><span class="s0">,</span>
        <span class="s3">19.64      </span><span class="s0">,  </span><span class="s3">20.18      </span><span class="s0">,  </span><span class="s3">22.97</span>
    <span class="s1">])</span>
    <span class="s1">df = load_advanced_data()</span>
    <span class="s1">df = ros._impute(df</span><span class="s0">, </span><span class="s2">'conc'</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s0">, </span><span class="s1">numpy.log</span><span class="s0">, </span><span class="s1">numpy.exp)</span>
    <span class="s1">result = df[</span><span class="s2">'final'</span><span class="s1">].values</span>
    <span class="s1">npt.assert_array_almost_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test__do_ros():</span>
    <span class="s1">expected = numpy.array([</span>
        <span class="s3">3.11279729</span><span class="s0">,   </span><span class="s3">3.60634338</span><span class="s0">,   </span><span class="s3">4.04602788</span><span class="s0">,   </span><span class="s3">4.04602788</span><span class="s0">,</span>
        <span class="s3">4.71008116</span><span class="s0">,   </span><span class="s3">6.14010906</span><span class="s0">,   </span><span class="s3">6.97841457</span><span class="s0">,   </span><span class="s3">2.        </span><span class="s0">,</span>
        <span class="s3">4.2       </span><span class="s0">,   </span><span class="s3">4.62      </span><span class="s0">,   </span><span class="s3">5.57      </span><span class="s0">,   </span><span class="s3">5.66      </span><span class="s0">,</span>
        <span class="s3">5.86      </span><span class="s0">,   </span><span class="s3">6.65      </span><span class="s0">,   </span><span class="s3">6.78      </span><span class="s0">,   </span><span class="s3">6.79      </span><span class="s0">,</span>
        <span class="s3">7.5       </span><span class="s0">,   </span><span class="s3">7.5       </span><span class="s0">,   </span><span class="s3">7.5       </span><span class="s0">,   </span><span class="s3">8.63      </span><span class="s0">,</span>
        <span class="s3">8.71      </span><span class="s0">,   </span><span class="s3">8.99      </span><span class="s0">,   </span><span class="s3">9.85      </span><span class="s0">,  </span><span class="s3">10.82      </span><span class="s0">,</span>
        <span class="s3">11.25      </span><span class="s0">,  </span><span class="s3">11.25      </span><span class="s0">,  </span><span class="s3">12.2       </span><span class="s0">,  </span><span class="s3">14.92      </span><span class="s0">,</span>
        <span class="s3">16.77      </span><span class="s0">,  </span><span class="s3">17.81      </span><span class="s0">,  </span><span class="s3">19.16      </span><span class="s0">,  </span><span class="s3">19.19      </span><span class="s0">,</span>
        <span class="s3">19.64      </span><span class="s0">,  </span><span class="s3">20.18      </span><span class="s0">,  </span><span class="s3">22.97</span>
    <span class="s1">])</span>

    <span class="s1">df = load_basic_data()</span>
    <span class="s1">df = ros._do_ros(df</span><span class="s0">, </span><span class="s2">'conc'</span><span class="s0">, </span><span class="s2">'censored'</span><span class="s0">, </span><span class="s1">numpy.log</span><span class="s0">, </span><span class="s1">numpy.exp)</span>
    <span class="s1">result = df[</span><span class="s2">'final'</span><span class="s1">].values</span>
    <span class="s1">npt.assert_array_almost_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">class </span><span class="s1">CheckROSMixin:</span>
    <span class="s0">def </span><span class="s1">test_ros_df(self):</span>
        <span class="s1">result = ros.impute_ros(self.rescol</span><span class="s0">, </span><span class="s1">self.cencol</span><span class="s0">, </span><span class="s1">df=self.df)</span>
        <span class="s1">npt.assert_array_almost_equal(</span>
            <span class="s1">sorted(result)</span><span class="s0">,</span>
            <span class="s1">sorted(self.expected_final)</span><span class="s0">,</span>
            <span class="s1">decimal=self.decimal</span>
        <span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_ros_arrays(self):</span>
        <span class="s1">result = ros.impute_ros(self.df[self.rescol]</span><span class="s0">, </span><span class="s1">self.df[self.cencol]</span><span class="s0">, </span><span class="s1">df=</span><span class="s0">None</span><span class="s1">)</span>
        <span class="s1">npt.assert_array_almost_equal(</span>
            <span class="s1">sorted(result)</span><span class="s0">,</span>
            <span class="s1">sorted(self.expected_final)</span><span class="s0">,</span>
            <span class="s1">decimal=self.decimal</span>
        <span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_cohn(self):</span>
        <span class="s1">cols = [</span>
            <span class="s2">'nuncen_above'</span><span class="s0">, </span><span class="s2">'nobs_below'</span><span class="s0">,</span>
            <span class="s2">'ncen_equal'</span><span class="s0">, </span><span class="s2">'prob_exceedance'</span>
        <span class="s1">]</span>
        <span class="s1">cohn = ros.cohn_numbers(self.df</span><span class="s0">, </span><span class="s1">self.rescol</span><span class="s0">, </span><span class="s1">self.cencol)</span>
        <span class="s4"># Use round in place of the deprecated check_less_precise arg</span>
        <span class="s1">assert_frame_equal(</span>
            <span class="s1">np.round(cohn[cols]</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span><span class="s0">,</span>
            <span class="s1">np.round(self.expected_cohn[cols]</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">)</span>


<span class="s0">class </span><span class="s1">Test_ROS_HelselAppendixB(CheckROSMixin):</span>
    <span class="s5">&quot;&quot;&quot; 
    Appendix B dataset from &quot;Estimation of Descriptive Statists for 
    Multiply Censored Water Quality Data&quot;, Water Resources Research, 
    Vol 24, No 12, pp 1997 - 2004. December 1988. 
    &quot;&quot;&quot;</span>
    <span class="s1">decimal = </span><span class="s3">2</span>
    <span class="s1">res = numpy.array([</span>
        <span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">10.</span><span class="s0">, </span><span class="s3">10.</span><span class="s0">, </span><span class="s3">10.</span><span class="s0">,</span>
        <span class="s3">3.0</span><span class="s0">, </span><span class="s3">7.0</span><span class="s0">, </span><span class="s3">9.0</span><span class="s0">, </span><span class="s3">12.</span><span class="s0">, </span><span class="s3">15.</span><span class="s0">, </span><span class="s3">20.</span><span class="s0">, </span><span class="s3">27.</span><span class="s0">, </span><span class="s3">33.</span><span class="s0">, </span><span class="s3">50.</span>
    <span class="s1">])</span>
    <span class="s1">cen = numpy.array([</span>
        <span class="s0">True, True, True, True, True, True, True, True, True,</span>
        <span class="s0">False, False, False, False, False, False, False,</span>
        <span class="s0">False, False</span>
    <span class="s1">])</span>
    <span class="s1">rescol = </span><span class="s2">'obs'</span>
    <span class="s1">cencol = </span><span class="s2">'cen'</span>
    <span class="s1">df = pandas.DataFrame({rescol: res</span><span class="s0">, </span><span class="s1">cencol: cen})</span>
    <span class="s1">expected_final = numpy.array([</span>
        <span class="s3">0.47</span><span class="s0">,  </span><span class="s3">0.85</span><span class="s0">, </span><span class="s3">1.11</span><span class="s0">, </span><span class="s3">1.27</span><span class="s0">, </span><span class="s3">1.76</span><span class="s0">, </span><span class="s3">2.34</span><span class="s0">, </span><span class="s3">2.50</span><span class="s0">, </span><span class="s3">3.00</span><span class="s0">, </span><span class="s3">3.03</span><span class="s0">,</span>
        <span class="s3">4.80</span><span class="s0">, </span><span class="s3">7.00</span><span class="s0">, </span><span class="s3">9.00</span><span class="s0">, </span><span class="s3">12.0</span><span class="s0">, </span><span class="s3">15.0</span><span class="s0">, </span><span class="s3">20.0</span><span class="s0">, </span><span class="s3">27.0</span><span class="s0">, </span><span class="s3">33.0</span><span class="s0">, </span><span class="s3">50.0</span>
    <span class="s1">])</span>

    <span class="s1">expected_cohn = pandas.DataFrame({</span>
        <span class="s2">'nuncen_above'</span><span class="s1">: numpy.array([</span><span class="s3">3.0</span><span class="s0">, </span><span class="s3">6.0</span><span class="s0">, </span><span class="s1">numpy.nan])</span><span class="s0">,</span>
        <span class="s2">'nobs_below'</span><span class="s1">: numpy.array([</span><span class="s3">6.0</span><span class="s0">, </span><span class="s3">12.0</span><span class="s0">, </span><span class="s1">numpy.nan])</span><span class="s0">,</span>
        <span class="s2">'ncen_equal'</span><span class="s1">: numpy.array([</span><span class="s3">6.0</span><span class="s0">, </span><span class="s3">3.0</span><span class="s0">, </span><span class="s1">numpy.nan])</span><span class="s0">,</span>
        <span class="s2">'prob_exceedance'</span><span class="s1">: numpy.array([</span><span class="s3">0.55556</span><span class="s0">, </span><span class="s3">0.33333</span><span class="s0">, </span><span class="s3">0.0</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">})</span>


<span class="s0">class </span><span class="s1">Test_ROS_HelselArsenic(CheckROSMixin):</span>
    <span class="s5">&quot;&quot;&quot; 
    Oahu arsenic data from Nondetects and Data Analysis by 
    Dennis R. Helsel (John Wiley, 2005) 
 
    Plotting positions are fudged since relative to source data since 
    modeled data is what matters and (source data plot positions are 
    not uniformly spaced, which seems weird) 
    &quot;&quot;&quot;</span>
    <span class="s1">decimal = </span><span class="s3">2</span>
    <span class="s1">res = numpy.array([</span>
        <span class="s3">3.2</span><span class="s0">, </span><span class="s3">2.8</span><span class="s0">, </span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">2.0</span><span class="s0">,</span>
        <span class="s3">2.0</span><span class="s0">, </span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">1.7</span><span class="s0">, </span><span class="s3">1.5</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">,</span>
        <span class="s3">0.9</span><span class="s0">, </span><span class="s3">0.9</span><span class="s0">, </span><span class="s3">0.7</span><span class="s0">, </span><span class="s3">0.7</span><span class="s0">, </span><span class="s3">0.6</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.5</span>
    <span class="s1">])</span>

    <span class="s1">cen = numpy.array([</span>
        <span class="s0">False, False, True, True, True, True, True,</span>
        <span class="s0">True, True, True, False, False, True, True,</span>
        <span class="s0">True, True, False, True, False, False, False,</span>
        <span class="s0">False, False, False</span>
    <span class="s1">])</span>
    <span class="s1">rescol = </span><span class="s2">'obs'</span>
    <span class="s1">cencol = </span><span class="s2">'cen'</span>
    <span class="s1">df = pandas.DataFrame({rescol: res</span><span class="s0">, </span><span class="s1">cencol: cen})</span>
    <span class="s1">expected_final = numpy.array([</span>
        <span class="s3">3.20</span><span class="s0">, </span><span class="s3">2.80</span><span class="s0">, </span><span class="s3">1.42</span><span class="s0">, </span><span class="s3">1.14</span><span class="s0">, </span><span class="s3">0.95</span><span class="s0">, </span><span class="s3">0.81</span><span class="s0">, </span><span class="s3">0.68</span><span class="s0">, </span><span class="s3">0.57</span><span class="s0">,</span>
        <span class="s3">0.46</span><span class="s0">, </span><span class="s3">0.35</span><span class="s0">, </span><span class="s3">1.70</span><span class="s0">, </span><span class="s3">1.50</span><span class="s0">, </span><span class="s3">0.98</span><span class="s0">, </span><span class="s3">0.76</span><span class="s0">, </span><span class="s3">0.58</span><span class="s0">, </span><span class="s3">0.41</span><span class="s0">,</span>
        <span class="s3">0.90</span><span class="s0">, </span><span class="s3">0.61</span><span class="s0">, </span><span class="s3">0.70</span><span class="s0">, </span><span class="s3">0.70</span><span class="s0">, </span><span class="s3">0.60</span><span class="s0">, </span><span class="s3">0.50</span><span class="s0">, </span><span class="s3">0.50</span><span class="s0">, </span><span class="s3">0.50</span>
    <span class="s1">])</span>

    <span class="s1">expected_cohn = pandas.DataFrame({</span>
        <span class="s2">'nuncen_above'</span><span class="s1">: numpy.array([</span><span class="s3">6.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">2.0</span><span class="s0">, </span><span class="s1">numpy.nan])</span><span class="s0">,</span>
        <span class="s2">'nobs_below'</span><span class="s1">: numpy.array([</span><span class="s3">0.0</span><span class="s0">, </span><span class="s3">7.0</span><span class="s0">, </span><span class="s3">12.0</span><span class="s0">, </span><span class="s3">22.0</span><span class="s0">, </span><span class="s1">numpy.nan])</span><span class="s0">,</span>
        <span class="s2">'ncen_equal'</span><span class="s1">: numpy.array([</span><span class="s3">0.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">4.0</span><span class="s0">, </span><span class="s3">8.0</span><span class="s0">, </span><span class="s1">numpy.nan])</span><span class="s0">,</span>
        <span class="s2">'prob_exceedance'</span><span class="s1">: numpy.array([</span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.3125</span><span class="s0">, </span><span class="s3">0.21429</span><span class="s0">, </span><span class="s3">0.0833</span><span class="s0">, </span><span class="s3">0.0</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">})</span>


<span class="s0">class </span><span class="s1">Test_ROS_RNADAdata(CheckROSMixin):</span>
    <span class="s1">decimal = </span><span class="s3">3</span>
    <span class="s1">datastring = StringIO(dedent(</span><span class="s2">&quot;&quot;&quot;</span><span class="s0">\ 
        </span><span class="s2">res cen 
        0.090  True 
        0.090  True 
        0.090  True 
        0.101 False 
        0.136 False 
        0.340 False 
        0.457 False 
        0.514 False 
        0.629 False 
        0.638 False 
        0.774 False 
        0.788 False 
        0.900  True 
        0.900  True 
        0.900  True 
        1.000  True 
        1.000  True 
        1.000  True 
        1.000  True 
        1.000  True 
        1.000 False 
        1.000  True 
        1.000  True 
        1.000  True 
        1.000  True 
        1.000  True 
        1.000  True 
        1.000  True 
        1.000  True 
        1.000  True 
        1.000  True 
        1.000  True 
        1.000  True 
        1.100 False 
        2.000 False 
        2.000 False 
        2.404 False 
        2.860 False 
        3.000 False 
        3.000 False 
        3.705 False 
        4.000 False 
        5.000 False 
        5.960 False 
        6.000 False 
        7.214 False 
       16.000 False 
       17.716 False 
       25.000 False 
       51.000 False&quot;&quot;&quot;</span><span class="s1">))</span>
    <span class="s1">rescol = </span><span class="s2">'res'</span>
    <span class="s1">cencol = </span><span class="s2">'cen'</span>
    <span class="s1">df = pandas.read_csv(datastring</span><span class="s0">, </span><span class="s1">sep=</span><span class="s2">r'\s+'</span><span class="s1">)</span>
    <span class="s1">expected_final = numpy.array([</span>
        <span class="s3">0.01907990</span><span class="s0">,  </span><span class="s3">0.03826254</span><span class="s0">,  </span><span class="s3">0.06080717</span><span class="s0">,  </span><span class="s3">0.10100000</span><span class="s0">,  </span><span class="s3">0.13600000</span><span class="s0">,</span>
        <span class="s3">0.34000000</span><span class="s0">,  </span><span class="s3">0.45700000</span><span class="s0">,  </span><span class="s3">0.51400000</span><span class="s0">,  </span><span class="s3">0.62900000</span><span class="s0">,  </span><span class="s3">0.63800000</span><span class="s0">,</span>
        <span class="s3">0.77400000</span><span class="s0">,  </span><span class="s3">0.78800000</span><span class="s0">,  </span><span class="s3">0.08745914</span><span class="s0">,  </span><span class="s3">0.25257575</span><span class="s0">,  </span><span class="s3">0.58544205</span><span class="s0">,</span>
        <span class="s3">0.01711153</span><span class="s0">,  </span><span class="s3">0.03373885</span><span class="s0">,  </span><span class="s3">0.05287083</span><span class="s0">,  </span><span class="s3">0.07506079</span><span class="s0">,  </span><span class="s3">0.10081573</span><span class="s0">,</span>
        <span class="s3">1.00000000</span><span class="s0">,  </span><span class="s3">0.13070334</span><span class="s0">,  </span><span class="s3">0.16539309</span><span class="s0">,  </span><span class="s3">0.20569039</span><span class="s0">,  </span><span class="s3">0.25257575</span><span class="s0">,</span>
        <span class="s3">0.30725491</span><span class="s0">,  </span><span class="s3">0.37122555</span><span class="s0">,  </span><span class="s3">0.44636843</span><span class="s0">,  </span><span class="s3">0.53507405</span><span class="s0">,  </span><span class="s3">0.64042242</span><span class="s0">,</span>
        <span class="s3">0.76644378</span><span class="s0">,  </span><span class="s3">0.91850581</span><span class="s0">,  </span><span class="s3">1.10390531</span><span class="s0">,  </span><span class="s3">1.10000000</span><span class="s0">,  </span><span class="s3">2.00000000</span><span class="s0">,</span>
        <span class="s3">2.00000000</span><span class="s0">,  </span><span class="s3">2.40400000</span><span class="s0">,  </span><span class="s3">2.86000000</span><span class="s0">,  </span><span class="s3">3.00000000</span><span class="s0">,  </span><span class="s3">3.00000000</span><span class="s0">,</span>
        <span class="s3">3.70500000</span><span class="s0">,  </span><span class="s3">4.00000000</span><span class="s0">,  </span><span class="s3">5.00000000</span><span class="s0">,  </span><span class="s3">5.96000000</span><span class="s0">,  </span><span class="s3">6.00000000</span><span class="s0">,</span>
        <span class="s3">7.21400000</span><span class="s0">, </span><span class="s3">16.00000000</span><span class="s0">, </span><span class="s3">17.71600000</span><span class="s0">, </span><span class="s3">25.00000000</span><span class="s0">, </span><span class="s3">51.00000000</span>
    <span class="s1">])</span>

    <span class="s1">expected_cohn = pandas.DataFrame({</span>
        <span class="s2">'nuncen_above'</span><span class="s1">: numpy.array([</span><span class="s3">9.</span><span class="s0">, </span><span class="s3">0.0</span><span class="s0">, </span><span class="s3">18.</span><span class="s0">, </span><span class="s1">numpy.nan])</span><span class="s0">,</span>
        <span class="s2">'nobs_below'</span><span class="s1">: numpy.array([</span><span class="s3">3.</span><span class="s0">, </span><span class="s3">15.</span><span class="s0">, </span><span class="s3">32.</span><span class="s0">, </span><span class="s1">numpy.nan])</span><span class="s0">,</span>
        <span class="s2">'ncen_equal'</span><span class="s1">: numpy.array([</span><span class="s3">3.</span><span class="s0">, </span><span class="s3">3.</span><span class="s0">, </span><span class="s3">17.</span><span class="s0">, </span><span class="s1">numpy.nan])</span><span class="s0">,</span>
        <span class="s2">'prob_exceedance'</span><span class="s1">: numpy.array([</span><span class="s3">0.84</span><span class="s0">, </span><span class="s3">0.36</span><span class="s0">, </span><span class="s3">0.36</span><span class="s0">, </span><span class="s3">0</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">})</span>


<span class="s0">class </span><span class="s1">Test_NoOp_ZeroND(CheckROSMixin):</span>
    <span class="s1">decimal = </span><span class="s3">2</span>
    <span class="s1">numpy.random.seed(</span><span class="s3">0</span><span class="s1">)</span>
    <span class="s1">N = </span><span class="s3">20</span>
    <span class="s1">res = numpy.random.lognormal(size=N)</span>
    <span class="s1">cen = [</span><span class="s0">False</span><span class="s1">] * N</span>
    <span class="s1">rescol = </span><span class="s2">'obs'</span>
    <span class="s1">cencol = </span><span class="s2">'cen'</span>
    <span class="s1">df = pandas.DataFrame({rescol: res</span><span class="s0">, </span><span class="s1">cencol: cen})</span>
    <span class="s1">expected_final = numpy.array([</span>
        <span class="s3">0.38</span><span class="s0">, </span><span class="s3">0.43</span><span class="s0">, </span><span class="s3">0.81</span><span class="s0">, </span><span class="s3">0.86</span><span class="s0">, </span><span class="s3">0.90</span><span class="s0">, </span><span class="s3">1.13</span><span class="s0">, </span><span class="s3">1.15</span><span class="s0">, </span><span class="s3">1.37</span><span class="s0">, </span><span class="s3">1.40</span><span class="s0">,</span>
        <span class="s3">1.49</span><span class="s0">, </span><span class="s3">1.51</span><span class="s0">, </span><span class="s3">1.56</span><span class="s0">, </span><span class="s3">2.14</span><span class="s0">, </span><span class="s3">2.59</span><span class="s0">, </span><span class="s3">2.66</span><span class="s0">, </span><span class="s3">4.28</span><span class="s0">, </span><span class="s3">4.46</span><span class="s0">, </span><span class="s3">5.84</span><span class="s0">,</span>
        <span class="s3">6.47</span><span class="s0">, </span><span class="s3">9.4</span>
    <span class="s1">])</span>

    <span class="s1">expected_cohn = pandas.DataFrame({</span>
        <span class="s2">'nuncen_above'</span><span class="s1">: numpy.array([])</span><span class="s0">,</span>
        <span class="s2">'nobs_below'</span><span class="s1">: numpy.array([])</span><span class="s0">,</span>
        <span class="s2">'ncen_equal'</span><span class="s1">: numpy.array([])</span><span class="s0">,</span>
        <span class="s2">'prob_exceedance'</span><span class="s1">: numpy.array([])</span><span class="s0">,</span>
    <span class="s1">})</span>


<span class="s0">class </span><span class="s1">Test_ROS_OneND(CheckROSMixin):</span>
    <span class="s1">decimal = </span><span class="s3">3</span>
    <span class="s1">res = numpy.array([</span>
        <span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">10.</span><span class="s0">, </span><span class="s3">10.</span><span class="s0">, </span><span class="s3">10.</span><span class="s0">,</span>
        <span class="s3">3.0</span><span class="s0">, </span><span class="s3">7.0</span><span class="s0">, </span><span class="s3">9.0</span><span class="s0">, </span><span class="s3">12.</span><span class="s0">, </span><span class="s3">15.</span><span class="s0">, </span><span class="s3">20.</span><span class="s0">, </span><span class="s3">27.</span><span class="s0">, </span><span class="s3">33.</span><span class="s0">, </span><span class="s3">50.</span>
    <span class="s1">])</span>
    <span class="s1">cen = numpy.array([</span>
        <span class="s0">True, False, False, False, False, False, False, False, False,</span>
        <span class="s0">False, False, False, False, False, False, False,</span>
        <span class="s0">False, False</span>
    <span class="s1">])</span>
    <span class="s1">rescol = </span><span class="s2">'conc'</span>
    <span class="s1">cencol = </span><span class="s2">'cen'</span>
    <span class="s1">df = pandas.DataFrame({rescol: res</span><span class="s0">, </span><span class="s1">cencol: cen})</span>
    <span class="s1">expected_final = numpy.array([</span>
        <span class="s3">0.24</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">10.</span><span class="s0">, </span><span class="s3">10.</span><span class="s0">, </span><span class="s3">10.</span><span class="s0">,</span>
        <span class="s3">3.0 </span><span class="s0">, </span><span class="s3">7.0</span><span class="s0">, </span><span class="s3">9.0</span><span class="s0">, </span><span class="s3">12.</span><span class="s0">, </span><span class="s3">15.</span><span class="s0">, </span><span class="s3">20.</span><span class="s0">, </span><span class="s3">27.</span><span class="s0">, </span><span class="s3">33.</span><span class="s0">, </span><span class="s3">50.</span>
    <span class="s1">])</span>

    <span class="s1">expected_cohn = pandas.DataFrame({</span>
        <span class="s2">'nuncen_above'</span><span class="s1">: numpy.array([</span><span class="s3">17.0</span><span class="s0">, </span><span class="s1">numpy.nan])</span><span class="s0">,</span>
        <span class="s2">'nobs_below'</span><span class="s1">: numpy.array([</span><span class="s3">1.0</span><span class="s0">, </span><span class="s1">numpy.nan])</span><span class="s0">,</span>
        <span class="s2">'ncen_equal'</span><span class="s1">: numpy.array([</span><span class="s3">1.0</span><span class="s0">, </span><span class="s1">numpy.nan])</span><span class="s0">,</span>
        <span class="s2">'prob_exceedance'</span><span class="s1">: numpy.array([</span><span class="s3">0.94444</span><span class="s0">, </span><span class="s3">0.0</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">})</span>


<span class="s0">class </span><span class="s1">Test_HalfDLs_80pctNDs(CheckROSMixin):</span>
    <span class="s1">decimal = </span><span class="s3">3</span>
    <span class="s1">res = numpy.array([</span>
        <span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">10.</span><span class="s0">, </span><span class="s3">10.</span><span class="s0">, </span><span class="s3">10.</span><span class="s0">,</span>
        <span class="s3">3.0</span><span class="s0">, </span><span class="s3">7.0</span><span class="s0">, </span><span class="s3">9.0</span><span class="s0">, </span><span class="s3">12.</span><span class="s0">, </span><span class="s3">15.</span><span class="s0">, </span><span class="s3">20.</span><span class="s0">, </span><span class="s3">27.</span><span class="s0">, </span><span class="s3">33.</span><span class="s0">, </span><span class="s3">50.</span>
    <span class="s1">])</span>
    <span class="s1">cen = numpy.array([</span>
        <span class="s0">True, True, True, True, True, True, True, True,</span>
        <span class="s0">True, True, True, True, True, True, True, False,</span>
        <span class="s0">False, False</span>
    <span class="s1">])</span>
    <span class="s1">rescol = </span><span class="s2">'value'</span>
    <span class="s1">cencol = </span><span class="s2">'qual'</span>
    <span class="s1">df = pandas.DataFrame({rescol: res</span><span class="s0">, </span><span class="s1">cencol: cen})</span>
    <span class="s1">expected_final = numpy.array([</span>
        <span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">5.0</span><span class="s0">, </span><span class="s3">5.0</span><span class="s0">, </span><span class="s3">5.0</span><span class="s0">,</span>
        <span class="s3">1.5</span><span class="s0">, </span><span class="s3">3.5</span><span class="s0">, </span><span class="s3">4.5</span><span class="s0">, </span><span class="s3">6.0</span><span class="s0">, </span><span class="s3">7.5</span><span class="s0">, </span><span class="s3">10.</span><span class="s0">, </span><span class="s3">27.</span><span class="s0">, </span><span class="s3">33.</span><span class="s0">, </span><span class="s3">50.</span>
    <span class="s1">])</span>

    <span class="s1">expected_cohn = pandas.DataFrame({</span>
        <span class="s2">'nuncen_above'</span><span class="s1">: numpy.array([</span><span class="s3">0.</span><span class="s0">, </span><span class="s3">0.</span><span class="s0">, </span><span class="s3">0.</span><span class="s0">, </span><span class="s3">0.</span><span class="s0">, </span><span class="s3">0.</span><span class="s0">, </span><span class="s3">0.</span><span class="s0">, </span><span class="s3">0.</span><span class="s0">, </span><span class="s3">3.</span><span class="s0">, </span><span class="s1">numpy.nan])</span><span class="s0">,</span>
        <span class="s2">'nobs_below'</span><span class="s1">: numpy.array([</span><span class="s3">6.</span><span class="s0">, </span><span class="s3">7.</span><span class="s0">, </span><span class="s3">8.</span><span class="s0">, </span><span class="s3">9.</span><span class="s0">, </span><span class="s3">12.</span><span class="s0">, </span><span class="s3">13.</span><span class="s0">, </span><span class="s3">14.</span><span class="s0">, </span><span class="s3">15.</span><span class="s0">, </span><span class="s1">numpy.nan])</span><span class="s0">,</span>
        <span class="s2">'ncen_equal'</span><span class="s1">: numpy.array([</span><span class="s3">6.</span><span class="s0">, </span><span class="s3">1.</span><span class="s0">, </span><span class="s3">1.</span><span class="s0">, </span><span class="s3">1.</span><span class="s0">, </span><span class="s3">3.</span><span class="s0">, </span><span class="s3">1.</span><span class="s0">, </span><span class="s3">1.</span><span class="s0">, </span><span class="s3">1.</span><span class="s0">, </span><span class="s1">numpy.nan])</span><span class="s0">,</span>
        <span class="s2">'prob_exceedance'</span><span class="s1">: numpy.array([</span><span class="s3">0.16667</span><span class="s1">] * </span><span class="s3">8 </span><span class="s1">+ [</span><span class="s3">0.</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">})</span>


<span class="s0">class </span><span class="s1">Test_HaflDLs_OneUncensored(CheckROSMixin):</span>
    <span class="s1">decimal = </span><span class="s3">3</span>
    <span class="s1">res = numpy.array([</span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">12.</span><span class="s0">, </span><span class="s3">15.</span><span class="s0">, </span><span class="s1">])</span>
    <span class="s1">cen = numpy.array([</span><span class="s0">True, True, True, False </span><span class="s1">])</span>
    <span class="s1">rescol = </span><span class="s2">'value'</span>
    <span class="s1">cencol = </span><span class="s2">'qual'</span>
    <span class="s1">df = pandas.DataFrame({rescol: res</span><span class="s0">, </span><span class="s1">cencol: cen})</span>
    <span class="s1">expected_final = numpy.array([</span><span class="s3">0.5</span><span class="s0">,   </span><span class="s3">0.5</span><span class="s0">,   </span><span class="s3">6. </span><span class="s0">,  </span><span class="s3">15.</span><span class="s1">])</span>

    <span class="s1">expected_cohn = pandas.DataFrame({</span>
        <span class="s2">'nuncen_above'</span><span class="s1">: numpy.array([</span><span class="s3">0.</span><span class="s0">, </span><span class="s3">1.</span><span class="s0">, </span><span class="s1">numpy.nan])</span><span class="s0">,</span>
        <span class="s2">'nobs_below'</span><span class="s1">: numpy.array([</span><span class="s3">2.</span><span class="s0">, </span><span class="s3">3.</span><span class="s0">, </span><span class="s1">numpy.nan])</span><span class="s0">,</span>
        <span class="s2">'ncen_equal'</span><span class="s1">: numpy.array([</span><span class="s3">2.</span><span class="s0">, </span><span class="s3">1.</span><span class="s0">, </span><span class="s1">numpy.nan])</span><span class="s0">,</span>
        <span class="s2">'prob_exceedance'</span><span class="s1">: numpy.array([</span><span class="s3">0.25</span><span class="s0">, </span><span class="s3">0.25</span><span class="s0">, </span><span class="s3">0.</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">})</span>


<span class="s0">class </span><span class="s1">Test_ROS_MaxCen_GT_MaxUncen(Test_ROS_HelselAppendixB):</span>
    <span class="s1">res = numpy.array([</span>
        <span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">10.</span><span class="s0">, </span><span class="s3">10.</span><span class="s0">, </span><span class="s3">10.</span><span class="s0">,</span>
        <span class="s3">3.0</span><span class="s0">, </span><span class="s3">7.0</span><span class="s0">, </span><span class="s3">9.0</span><span class="s0">, </span><span class="s3">12.</span><span class="s0">, </span><span class="s3">15.</span><span class="s0">, </span><span class="s3">20.</span><span class="s0">, </span><span class="s3">27.</span><span class="s0">, </span><span class="s3">33.</span><span class="s0">, </span><span class="s3">50.</span><span class="s0">,</span>
        <span class="s3">60</span><span class="s0">, </span><span class="s3">70</span>
    <span class="s1">])</span>
    <span class="s1">cen = numpy.array([</span>
        <span class="s0">True, True, True, True, True, True, True, True, True,</span>
        <span class="s0">False, False, False, False, False, False, False,</span>
        <span class="s0">False, False, True, True</span>
    <span class="s1">])</span>


<span class="s0">class </span><span class="s1">Test_ROS_OnlyDL_GT_MaxUncen(Test_NoOp_ZeroND):</span>
    <span class="s1">numpy.random.seed(</span><span class="s3">0</span><span class="s1">)</span>
    <span class="s1">N = </span><span class="s3">20</span>
    <span class="s1">res =  [</span>
        <span class="s3">0.38</span><span class="s0">, </span><span class="s3">0.43</span><span class="s0">, </span><span class="s3">0.81</span><span class="s0">, </span><span class="s3">0.86</span><span class="s0">, </span><span class="s3">0.90</span><span class="s0">, </span><span class="s3">1.13</span><span class="s0">, </span><span class="s3">1.15</span><span class="s0">, </span><span class="s3">1.37</span><span class="s0">, </span><span class="s3">1.40</span><span class="s0">,</span>
        <span class="s3">1.49</span><span class="s0">, </span><span class="s3">1.51</span><span class="s0">, </span><span class="s3">1.56</span><span class="s0">, </span><span class="s3">2.14</span><span class="s0">, </span><span class="s3">2.59</span><span class="s0">, </span><span class="s3">2.66</span><span class="s0">, </span><span class="s3">4.28</span><span class="s0">, </span><span class="s3">4.46</span><span class="s0">, </span><span class="s3">5.84</span><span class="s0">,</span>
        <span class="s3">6.47</span><span class="s0">, </span><span class="s3">9.40</span><span class="s0">, </span><span class="s3">10.0</span><span class="s0">, </span><span class="s3">10.0</span>
    <span class="s1">]</span>
    <span class="s1">cen = ([</span><span class="s0">False</span><span class="s1">] * N) + [</span><span class="s0">True, True</span><span class="s1">]</span>
</pre>
</body>
</html>