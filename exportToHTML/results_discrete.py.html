<html>
<head>
<title>results_discrete.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #629755; font-style: italic;}
.s1 { color: #a9b7c6;}
.s2 { color: #cc7832;}
.s3 { color: #808080;}
.s4 { color: #6897bb;}
.s5 { color: #6a8759;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
results_discrete.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot; 
Test Results for discrete models from Stata 
&quot;&quot;&quot;</span>
<span class="s2">import </span><span class="s1">os</span>

<span class="s2">import </span><span class="s1">numpy </span><span class="s2">as </span><span class="s1">np</span>


<span class="s2">class </span><span class="s1">Namespace:</span>
    <span class="s2">pass</span>


<span class="s3"># Discrete Model Tests</span>
<span class="s3"># Note that there is a slight refactor of the classes, so that one dataset</span>
<span class="s3"># might be used for more than one model</span>

<span class="s1">cur_dir = os.path.abspath(os.path.dirname(__file__))</span>


<span class="s2">class </span><span class="s1">Anes:</span>
    <span class="s2">def </span><span class="s1">__init__(self):</span>
        <span class="s0">&quot;&quot;&quot;r 
        Results are from Stata 11 (checked vs R nnet package). 
        &quot;&quot;&quot;</span>
        <span class="s1">self.nobs = </span><span class="s4">944</span>

    <span class="s2">def </span><span class="s1">mnlogit_basezero():</span>
        <span class="s1">obj = Namespace()</span>
        <span class="s1">obj.nobs = </span><span class="s4">944</span>
        <span class="s1">params = [</span>
            <span class="s1">-</span><span class="s4">.01153598</span><span class="s2">, </span><span class="s4">.29771435</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.024945</span><span class="s2">, </span><span class="s4">.08249144</span><span class="s2">, </span><span class="s4">.00519655</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.37340167</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.08875065</span><span class="s2">, </span><span class="s4">.39166864</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.02289784</span><span class="s2">, </span><span class="s4">.18104276</span><span class="s2">,</span>
            <span class="s4">.04787398</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.2509132</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.1059667</span><span class="s2">, </span><span class="s4">.57345051</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.01485121</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.00715242</span><span class="s2">, </span><span class="s4">.05757516</span><span class="s2">, </span><span class="s1">-</span><span class="s4">3.6655835</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.0915567</span><span class="s2">, </span><span class="s4">1.2787718</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.00868135</span><span class="s2">, </span><span class="s4">.19982796</span><span class="s2">, </span><span class="s4">.08449838</span><span class="s2">, </span><span class="s1">-</span><span class="s4">7.6138431</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.0932846</span><span class="s2">,</span>
            <span class="s4">1.3469616</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.01790407</span><span class="s2">, </span><span class="s4">.21693885</span><span class="s2">, </span><span class="s4">.08095841</span><span class="s2">, </span><span class="s1">-</span><span class="s4">7.0604782</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.14088069</span><span class="s2">, </span><span class="s4">2.0700801</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.00943265</span><span class="s2">, </span><span class="s4">.3219257</span><span class="s2">, </span><span class="s4">.10889408</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">12.105751</span><span class="s1">]</span>
        <span class="s1">obj.params = np.reshape(params</span><span class="s2">, </span><span class="s1">(</span><span class="s4">6</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1</span><span class="s1">)</span><span class="s2">, </span><span class="s1">order=</span><span class="s5">'F'</span><span class="s1">)</span>
        <span class="s1">bse = [</span>
            <span class="s4">.0342823657</span><span class="s2">, </span><span class="s4">.093626795</span><span class="s2">, </span><span class="s4">.0065248584</span><span class="s2">, </span><span class="s4">.0735865799</span><span class="s2">,</span>
            <span class="s4">.0176336937</span><span class="s2">, </span><span class="s4">.6298376313</span><span class="s2">, </span><span class="s4">.0391615553</span><span class="s2">, </span><span class="s4">.1082386919</span><span class="s2">,</span>
            <span class="s4">.0079144618</span><span class="s2">, </span><span class="s4">.0852893563</span><span class="s2">, </span><span class="s4">.0222809297</span><span class="s2">, </span><span class="s4">.7631899491</span><span class="s2">,</span>
            <span class="s4">.0570382292</span><span class="s2">, </span><span class="s4">.1585481337</span><span class="s2">, </span><span class="s4">.0113313133</span><span class="s2">, </span><span class="s4">.1262913234</span><span class="s2">,</span>
            <span class="s4">.0336142088</span><span class="s2">, </span><span class="s4">1.156541492</span><span class="s2">, </span><span class="s4">.0437902764</span><span class="s2">, </span><span class="s4">.1288965854</span><span class="s2">,</span>
            <span class="s4">.0084187486</span><span class="s2">, </span><span class="s4">.0941250559</span><span class="s2">, </span><span class="s4">.0261963632</span><span class="s2">, </span><span class="s4">.9575809602</span><span class="s2">,</span>
            <span class="s4">.0393516553</span><span class="s2">, </span><span class="s4">.1171860107</span><span class="s2">, </span><span class="s4">.0076110152</span><span class="s2">, </span><span class="s4">.0850070091</span><span class="s2">,</span>
            <span class="s4">.0229760791</span><span class="s2">, </span><span class="s4">.8443638283</span><span class="s2">, </span><span class="s4">.042138047</span><span class="s2">, </span><span class="s4">.1434089089</span><span class="s2">,</span>
            <span class="s4">.0081338625</span><span class="s2">, </span><span class="s4">.0910979921</span><span class="s2">, </span><span class="s4">.025300888</span><span class="s2">, </span><span class="s4">1.059954821</span><span class="s1">]</span>
        <span class="s1">obj.bse = np.reshape(bse</span><span class="s2">, </span><span class="s1">(</span><span class="s4">6</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1</span><span class="s1">)</span><span class="s2">, </span><span class="s1">order=</span><span class="s5">'F'</span><span class="s1">)</span>
        <span class="s1">obj.yhat = np.loadtxt(os.path.join(cur_dir</span><span class="s2">, </span><span class="s5">'yhat_mnlogit.csv'</span><span class="s1">))</span>
        <span class="s1">obj.phat = np.loadtxt(os.path.join(cur_dir</span><span class="s2">, </span><span class="s5">'phat_mnlogit.csv'</span><span class="s1">))</span>
        <span class="s1">obj.cov_params = </span><span class="s2">None</span>
        <span class="s1">obj.llf = -</span><span class="s4">1461.922747312</span>
        <span class="s1">obj.llnull = -</span><span class="s4">1750.34670999</span>
        <span class="s1">obj.llr = </span><span class="s4">576.8479253554</span>
        <span class="s1">obj.llr_pvalue = </span><span class="s4">1.8223179e-102</span>
        <span class="s1">obj.prsquared = </span><span class="s4">.1647810465387</span>
        <span class="s1">obj.df_model = </span><span class="s4">30</span>
        <span class="s1">obj.df_resid = </span><span class="s4">944 </span><span class="s1">- </span><span class="s4">36</span>
        <span class="s1">obj.J = </span><span class="s4">7</span>
        <span class="s1">obj.K = </span><span class="s4">6</span>
        <span class="s1">obj.aic = </span><span class="s4">2995.84549462</span>
        <span class="s1">obj.bic = </span><span class="s4">3170.45003661</span>
        <span class="s1">z = [</span>
            <span class="s1">-</span><span class="s4">.3364988051</span><span class="s2">, </span><span class="s4">3.179798597</span><span class="s2">,  </span><span class="s1">-</span><span class="s4">3.823070772</span><span class="s2">, </span><span class="s4">1.121012042</span><span class="s2">,</span>
            <span class="s4">.2946945327</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.5928538661</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.266269864</span><span class="s2">, </span><span class="s4">3.618564069</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">2.893164162</span><span class="s2">, </span><span class="s4">2.122688754</span><span class="s2">, </span><span class="s4">2.148652536</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.949348555</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">1.857818873</span><span class="s2">, </span><span class="s4">3.616885888</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.310634214</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.0566342868</span><span class="s2">,</span>
            <span class="s4">1.712822091</span><span class="s2">, </span><span class="s1">-</span><span class="s4">3.169435381</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.090799808</span><span class="s2">, </span><span class="s4">9.920912816</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">1.031191864</span><span class="s2">, </span><span class="s4">2.123004903</span><span class="s2">, </span><span class="s4">3.225576554</span><span class="s2">, </span><span class="s1">-</span><span class="s4">7.951122047</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">2.370538224</span><span class="s2">, </span><span class="s4">11.49421878</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.352389066</span><span class="s2">, </span><span class="s4">2.552011323</span><span class="s2">,</span>
            <span class="s4">3.523595639</span><span class="s2">, </span><span class="s1">-</span><span class="s4">8.361890935</span><span class="s2">, </span><span class="s1">-</span><span class="s4">3.34331327</span><span class="s2">, </span><span class="s4">14.43480847</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">1.159676452</span><span class="s2">, </span><span class="s4">3.533839715</span><span class="s2">, </span><span class="s4">4.303962885</span><span class="s2">, </span><span class="s1">-</span><span class="s4">11.42100649</span><span class="s1">]</span>
        <span class="s1">obj.z = np.reshape(z</span><span class="s2">, </span><span class="s1">(</span><span class="s4">6</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1</span><span class="s1">)</span><span class="s2">, </span><span class="s1">order=</span><span class="s5">'F'</span><span class="s1">)</span>
        <span class="s1">pvalues = [</span>
            <span class="s4">0.7364947525</span><span class="s2">, </span><span class="s4">0.0014737744</span><span class="s2">, </span><span class="s4">0.0001317999</span><span class="s2">, </span><span class="s4">0.2622827367</span><span class="s2">,</span>
            <span class="s4">0.7682272401</span><span class="s2">, </span><span class="s4">0.5532789548</span><span class="s2">, </span><span class="s4">0.0234348654</span><span class="s2">, </span><span class="s4">0.0002962422</span><span class="s2">,</span>
            <span class="s4">0.0038138191</span><span class="s2">, </span><span class="s4">0.0337799420</span><span class="s2">, </span><span class="s4">0.0316619538</span><span class="s2">, </span><span class="s4">0.0031844460</span><span class="s2">,</span>
            <span class="s4">0.0631947400</span><span class="s2">, </span><span class="s4">0.0002981687</span><span class="s2">, </span><span class="s4">0.1899813744</span><span class="s2">, </span><span class="s4">0.9548365214</span><span class="s2">,</span>
            <span class="s4">0.0867452747</span><span class="s2">, </span><span class="s4">0.0015273542</span><span class="s2">, </span><span class="s4">0.0365460134</span><span class="s2">, </span><span class="s4">3.37654e-23</span><span class="s2">,</span>
            <span class="s4">0.3024508550</span><span class="s2">, </span><span class="s4">0.0337534410</span><span class="s2">, </span><span class="s4">0.0012571921</span><span class="s2">, </span><span class="s4">1.84830e-15</span><span class="s2">,</span>
            <span class="s4">0.0177622072</span><span class="s2">, </span><span class="s4">1.41051e-30</span><span class="s2">, </span><span class="s4">0.0186532528</span><span class="s2">, </span><span class="s4">0.0107103038</span><span class="s2">,</span>
            <span class="s4">0.0004257334</span><span class="s2">, </span><span class="s4">6.17209e-17</span><span class="s2">, </span><span class="s4">0.0008278439</span><span class="s2">, </span><span class="s4">3.12513e-47</span><span class="s2">,</span>
            <span class="s4">0.2461805610</span><span class="s2">, </span><span class="s4">0.0004095694</span><span class="s2">, </span><span class="s4">0.0000167770</span><span class="s2">, </span><span class="s4">3.28408e-30</span><span class="s1">]</span>
        <span class="s1">obj.pvalues = np.reshape(pvalues</span><span class="s2">, </span><span class="s1">(</span><span class="s4">6</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1</span><span class="s1">)</span><span class="s2">, </span><span class="s1">order=</span><span class="s5">'F'</span><span class="s1">)</span>
        <span class="s1">conf_int = [</span>
            <span class="s1">[[-</span><span class="s4">0.0787282</span><span class="s2">, </span><span class="s4">0.0556562</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[</span><span class="s4">0.1142092</span><span class="s2">, </span><span class="s4">0.4812195</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">0.0377335</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.0121565</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">0.0617356</span><span class="s2">, </span><span class="s4">0.2267185</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">0.0293649</span><span class="s2">, </span><span class="s4">0.0397580</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">1.6078610</span><span class="s2">, </span><span class="s4">0.8610574</span><span class="s1">]]</span><span class="s2">,</span>
            <span class="s1">[[-</span><span class="s4">0.1655059</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.0119954</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[</span><span class="s4">0.1795247</span><span class="s2">, </span><span class="s4">0.6038126</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">0.0384099</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.0073858</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[</span><span class="s4">0.0138787</span><span class="s2">, </span><span class="s4">0.3482068</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[</span><span class="s4">0.0042042</span><span class="s2">, </span><span class="s4">0.0915438</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">3.7467380</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.7550884</span><span class="s1">]]</span><span class="s2">,</span>
            <span class="s1">[[-</span><span class="s4">0.2177596</span><span class="s2">, </span><span class="s4">0.0058262</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[</span><span class="s4">0.2627019</span><span class="s2">,   </span><span class="s4">0.8841991</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">0.0370602</span><span class="s2">, </span><span class="s4">0.0073578</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">0.2546789</span><span class="s2">, </span><span class="s4">0.2403740</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">0.0083075</span><span class="s2">, </span><span class="s4">0.1234578</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">5.9323630</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.3988040</span><span class="s1">]]</span><span class="s2">,</span>
            <span class="s1">[[-</span><span class="s4">0.1773841</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.0057293</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[</span><span class="s4">1.0261390</span><span class="s2">, </span><span class="s4">1.5314040</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">0.0251818</span><span class="s2">, </span><span class="s4">0.0078191</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[</span><span class="s4">0.0153462</span><span class="s2">,    </span><span class="s4">0.3843097</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[</span><span class="s4">0.0331544</span><span class="s2">, </span><span class="s4">0.1358423</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">9.4906670</span><span class="s2">, </span><span class="s1">-</span><span class="s4">5.7370190</span><span class="s1">]]</span><span class="s2">,</span>
            <span class="s1">[[-</span><span class="s4">0.1704124</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.0161568</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[</span><span class="s4">1.1172810</span><span class="s2">,    </span><span class="s4">1.5766420</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">0.0328214</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.0029868</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[</span><span class="s4">0.0503282</span><span class="s2">, </span><span class="s4">0.3835495</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[</span><span class="s4">0.0359261</span><span class="s2">, </span><span class="s4">0.1259907</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">8.7154010</span><span class="s2">, </span><span class="s1">-</span><span class="s4">5.4055560</span><span class="s1">]]</span><span class="s2">,</span>
            <span class="s1">[[-</span><span class="s4">0.2234697</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.0582916</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[</span><span class="s4">1.7890040</span><span class="s2">, </span><span class="s4">2.3511560</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">0.0253747</span><span class="s2">, </span><span class="s4">0.0065094</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[</span><span class="s4">0.1433769</span><span class="s2">, </span><span class="s4">0.5004745</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[</span><span class="s4">0.0593053</span><span class="s2">, </span><span class="s4">0.1584829</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">14.1832200</span><span class="s2">, </span><span class="s1">-</span><span class="s4">10.0282800</span><span class="s1">]]]</span>
        <span class="s1">obj.conf_int = np.asarray(conf_int)</span>

        <span class="s3"># margins, dydx(*) predict(outcome(#))</span>
        <span class="s1">obj.margeff_dydx_overall = np.array([</span>
            <span class="s1">[</span><span class="s4">0.00868085993550</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.09779854015456</span><span class="s2">, </span><span class="s4">0.00272556969847</span><span class="s2">,</span>
             <span class="s1">-</span><span class="s4">0.01992376579372</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00603133322764</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.00699386733148</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.05022430802614</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00211003909752</span><span class="s2">,</span>
             <span class="s1">-</span><span class="s4">0.00536980000265</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00554366741814</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.00391040848820</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.02824717135857</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00100551299310</span><span class="s2">,</span>
             <span class="s4">0.00664337806861</span><span class="s2">, </span><span class="s4">0.00097987356999</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.00182580888015</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00573744730031</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00004249256428</span><span class="s2">,</span>
             <span class="s1">-</span><span class="s4">0.00546669558488</span><span class="s2">, </span><span class="s4">0.00054101121854</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.00098558129923</span><span class="s2">, </span><span class="s4">0.01985550937033</span><span class="s2">, </span><span class="s4">0.00047972250012</span><span class="s2">,</span>
             <span class="s4">0.00172605778905</span><span class="s2">, </span><span class="s4">0.00211291403209</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.00153469551647</span><span class="s2">, </span><span class="s4">0.03755346502013</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00068531143399</span><span class="s2">,</span>
             <span class="s4">0.00472471794347</span><span class="s2">, </span><span class="s4">0.00254733486106</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.00741820702809</span><span class="s2">, </span><span class="s4">0.12459834487569</span><span class="s2">, </span><span class="s4">0.00063806819375</span><span class="s2">,</span>
             <span class="s4">0.01766610701188</span><span class="s2">, </span><span class="s4">0.00539385283759</span><span class="s1">]</span>
        <span class="s1">]).T</span>
        <span class="s1">obj.margeff_dydx_overall_se = np.array([</span>
            <span class="s1">[</span><span class="s4">.0038581061</span><span class="s2">, </span><span class="s4">.0080471125</span><span class="s2">, </span><span class="s4">.0007068488</span><span class="s2">, </span><span class="s4">.0082318967</span><span class="s2">, </span><span class="s4">.0020261706</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.003904378</span><span class="s2">, </span><span class="s4">.0073600286</span><span class="s2">, </span><span class="s4">.000756431</span><span class="s2">, </span><span class="s4">.0084381578</span><span class="s2">, </span><span class="s4">.0020482238</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.003137126</span><span class="s2">, </span><span class="s4">.0056813182</span><span class="s2">, </span><span class="s4">.0006601377</span><span class="s2">, </span><span class="s4">.0068932588</span><span class="s2">, </span><span class="s4">.0018481806</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0019427783</span><span class="s2">, </span><span class="s4">.0031904763</span><span class="s2">, </span><span class="s4">.0003865411</span><span class="s2">, </span><span class="s4">.004361789</span><span class="s2">, </span><span class="s4">.0011523221</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0029863227</span><span class="s2">, </span><span class="s4">.0054076092</span><span class="s2">, </span><span class="s4">.0005886612</span><span class="s2">, </span><span class="s4">.0064426365</span><span class="s2">, </span><span class="s4">.0018886818</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0035806552</span><span class="s2">, </span><span class="s4">.0069497362</span><span class="s2">, </span><span class="s4">.000722511</span><span class="s2">, </span><span class="s4">.0078287717</span><span class="s2">, </span><span class="s4">.0022352393</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0033641608</span><span class="s2">, </span><span class="s4">.008376629</span><span class="s2">, </span><span class="s4">.0006774697</span><span class="s2">, </span><span class="s4">.0073505286</span><span class="s2">, </span><span class="s4">.0021660086</span><span class="s1">]</span>
        <span class="s1">]).T</span>

        <span class="s1">obj.margeff_dydx_mean = np.array([</span>
            <span class="s1">[</span><span class="s4">0.01149887431225</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.13784207091973</span><span class="s2">, </span><span class="s4">0.00273313385873</span><span class="s2">,</span>
                <span class="s1">-</span><span class="s4">0.02542974260540</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00855346837482</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.01114846831102</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.09864273512889</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00222435063712</span><span class="s2">,</span>
                <span class="s1">-</span><span class="s4">0.01214617126321</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00903581444579</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.00381702868421</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.05132297961269</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00116763216994</span><span class="s2">,</span>
                <span class="s4">0.00624203027060</span><span class="s2">, </span><span class="s4">0.00021912081810</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.00233455327258</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00928554037343</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00000206561214</span><span class="s2">,</span>
                <span class="s1">-</span><span class="s4">0.00775415690571</span><span class="s2">, </span><span class="s4">0.00060004460394</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.00352579921274</span><span class="s2">, </span><span class="s4">0.06412187169362</span><span class="s2">, </span><span class="s4">0.00073938948643</span><span class="s2">,</span>
                <span class="s4">0.00747778063206</span><span class="s2">, </span><span class="s4">0.00459965010365</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.00574308219449</span><span class="s2">, </span><span class="s4">0.11126535089794</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00057337915464</span><span class="s2">,</span>
                <span class="s4">0.01467424346725</span><span class="s2">, </span><span class="s4">0.00641760846097</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.00722687818452</span><span class="s2">, </span><span class="s4">0.12170608820238</span><span class="s2">, </span><span class="s4">0.00049490419675</span><span class="s2">,</span>
                <span class="s4">0.01693601418978</span><span class="s2">, </span><span class="s4">0.00575285798725</span><span class="s1">]]).T</span>
        <span class="s1">obj.margeff_dydx_mean_se = np.array([</span>
            <span class="s1">[</span><span class="s4">.0043729758</span><span class="s2">, </span><span class="s4">.0110343353</span><span class="s2">, </span><span class="s4">.0008149907</span><span class="s2">, </span><span class="s4">.0092551389</span><span class="s2">, </span><span class="s4">.0023752071</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.004875051</span><span class="s2">, </span><span class="s4">.0124746358</span><span class="s2">, </span><span class="s4">.0009613152</span><span class="s2">, </span><span class="s4">.0105665812</span><span class="s2">, </span><span class="s4">.0026524426</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0040718954</span><span class="s2">, </span><span class="s4">.0103613938</span><span class="s2">, </span><span class="s4">.0008554615</span><span class="s2">, </span><span class="s4">.0089931297</span><span class="s2">, </span><span class="s4">.0024374625</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0026430804</span><span class="s2">, </span><span class="s4">.0070845916</span><span class="s2">, </span><span class="s4">.0005364369</span><span class="s2">, </span><span class="s4">.0057654258</span><span class="s2">, </span><span class="s4">.0015988838</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0037798151</span><span class="s2">, </span><span class="s4">.0103849291</span><span class="s2">, </span><span class="s4">.0007393481</span><span class="s2">, </span><span class="s4">.0082021938</span><span class="s2">, </span><span class="s4">.0023489261</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0045654631</span><span class="s2">, </span><span class="s4">.0130329403</span><span class="s2">, </span><span class="s4">.0009128134</span><span class="s2">, </span><span class="s4">.0100053262</span><span class="s2">, </span><span class="s4">.0028048602</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0027682389</span><span class="s2">, </span><span class="s4">.0113292677</span><span class="s2">, </span><span class="s4">.0005325113</span><span class="s2">, </span><span class="s4">.0061289353</span><span class="s2">, </span><span class="s4">.0017330763</span><span class="s1">]</span>
        <span class="s1">]).T</span>

        <span class="s1">obj.margeff_dydx_dummy_overall = np.array([</span>
            <span class="s1">[</span><span class="s4">0.00549149574321</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.05348235321783</span><span class="s2">, </span><span class="s4">0.00298963549049</span><span class="s2">,</span>
             <span class="s1">-</span><span class="s4">0.01479461677951</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00332167981255</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.26502967041815</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.00345677928276</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00950322030929</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00189456107189</span><span class="s2">,</span>
             <span class="s4">0.00033893662061</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00314690167350</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.21040878091828</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.00645089013284</span><span class="s2">, </span><span class="s4">0.00401746940204</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00083948249351</span><span class="s2">,</span>
             <span class="s4">0.01114202556889</span><span class="s2">, </span><span class="s4">0.00277069841472</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.15967397659686</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.00215436802341</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00366545199370</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00000002297812</span><span class="s2">,</span>
             <span class="s1">-</span><span class="s4">0.00457368049644</span><span class="s2">, </span><span class="s4">0.00065303026027</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00094772782001</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.00058038428936</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00369080100124</span><span class="s2">, </span><span class="s4">0.00035948233235</span><span class="s2">,</span>
             <span class="s1">-</span><span class="s4">0.00018863693013</span><span class="s2">, </span><span class="s4">0.00079351293461</span><span class="s2">, </span><span class="s4">0.12640653743480</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.00217597030999</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.01279456622853</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00091882392767</span><span class="s2">,</span>
             <span class="s4">0.00001651192759</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00037998290789</span><span class="s2">, </span><span class="s4">0.27175070356670</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.00309932483642</span><span class="s2">, </span><span class="s4">0.07911868907484</span><span class="s2">, </span><span class="s4">0.00030378521102</span><span class="s2">,</span>
             <span class="s4">0.00805941631677</span><span class="s2">, </span><span class="s4">0.00263129901425</span><span class="s2">, </span><span class="s4">0.23790291475181</span><span class="s1">]]).T</span>
        <span class="s1">obj.margeff_dydx_dummy_overall_se = np.array([</span>
            <span class="s1">[</span><span class="s4">.0037314453</span><span class="s2">, </span><span class="s4">.0094102332</span><span class="s2">, </span><span class="s4">.000688838</span><span class="s2">, </span><span class="s4">.0079744554</span><span class="s2">, </span><span class="s4">.0019365971</span><span class="s2">,</span>
             <span class="s4">.0243914836</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0038215262</span><span class="s2">, </span><span class="s4">.0095938828</span><span class="s2">, </span><span class="s4">.0007410885</span><span class="s2">, </span><span class="s4">.008259353</span><span class="s2">, </span><span class="s4">.0019984087</span><span class="s2">,</span>
             <span class="s4">.0317628806</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0031045718</span><span class="s2">, </span><span class="s4">.00785814</span><span class="s2">, </span><span class="s4">.0006504353</span><span class="s2">, </span><span class="s4">.0067892866</span><span class="s2">, </span><span class="s4">.0018060332</span><span class="s2">,</span>
             <span class="s4">0.0262803561</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0019756086</span><span class="s2">, </span><span class="s4">.0051031194</span><span class="s2">, </span><span class="s4">.0003862449</span><span class="s2">, </span><span class="s4">.0043621673</span><span class="s2">, </span><span class="s4">.0011796953</span><span class="s2">,</span>
             <span class="s4">.0219999601</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0029714074</span><span class="s2">, </span><span class="s4">.0081732018</span><span class="s2">, </span><span class="s4">.0005715192</span><span class="s2">, </span><span class="s4">.0064742872</span><span class="s2">, </span><span class="s4">.0019130195</span><span class="s2">,</span>
             <span class="s4">.0331694192</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0034443743</span><span class="s2">, </span><span class="s4">.0097296187</span><span class="s2">, </span><span class="s4">.0006774867</span><span class="s2">, </span><span class="s4">.0075996454</span><span class="s2">, </span><span class="s4">.0021993881</span><span class="s2">,</span>
             <span class="s4">.038600835</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0032003518</span><span class="s2">, </span><span class="s4">.0098741227</span><span class="s2">, </span><span class="s4">.0006335772</span><span class="s2">, </span><span class="s4">.0070902078</span><span class="s2">, </span><span class="s4">.0021003227</span><span class="s2">,</span>
             <span class="s4">.0255727127</span><span class="s1">]]).T</span>

        <span class="s1">obj.margeff_eydx_dummy_overall = np.array([</span>
            <span class="s1">[</span><span class="s4">.03939188</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.65758371</span><span class="s2">, </span><span class="s4">.01750922</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.12131806</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.03613241</span><span class="s2">,</span>
             <span class="s1">-</span><span class="s4">3.2132513</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.02752366</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.383165</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.00830021</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.03652935</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.03286046</span><span class="s2">,</span>
             <span class="s1">-</span><span class="s4">1.8741853</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">.05006681</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.2719659</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.00626481</span><span class="s2">, </span><span class="s4">.06525323</span><span class="s2">, </span><span class="s4">.01012554</span><span class="s2">,</span>
             <span class="s1">-</span><span class="s4">2.0058029</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">.05239558</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.22549142</span><span class="s2">, </span><span class="s4">.00025015</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.13104416</span><span class="s2">, </span><span class="s4">.01114517</span><span class="s2">,</span>
             <span class="s1">-</span><span class="s4">.27052009</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">.00296374</span><span class="s2">, </span><span class="s4">.25627809</span><span class="s2">, </span><span class="s4">.00140513</span><span class="s2">, </span><span class="s4">.03358712</span><span class="s2">, </span><span class="s4">.02296041</span><span class="s2">,</span>
             <span class="s4">1.3302701</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.00328283</span><span class="s2">, </span><span class="s4">.2800168</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.0083912</span><span class="s2">, </span><span class="s4">.04332782</span><span class="s2">, </span><span class="s4">.01575863</span><span class="s2">,</span>
             <span class="s4">1.8441023</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">.03257068</span><span class="s2">, </span><span class="s4">.98346111</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.00122118</span><span class="s2">, </span><span class="s4">.10847807</span><span class="s2">, </span><span class="s4">.0406456</span><span class="s2">,</span>
             <span class="s4">2.9119099</span><span class="s1">]]).T</span>

        <span class="s1">obj.margeff_eydx_dummy_overall_se = np.array([</span>
            <span class="s1">[</span><span class="s4">.0272085605</span><span class="s2">, </span><span class="s4">.0777760394</span><span class="s2">, </span><span class="s4">.0052427952</span><span class="s2">, </span><span class="s4">.0584011446</span><span class="s2">, </span><span class="s4">.0148618012</span><span class="s2">,</span>
             <span class="s4">.5796921383</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0262290023</span><span class="s2">, </span><span class="s4">.0724479385</span><span class="s2">, </span><span class="s4">.005174736</span><span class="s2">, </span><span class="s4">.0567743614</span><span class="s2">, </span><span class="s4">.0144447083</span><span class="s2">,</span>
             <span class="s4">.3015738731</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0321415498</span><span class="s2">, </span><span class="s4">.0895589422</span><span class="s2">, </span><span class="s4">.0067480662</span><span class="s2">, </span><span class="s4">.0701460193</span><span class="s2">, </span><span class="s4">.0190451865</span><span class="s2">,</span>
             <span class="s4">.3904138447</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0511305319</span><span class="s2">, </span><span class="s4">.1420904068</span><span class="s2">, </span><span class="s4">.0102342163</span><span class="s2">, </span><span class="s4">.1129912244</span><span class="s2">, </span><span class="s4">.0308618233</span><span class="s2">,</span>
             <span class="s4">.3693799595</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0340186217</span><span class="s2">, </span><span class="s4">.0991711703</span><span class="s2">, </span><span class="s4">.0065812158</span><span class="s2">, </span><span class="s4">.0737441012</span><span class="s2">, </span><span class="s4">.0212966336</span><span class="s2">,</span>
             <span class="s4">.2346982385</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0289250212</span><span class="s2">, </span><span class="s4">.0840662279</span><span class="s2">, </span><span class="s4">.0056743561</span><span class="s2">, </span><span class="s4">.0631772185</span><span class="s2">, </span><span class="s4">.0177278895</span><span class="s2">,</span>
             <span class="s4">.2089516714</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0318251305</span><span class="s2">, </span><span class="s4">.1085637405</span><span class="s2">, </span><span class="s4">.0062400589</span><span class="s2">, </span><span class="s4">.0699123044</span><span class="s2">, </span><span class="s4">.0201045606</span><span class="s2">,</span>
             <span class="s4">.3727166284</span><span class="s1">]]).T</span>

        <span class="s3"># taken from gretl</span>
        <span class="s1">obj.resid = np.loadtxt(os.path.join(cur_dir</span><span class="s2">, </span><span class="s5">'mnlogit_resid.csv'</span><span class="s1">)</span><span class="s2">,</span>
                               <span class="s1">delimiter=</span><span class="s5">&quot;,&quot;</span><span class="s1">)</span>
        <span class="s2">return </span><span class="s1">obj</span>

    <span class="s1">mnlogit_basezero = mnlogit_basezero()</span>


<span class="s2">class </span><span class="s1">DiscreteL1:</span>
    <span class="s2">def </span><span class="s1">__init__(self):</span>
        <span class="s0">&quot;&quot;&quot; 
        Special results for L1 models 
        Uses the Spector data and a script to generate the baseline results 
        &quot;&quot;&quot;</span>
        <span class="s2">pass</span>

    <span class="s2">def </span><span class="s1">logit():</span>
        <span class="s0">&quot;&quot;&quot; 
        Results generated with: 
            data = sm.datasets.spector.load() 
            data.exog = sm.add_constant(data.exog, prepend=True) 
            alpha = 3 * np.array([0, 1, 1, 1]) 
            res2 = sm.Logit(data.endog, data.exog).fit_regularized( 
                method=&quot;l1&quot;, alpha=alpha, disp=0, trim_mode='size', 
                size_trim_tol=1e-5, acc=1e-10, maxiter=1000) 
        &quot;&quot;&quot;</span>
        <span class="s1">obj = Namespace()</span>
        <span class="s1">nan = np.nan</span>
        <span class="s1">obj.params = [-</span><span class="s4">4.10271595</span><span class="s2">,  </span><span class="s4">0.</span><span class="s2">, </span><span class="s4">0.15493781</span><span class="s2">, </span><span class="s4">0.</span><span class="s1">]</span>
        <span class="s1">obj.conf_int = [</span>
            <span class="s1">[-</span><span class="s4">9.15205122</span><span class="s2">,  </span><span class="s4">0.94661932</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[nan</span><span class="s2">, </span><span class="s1">nan]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.06539482</span><span class="s2">,  </span><span class="s4">0.37527044</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[nan</span><span class="s2">, </span><span class="s1">nan]]</span>
        <span class="s1">obj.bse = [</span><span class="s4">2.5762388</span><span class="s2">,          </span><span class="s1">nan</span><span class="s2">,  </span><span class="s4">0.11241668</span><span class="s2">,         </span><span class="s1">nan]</span>
        <span class="s1">obj.nnz_params = </span><span class="s4">2</span>
        <span class="s1">obj.aic = </span><span class="s4">42.091439368583671</span>
        <span class="s1">obj.bic = </span><span class="s4">45.022911174183122</span>
        <span class="s1">obj.cov_params = [</span>
            <span class="s1">[</span><span class="s4">6.63700638</span><span class="s2">, </span><span class="s1">nan</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.28636261</span><span class="s2">, </span><span class="s1">nan]</span><span class="s2">,</span>
            <span class="s1">[nan</span><span class="s2">, </span><span class="s1">nan</span><span class="s2">, </span><span class="s1">nan</span><span class="s2">, </span><span class="s1">nan]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.28636261</span><span class="s2">, </span><span class="s1">nan</span><span class="s2">,  </span><span class="s4">0.01263751</span><span class="s2">, </span><span class="s1">nan]</span><span class="s2">,</span>
            <span class="s1">[nan</span><span class="s2">, </span><span class="s1">nan</span><span class="s2">, </span><span class="s1">nan</span><span class="s2">, </span><span class="s1">nan]]</span>
        <span class="s2">return </span><span class="s1">obj</span>

    <span class="s1">logit = logit()</span>

    <span class="s2">def </span><span class="s1">sweep():</span>
        <span class="s0">&quot;&quot;&quot; 
        Results generated with 
            params = np.zeros((3, 4)) 
            alphas = np.array( 
                    [[0.1, 0.1, 0.1, 0.1], 
                        [0.4, 0.4, 0.5, 0.5], [0.5, 0.5, 1, 1]]) 
            model = sm.Logit(data.endog, data.exog) 
            for i in range(3): 
                alpha = alphas[i, :] 
                res2 = model.fit_regularized(method=&quot;l1&quot;, alpha=alpha, 
                                             disp=0, acc=1e-10, 
                                             maxiter=1000, trim_mode='off') 
                params[i, :] = res2.params 
            print(params) 
        &quot;&quot;&quot;</span>
        <span class="s1">obj = Namespace()</span>
        <span class="s1">obj.params = [</span>
            <span class="s1">[-</span><span class="s4">10.37593611</span><span class="s2">,   </span><span class="s4">2.27080968</span><span class="s2">,   </span><span class="s4">0.06670638</span><span class="s2">,   </span><span class="s4">2.05723691</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">5.32670811</span><span class="s2">,   </span><span class="s4">1.18216019</span><span class="s2">,   </span><span class="s4">0.01402395</span><span class="s2">,   </span><span class="s4">1.45178712</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">3.92630318</span><span class="s2">,   </span><span class="s4">0.90126958</span><span class="s2">,  </span><span class="s1">-</span><span class="s4">0.</span><span class="s2">,           </span><span class="s4">1.09498178</span><span class="s1">]]</span>
        <span class="s2">return </span><span class="s1">obj</span>

    <span class="s1">sweep = sweep()</span>

    <span class="s2">def </span><span class="s1">probit():</span>
        <span class="s0">&quot;&quot;&quot; 
        Results generated with 
            data = sm.datasets.spector.load() 
            data.exog = sm.add_constant(data.exog, prepend=True) 
            alpha = np.array([0.1, 0.2, 0.3, 10]) 
            res2 = sm.Probit(data.endog, data.exog).fit_regularized( 
                method=&quot;l1&quot;, alpha=alpha, disp=0, trim_mode='auto', 
                auto_trim_tol=0.02, acc=1e-10, maxiter=1000) 
        &quot;&quot;&quot;</span>
        <span class="s1">obj = Namespace()</span>
        <span class="s1">nan = np.nan</span>
        <span class="s1">obj.params = [-</span><span class="s4">5.40476992</span><span class="s2">,  </span><span class="s4">1.25018458</span><span class="s2">,  </span><span class="s4">0.04744558</span><span class="s2">,  </span><span class="s4">0.</span><span class="s1">]</span>
        <span class="s1">obj.conf_int = [</span>
            <span class="s1">[-</span><span class="s4">9.44077951</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.36876033</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.03716721</span><span class="s2">,  </span><span class="s4">2.46320194</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.09727571</span><span class="s2">,  </span><span class="s4">0.19216687</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[np.nan</span><span class="s2">,         </span><span class="s1">np.nan]]</span>
        <span class="s1">obj.bse = [</span><span class="s4">2.05922641</span><span class="s2">,  </span><span class="s4">0.61889778</span><span class="s2">,  </span><span class="s4">0.07383875</span><span class="s2">,         </span><span class="s1">np.nan]</span>
        <span class="s1">obj.nnz_params = </span><span class="s4">3</span>
        <span class="s1">obj.aic = </span><span class="s4">38.399773877542927</span>
        <span class="s1">obj.bic = </span><span class="s4">42.796981585942106</span>
        <span class="s1">obj.cov_params = [</span>
            <span class="s1">[</span><span class="s4">4.24041339</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.83432592</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.06827915</span><span class="s2">, </span><span class="s1">nan]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.83432592</span><span class="s2">,  </span><span class="s4">0.38303447</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.01700249</span><span class="s2">,         </span><span class="s1">nan]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.06827915</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.01700249</span><span class="s2">,  </span><span class="s4">0.00545216</span><span class="s2">,         </span><span class="s1">nan]</span><span class="s2">,</span>
            <span class="s1">[nan</span><span class="s2">,         </span><span class="s1">nan</span><span class="s2">,         </span><span class="s1">nan</span><span class="s2">,         </span><span class="s1">nan]]</span>
        <span class="s2">return </span><span class="s1">obj</span>

    <span class="s1">probit = probit()</span>

    <span class="s2">def </span><span class="s1">mnlogit():</span>
        <span class="s0">&quot;&quot;&quot; 
        Results generated with 
            anes_data = sm.datasets.anes96.load() 
            anes_exog = anes_data.exog 
            anes_exog = sm.add_constant(anes_exog, prepend=False) 
            mlogit_mod = sm.MNLogit(anes_data.endog, anes_exog) 
 
            alpha = 10 * np.ones((mlogit_mod.J - 1, mlogit_mod.K)) 
            alpha[-1, :] = 0 
            mlogit_l1_res = mlogit_mod.fit_regularized( 
            method='l1', alpha=alpha, trim_mode='auto', auto_trim_tol=0.02, 
            acc=1e-10) 
        &quot;&quot;&quot;</span>
        <span class="s1">obj = Namespace()</span>
        <span class="s1">obj.params = [</span>
            <span class="s1">[</span><span class="s4">0.00100163</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.05864195</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.06147822</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.04769671</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.05222987</span><span class="s2">,</span>
             <span class="s1">-</span><span class="s4">0.09522432</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.</span><span class="s2">,          </span><span class="s4">0.03186139</span><span class="s2">,  </span><span class="s4">0.12048999</span><span class="s2">,  </span><span class="s4">0.83211915</span><span class="s2">,  </span><span class="s4">0.92330292</span><span class="s2">,</span>
             <span class="s4">1.5680646</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.0218185</span><span class="s2">,  </span><span class="s1">-</span><span class="s4">0.01988066</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00808564</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00487463</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.01400173</span><span class="s2">,</span>
             <span class="s1">-</span><span class="s4">0.00562079</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.</span><span class="s2">,          </span><span class="s4">0.03306875</span><span class="s2">,  </span><span class="s4">0.</span><span class="s2">,          </span><span class="s4">0.02362861</span><span class="s2">,  </span><span class="s4">0.05486435</span><span class="s2">,</span>
             <span class="s4">0.14656966</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.</span><span class="s2">,          </span><span class="s4">0.04448213</span><span class="s2">,  </span><span class="s4">0.03252651</span><span class="s2">,  </span><span class="s4">0.07661761</span><span class="s2">,  </span><span class="s4">0.07265266</span><span class="s2">,</span>
             <span class="s4">0.0967758</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.90993803</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.50081247</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.08285102</span><span class="s2">, </span><span class="s1">-</span><span class="s4">5.26132955</span><span class="s2">, </span><span class="s1">-</span><span class="s4">4.86783179</span><span class="s2">,</span>
             <span class="s1">-</span><span class="s4">9.31537963</span><span class="s1">]]</span>
        <span class="s1">obj.conf_int = [</span>
            <span class="s1">[[-</span><span class="s4">0.0646223</span><span class="s2">,    </span><span class="s4">0.06662556</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[np.nan</span><span class="s2">,          </span><span class="s1">np.nan]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">0.03405931</span><span class="s2">,  </span><span class="s1">-</span><span class="s4">0.00957768</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[np.nan</span><span class="s2">,          </span><span class="s1">np.nan]</span><span class="s2">,</span>
             <span class="s1">[np.nan</span><span class="s2">,          </span><span class="s1">np.nan]</span><span class="s2">,</span>
             <span class="s1">[</span><span class="s4">0.26697895</span><span class="s2">,   </span><span class="s4">1.55289711</span><span class="s1">]]</span><span class="s2">,</span>

            <span class="s1">[[-</span><span class="s4">0.1337913</span><span class="s2">,    </span><span class="s4">0.01650741</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">0.14477255</span><span class="s2">,   </span><span class="s4">0.20849532</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">0.03500303</span><span class="s2">,  </span><span class="s1">-</span><span class="s4">0.00475829</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">0.11406121</span><span class="s2">,   </span><span class="s4">0.18019871</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[</span><span class="s4">0.00479741</span><span class="s2">,   </span><span class="s4">0.08416684</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">1.84626136</span><span class="s2">,   </span><span class="s4">0.84463642</span><span class="s1">]]</span><span class="s2">,</span>

            <span class="s1">[[-</span><span class="s4">0.17237962</span><span class="s2">,   </span><span class="s4">0.04942317</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">0.15146029</span><span class="s2">,   </span><span class="s4">0.39244026</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">0.02947379</span><span class="s2">,   </span><span class="s4">0.01330252</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[np.nan</span><span class="s2">,          </span><span class="s1">np.nan]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">0.02501483</span><span class="s2">,   </span><span class="s4">0.09006785</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">3.90379391</span><span class="s2">,  </span><span class="s1">-</span><span class="s4">0.26190812</span><span class="s1">]]</span><span class="s2">,</span>

            <span class="s1">[[-</span><span class="s4">0.12938296</span><span class="s2">,   </span><span class="s4">0.03398954</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[</span><span class="s4">0.62612955</span><span class="s2">,   </span><span class="s4">1.03810876</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">0.02046322</span><span class="s2">,   </span><span class="s4">0.01071395</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">0.13738534</span><span class="s2">,   </span><span class="s4">0.18464256</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[</span><span class="s4">0.03017236</span><span class="s2">,   </span><span class="s4">0.12306286</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">6.91227465</span><span class="s2">,  </span><span class="s1">-</span><span class="s4">3.61038444</span><span class="s1">]]</span><span class="s2">,</span>

            <span class="s1">[[-</span><span class="s4">0.12469773</span><span class="s2">,   </span><span class="s4">0.02023799</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[</span><span class="s4">0.742564</span><span class="s2">,     </span><span class="s4">1.10404183</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">0.02791975</span><span class="s2">,  </span><span class="s1">-</span><span class="s4">0.00008371</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">0.08491561</span><span class="s2">,   </span><span class="s4">0.19464431</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[</span><span class="s4">0.0332926</span><span class="s2">,    </span><span class="s4">0.11201273</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">6.29331126</span><span class="s2">,  </span><span class="s1">-</span><span class="s4">3.44235233</span><span class="s1">]]</span><span class="s2">,</span>

            <span class="s1">[[-</span><span class="s4">0.17165567</span><span class="s2">,  </span><span class="s1">-</span><span class="s4">0.01879296</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[</span><span class="s4">1.33994079</span><span class="s2">,   </span><span class="s4">1.79618841</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">0.02027503</span><span class="s2">,   </span><span class="s4">0.00903345</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">0.00267819</span><span class="s2">,   </span><span class="s4">0.29581751</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[</span><span class="s4">0.05343135</span><span class="s2">,   </span><span class="s4">0.14012026</span><span class="s1">]</span><span class="s2">,</span>
             <span class="s1">[-</span><span class="s4">11.10419107</span><span class="s2">,  </span><span class="s1">-</span><span class="s4">7.52656819</span><span class="s1">]]]</span>

        <span class="s1">obj.bse = [</span>
            <span class="s1">[</span><span class="s4">0.03348221</span><span class="s2">,  </span><span class="s4">0.03834221</span><span class="s2">,  </span><span class="s4">0.05658338</span><span class="s2">,  </span><span class="s4">0.04167742</span><span class="s2">,  </span><span class="s4">0.03697408</span><span class="s2">,</span>
             <span class="s4">0.03899631</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[np.nan</span><span class="s2">,  </span><span class="s4">0.09012101</span><span class="s2">,  </span><span class="s4">0.13875269</span><span class="s2">,  </span><span class="s4">0.10509867</span><span class="s2">,  </span><span class="s4">0.09221543</span><span class="s2">,</span>
             <span class="s4">0.11639184</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.00624543</span><span class="s2">,  </span><span class="s4">0.00771564</span><span class="s2">,  </span><span class="s4">0.01091253</span><span class="s2">,  </span><span class="s4">0.00795351</span><span class="s2">,  </span><span class="s4">0.00710116</span><span class="s2">,</span>
             <span class="s4">0.00747679</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[np.nan</span><span class="s2">,  </span><span class="s4">0.07506769</span><span class="s2">,         </span><span class="s1">np.nan</span><span class="s2">,  </span><span class="s4">0.08215148</span><span class="s2">,  </span><span class="s4">0.07131762</span><span class="s2">,</span>
             <span class="s4">0.07614826</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[np.nan</span><span class="s2">,  </span><span class="s4">0.02024768</span><span class="s2">,  </span><span class="s4">0.02935837</span><span class="s2">,  </span><span class="s4">0.02369699</span><span class="s2">,  </span><span class="s4">0.02008204</span><span class="s2">,</span>
             <span class="s4">0.02211492</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.32804638</span><span class="s2">,  </span><span class="s4">0.68646613</span><span class="s2">,  </span><span class="s4">0.92906957</span><span class="s2">,  </span><span class="s4">0.84233441</span><span class="s2">,  </span><span class="s4">0.72729881</span><span class="s2">,</span>
             <span class="s4">0.91267567</span><span class="s1">]]</span>

        <span class="s1">obj.nnz_params = </span><span class="s4">32</span>
        <span class="s1">obj.aic = </span><span class="s4">3019.4391360294126</span>
        <span class="s1">obj.bic = </span><span class="s4">3174.6431733460686</span>
        <span class="s2">return </span><span class="s1">obj</span>

    <span class="s1">mnlogit = mnlogit()</span>


<span class="s2">class </span><span class="s1">Spector:</span>
    <span class="s0">&quot;&quot;&quot; 
    Results are from Stata 11 
    &quot;&quot;&quot;</span>
    <span class="s2">def </span><span class="s1">__init__(self):</span>
        <span class="s1">self.nobs = </span><span class="s4">32</span>

    <span class="s2">def </span><span class="s1">logit():</span>
        <span class="s1">obj = Namespace()</span>
        <span class="s1">obj.nobs = </span><span class="s4">32</span>
        <span class="s1">obj.params = [</span><span class="s4">2.82611297201</span><span class="s2">, </span><span class="s4">.0951576702557</span><span class="s2">, </span><span class="s4">2.37868772835</span><span class="s2">,</span>
                      <span class="s1">-</span><span class="s4">13.0213483201</span><span class="s1">]</span>
        <span class="s1">obj.cov_params = [</span>
            <span class="s1">[</span><span class="s4">1.59502033639</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.036920566629</span><span class="s2">, </span><span class="s4">.427615725153</span><span class="s2">, </span><span class="s1">-</span><span class="s4">4.57347950298</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">.036920566629</span><span class="s2">, </span><span class="s4">.0200375937069</span><span class="s2">, </span><span class="s4">.0149126464275</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.346255757562</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.427615725153</span><span class="s2">,  </span><span class="s4">.0149126464275</span><span class="s2">, </span><span class="s4">1.13329715236</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.35916128427</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">4.57347950298</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.346255757562</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.35916128427</span><span class="s2">, </span><span class="s4">24.3179625937</span><span class="s1">]]</span>
        <span class="s1">obj.bse = [</span><span class="s4">1.26294114526</span><span class="s2">, </span><span class="s4">.141554207662</span><span class="s2">, </span><span class="s4">1.06456430165</span><span class="s2">, </span><span class="s4">4.93132462871</span><span class="s1">]</span>

        <span class="s1">obj.resid_pearson = [</span>
            <span class="s1">-</span><span class="s4">.1652382</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.2515266</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.4800059</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.1630655</span><span class="s2">,</span>
            <span class="s4">.8687437</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.1900454</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.165002</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.2331563</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.3535812</span><span class="s2">, </span><span class="s4">.6647838</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.1583799</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.4843181</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.689527</span><span class="s2">, </span><span class="s4">2.043449</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.7516119</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.1764176</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.2380445</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.2003426</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.199277</span><span class="s2">, </span><span class="s4">.7164842</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.255713</span><span class="s2">, </span><span class="s4">.3242821</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.5646816</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.400189</span><span class="s2">,</span>
            <span class="s4">.4392082</span><span class="s2">, </span><span class="s4">1.038473</span><span class="s2">, </span><span class="s4">.75747</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.6659256</span><span class="s2">,</span>
            <span class="s4">.4336657</span><span class="s2">, </span><span class="s4">.2404583</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.060033</span><span class="s2">, </span><span class="s4">2.829577</span><span class="s1">]</span>

        <span class="s1">obj.resid_dev = [</span>
            <span class="s1">-</span><span class="s4">.2321102</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.3502712</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.6439626</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.2290982</span><span class="s2">,</span>
            <span class="s4">1.060478</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.2663844</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.2317827</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.3253788</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.4853875</span><span class="s2">,</span>
            <span class="s4">.8555557</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.2225972</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.6491808</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.8819993</span><span class="s2">, </span><span class="s4">1.813269</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.9463985</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.247583</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.3320177</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.2805444</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.335131</span><span class="s2">,</span>
            <span class="s4">.9103027</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.3559217</span><span class="s2">, </span><span class="s4">.4471892</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.744005</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.955074</span><span class="s2">,</span>
            <span class="s4">.5939538</span><span class="s2">, </span><span class="s4">1.209638</span><span class="s2">, </span><span class="s4">.952332</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.8567857</span><span class="s2">, </span><span class="s4">.5870719</span><span class="s2">, </span><span class="s4">.335292</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">1.227311</span><span class="s2">, </span><span class="s4">2.096639</span><span class="s1">]</span>

        <span class="s3"># from gretl</span>
        <span class="s1">obj.resid_generalized = [</span>
            <span class="s1">-</span><span class="s4">0.026578</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.059501</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.187260</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">0.025902</span><span class="s2">,  </span><span class="s4">0.430107</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.034858</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.026504</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.051559</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">0.111127</span><span class="s2">,  </span><span class="s4">0.306489</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.024470</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.189997</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.322240</span><span class="s2">,</span>
            <span class="s4">0.806789</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.360990</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.030184</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.053626</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.038588</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">0.589872</span><span class="s2">,  </span><span class="s4">0.339214</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.061376</span><span class="s2">,  </span><span class="s4">0.095153</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.241772</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">0.852091</span><span class="s2">,  </span><span class="s4">0.161709</span><span class="s2">,  </span><span class="s4">0.518867</span><span class="s2">,  </span><span class="s4">0.364579</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.307219</span><span class="s2">,</span>
            <span class="s4">0.158296</span><span class="s2">,  </span><span class="s4">0.054660</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.529117</span><span class="s2">,  </span><span class="s4">0.888969</span><span class="s1">]</span>

        <span class="s1">obj.phat = np.array([</span>
            <span class="s4">.02657799236476</span><span class="s2">,</span>
            <span class="s4">.05950126051903</span><span class="s2">,</span>
            <span class="s4">.18725991249084</span><span class="s2">,</span>
            <span class="s4">.02590163610876</span><span class="s2">,</span>
            <span class="s4">.56989300251007</span><span class="s2">,</span>
            <span class="s4">.03485824912786</span><span class="s2">,</span>
            <span class="s4">.02650404907763</span><span class="s2">,</span>
            <span class="s4">.05155897513032</span><span class="s2">,</span>
            <span class="s4">.11112663894892</span><span class="s2">,</span>
            <span class="s4">.69351142644882</span><span class="s2">,</span>
            <span class="s4">.02447037212551</span><span class="s2">,</span>
            <span class="s4">.18999740481377</span><span class="s2">,</span>
            <span class="s4">.32223951816559</span><span class="s2">,</span>
            <span class="s4">.1932111531496</span><span class="s2">,</span>
            <span class="s4">.36098992824554</span><span class="s2">,</span>
            <span class="s4">.03018374741077</span><span class="s2">,</span>
            <span class="s4">.05362640321255</span><span class="s2">,</span>
            <span class="s4">.03858831897378</span><span class="s2">,</span>
            <span class="s4">.58987241983414</span><span class="s2">,</span>
            <span class="s4">.66078591346741</span><span class="s2">,</span>
            <span class="s4">.06137581542134</span><span class="s2">,</span>
            <span class="s4">.90484726428986</span><span class="s2">,</span>
            <span class="s4">.24177247285843</span><span class="s2">,</span>
            <span class="s4">.85209089517593</span><span class="s2">,</span>
            <span class="s4">.8382905125618</span><span class="s2">,</span>
            <span class="s4">.48113295435905</span><span class="s2">,</span>
            <span class="s4">.63542068004608</span><span class="s2">,</span>
            <span class="s4">.30721867084503</span><span class="s2">,</span>
            <span class="s4">.84170418977737</span><span class="s2">,</span>
            <span class="s4">.94534027576447</span><span class="s2">,</span>
            <span class="s4">.52911710739136</span><span class="s2">,</span>
            <span class="s4">.1110308393836</span><span class="s1">])</span>
        <span class="s1">obj.yhat = np.array([</span>
            <span class="s1">-</span><span class="s4">3.6007342338562</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">2.7604126930237</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">1.4679137468338</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">3.6272060871124</span><span class="s2">,</span>
            <span class="s4">.28141465783119</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">3.3209850788116</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">3.6035962104797</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">2.9120934009552</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">2.0792844295502</span><span class="s2">,</span>
            <span class="s4">.81658720970154</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">3.6855175495148</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">1.4500269889832</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.74349880218506</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">1.429278254509</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.57107019424438</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">3.4698030948639</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">2.8705959320068</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">3.2154531478882</span><span class="s2">,</span>
            <span class="s4">.36343798041344</span><span class="s2">,</span>
            <span class="s4">.66679841279984</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">2.7273993492126</span><span class="s2">,</span>
            <span class="s4">2.2522828578949</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">1.1429864168167</span><span class="s2">,</span>
            <span class="s4">1.7510952949524</span><span class="s2">,</span>
            <span class="s4">1.6455633640289</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.07550399750471</span><span class="s2">,</span>
            <span class="s4">.55554306507111</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.81315463781357</span><span class="s2">,</span>
            <span class="s4">1.6709630489349</span><span class="s2">,</span>
            <span class="s4">2.8504176139832</span><span class="s2">,</span>
            <span class="s4">.11660042405128</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">2.0802545547485</span><span class="s1">])</span>
        <span class="s1">obj.llf = -</span><span class="s4">12.8896334653335</span>
        <span class="s1">obj.llnull = -</span><span class="s4">20.5917296966173</span>
        <span class="s1">obj.df_model = </span><span class="s4">3</span>
        <span class="s1">obj.df_resid = </span><span class="s4">32 </span><span class="s1">- </span><span class="s4">4  </span><span class="s3"># TODO: is this right? not reported in stata</span>
        <span class="s1">obj.llr = </span><span class="s4">15.4041924625676</span>
        <span class="s1">obj.prsquared = </span><span class="s4">.374038332124624</span>
        <span class="s1">obj.llr_pvalue = </span><span class="s4">.00150187761112892</span>
        <span class="s1">obj.aic = </span><span class="s4">33.779266930667</span>
        <span class="s1">obj.bic = </span><span class="s4">39.642210541866</span>
        <span class="s1">obj.z = [</span><span class="s4">2.237723415</span><span class="s2">, </span><span class="s4">0.6722348408</span><span class="s2">, </span><span class="s4">2.234423721</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.640537645</span><span class="s1">]</span>
        <span class="s1">obj.conf_int = [</span>
            <span class="s1">[</span><span class="s4">.3507938</span><span class="s2">, </span><span class="s4">5.301432</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">.1822835</span><span class="s2">, </span><span class="s4">.3725988</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.29218</span><span class="s2">, </span><span class="s4">4.465195</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">22.68657</span><span class="s2">, </span><span class="s1">-</span><span class="s4">3.35613</span><span class="s1">]]</span>
        <span class="s1">obj.pvalues = [</span><span class="s4">.0252390974</span><span class="s2">, </span><span class="s4">.5014342039</span><span class="s2">, </span><span class="s4">.0254552063</span><span class="s2">, </span><span class="s4">.0082774596</span><span class="s1">]</span>

        <span class="s3"># taken from margins command</span>
        <span class="s1">obj.margeff_nodummy_dydx = [</span>
            <span class="s4">.36258084688424</span><span class="s2">, </span><span class="s4">.01220841099085</span><span class="s2">, </span><span class="s4">.30517768382304</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_dydx_se = [</span><span class="s4">.1094412</span><span class="s2">, </span><span class="s4">.0177942</span><span class="s2">, </span><span class="s4">.0923796</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_dydxmean = [</span>
            <span class="s4">.53385885781692</span><span class="s2">, </span><span class="s4">.01797548988961</span><span class="s2">, </span><span class="s4">.44933926079386</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_dydxmean_se = [</span><span class="s4">.237038</span><span class="s2">, </span><span class="s4">.0262369</span><span class="s2">, </span><span class="s4">.1967626</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_dydxmedian = [</span>
            <span class="s4">.25009492465091</span><span class="s2">, </span><span class="s4">.00842091261329</span><span class="s2">, </span><span class="s4">.2105003352955</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_dydxmedian_se = [</span><span class="s4">.1546708</span><span class="s2">, </span><span class="s4">.0134314</span><span class="s2">, </span><span class="s4">.0928183</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_dydxzero = [</span>
            <span class="s4">6.252993785e-06</span><span class="s2">, </span><span class="s4">2.105437138e-07</span><span class="s2">, </span><span class="s4">5.263030788e-06</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_dydxzero_se = [</span><span class="s4">.0000288</span><span class="s2">,  </span><span class="s4">9.24e-07</span><span class="s2">, </span><span class="s4">.000025</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_dyex = [</span>
            <span class="s4">1.1774000792198</span><span class="s2">, </span><span class="s4">.27896245178384</span><span class="s2">, </span><span class="s4">.16960002159996</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_dyex_se = [</span><span class="s4">.3616481</span><span class="s2">, </span><span class="s4">.4090679</span><span class="s2">, </span><span class="s4">.0635583</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_dyexmean = [</span>
            <span class="s4">1.6641381583512</span><span class="s2">, </span><span class="s4">.39433730945339</span><span class="s2">, </span><span class="s4">.19658592659731</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_dyexmean_se = [</span><span class="s4">.7388917</span><span class="s2">, </span><span class="s4">.5755722</span><span class="s2">, </span><span class="s4">.0860836</span><span class="s1">]</span>
        <span class="s3"># NOTE: PSI at median should be a NaN or 'omitted'</span>
        <span class="s1">obj.margeff_nodummy_dyexmedian = [</span><span class="s4">.76654095836557</span><span class="s2">, </span><span class="s4">.18947053379898</span><span class="s2">, </span><span class="s4">0</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_dyexmedian_se = [</span><span class="s4">.4740659</span><span class="s2">, </span><span class="s4">.302207</span><span class="s2">, </span><span class="s4">0</span><span class="s1">]</span>
        <span class="s3"># NOTE: all should be NaN</span>
        <span class="s3"># TODO: re above Note, since the values below are *not* NaN,</span>
        <span class="s3">#  should something be done about this?</span>
        <span class="s1">obj.margeff_nodummy_dyexzero = [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_dyexzero_se = [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s1">]</span>

        <span class="s1">obj.margeff_nodummy_eydx = [</span>
            <span class="s4">1.8546366266779</span><span class="s2">, </span><span class="s4">.06244722072812</span><span class="s2">, </span><span class="s4">1.5610138123033</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_eydx_se = [</span><span class="s4">.847903</span><span class="s2">, </span><span class="s4">.0930901</span><span class="s2">, </span><span class="s4">.7146715</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_eydxmean = [</span>
            <span class="s4">2.1116143062702</span><span class="s2">, </span><span class="s4">.0710998816585</span><span class="s2">, </span><span class="s4">1.7773072368626</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_eydxmean_se = [</span><span class="s4">1.076109</span><span class="s2">, </span><span class="s4">.1081501</span><span class="s2">, </span><span class="s4">.9120842</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_eydxmedian = [</span>
            <span class="s4">2.5488082240624</span><span class="s2">, </span><span class="s4">.0858205793373</span><span class="s2">, </span><span class="s4">2.1452853812126</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_eydxmedian_se = [</span><span class="s4">1.255377</span><span class="s2">, </span><span class="s4">.1283771</span><span class="s2">, </span><span class="s4">1.106872</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_eydxzero = [</span>
            <span class="s4">2.8261067189993</span><span class="s2">, </span><span class="s4">.0951574597115</span><span class="s2">, </span><span class="s4">2.3786824653103</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_eydxzero_se = [</span><span class="s4">1.262961</span><span class="s2">, </span><span class="s4">.1415544</span><span class="s2">, </span><span class="s4">1.064574</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_eyex = [</span>
            <span class="s4">5.4747106798973</span><span class="s2">, </span><span class="s4">1.3173389907576</span><span class="s2">, </span><span class="s4">.44600395466634</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_eyex_se = [</span><span class="s4">2.44682</span><span class="s2">, </span><span class="s4">1.943525</span><span class="s2">, </span><span class="s4">.1567618</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_eyexmean = [</span>
            <span class="s4">6.5822977203268</span><span class="s2">, </span><span class="s4">1.5597536538833</span><span class="s2">, </span><span class="s4">.77757191612739</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_eyexmean_se = [</span><span class="s4">3.354433</span><span class="s2">, </span><span class="s4">2.372543</span><span class="s2">, </span><span class="s4">.3990368</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_eyexmedian = [</span><span class="s4">7.8120973525952</span><span class="s2">, </span><span class="s4">1.9309630350892</span><span class="s2">, </span><span class="s4">0</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_eyexmedian_se = [</span><span class="s4">3.847731951</span><span class="s2">, </span><span class="s4">2.888485089</span><span class="s2">, </span><span class="s4">0</span><span class="s1">]</span>

        <span class="s1">obj.margeff_nodummy_eyexzero = [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_eyexzero_se = [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s1">]</span>

        <span class="s3"># for below GPA = 2.0, psi = 1</span>
        <span class="s1">obj.margeff_nodummy_atexog1 = [</span>
            <span class="s4">.1456333017086</span><span class="s2">, </span><span class="s4">.00490359933927</span><span class="s2">, </span><span class="s4">.12257689308426</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_atexog1_se = [</span><span class="s4">.145633</span><span class="s2">, </span><span class="s4">.0111226</span><span class="s2">, </span><span class="s4">.1777101</span><span class="s1">]</span>
        <span class="s3"># for below GPA at mean, tuce = 21, psi = 0</span>
        <span class="s1">obj.margeff_nodummy_atexog2 = [</span>
            <span class="s4">.25105129214546</span><span class="s2">, </span><span class="s4">.00845311433473</span><span class="s2">, </span><span class="s4">.2113052923675</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_atexog2_se = [</span><span class="s4">.1735778</span><span class="s2">, </span><span class="s4">.012017</span><span class="s2">, </span><span class="s4">.0971515</span><span class="s1">]</span>

        <span class="s3"># must get this from older margeff or i.psi then margins</span>
        <span class="s1">obj.margeff_dummy_dydx = [</span>
            <span class="s4">.36258084688424</span><span class="s2">, </span><span class="s4">.01220841099085</span><span class="s2">, </span><span class="s4">.35751515254729</span><span class="s1">]</span>
        <span class="s1">obj.margeff_dummy_dydx_se = [</span><span class="s4">.1094412</span><span class="s2">, </span><span class="s4">.0177942</span><span class="s2">, </span><span class="s4">.1420034</span><span class="s1">]</span>
        <span class="s1">obj.margeff_dummy_dydxmean = [</span>
            <span class="s4">.53385885781692</span><span class="s2">, </span><span class="s4">.01797548988961</span><span class="s2">, </span><span class="s4">.4564984096959</span><span class="s1">]</span>
        <span class="s1">obj.margeff_dummy_dydxmean_se = [</span><span class="s4">.237038</span><span class="s2">, </span><span class="s4">.0262369</span><span class="s2">, </span><span class="s4">.1810537</span><span class="s1">]</span>
        <span class="s3"># from margeff</span>
        <span class="s1">obj.margeff_dummy_count_dydx_median = [</span>
            <span class="s4">0.250110487483923</span><span class="s2">, </span><span class="s4">0.008426867847905</span><span class="s2">,  </span><span class="s4">0.441897738279663</span><span class="s1">]</span>
        <span class="s1">obj.margeff_dummy_count_dydx_median_se = [</span>
            <span class="s4">.1546736661</span><span class="s2">, </span><span class="s4">.0134551951</span><span class="s2">, </span><span class="s4">.1792363708</span><span class="s1">]</span>

        <span class="s3"># estimate with i.psi for the below then use margins</span>
        <span class="s1">obj.margeff_dummy_eydx = [</span>
            <span class="s4">1.8546366266779</span><span class="s2">, </span><span class="s4">.06244722072812</span><span class="s2">, </span><span class="s4">1.5549034398832</span><span class="s1">]</span>
        <span class="s1">obj.margeff_dummy_eydx_se = [</span><span class="s4">.847903</span><span class="s2">, </span><span class="s4">.0930901</span><span class="s2">, </span><span class="s4">.7283702</span><span class="s1">]</span>
        <span class="s3"># ie</span>
        <span class="s3">#  margins, eydx(*) at((mean) _all)</span>
        <span class="s1">obj.margeff_dummy_eydxmean = [</span>
            <span class="s4">2.1116143062702</span><span class="s2">, </span><span class="s4">.0710998816585</span><span class="s2">, </span><span class="s4">1.6631775707188</span><span class="s1">]</span>
        <span class="s1">obj.margeff_dummy_eydxmean_se = [</span><span class="s4">1.076109</span><span class="s2">, </span><span class="s4">.1081501</span><span class="s2">, </span><span class="s4">.801205</span><span class="s1">]</span>

        <span class="s3"># TODO: Should we remove the commented-out code below?</span>
        <span class="s3"># Factor variables not allowed in below</span>
        <span class="s3"># test raises</span>
        <span class="s3"># obj.margeff_dummy_dydxzero</span>
        <span class="s3"># obj.margeff_dummy_eydxmedian</span>
        <span class="s3"># obj.margeff_dummy_eydxzero</span>
        <span class="s3"># obj.margeff_dummy_dyex</span>
        <span class="s3"># obj.margeff_dummy_dyexmean</span>
        <span class="s3"># obj.margeff_dummy_dyexmedian</span>
        <span class="s3"># obj.margeff_dummy_dyexzero</span>
        <span class="s3"># obj.margeff_dummy_eyex</span>
        <span class="s3"># obj.margeff_count_dummy_dydx_median</span>
        <span class="s3"># obj.margeff_count_dummy_dydx_median_se</span>

        <span class="s3"># NOTE: need old version of margeff for nodisc but at option is broken</span>
        <span class="s3"># stata command is margeff, count nodisc</span>
        <span class="s3"># this can be replicated with the new results by margeff</span>
        <span class="s3"># and then using margins for the last value</span>
        <span class="s1">obj.margeff_count_dydx = [</span><span class="s4">.3625767598018</span><span class="s2">,  </span><span class="s4">.0122068569914</span><span class="s2">, </span><span class="s4">.3051777</span><span class="s1">]</span>
        <span class="s1">obj.margeff_count_dydx_se = [</span><span class="s4">.1094379569</span><span class="s2">, </span><span class="s4">.0177869773</span><span class="s2">, </span><span class="s4">.0923796</span><span class="s1">]</span>

        <span class="s3"># middle value taken from margeff rest from margins</span>
        <span class="s1">obj.margeff_count_dydxmean = [</span>
            <span class="s4">.5338588</span><span class="s2">,  </span><span class="s4">0.01797186545386</span><span class="s2">, </span><span class="s4">.4493393</span><span class="s1">]</span>
        <span class="s1">obj.margeff_count_dydxmean_se = [</span><span class="s4">.237038</span><span class="s2">, </span><span class="s4">.0262211</span><span class="s2">, </span><span class="s4">.1967626</span><span class="s1">]</span>

        <span class="s3"># with new version of margeff this is just a call to</span>
        <span class="s3"># margeff</span>
        <span class="s3"># mat list e(margeff_b), nonames format(%17.16g)</span>
        <span class="s1">obj.margeff_count_dummy_dydxoverall = [</span><span class="s4">.362576759801767</span><span class="s2">,</span>
                                               <span class="s4">.012206856991439</span><span class="s2">,</span>
                                               <span class="s4">.357515163621704</span><span class="s1">]</span>
        <span class="s3"># AFAICT, an easy way to get se is</span>
        <span class="s3"># mata</span>
        <span class="s3"># V = st_matrix(&quot;e(margeff_V)&quot;)</span>
        <span class="s3"># se = diagonal(cholesky(diag(V)))</span>
        <span class="s3"># last SE taken from margins with i.psi, do not know how they</span>
        <span class="s3"># do not know why margeff is different, but trust official results</span>
        <span class="s1">obj.margeff_count_dummy_dydxoverall_se = [</span><span class="s4">.1094379569</span><span class="s2">, </span><span class="s4">.0177869773</span><span class="s2">,</span>
                                                  <span class="s4">.1420034</span><span class="s1">]</span>

        <span class="s3"># from new margeff</span>
        <span class="s1">obj.margeff_count_dummy_dydxmean = [</span><span class="s4">0.533849340033768</span><span class="s2">,</span>
                                            <span class="s4">0.017971865453858</span><span class="s2">,</span>
                                            <span class="s4">0.456498405282412</span><span class="s1">]</span>
        <span class="s1">obj.margeff_count_dummy_dydxmean_se = [</span><span class="s4">.2370202503</span><span class="s2">, </span><span class="s4">.0262210796</span><span class="s2">,</span>
                                               <span class="s4">.1810536852</span><span class="s1">]</span>

        <span class="s3"># for below GPA = 2.0, psi = 1</span>
        <span class="s1">obj.margeff_dummy_atexog1 = [</span>
            <span class="s4">.1456333017086</span><span class="s2">, </span><span class="s4">.00490359933927</span><span class="s2">, </span><span class="s4">.0494715429937</span><span class="s1">]</span>
        <span class="s1">obj.margeff_dummy_atexog1_se = [</span><span class="s4">.145633</span><span class="s2">, </span><span class="s4">.0111226</span><span class="s2">, </span><span class="s4">.0731368</span><span class="s1">]</span>
        <span class="s3"># for below GPA at mean, tuce = 21, psi = 0</span>
        <span class="s1">obj.margeff_dummy_atexog2 = [</span><span class="s4">.25105129214546</span><span class="s2">,</span>
                                     <span class="s4">.00845311433473</span><span class="s2">,</span>
                                     <span class="s4">.44265645632553</span><span class="s1">]</span>
        <span class="s1">obj.margeff_dummy_atexog2_se = [</span><span class="s4">.1735778</span><span class="s2">, </span><span class="s4">.012017</span><span class="s2">, </span><span class="s4">.1811925</span><span class="s1">]</span>
        <span class="s3"># The test for the prediction table was taken from Gretl</span>
        <span class="s3"># Gretl Output matched the Stata output here for params and SE</span>
        <span class="s1">obj.pred_table = np.array([[</span><span class="s4">18</span><span class="s2">, </span><span class="s4">3</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s4">3</span><span class="s2">, </span><span class="s4">8</span><span class="s1">]])</span>
        <span class="s2">return </span><span class="s1">obj</span>

    <span class="s1">logit = logit()</span>

    <span class="s2">def </span><span class="s1">probit():</span>
        <span class="s1">obj = Namespace()</span>
        <span class="s1">obj.nobs = </span><span class="s4">32</span>
        <span class="s1">obj.params = [</span>
            <span class="s4">1.62581025407</span><span class="s2">, </span><span class="s4">.051728948442</span><span class="s2">, </span><span class="s4">1.42633236818</span><span class="s2">, </span><span class="s1">-</span><span class="s4">7.45232041607</span><span class="s1">]</span>
        <span class="s1">obj.cov_params = [</span>
            <span class="s1">[</span><span class="s4">.481472955383</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.01891350017</span><span class="s2">, </span><span class="s4">.105439226234</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.1696681354</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">.01891350017</span><span class="s2">, </span><span class="s4">.00703757594</span><span class="s2">, </span><span class="s4">.002471864882</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.101172838897</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.105439226234</span><span class="s2">, </span><span class="s4">.002471864882</span><span class="s2">, </span><span class="s4">.354070126802</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.594791776765</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">1.1696681354</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.101172838897</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.594791776765</span><span class="s2">, </span><span class="s4">6.46416639958</span><span class="s1">]]</span>
        <span class="s1">obj.bse = [</span><span class="s4">.693882522754</span><span class="s2">, </span><span class="s4">.083890261293</span><span class="s2">, </span><span class="s4">.595037920474</span><span class="s2">, </span><span class="s4">2.54247249731</span><span class="s1">]</span>
        <span class="s1">obj.llf = -</span><span class="s4">12.8188033249334</span>
        <span class="s1">obj.llnull = -</span><span class="s4">20.5917296966173</span>
        <span class="s1">obj.df_model = </span><span class="s4">3</span>
        <span class="s1">obj.df_resid = </span><span class="s4">32 </span><span class="s1">- </span><span class="s4">4</span>
        <span class="s1">obj.llr = </span><span class="s4">15.5458527433678</span>
        <span class="s1">obj.prsquared = </span><span class="s4">.377478069409622</span>
        <span class="s1">obj.llr_pvalue = </span><span class="s4">.00140489496775855</span>
        <span class="s1">obj.aic = </span><span class="s4">33.637606649867</span>
        <span class="s1">obj.bic = </span><span class="s4">39.500550261066</span>
        <span class="s1">obj.z = [</span><span class="s4">2.343062695</span><span class="s2">, </span><span class="s4">.6166263836</span><span class="s2">, </span><span class="s4">2.397044489</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.931131182</span><span class="s1">]</span>
        <span class="s1">obj.conf_int = [</span>
            <span class="s1">[</span><span class="s4">.2658255</span><span class="s2">, </span><span class="s4">2.985795</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">.1126929</span><span class="s2">, </span><span class="s4">.2161508</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.2600795</span><span class="s2">, </span><span class="s4">2.592585</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">12.43547</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.469166</span><span class="s1">]]</span>
        <span class="s1">obj.pvalues = [</span><span class="s4">.0191261688</span><span class="s2">, </span><span class="s4">.537481188</span><span class="s2">, </span><span class="s4">.0165279168</span><span class="s2">, </span><span class="s4">.0033773013</span><span class="s1">]</span>
        <span class="s1">obj.phat = [</span>
            <span class="s4">.0181707</span><span class="s2">, </span><span class="s4">.0530805</span><span class="s2">, </span><span class="s4">.1899263</span><span class="s2">, </span><span class="s4">.0185707</span><span class="s2">, </span><span class="s4">.5545748</span><span class="s2">,</span>
            <span class="s4">.0272331</span><span class="s2">, </span><span class="s4">.0185033</span><span class="s2">, </span><span class="s4">.0445714</span><span class="s2">, </span><span class="s4">.1088081</span><span class="s2">, </span><span class="s4">.6631207</span><span class="s2">,</span>
            <span class="s4">.0161024</span><span class="s2">, </span><span class="s4">.1935566</span><span class="s2">, </span><span class="s4">.3233282</span><span class="s2">, </span><span class="s4">.1951826</span><span class="s2">, </span><span class="s4">.3563406</span><span class="s2">,</span>
            <span class="s4">.0219654</span><span class="s2">, </span><span class="s4">.0456943</span><span class="s2">, </span><span class="s4">.0308513</span><span class="s2">, </span><span class="s4">.5934023</span><span class="s2">, </span><span class="s4">.6571863</span><span class="s2">,</span>
            <span class="s4">.0619288</span><span class="s2">, </span><span class="s4">.9045388</span><span class="s2">, </span><span class="s4">.2731908</span><span class="s2">, </span><span class="s4">.8474501</span><span class="s2">, </span><span class="s4">.8341947</span><span class="s2">,</span>
            <span class="s4">.488726</span><span class="s2">, </span><span class="s4">.6424073</span><span class="s2">, </span><span class="s4">.3286732</span><span class="s2">, </span><span class="s4">.8400168</span><span class="s2">, </span><span class="s4">.9522446</span><span class="s2">,</span>
            <span class="s4">.5399595</span><span class="s2">, </span><span class="s4">.123544</span><span class="s1">]</span>
        <span class="s1">obj.yhat = np.array([</span>
            <span class="s1">-</span><span class="s4">2.0930860042572</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">1.615691781044</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.87816804647446</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">2.0842070579529</span><span class="s2">,</span>
            <span class="s4">.13722851872444</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">1.9231110811234</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">2.0856919288635</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">1.6999372243881</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">1.2328916788101</span><span class="s2">,</span>
            <span class="s4">.42099541425705</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">2.1418602466583</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.86486464738846</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.45841211080551</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.85895526409149</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.36825761198997</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">2.0147502422333</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">1.6881184577942</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">1.8684275150299</span><span class="s2">,</span>
            <span class="s4">.23630557954311</span><span class="s2">,</span>
            <span class="s4">.40479621291161</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">1.538782119751</span><span class="s2">,</span>
            <span class="s4">1.3078554868698</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.60319095849991</span><span class="s2">,</span>
            <span class="s4">1.025558590889</span><span class="s2">,</span>
            <span class="s4">.97087496519089</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.02826354466379</span><span class="s2">,</span>
            <span class="s4">.36490100622177</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.44357979297638</span><span class="s2">,</span>
            <span class="s4">.99452745914459</span><span class="s2">,</span>
            <span class="s4">1.6670187711716</span><span class="s2">,</span>
            <span class="s4">.10033150017262</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">1.1574513912201</span><span class="s1">])</span>
        <span class="s1">obj.resid_dev = [</span>
            <span class="s1">-</span><span class="s4">.191509</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.3302762</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.6490455</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.1936247</span><span class="s2">, </span><span class="s4">1.085867</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.2349926</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.1932698</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.3019776</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.4799906</span><span class="s2">, </span><span class="s4">.9064196</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.1801855</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.6559291</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.8838201</span><span class="s2">, </span><span class="s4">1.807661</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.9387071</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.2107617</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.3058469</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.2503485</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.341589</span><span class="s2">, </span><span class="s4">.9162835</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.3575735</span><span class="s2">, </span><span class="s4">.447951</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.7988633</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.939208</span><span class="s2">, </span><span class="s4">.6021435</span><span class="s2">,</span>
            <span class="s4">1.196623</span><span class="s2">, </span><span class="s4">.9407793</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.8927477</span><span class="s2">, </span><span class="s4">.59048</span><span class="s2">, </span><span class="s4">.3128364</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">1.246147</span><span class="s2">, </span><span class="s4">2.045071</span><span class="s1">]</span>
        <span class="s3"># Stata does not have it, but I think it's just oversight</span>
        <span class="s1">obj.resid_pearson = </span><span class="s2">None</span>
        <span class="s3"># generalized residuals from gretl</span>
        <span class="s1">obj.resid_generalized = [</span>
            <span class="s1">-</span><span class="s4">0.045452</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.114220</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.334908</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">0.046321</span><span class="s2">,  </span><span class="s4">0.712624</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.064538</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">0.046175</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.098447</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.209349</span><span class="s2">,</span>
            <span class="s4">0.550593</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.040906</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.340339</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">0.530763</span><span class="s2">,  </span><span class="s4">1.413373</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.579170</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">0.053593</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.100556</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.071855</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">0.954156</span><span class="s2">,  </span><span class="s4">0.559294</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.130167</span><span class="s2">,</span>
            <span class="s4">0.187523</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.457597</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.545643</span><span class="s2">,</span>
            <span class="s4">0.298511</span><span class="s2">,  </span><span class="s4">0.815964</span><span class="s2">,  </span><span class="s4">0.581013</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">0.538579</span><span class="s2">,  </span><span class="s4">0.289631</span><span class="s2">,  </span><span class="s4">0.104405</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">0.862836</span><span class="s2">,  </span><span class="s4">1.652638</span><span class="s1">]</span>
        <span class="s1">obj.pred_table = np.array([[</span><span class="s4">18</span><span class="s2">, </span><span class="s4">3</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s4">3</span><span class="s2">, </span><span class="s4">8</span><span class="s1">]])</span>
        <span class="s2">return </span><span class="s1">obj</span>

    <span class="s1">probit = probit()</span>


<span class="s2">class </span><span class="s1">RandHIE:</span>
    <span class="s0">&quot;&quot;&quot; 
    Results obtained from Stata 11 
    &quot;&quot;&quot;</span>
    <span class="s2">def </span><span class="s1">__init__(self):</span>
        <span class="s1">self.nobs = </span><span class="s4">20190</span>

    <span class="s2">def </span><span class="s1">poisson():</span>
        <span class="s1">obj = Namespace()</span>
        <span class="s1">obj.nobs = </span><span class="s4">20190</span>
        <span class="s1">obj.params = [</span>
            <span class="s1">-</span><span class="s4">.052535114675</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.247086797633</span><span class="s2">, </span><span class="s4">.035290201794</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">.03457750643</span><span class="s2">, </span><span class="s4">.271713973711</span><span class="s2">, </span><span class="s4">.033941474461</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.012635035534</span><span class="s2">,</span>
            <span class="s4">.054056326828</span><span class="s2">, </span><span class="s4">.206115121809</span><span class="s2">, </span><span class="s4">.700352877227</span><span class="s1">]</span>
        <span class="s1">obj.cov_params = </span><span class="s2">None</span>
        <span class="s1">obj.bse = [</span>
            <span class="s4">.00288398915279</span><span class="s2">, </span><span class="s4">.01061725196728</span><span class="s2">, </span><span class="s4">.00182833684966</span><span class="s2">,</span>
            <span class="s4">.00161284852954</span><span class="s2">, </span><span class="s4">.01223913844387</span><span class="s2">, </span><span class="s4">.00056476496963</span><span class="s2">,</span>
            <span class="s4">.00925061122826</span><span class="s2">, </span><span class="s4">.01530987068312</span><span class="s2">, </span><span class="s4">.02627928267502</span><span class="s2">,</span>
            <span class="s4">.01116266712362</span><span class="s1">]</span>
        <span class="s1">predict = np.loadtxt(os.path.join(cur_dir</span><span class="s2">, </span><span class="s5">'yhat_poisson.csv'</span><span class="s1">)</span><span class="s2">,</span>
                             <span class="s1">delimiter=</span><span class="s5">&quot;,&quot;</span><span class="s1">)</span>
        <span class="s1">obj.phat = predict[:</span><span class="s2">, </span><span class="s4">0</span><span class="s1">]</span>
        <span class="s1">obj.yhat = predict[:</span><span class="s2">, </span><span class="s4">1</span><span class="s1">]</span>
        <span class="s1">obj.llf = -</span><span class="s4">62419.588535018</span>
        <span class="s1">obj.llnull = -</span><span class="s4">66647.181687959</span>
        <span class="s1">obj.df_model = </span><span class="s4">9</span>
        <span class="s1">obj.df_resid = obj.nobs - obj.df_model - </span><span class="s4">1</span>
        <span class="s1">obj.llr = </span><span class="s4">8455.186305881856</span>
        <span class="s1">obj.prsquared = </span><span class="s4">.0634324369893758</span>
        <span class="s1">obj.llr_pvalue = </span><span class="s4">0</span>
        <span class="s1">obj.aic = </span><span class="s4">124859.17707</span>
        <span class="s1">obj.bic = </span><span class="s4">124938.306497</span>
        <span class="s1">obj.z = [-</span><span class="s4">18.21612769</span><span class="s2">, </span><span class="s1">-</span><span class="s4">23.27219872</span><span class="s2">, </span><span class="s4">19.30180524</span><span class="s2">, </span><span class="s1">-</span><span class="s4">21.43878101</span><span class="s2">,</span>
                 <span class="s4">22.20041672</span><span class="s2">, </span><span class="s4">60.09840604</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.36585953</span><span class="s2">, </span><span class="s4">3.53081538</span><span class="s2">, </span><span class="s4">7.84325525</span><span class="s2">,</span>
                 <span class="s4">62.74063980</span><span class="s1">]</span>
        <span class="s1">obj.conf_int = [</span>
            <span class="s1">[-</span><span class="s4">.0581876</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.0468826</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.2678962</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.2262774</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.0317067</span><span class="s2">, </span><span class="s4">0.0388737</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.0377386</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.0314164</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.2477257</span><span class="s2">, </span><span class="s4">0.2957022</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.0328346</span><span class="s2">, </span><span class="s4">0.0350484</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.0307659</span><span class="s2">, </span><span class="s4">0.0054958</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.0240495</span><span class="s2">, </span><span class="s4">0.0840631</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.1546087</span><span class="s2">, </span><span class="s4">0.2576216</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.6784745</span><span class="s2">, </span><span class="s4">0.7222313</span><span class="s1">]]</span>
        <span class="s1">obj.pvalues = [</span>
            <span class="s4">3.84415e-74</span><span class="s2">, </span><span class="s4">8.4800e-120</span><span class="s2">, </span><span class="s4">5.18652e-83</span><span class="s2">, </span><span class="s4">5.8116e-102</span><span class="s2">,</span>
            <span class="s4">3.4028e-109</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">.1719830562</span><span class="s2">, </span><span class="s4">.0004142808</span><span class="s2">, </span><span class="s4">4.39014e-15</span><span class="s2">, </span><span class="s4">0</span><span class="s1">]</span>

        <span class="s3"># from stata</span>
        <span class="s3"># use margins and put i. in front of dummies</span>
        <span class="s1">obj.margeff_dummy_overall = [</span>
            <span class="s1">-</span><span class="s4">0.15027280560599</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.66568074771099</span><span class="s2">,</span>
            <span class="s4">0.10094500919706</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.09890639687842</span><span class="s2">,</span>
            <span class="s4">0.77721770295360</span><span class="s2">,  </span><span class="s4">0.09708707452600</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">0.03608195237609</span><span class="s2">, </span><span class="s4">0.15804581481115</span><span class="s2">,</span>
            <span class="s4">0.65104087597053</span><span class="s1">]</span>
        <span class="s1">obj.margeff_dummy_overall_se = [</span>
            <span class="s4">.008273103</span><span class="s2">,  </span><span class="s4">.0269856266</span><span class="s2">,</span>
            <span class="s4">.0052466639</span><span class="s2">, </span><span class="s4">.0046317555</span><span class="s2">, </span><span class="s4">.0351582169</span><span class="s2">, </span><span class="s4">.0016652181</span><span class="s2">,</span>
            <span class="s4">.0263736472</span><span class="s2">,   </span><span class="s4">.0457480115</span><span class="s2">,  </span><span class="s4">.0913901155</span><span class="s1">]</span>

        <span class="s3"># just use margins</span>
        <span class="s1">obj.margeff_nodummy_overall = [</span>
            <span class="s1">-</span><span class="s4">0.15027280560599</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.70677348928158</span><span class="s2">,</span>
            <span class="s4">0.10094500919705</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.09890639687842</span><span class="s2">,</span>
            <span class="s4">0.77721770295359</span><span class="s2">, </span><span class="s4">0.09708707452600</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">0.03614158359367</span><span class="s2">, </span><span class="s4">0.15462412033340</span><span class="s2">,</span>
            <span class="s4">0.58957704430148</span><span class="s1">]</span>
        <span class="s1">obj.margeff_nodummy_overall_se = [</span>
            <span class="s4">.008273103</span><span class="s2">, </span><span class="s4">.0305119343</span><span class="s2">,</span>
            <span class="s4">.0052466639</span><span class="s2">, </span><span class="s4">.0046317555</span><span class="s2">,</span>
            <span class="s4">.0351582168</span><span class="s2">, </span><span class="s4">.0016652181</span><span class="s2">,</span>
            <span class="s4">.0264611158</span><span class="s2">, </span><span class="s4">.0437974779</span><span class="s2">,</span>
            <span class="s4">.0752099666</span><span class="s1">]</span>
        <span class="s3"># taken from gretl</span>
        <span class="s1">obj.resid = np.loadtxt(os.path.join(cur_dir</span><span class="s2">, </span><span class="s5">'poisson_resid.csv'</span><span class="s1">)</span><span class="s2">,</span>
                               <span class="s1">delimiter=</span><span class="s5">&quot;,&quot;</span><span class="s1">)</span>
        <span class="s2">return </span><span class="s1">obj</span>

    <span class="s1">poisson = poisson()</span>

    <span class="s2">def </span><span class="s1">negativebinomial_nb2_bfgs():</span>
        <span class="s3"># R 2.15.1 MASS 7.3-22 glm.nb()</span>
        <span class="s1">obj = Namespace()</span>
        <span class="s1">obj.nobs = </span><span class="s4">20190</span>
        <span class="s1">obj.params = [</span>
            <span class="s1">-</span><span class="s4">0.0579469537244314</span><span class="s2">,</span>
            <span class="s1">-</span><span class="s4">0.267787718814838</span><span class="s2">, </span><span class="s4">0.0412060770911646</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.0381376804392121</span><span class="s2">,</span>
            <span class="s4">0.268915772213171</span><span class="s2">, </span><span class="s4">0.0381637446219235</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.0441338846217674</span><span class="s2">,</span>
            <span class="s4">0.0172521803400544</span><span class="s2">, </span><span class="s4">0.177960787443151</span><span class="s2">, </span><span class="s4">0.663556087183864</span><span class="s2">,</span>
            <span class="s3"># lnalpha from stata</span>
            <span class="s4">1.292953339909746</span><span class="s1">]</span>
        <span class="s3"># alpha and stderr from stata</span>
        <span class="s1">obj.lnalpha_std_err = </span><span class="s4">.0143932</span>
        <span class="s1">obj.lnalpha = </span><span class="s4">0.256929012449</span>
        <span class="s1">obj.bse = [</span>
            <span class="s4">0.00607085853920512</span><span class="s2">, </span><span class="s4">0.0226125368090765</span><span class="s2">,</span>
            <span class="s4">0.00405542008282773</span><span class="s2">, </span><span class="s4">0.00344455937127785</span><span class="s2">, </span><span class="s4">0.0298855063286547</span><span class="s2">,</span>
            <span class="s4">0.00142421904710063</span><span class="s2">, </span><span class="s4">0.0199374393307107</span><span class="s2">, </span><span class="s4">0.0358416931939136</span><span class="s2">,</span>
            <span class="s4">0.0741013728607101</span><span class="s2">, </span><span class="s4">0.0250354082637892</span><span class="s2">,</span>
            <span class="s3"># from stata</span>
            <span class="s4">.0186098</span><span class="s1">]</span>
        <span class="s1">obj.z = [</span>
            <span class="s1">-</span><span class="s4">9.54510030998327</span><span class="s2">, </span><span class="s1">-</span><span class="s4">11.8424447940467</span><span class="s2">,</span>
            <span class="s4">10.1607419822296</span><span class="s2">, </span><span class="s1">-</span><span class="s4">11.071860382846</span><span class="s2">, </span><span class="s4">8.99820030672628</span><span class="s2">,</span>
            <span class="s4">26.7962605187844</span><span class="s2">, </span><span class="s1">-</span><span class="s4">2.21361850384595</span><span class="s2">, </span><span class="s4">0.481343898758222</span><span class="s2">,</span>
            <span class="s4">2.40158556546135</span><span class="s2">, </span><span class="s4">26.5047040652267</span><span class="s1">]</span>
        <span class="s1">obj.pvalues = [</span>
            <span class="s4">1.35975947860026e-21</span><span class="s2">,</span>
            <span class="s4">2.35486776488278e-32</span><span class="s2">, </span><span class="s4">2.96808970292151e-24</span><span class="s2">,</span>
            <span class="s4">1.71796558863781e-28</span><span class="s2">, </span><span class="s4">2.2944789508802e-19</span><span class="s2">,</span>
            <span class="s4">3.57231639404726e-158</span><span class="s2">, </span><span class="s4">0.0268550333379416</span><span class="s2">, </span><span class="s4">0.630272102021494</span><span class="s2">,</span>
            <span class="s4">0.0163241908407114</span><span class="s2">, </span><span class="s4">8.55476622951356e-155</span><span class="s1">]</span>
        <span class="s1">obj.fittedvalues = [</span>
            <span class="s4">0.892904166867786</span><span class="s2">, </span><span class="s4">0.892904166867786</span><span class="s2">, </span><span class="s4">0.892904166867786</span><span class="s2">,</span>
            <span class="s4">0.892904166867786</span><span class="s2">, </span><span class="s4">0.892904166867786</span><span class="s2">, </span><span class="s4">0.937038051489553</span><span class="s2">,</span>
            <span class="s4">0.937038051489553</span><span class="s2">, </span><span class="s4">0.937038051489553</span><span class="s2">, </span><span class="s4">0.937038051489553</span><span class="s2">,</span>
            <span class="s4">0.937038051489553</span><span class="s1">]</span>
        <span class="s3"># obj.aic = 86789.3241530713    # This is what R reports</span>
        <span class="s1">obj.aic = </span><span class="s4">86789.32415307125484  </span><span class="s3"># from Stata</span>
        <span class="s1">obj.df_resid = </span><span class="s4">20180</span>
        <span class="s1">obj.df_model = </span><span class="s4">9</span>
        <span class="s3"># R conf_int: 1.96 * bse, not profile likelihood via R's confint()</span>
        <span class="s1">obj.conf_int = [</span>
                            <span class="s3"># from Stata</span>
                            <span class="s1">[-</span><span class="s4">.0698826</span><span class="s2">,   </span><span class="s1">-</span><span class="s4">.0460113</span><span class="s1">]</span><span class="s2">,</span>
                            <span class="s1">[-</span><span class="s4">.3122654</span><span class="s2">,   </span><span class="s1">-</span><span class="s4">.2233101</span><span class="s1">]</span><span class="s2">,</span>
                            <span class="s1">[</span><span class="s4">.0330781</span><span class="s2">,     </span><span class="s4">.049334</span><span class="s1">]</span><span class="s2">,</span>
                            <span class="s1">[-</span><span class="s4">.0448006</span><span class="s2">,   </span><span class="s1">-</span><span class="s4">.0314748</span><span class="s1">]</span><span class="s2">,</span>
                            <span class="s1">[</span><span class="s4">.2102246</span><span class="s2">,    </span><span class="s4">.3276069</span><span class="s1">]</span><span class="s2">,</span>
                            <span class="s1">[</span><span class="s4">.0352959</span><span class="s2">,    </span><span class="s4">.0410316</span><span class="s1">]</span><span class="s2">,</span>
                            <span class="s1">[-</span><span class="s4">.0834356</span><span class="s2">,   </span><span class="s1">-</span><span class="s4">.0048321</span><span class="s1">]</span><span class="s2">,</span>
                            <span class="s1">[-</span><span class="s4">.0535908</span><span class="s2">,    </span><span class="s4">.0880951</span><span class="s1">]</span><span class="s2">,</span>
                            <span class="s1">[</span><span class="s4">.0324115</span><span class="s2">,    </span><span class="s4">.3235101</span><span class="s1">]</span><span class="s2">,</span>
                            <span class="s1">[</span><span class="s4">.6150055</span><span class="s2">,    </span><span class="s4">.7121067</span><span class="s1">]</span><span class="s2">,</span>
                            <span class="s3"># from Stata</span>
                            <span class="s1">[</span><span class="s4">1.256989</span><span class="s2">, </span><span class="s4">1.329947</span><span class="s1">]</span>
        <span class="s1">]</span>
        <span class="s1">obj.bic = </span><span class="s4">86876.36652289562335  </span><span class="s3"># stata</span>
        <span class="s1">obj.llnull = -</span><span class="s4">44199.27443563430279  </span><span class="s3"># stata</span>
        <span class="s1">obj.llr = </span><span class="s4">1631.224718197351  </span><span class="s3"># stata</span>
        <span class="s1">obj.llf = -</span><span class="s4">43383.66207653563  </span><span class="s3"># stata</span>
        <span class="s1">obj.df_model = </span><span class="s4">9.0</span>
        <span class="s1">obj.llr_pvalue = </span><span class="s4">0.0</span>
        <span class="s2">return </span><span class="s1">obj</span>

    <span class="s1">negativebinomial_nb2_bfgs = negativebinomial_nb2_bfgs()</span>

    <span class="s2">def </span><span class="s1">negativebinomial_nb1_bfgs():</span>
        <span class="s3"># Unpublished implementation intended for R's COUNT package. Sent by</span>
        <span class="s3"># J.Hilbe (of Cambridge UP NBin book) and Andrew Robinson to Vincent</span>
        <span class="s3"># Arel-Bundock on 2012-12-06.</span>

        <span class="s3"># TODO: Does the from Stata comment below apply to the</span>
        <span class="s3">#  commented-out obj.params here or to everything below?  If the</span>
        <span class="s3">#  latter, then where do the commented-out version come from?</span>
        <span class="s3"># obj.params = [-0.065309744899923, -0.296016207412261,</span>
        <span class="s3">#        0.0411724098925173, -0.0320460533573259, 0.19083354227553,</span>
        <span class="s3">#        0.0318566232844115, -0.0331972813313092, -0.0484691550721231,</span>
        <span class="s3">#        0.111971860837541, 0.757560143822609,</span>
        <span class="s3">#        3.73086958562569]</span>
        <span class="s3"># from Stata</span>
        <span class="s1">obj = Namespace()</span>
        <span class="s1">obj.nobs = </span><span class="s4">20190</span>
        <span class="s1">obj.params = [-</span><span class="s4">.065317260803762961</span><span class="s2">,  </span><span class="s1">-</span><span class="s4">.296023807893893376</span><span class="s2">,</span>
                      <span class="s4">.041187021258044826</span><span class="s2">,  </span><span class="s1">-</span><span class="s4">.032028789543547605</span><span class="s2">,</span>
                      <span class="s4">.19065933246421754</span><span class="s2">,   </span><span class="s4">.031871625115758778</span><span class="s2">,</span>
                      <span class="s1">-</span><span class="s4">.033250849053302826</span><span class="s2">,   </span><span class="s1">-</span><span class="s4">.04850769174426571</span><span class="s2">,</span>
                      <span class="s4">.111813637465757343</span><span class="s2">, </span><span class="s4">.757277086555503409</span><span class="s2">,</span>
                      <span class="s4">3.731151380800305</span><span class="s1">]</span>
        <span class="s3"># lnalpha and lnalpha_std_err are from stata</span>
        <span class="s1">obj.lnalpha = </span><span class="s4">1.316716867203</span>
        <span class="s1">obj.lnalpha_std_err = </span><span class="s4">.0168876692</span>
        <span class="s1">obj.bse = [</span>
            <span class="s4">0.00536019929563678</span><span class="s2">,</span>
            <span class="s4">0.0196998350459769</span><span class="s2">, </span><span class="s4">0.00335779098766272</span><span class="s2">, </span><span class="s4">0.00301145915122889</span><span class="s2">,</span>
            <span class="s4">0.0237984097096245</span><span class="s2">, </span><span class="s4">0.00107360844112751</span><span class="s2">, </span><span class="s4">0.0167174614755359</span><span class="s2">,</span>
            <span class="s4">0.0298037989274781</span><span class="s2">, </span><span class="s4">0.0546838603596457</span><span class="s2">, </span><span class="s4">0.0214703279904911</span><span class="s2">,</span>
            <span class="s4">0.0630011409376052</span><span class="s1">]</span>
        <span class="s1">obj.z = [</span>
            <span class="s1">-</span><span class="s4">12.1842008660173</span><span class="s2">, </span><span class="s1">-</span><span class="s4">15.0263292419148</span><span class="s2">,</span>
            <span class="s4">12.2617548393554</span><span class="s2">, </span><span class="s1">-</span><span class="s4">10.6413707601675</span><span class="s2">, </span><span class="s4">8.0187518663633</span><span class="s2">,</span>
            <span class="s4">29.6724784046551</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.98578482623631</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.62627439508848</span><span class="s2">,</span>
            <span class="s4">2.04762173155154</span><span class="s2">, </span><span class="s4">35.2840508145997</span><span class="s2">,</span>

            <span class="s3"># From R, this is alpha/bse(alpha)</span>
            <span class="s4">59.2190796881069</span>

            <span class="s3"># taken from Stata even though they do not report it</span>
            <span class="s3"># lnalpha/bse(lnalpha)</span>
            <span class="s3"># 77.968995</span>
        <span class="s1">]</span>

        <span class="s1">obj.conf_int = [</span>
            <span class="s1">[-</span><span class="s4">0.075815736</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.0548037543</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.334627884</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.2574045307</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.034591140</span><span class="s2">, </span><span class="s4">0.0477536802</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.037948513</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.0261435934</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.144188659</span><span class="s2">, </span><span class="s4">0.2374784253</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.029752351</span><span class="s2">, </span><span class="s4">0.0339608958</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.065963506</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.0004310568</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.106884601</span><span class="s2">, </span><span class="s4">0.0099462908</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.004791495</span><span class="s2">, </span><span class="s4">0.2191522271</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">3.607387349</span><span class="s2">, </span><span class="s4">3.8543518219</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.715478301</span><span class="s2">, </span><span class="s4">0.7996419867</span><span class="s1">]]</span>
        <span class="s3"># from Stata</span>
        <span class="s1">obj.llf = -</span><span class="s4">43278.75612911823</span>
        <span class="s1">obj.llnull = -</span><span class="s4">44199.2744356343</span>
        <span class="s1">obj.llr = </span><span class="s4">1841.036613032149</span>
        <span class="s1">obj.aic = </span><span class="s4">86579.51225823645655</span>
        <span class="s1">obj.bic = </span><span class="s4">86666.55462806082505</span>
        <span class="s1">obj.llr_pvalue = </span><span class="s4">0.0</span>
        <span class="s1">obj.df_model = </span><span class="s4">9.0</span>
        <span class="s1">obj.df_resid = </span><span class="s4">20180.0</span>
        <span class="s3"># Smoke tests TODO: check against other stats package</span>
        <span class="s1">obj.pvalues = [</span>
            <span class="s4">3.65557865e-034</span><span class="s2">,   </span><span class="s4">5.24431864e-051</span><span class="s2">,</span>
            <span class="s4">1.42921171e-034</span><span class="s2">, </span><span class="s4">2.09797259e-026</span><span class="s2">,   </span><span class="s4">1.15949461e-015</span><span class="s2">,</span>
            <span class="s4">1.56785415e-193</span><span class="s2">, </span><span class="s4">4.71746349e-002</span><span class="s2">,   </span><span class="s4">1.04731854e-001</span><span class="s2">,</span>
            <span class="s4">4.07534831e-002</span><span class="s2">, </span><span class="s4">1.95504975e-272</span><span class="s2">,   </span><span class="s4">0.00000000e+000</span><span class="s1">]</span>
        <span class="s1">obj.conf_int = [</span>
            <span class="s1">[-</span><span class="s4">.0758236</span><span class="s2">,    </span><span class="s1">-</span><span class="s4">.054811</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">.3346363</span><span class="s2">,   </span><span class="s1">-</span><span class="s4">.2574113</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0346053</span><span class="s2">,    </span><span class="s4">.0477687</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">.0379314</span><span class="s2">,   </span><span class="s1">-</span><span class="s4">.0261261</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.1440119</span><span class="s2">,    </span><span class="s4">.2373067</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0297667</span><span class="s2">,    </span><span class="s4">.0339766</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">.0660178</span><span class="s2">,   </span><span class="s1">-</span><span class="s4">.0004839</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">.1069241</span><span class="s2">,    </span><span class="s4">.0099087</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0046266</span><span class="s2">,    </span><span class="s4">.2190007</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.7151889</span><span class="s2">,    </span><span class="s4">.7993652</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s3"># from stata for alpha no lnalpha</span>
            <span class="s1">[</span><span class="s4">3.609675</span><span class="s2">,    </span><span class="s4">3.856716</span><span class="s1">]]</span>
        <span class="s3">#   [1.28360034e+00,   1.34979803e+00]]</span>
        <span class="s1">obj.fittedvalues = [</span>
            <span class="s4">0.8487497</span><span class="s2">,   </span><span class="s4">0.8487497</span><span class="s2">,   </span><span class="s4">0.8487497</span><span class="s2">,   </span><span class="s4">0.8487497</span><span class="s2">,</span>
            <span class="s4">0.8487497</span><span class="s2">,  </span><span class="s4">0.88201746</span><span class="s2">,  </span><span class="s4">0.88201746</span><span class="s2">,  </span><span class="s4">0.88201746</span><span class="s2">,  </span><span class="s4">0.88201746</span><span class="s2">,</span>
            <span class="s4">0.88201746</span><span class="s1">]</span>
        <span class="s2">return </span><span class="s1">obj</span>

    <span class="s1">negativebinomial_nb1_bfgs = negativebinomial_nb1_bfgs()</span>

    <span class="s2">def </span><span class="s1">negativebinomial_geometric_bfgs():</span>
        <span class="s3"># Smoke tests TODO: Cross check with other stats package</span>
        <span class="s1">obj = Namespace()</span>
        <span class="s1">obj.nobs = </span><span class="s4">20190</span>
        <span class="s1">obj.params = [</span>
            <span class="s1">-</span><span class="s4">0.05768894</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.26646696</span><span class="s2">,  </span><span class="s4">0.04088528</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.03795503</span><span class="s2">,</span>
            <span class="s4">0.26885821</span><span class="s2">, </span><span class="s4">0.03802523</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.04308456</span><span class="s2">,  </span><span class="s4">0.01931675</span><span class="s2">,  </span><span class="s4">0.18051684</span><span class="s2">,</span>
            <span class="s4">0.66469896</span><span class="s1">]</span>
        <span class="s1">obj.bse = [</span>
            <span class="s4">0.00553867</span><span class="s2">,  </span><span class="s4">0.02061988</span><span class="s2">,  </span><span class="s4">0.00375937</span><span class="s2">,  </span><span class="s4">0.0030924</span><span class="s2">,</span>
            <span class="s4">0.02701658</span><span class="s2">, </span><span class="s4">0.00132201</span><span class="s2">,  </span><span class="s4">0.01821646</span><span class="s2">,  </span><span class="s4">0.03271784</span><span class="s2">,  </span><span class="s4">0.06666231</span><span class="s2">,</span>
            <span class="s4">0.02250053</span><span class="s1">]</span>
        <span class="s1">obj.pvalues = [</span>
            <span class="s4">2.10310916e-025</span><span class="s2">,   </span><span class="s4">3.34666368e-038</span><span class="s2">, </span><span class="s4">1.50697768e-027</span><span class="s2">,</span>
            <span class="s4">1.25468406e-034</span><span class="s2">,   </span><span class="s4">2.48155744e-023</span><span class="s2">, </span><span class="s4">6.18745348e-182</span><span class="s2">,</span>
            <span class="s4">1.80230194e-002</span><span class="s2">,   </span><span class="s4">5.54919603e-001</span><span class="s2">,   </span><span class="s4">6.77044178e-003</span><span class="s2">,</span>
            <span class="s4">8.44913440e-192</span><span class="s1">]</span>
        <span class="s1">obj.z = [-</span><span class="s4">10.41567024</span><span class="s2">, </span><span class="s1">-</span><span class="s4">12.92281571</span><span class="s2">, </span><span class="s4">10.8755779</span><span class="s2">,  </span><span class="s1">-</span><span class="s4">12.27364916</span><span class="s2">,</span>
                 <span class="s4">9.95160202</span><span class="s2">,  </span><span class="s4">28.76323587</span><span class="s2">,  </span><span class="s1">-</span><span class="s4">2.36514487</span><span class="s2">,   </span><span class="s4">0.59040434</span><span class="s2">,</span>
                 <span class="s4">2.70792943</span><span class="s2">,  </span><span class="s4">29.54148082</span><span class="s1">]</span>
        <span class="s1">obj.aic = </span><span class="s4">87101.159433012392  </span><span class="s3"># old value 87101.160011780419</span>
        <span class="s1">obj.bic = </span><span class="s4">87180.288860125467  </span><span class="s3"># old value 87180.289438893495</span>
        <span class="s1">obj.df_model = </span><span class="s4">9.0</span>
        <span class="s1">obj.df_resid = </span><span class="s4">20180.0</span>
        <span class="s1">obj.llf = -</span><span class="s4">43540.58000589021</span>
        <span class="s1">obj.llnull = -</span><span class="s4">44586.650971362695  </span><span class="s3"># old value -44199.27443567125</span>
        <span class="s1">obj.llr = </span><span class="s4">2092.1425097129977  </span><span class="s3"># old value 1317.3888595620811</span>
        <span class="s1">obj.llr_pvalue = </span><span class="s4">0  </span><span class="s3"># old value 5.4288002863296022e-278</span>
        <span class="s1">obj.fittedvalues = [</span>
            <span class="s4">0.89348994</span><span class="s2">,  </span><span class="s4">0.89348994</span><span class="s2">,  </span><span class="s4">0.89348994</span><span class="s2">,</span>
            <span class="s4">0.89348994</span><span class="s2">,  </span><span class="s4">0.89348994</span><span class="s2">, </span><span class="s4">0.9365745</span><span class="s2">,   </span><span class="s4">0.9365745</span><span class="s2">,   </span><span class="s4">0.9365745</span><span class="s2">,</span>
            <span class="s4">0.9365745</span><span class="s2">,   </span><span class="s4">0.9365745</span><span class="s1">]</span>
        <span class="s1">obj.conf_int = [</span>
            <span class="s1">[-</span><span class="s4">0.06854453</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.04683335</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.30688118</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.22605273</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.03351706</span><span class="s2">,  </span><span class="s4">0.04825351</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.04401602</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.03189404</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.21590669</span><span class="s2">,  </span><span class="s4">0.32180972</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.03543415</span><span class="s2">,  </span><span class="s4">0.04061632</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.07878816</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.00738096</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.04480903</span><span class="s2">,  </span><span class="s4">0.08344253</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.04986111</span><span class="s2">,  </span><span class="s4">0.31117258</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.62059873</span><span class="s2">,  </span><span class="s4">0.70879919</span><span class="s1">]]</span>
        <span class="s2">return </span><span class="s1">obj</span>

    <span class="s1">negativebinomial_geometric_bfgs = negativebinomial_geometric_bfgs()</span>

    <span class="s2">def </span><span class="s1">generalizedpoisson_gp2():</span>
        <span class="s3"># Stata gnpoisson function</span>
        <span class="s1">obj = Namespace()</span>
        <span class="s1">obj.nobs = </span><span class="s4">20190</span>
        <span class="s1">obj.llf = -</span><span class="s4">43326.42720093228</span>
        <span class="s1">obj.params = [-</span><span class="s4">0.0604495342</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.277717228</span><span class="s2">, </span><span class="s4">0.0438136144</span><span class="s2">,</span>
                      <span class="s1">-</span><span class="s4">0.0395811744</span><span class="s2">,  </span><span class="s4">0.273044906</span><span class="s2">, </span><span class="s4">0.0399108677</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.0552626543</span><span class="s2">,</span>
                      <span class="s1">-</span><span class="s4">0.001227569488</span><span class="s2">, </span><span class="s4">0.151980519</span><span class="s2">, </span><span class="s4">0.651125316</span><span class="s2">, </span><span class="s4">0.448085318</span><span class="s1">]</span>
        <span class="s1">obj.lnalpha_std_err = </span><span class="s4">0.0125607</span>
        <span class="s1">obj.lnalpha = -</span><span class="s4">0.8027716</span>
        <span class="s1">obj.bse = [</span><span class="s4">0.00634704</span><span class="s2">, </span><span class="s4">0.02381906</span><span class="s2">, </span><span class="s4">0.00443871</span><span class="s2">, </span><span class="s4">0.00355094</span><span class="s2">,</span>
                   <span class="s4">0.0334247</span><span class="s2">, </span><span class="s4">0.00166303</span><span class="s2">, </span><span class="s4">0.02102142</span><span class="s2">, </span><span class="s4">0.0390845</span><span class="s2">,</span>
                   <span class="s4">0.087821</span><span class="s2">, </span><span class="s4">0.02626823</span><span class="s2">,  </span><span class="s4">0.00562825</span><span class="s1">]</span>
        <span class="s1">obj.df_model = </span><span class="s4">9</span>
        <span class="s1">obj.aic = </span><span class="s4">86674.854401865</span>
        <span class="s1">obj.conf_int = [</span>
            <span class="s1">[-</span><span class="s4">0.07288951</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.04800956</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.32440173</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.23103272</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.03511389</span><span class="s2">,  </span><span class="s4">0.05251333</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.04654088</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.03262147</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.20753371</span><span class="s2">,  </span><span class="s4">0.33855610</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.03665139</span><span class="s2">,  </span><span class="s4">0.04317034</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.09646387</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.01406144</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.07783191</span><span class="s2">,  </span><span class="s4">0.07537652</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.02014548</span><span class="s2">,  </span><span class="s4">0.32410651</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.59964053</span><span class="s2">,  </span><span class="s4">0.70261011</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.43718883</span><span class="s2">,  </span><span class="s4">0.45925338</span><span class="s1">]</span>
        <span class="s1">]</span>
        <span class="s1">obj.bic = </span><span class="s4">86761.896771689</span>
        <span class="s1">obj.wald_pvalue = </span><span class="s4">4.8795019354e-254</span>
        <span class="s1">obj.wald_statistic = </span><span class="s4">1206.46339591254</span>
        <span class="s2">return </span><span class="s1">obj</span>

    <span class="s1">generalizedpoisson_gp2 = generalizedpoisson_gp2()</span>

    <span class="s2">def </span><span class="s1">zero_inflated_poisson_logit():</span>
        <span class="s1">obj = Namespace()</span>
        <span class="s1">obj.nobs = </span><span class="s4">20190</span>
        <span class="s1">obj.params = [</span><span class="s4">.1033783</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.045983</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.0821979</span><span class="s2">, </span><span class="s4">.0085692</span><span class="s2">,</span>
                      <span class="s1">-</span><span class="s4">.0267957</span><span class="s2">, </span><span class="s4">1.482363</span><span class="s1">]</span>
        <span class="s1">obj.llf = -</span><span class="s4">57005.72199826186</span>
        <span class="s1">obj.bse = [</span><span class="s4">0.0079912</span><span class="s2">, </span><span class="s4">0.02235510</span><span class="s2">, </span><span class="s4">.0107145</span><span class="s2">, </span><span class="s4">0.0018697</span><span class="s2">,</span>
                   <span class="s4">0.0014121</span><span class="s2">, </span><span class="s4">0.0085915</span><span class="s1">]</span>
        <span class="s1">obj.conf_int = [</span>
            <span class="s1">[</span><span class="s4">0.0877159</span><span class="s2">,  </span><span class="s4">0.1190408</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">1.089798</span><span class="s2">,  </span><span class="s1">-</span><span class="s4">1.002167</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.1031979</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.061198</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.0049045</span><span class="s2">,  </span><span class="s4">0.0122338</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.0295635</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.024028</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">1.465524</span><span class="s2">,   </span><span class="s4">1.499202</span><span class="s1">]]</span>
        <span class="s1">obj.aic = </span><span class="s4">114023.444</span>
        <span class="s1">obj.bic = </span><span class="s4">114070.9</span>
        <span class="s2">return </span><span class="s1">obj</span>

    <span class="s1">zero_inflated_poisson_logit = zero_inflated_poisson_logit()</span>

    <span class="s2">def </span><span class="s1">zero_inflated_poisson_probit():</span>
        <span class="s1">obj = Namespace()</span>
        <span class="s1">obj.nobs = </span><span class="s4">20190</span>
        <span class="s1">obj.params = [</span><span class="s4">.0622534</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.6429324</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.0821788</span><span class="s2">, </span><span class="s4">.0085673</span><span class="s2">,</span>
                      <span class="s1">-</span><span class="s4">.0267952</span><span class="s2">, </span><span class="s4">1.482369</span><span class="s1">]</span>
        <span class="s1">obj.llf = -</span><span class="s4">57006.05</span>
        <span class="s1">obj.bse = [</span><span class="s4">.0048228</span><span class="s2">, </span><span class="s4">.0132516</span><span class="s2">, </span><span class="s4">.0107142</span><span class="s2">, </span><span class="s4">.0018697</span><span class="s2">,</span>
                   <span class="s4">.0014121</span><span class="s2">, </span><span class="s4">.0085913</span><span class="s1">]</span>
        <span class="s1">obj.conf_int = [</span>
            <span class="s1">[</span><span class="s4">0.0528009</span><span class="s2">,  </span><span class="s4">.0717058</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.6689051</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.6169597</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.1031783</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.0611793</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">0.0049027</span><span class="s2">,  </span><span class="s4">.0122319</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">0.0295629</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.0240275</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">1.46553</span><span class="s2">,   </span><span class="s4">1.499208</span><span class="s1">]]</span>
        <span class="s1">obj.aic = </span><span class="s4">114024.1</span>
        <span class="s1">obj.bic = </span><span class="s4">114071.6</span>
        <span class="s2">return </span><span class="s1">obj</span>

    <span class="s1">zero_inflated_poisson_probit = zero_inflated_poisson_probit()</span>

    <span class="s2">def </span><span class="s1">zero_inflated_poisson_offset():</span>
        <span class="s1">obj = Namespace()</span>
        <span class="s1">obj.nobs = </span><span class="s4">20190</span>
        <span class="s1">obj.params = [</span><span class="s4">.1052014</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.082434</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.0922822</span><span class="s2">, </span><span class="s4">.0115868</span><span class="s2">,</span>
                      <span class="s1">-</span><span class="s4">.0283842</span><span class="s2">, </span><span class="s4">1.347514</span><span class="s1">]</span>
        <span class="s1">obj.llf = -</span><span class="s4">58207.67</span>
        <span class="s1">obj.bse = [</span><span class="s4">.0081836</span><span class="s2">, </span><span class="s4">.0230043</span><span class="s2">, </span><span class="s4">.0107788</span><span class="s2">, </span><span class="s4">.0018687</span><span class="s2">,</span>
                   <span class="s4">.0014162</span><span class="s2">, </span><span class="s4">.0086309</span><span class="s1">]</span>
        <span class="s1">obj.conf_int = [</span>
            <span class="s1">[</span><span class="s4">.0891619</span><span class="s2">,   </span><span class="s4">.1212409</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">1.127522</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1.037347</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">.1134082</span><span class="s2">,  </span><span class="s1">-</span><span class="s4">.0711561</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">.0079242</span><span class="s2">,   </span><span class="s4">.0152494</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[-</span><span class="s4">.0311599</span><span class="s2">,  </span><span class="s1">-</span><span class="s4">.0256085</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s4">1.330598</span><span class="s2">,  </span><span class="s4">1.36443</span><span class="s1">]]</span>
        <span class="s1">obj.aic = </span><span class="s4">116427.3</span>
        <span class="s1">obj.bic = </span><span class="s4">116474.8</span>
        <span class="s2">return </span><span class="s1">obj</span>

    <span class="s1">zero_inflated_poisson_offset = zero_inflated_poisson_offset()</span>

    <span class="s2">def </span><span class="s1">zero_inflated_generalized_poisson():</span>
        <span class="s1">obj = Namespace()</span>
        <span class="s1">obj.nobs = </span><span class="s4">20190</span>
        <span class="s1">obj.params = [</span><span class="s4">3.57337</span><span class="s2">, </span><span class="s1">-</span><span class="s4">17.95797</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.21380</span><span class="s2">, </span><span class="s4">0.03847</span><span class="s2">,</span>
                      <span class="s1">-</span><span class="s4">0.05348</span><span class="s2">, </span><span class="s4">1.15666</span><span class="s2">, </span><span class="s4">1.36468</span><span class="s1">]</span>
        <span class="s1">obj.llf = -</span><span class="s4">43630.6</span>
        <span class="s1">obj.bse = [</span><span class="s4">1.66109</span><span class="s2">, </span><span class="s4">7.62052</span><span class="s2">, </span><span class="s4">0.02066</span><span class="s2">, </span><span class="s4">0.00339</span><span class="s2">,</span>
                   <span class="s4">0.00289</span><span class="s2">, </span><span class="s4">0.01680</span><span class="s2">, </span><span class="s4">0.01606</span><span class="s1">]</span>
        <span class="s1">obj.aic = </span><span class="s4">87275</span>
        <span class="s2">return </span><span class="s1">obj</span>

    <span class="s1">zero_inflated_generalized_poisson = zero_inflated_generalized_poisson()</span>

    <span class="s2">def </span><span class="s1">zero_inflated_negative_binomial():</span>
        <span class="s1">obj = Namespace()</span>
        <span class="s1">obj.params = [</span><span class="s4">1.883859</span><span class="s2">, </span><span class="s1">-</span><span class="s4">10.280888</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.204769</span><span class="s2">, </span><span class="s4">1.137985</span><span class="s2">, </span><span class="s4">1.344457</span><span class="s1">]</span>
        <span class="s1">obj.llf = -</span><span class="s4">44077.91</span>
        <span class="s1">obj.bse = [</span><span class="s4">0.3653</span><span class="s2">, </span><span class="s4">1.6694</span><span class="s2">, </span><span class="s4">0.02178</span><span class="s2">, </span><span class="s4">0.01163</span><span class="s2">, </span><span class="s4">0.0217496</span><span class="s1">]</span>
        <span class="s1">obj.aic = </span><span class="s4">88165.81</span>
        <span class="s2">return </span><span class="s1">obj</span>

    <span class="s1">zero_inflated_negative_binomial = zero_inflated_negative_binomial()</span>

    <span class="s2">def </span><span class="s1">truncated_poisson(self):</span>
        <span class="s1">self.params = [</span><span class="s4">.000241</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.0002085</span><span class="s2">, </span><span class="s4">.0059419</span><span class="s2">, </span><span class="s4">.0016508</span><span class="s2">,  </span><span class="s4">2.289668</span><span class="s1">]</span>
        <span class="s1">self.llf = -</span><span class="s4">11091.36</span>
        <span class="s1">self.bse = [</span><span class="s4">.0042718</span><span class="s2">, </span><span class="s4">.0157994</span><span class="s2">, </span><span class="s4">.002791</span><span class="s2">, </span><span class="s4">.0023491</span><span class="s2">, </span><span class="s4">.0123182</span><span class="s1">]</span>
        <span class="s1">self.conf_int = [[-</span><span class="s4">.0081316</span><span class="s2">,  </span><span class="s4">.0086136</span><span class="s1">]</span><span class="s2">,</span>
                         <span class="s1">[-</span><span class="s4">.0311747</span><span class="s2">,  </span><span class="s4">.0307577</span><span class="s1">]</span><span class="s2">,</span>
                         <span class="s1">[</span><span class="s4">0.0004716</span><span class="s2">,  </span><span class="s4">.0114122</span><span class="s1">]</span><span class="s2">,</span>
                         <span class="s1">[-</span><span class="s4">.0029532</span><span class="s2">,  </span><span class="s4">.0062549</span><span class="s1">]</span><span class="s2">,</span>
                         <span class="s1">[</span><span class="s4">2.265525</span><span class="s2">,  </span><span class="s4">2.313812</span><span class="s1">]]</span>
        <span class="s1">self.aic = </span><span class="s4">22192.72</span>
        <span class="s1">self.bic = </span><span class="s4">22222.87</span>

    <span class="s2">def </span><span class="s1">zero_truncated_poisson(self):</span>
        <span class="s1">self.params = [-</span><span class="s4">.0095444</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.07581</span><span class="s2">, </span><span class="s4">.0080299</span><span class="s2">, </span><span class="s1">-</span><span class="s4">.022879</span><span class="s2">, </span><span class="s4">1.486142</span><span class="s1">]</span>
        <span class="s1">self.llf = -</span><span class="s4">44570.853</span>
        <span class="s1">self.bse = [</span><span class="s4">.0029817</span><span class="s2">, </span><span class="s4">.0109677</span><span class="s2">, </span><span class="s4">.0019165</span><span class="s2">, </span><span class="s4">.0016393</span><span class="s2">, </span><span class="s4">.0085697</span><span class="s1">]</span>
        <span class="s1">self.conf_int = [[-</span><span class="s4">.0153884</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.0037005</span><span class="s1">]</span><span class="s2">,</span>
                         <span class="s1">[-</span><span class="s4">.0973064</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.0543137</span><span class="s1">]</span><span class="s2">,</span>
                         <span class="s1">[</span><span class="s4">0.0042736</span><span class="s2">,  </span><span class="s4">0.0117861</span><span class="s1">]</span><span class="s2">,</span>
                         <span class="s1">[-</span><span class="s4">.0260919</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.019666</span><span class="s1">]</span><span class="s2">,</span>
                         <span class="s1">[</span><span class="s4">1.469346</span><span class="s2">,   </span><span class="s4">1.502939</span><span class="s1">]]</span>
        <span class="s1">self.aic = </span><span class="s4">89151.71</span>
        <span class="s1">self.bic = </span><span class="s4">89189.39</span>

    <span class="s2">def </span><span class="s1">zero_truncted_nbp(self):</span>
        <span class="s1">self.params = [-</span><span class="s4">0.0397571554</span><span class="s2">, </span><span class="s1">-</span><span class="s4">0.1269997715</span><span class="s2">, </span><span class="s4">0.0002753126</span><span class="s2">,</span>
                       <span class="s4">0.9294720085</span><span class="s2">, </span><span class="s4">2.246603</span><span class="s1">]</span>
        <span class="s1">self.llf = -</span><span class="s4">31565</span>
        <span class="s1">self.bse = [</span><span class="s4">0.0074415</span><span class="s2">, </span><span class="s4">0.0308599</span><span class="s2">, </span><span class="s4">0.0053180</span><span class="s2">, </span><span class="s4">0.0342113</span><span class="s2">,</span>
                    <span class="s4">0.1030674</span><span class="s1">]</span>
        <span class="s1">self.aic = </span><span class="s4">63139.99</span>
        <span class="s1">self.bic = </span><span class="s4">63177.69</span>
</pre>
</body>
</html>