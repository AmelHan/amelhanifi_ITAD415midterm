<html>
<head>
<title>test_anova_rm.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6897bb;}
.s3 { color: #6a8759;}
.s4 { color: #629755; font-style: italic;}
.s5 { color: #808080;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_anova_rm.py</font>
</center></td></tr></table>
<pre><span class="s0">from </span><span class="s1">statsmodels.compat.pandas </span><span class="s0">import </span><span class="s1">assert_frame_equal</span>

<span class="s0">import </span><span class="s1">pandas </span><span class="s0">as </span><span class="s1">pd</span>
<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">from </span><span class="s1">statsmodels.stats.anova </span><span class="s0">import </span><span class="s1">AnovaRM</span>
<span class="s0">from </span><span class="s1">numpy.testing </span><span class="s0">import </span><span class="s1">(assert_array_almost_equal</span><span class="s0">, </span><span class="s1">assert_raises</span><span class="s0">,</span>
                           <span class="s1">assert_equal)</span>

<span class="s1">DV = [</span><span class="s2">7</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">6</span><span class="s0">, </span><span class="s2">6</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s2">8</span><span class="s0">, </span><span class="s2">6</span><span class="s0">, </span><span class="s2">7</span><span class="s0">,</span>
      <span class="s2">7</span><span class="s0">, </span><span class="s2">11</span><span class="s0">, </span><span class="s2">9</span><span class="s0">, </span><span class="s2">11</span><span class="s0">, </span><span class="s2">10</span><span class="s0">, </span><span class="s2">10</span><span class="s0">, </span><span class="s2">11</span><span class="s0">, </span><span class="s2">11</span><span class="s0">,</span>
      <span class="s2">8</span><span class="s0">, </span><span class="s2">14</span><span class="s0">, </span><span class="s2">10</span><span class="s0">, </span><span class="s2">11</span><span class="s0">, </span><span class="s2">12</span><span class="s0">, </span><span class="s2">10</span><span class="s0">, </span><span class="s2">11</span><span class="s0">, </span><span class="s2">12</span><span class="s0">,</span>
      <span class="s2">16</span><span class="s0">, </span><span class="s2">7</span><span class="s0">, </span><span class="s2">11</span><span class="s0">, </span><span class="s2">9</span><span class="s0">, </span><span class="s2">10</span><span class="s0">, </span><span class="s2">11</span><span class="s0">, </span><span class="s2">8</span><span class="s0">, </span><span class="s2">8</span><span class="s0">,</span>
      <span class="s2">16</span><span class="s0">, </span><span class="s2">10</span><span class="s0">, </span><span class="s2">13</span><span class="s0">, </span><span class="s2">10</span><span class="s0">, </span><span class="s2">10</span><span class="s0">, </span><span class="s2">14</span><span class="s0">, </span><span class="s2">11</span><span class="s0">, </span><span class="s2">12</span><span class="s0">,</span>
      <span class="s2">24</span><span class="s0">, </span><span class="s2">29</span><span class="s0">, </span><span class="s2">10</span><span class="s0">, </span><span class="s2">22</span><span class="s0">, </span><span class="s2">25</span><span class="s0">, </span><span class="s2">28</span><span class="s0">, </span><span class="s2">22</span><span class="s0">, </span><span class="s2">24</span><span class="s0">,</span>
      <span class="s2">1</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s2">8</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s2">6</span><span class="s0">, </span><span class="s2">8</span><span class="s0">,</span>
      <span class="s2">9</span><span class="s0">, </span><span class="s2">18</span><span class="s0">, </span><span class="s2">19</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s2">12</span><span class="s0">, </span><span class="s2">15</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s0">,</span>
      <span class="s2">3</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s2">13</span><span class="s0">, </span><span class="s2">21</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">11</span><span class="s0">, </span><span class="s2">18</span><span class="s0">, </span><span class="s2">2</span><span class="s0">,</span>
      <span class="s2">12</span><span class="s0">, </span><span class="s2">7</span><span class="s0">, </span><span class="s2">12</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">19</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s2">13</span><span class="s0">,</span>
      <span class="s2">13</span><span class="s0">, </span><span class="s2">14</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s2">8</span><span class="s0">, </span><span class="s2">19</span><span class="s0">, </span><span class="s2">21</span><span class="s0">, </span><span class="s2">2</span><span class="s0">,</span>
      <span class="s2">4</span><span class="s0">, </span><span class="s2">9</span><span class="s0">, </span><span class="s2">12</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s2">8</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">4</span><span class="s1">]</span>

<span class="s1">id = [</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s2">6</span><span class="s0">, </span><span class="s2">7</span><span class="s0">, </span><span class="s2">8</span><span class="s0">,</span>
      <span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s2">6</span><span class="s0">, </span><span class="s2">7</span><span class="s0">, </span><span class="s2">8</span><span class="s0">,</span>
      <span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s2">6</span><span class="s0">, </span><span class="s2">7</span><span class="s0">, </span><span class="s2">8</span><span class="s0">,</span>
      <span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s2">6</span><span class="s0">, </span><span class="s2">7</span><span class="s0">, </span><span class="s2">8</span><span class="s0">,</span>
      <span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s2">6</span><span class="s0">, </span><span class="s2">7</span><span class="s0">, </span><span class="s2">8</span><span class="s0">,</span>
      <span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s2">6</span><span class="s0">, </span><span class="s2">7</span><span class="s0">, </span><span class="s2">8</span><span class="s0">,</span>
      <span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s2">6</span><span class="s0">, </span><span class="s2">7</span><span class="s0">, </span><span class="s2">8</span><span class="s0">,</span>
      <span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s2">6</span><span class="s0">, </span><span class="s2">7</span><span class="s0">, </span><span class="s2">8</span><span class="s0">,</span>
      <span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s2">6</span><span class="s0">, </span><span class="s2">7</span><span class="s0">, </span><span class="s2">8</span><span class="s0">,</span>
      <span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s2">6</span><span class="s0">, </span><span class="s2">7</span><span class="s0">, </span><span class="s2">8</span><span class="s0">,</span>
      <span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s2">6</span><span class="s0">, </span><span class="s2">7</span><span class="s0">, </span><span class="s2">8</span><span class="s0">,</span>
      <span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s2">6</span><span class="s0">, </span><span class="s2">7</span><span class="s0">, </span><span class="s2">8</span><span class="s1">]</span>

<span class="s1">id = [</span><span class="s3">'%d' </span><span class="s1">% i </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">id]</span>

<span class="s1">A = [</span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">,</span>
     <span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">,</span>
     <span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">,</span>
     <span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">,</span>
     <span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">,</span>
     <span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">,</span>
     <span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">,</span>
     <span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">,</span>
     <span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">,</span>
     <span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">,</span>
     <span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">,</span>
     <span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s1">]</span>

<span class="s1">B = [</span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">,</span>
     <span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">,</span>
     <span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">,</span>
     <span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">,</span>
     <span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">,</span>
     <span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">,</span>
     <span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">,</span>
     <span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">,</span>
     <span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">,</span>
     <span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">,</span>
     <span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">,</span>
     <span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s0">, </span><span class="s3">'c'</span><span class="s1">]</span>

<span class="s1">D = [</span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">,</span>
     <span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">,</span>
     <span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">,</span>
     <span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">,</span>
     <span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">,</span>
     <span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">, </span><span class="s3">'a'</span><span class="s0">,</span>
     <span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">,</span>
     <span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">,</span>
     <span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">,</span>
     <span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">,</span>
     <span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">,</span>
     <span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s0">, </span><span class="s3">'b'</span><span class="s1">]</span>

<span class="s1">data = pd.DataFrame([id</span><span class="s0">, </span><span class="s1">A</span><span class="s0">, </span><span class="s1">B</span><span class="s0">, </span><span class="s1">D</span><span class="s0">, </span><span class="s1">DV]</span><span class="s0">, </span><span class="s1">index=[</span><span class="s3">'id'</span><span class="s0">, </span><span class="s3">'A'</span><span class="s0">, </span><span class="s3">'B'</span><span class="s0">, </span><span class="s3">'D'</span><span class="s0">, </span><span class="s3">'DV'</span><span class="s1">]).T</span>
<span class="s1">data[</span><span class="s3">'DV'</span><span class="s1">] = data[</span><span class="s3">'DV'</span><span class="s1">].astype(</span><span class="s3">'int'</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_single_factor_repeated_measures_anova():</span>
    <span class="s4">&quot;&quot;&quot; 
    Testing single factor repeated measures anova 
    Results reproduces R `ezANOVA` function from library ez 
    &quot;&quot;&quot;</span>
    <span class="s1">df = AnovaRM(data.iloc[:</span><span class="s2">16</span><span class="s0">, </span><span class="s1">:]</span><span class="s0">, </span><span class="s3">'DV'</span><span class="s0">, </span><span class="s3">'id'</span><span class="s0">, </span><span class="s1">within=[</span><span class="s3">'B'</span><span class="s1">]).fit()</span>
    <span class="s1">a = [[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">7</span><span class="s0">, </span><span class="s2">22.4</span><span class="s0">, </span><span class="s2">0.002125452</span><span class="s1">]]</span>
    <span class="s1">assert_array_almost_equal(df.anova_table.iloc[:</span><span class="s0">, </span><span class="s1">[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">3</span><span class="s1">]].values</span><span class="s0">,</span>
                              <span class="s1">a</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">5</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_two_factors_repeated_measures_anova():</span>
    <span class="s4">&quot;&quot;&quot; 
    Testing two factors repeated measures anova 
    Results reproduces R `ezANOVA` function from library ez 
    &quot;&quot;&quot;</span>
    <span class="s1">df = AnovaRM(data.iloc[:</span><span class="s2">48</span><span class="s0">, </span><span class="s1">:]</span><span class="s0">, </span><span class="s3">'DV'</span><span class="s0">, </span><span class="s3">'id'</span><span class="s0">, </span><span class="s1">within=[</span><span class="s3">'A'</span><span class="s0">, </span><span class="s3">'B'</span><span class="s1">]).fit()</span>
    <span class="s1">a = [[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">7</span><span class="s0">, </span><span class="s2">40.14159</span><span class="s0">, </span><span class="s2">3.905263e-04</span><span class="s1">]</span><span class="s0">,</span>
         <span class="s1">[</span><span class="s2">2</span><span class="s0">, </span><span class="s2">14</span><span class="s0">, </span><span class="s2">29.21739</span><span class="s0">, </span><span class="s2">1.007549e-05</span><span class="s1">]</span><span class="s0">,</span>
         <span class="s1">[</span><span class="s2">2</span><span class="s0">, </span><span class="s2">14</span><span class="s0">, </span><span class="s2">17.10545</span><span class="s0">, </span><span class="s2">1.741322e-04</span><span class="s1">]]</span>
    <span class="s1">assert_array_almost_equal(df.anova_table.iloc[:</span><span class="s0">, </span><span class="s1">[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">3</span><span class="s1">]].values</span><span class="s0">,</span>
                              <span class="s1">a</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">5</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_three_factors_repeated_measures_anova():</span>
    <span class="s4">&quot;&quot;&quot; 
    Testing three factors repeated measures anova 
    Results reproduces R `ezANOVA` function from library ez 
    &quot;&quot;&quot;</span>
    <span class="s1">df = AnovaRM(data</span><span class="s0">, </span><span class="s3">'DV'</span><span class="s0">, </span><span class="s3">'id'</span><span class="s0">, </span><span class="s1">within=[</span><span class="s3">'A'</span><span class="s0">, </span><span class="s3">'B'</span><span class="s0">, </span><span class="s3">'D'</span><span class="s1">]).fit()</span>
    <span class="s1">a = [[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">7</span><span class="s0">, </span><span class="s2">8.7650709</span><span class="s0">, </span><span class="s2">0.021087505</span><span class="s1">]</span><span class="s0">,</span>
         <span class="s1">[</span><span class="s2">2</span><span class="s0">, </span><span class="s2">14</span><span class="s0">, </span><span class="s2">8.4985785</span><span class="s0">, </span><span class="s2">0.003833921</span><span class="s1">]</span><span class="s0">,</span>
         <span class="s1">[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">7</span><span class="s0">, </span><span class="s2">20.5076546</span><span class="s0">, </span><span class="s2">0.002704428</span><span class="s1">]</span><span class="s0">,</span>
         <span class="s1">[</span><span class="s2">2</span><span class="s0">, </span><span class="s2">14</span><span class="s0">, </span><span class="s2">0.8457797</span><span class="s0">, </span><span class="s2">0.450021759</span><span class="s1">]</span><span class="s0">,</span>
         <span class="s1">[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">7</span><span class="s0">, </span><span class="s2">21.7593382</span><span class="s0">, </span><span class="s2">0.002301792</span><span class="s1">]</span><span class="s0">,</span>
         <span class="s1">[</span><span class="s2">2</span><span class="s0">, </span><span class="s2">14</span><span class="s0">, </span><span class="s2">6.2416695</span><span class="s0">, </span><span class="s2">0.011536846</span><span class="s1">]</span><span class="s0">,</span>
         <span class="s1">[</span><span class="s2">2</span><span class="s0">, </span><span class="s2">14</span><span class="s0">, </span><span class="s2">5.4253359</span><span class="s0">, </span><span class="s2">0.018010647</span><span class="s1">]]</span>
    <span class="s1">assert_array_almost_equal(df.anova_table.iloc[:</span><span class="s0">, </span><span class="s1">[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">3</span><span class="s1">]].values</span><span class="s0">,</span>
                              <span class="s1">a</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">5</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_repeated_measures_invalid_factor_name():</span>
    <span class="s4">&quot;&quot;&quot; 
    Test with a factor name of 'C', which conflicts with patsy. 
    &quot;&quot;&quot;</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">AnovaRM</span><span class="s0">, </span><span class="s1">data.iloc[:</span><span class="s2">16</span><span class="s0">, </span><span class="s1">:]</span><span class="s0">, </span><span class="s3">'DV'</span><span class="s0">, </span><span class="s3">'id'</span><span class="s0">,</span>
                  <span class="s1">within=[</span><span class="s3">'C'</span><span class="s1">])</span>


<span class="s0">def </span><span class="s1">test_repeated_measures_collinearity():</span>
    <span class="s1">data1 = data.iloc[:</span><span class="s2">48</span><span class="s0">, </span><span class="s1">:].copy()</span>
    <span class="s1">data1[</span><span class="s3">'E'</span><span class="s1">] = data1[</span><span class="s3">'A'</span><span class="s1">]</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">AnovaRM</span><span class="s0">, </span><span class="s1">data1</span><span class="s0">, </span><span class="s3">'DV'</span><span class="s0">, </span><span class="s3">'id'</span><span class="s0">, </span><span class="s1">within=[</span><span class="s3">'A'</span><span class="s0">, </span><span class="s3">'E'</span><span class="s1">])</span>


<span class="s0">def </span><span class="s1">test_repeated_measures_unbalanced_data():</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">AnovaRM</span><span class="s0">, </span><span class="s1">data.iloc[</span><span class="s2">1</span><span class="s1">:</span><span class="s2">48</span><span class="s0">, </span><span class="s1">:]</span><span class="s0">, </span><span class="s3">'DV'</span><span class="s0">, </span><span class="s3">'id'</span><span class="s0">,</span>
                  <span class="s1">within=[</span><span class="s3">'A'</span><span class="s0">, </span><span class="s3">'B'</span><span class="s1">])</span>


<span class="s0">def </span><span class="s1">test_repeated_measures_aggregation():</span>
    <span class="s1">df1 = AnovaRM(data</span><span class="s0">, </span><span class="s3">'DV'</span><span class="s0">, </span><span class="s3">'id'</span><span class="s0">, </span><span class="s1">within=[</span><span class="s3">'A'</span><span class="s0">, </span><span class="s3">'B'</span><span class="s0">, </span><span class="s3">'D'</span><span class="s1">]).fit()</span>
    <span class="s1">double_data = pd.concat([data</span><span class="s0">, </span><span class="s1">data]</span><span class="s0">, </span><span class="s1">axis=</span><span class="s2">0</span><span class="s1">)</span>
    <span class="s1">df2 = AnovaRM(double_data</span><span class="s0">, </span><span class="s3">'DV'</span><span class="s0">, </span><span class="s3">'id'</span><span class="s0">, </span><span class="s1">within=[</span><span class="s3">'A'</span><span class="s0">, </span><span class="s3">'B'</span><span class="s0">, </span><span class="s3">'D'</span><span class="s1">]</span><span class="s0">,</span>
                  <span class="s1">aggregate_func=np.mean).fit()</span>

    <span class="s1">assert_frame_equal(df1.anova_table</span><span class="s0">, </span><span class="s1">df2.anova_table)</span>


<span class="s0">def </span><span class="s1">test_repeated_measures_aggregation_one_subject_duplicated():</span>
    <span class="s1">df1 = AnovaRM(data</span><span class="s0">, </span><span class="s3">'DV'</span><span class="s0">, </span><span class="s3">'id'</span><span class="s0">, </span><span class="s1">within=[</span><span class="s3">'A'</span><span class="s0">, </span><span class="s3">'B'</span><span class="s0">, </span><span class="s3">'D'</span><span class="s1">]).fit()</span>
    <span class="s1">data2 = pd.concat([data</span><span class="s0">, </span><span class="s1">data.loc[data[</span><span class="s3">'id'</span><span class="s1">] == </span><span class="s3">'1'</span><span class="s0">, </span><span class="s1">:]]</span><span class="s0">, </span><span class="s1">axis=</span><span class="s2">0</span><span class="s1">)</span>
    <span class="s1">data2 = data2.reset_index()</span>
    <span class="s1">df2 = AnovaRM(data2</span><span class="s0">,</span>
                  <span class="s3">'DV'</span><span class="s0">, </span><span class="s3">'id'</span><span class="s0">, </span><span class="s1">within=[</span><span class="s3">'A'</span><span class="s0">, </span><span class="s3">'B'</span><span class="s0">, </span><span class="s3">'D'</span><span class="s1">]</span><span class="s0">,</span>
                  <span class="s1">aggregate_func=np.mean).fit()</span>

    <span class="s1">assert_frame_equal(df1.anova_table</span><span class="s0">, </span><span class="s1">df2.anova_table)</span>


<span class="s0">def </span><span class="s1">test_repeated_measures_aggregate_func():</span>
    <span class="s1">double_data = pd.concat([data</span><span class="s0">, </span><span class="s1">data]</span><span class="s0">, </span><span class="s1">axis=</span><span class="s2">0</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">AnovaRM</span><span class="s0">, </span><span class="s1">double_data</span><span class="s0">, </span><span class="s3">'DV'</span><span class="s0">, </span><span class="s3">'id'</span><span class="s0">,</span>
                  <span class="s1">within=[</span><span class="s3">'A'</span><span class="s0">, </span><span class="s3">'B'</span><span class="s0">, </span><span class="s3">'D'</span><span class="s1">])</span>

    <span class="s1">m1 = AnovaRM(double_data</span><span class="s0">, </span><span class="s3">'DV'</span><span class="s0">, </span><span class="s3">'id'</span><span class="s0">, </span><span class="s1">within=[</span><span class="s3">'A'</span><span class="s0">, </span><span class="s3">'B'</span><span class="s0">, </span><span class="s3">'D'</span><span class="s1">]</span><span class="s0">,</span>
                 <span class="s1">aggregate_func=np.mean)</span>
    <span class="s1">m2 = AnovaRM(double_data</span><span class="s0">, </span><span class="s3">'DV'</span><span class="s0">, </span><span class="s3">'id'</span><span class="s0">, </span><span class="s1">within=[</span><span class="s3">'A'</span><span class="s0">, </span><span class="s3">'B'</span><span class="s0">, </span><span class="s3">'D'</span><span class="s1">]</span><span class="s0">,</span>
                 <span class="s1">aggregate_func=np.median)</span>

    <span class="s1">assert_raises(AssertionError</span><span class="s0">, </span><span class="s1">assert_equal</span><span class="s0">,</span>
                  <span class="s1">m1.aggregate_func</span><span class="s0">, </span><span class="s1">m2.aggregate_func)</span>
    <span class="s1">assert_frame_equal(m1.fit().anova_table</span><span class="s0">, </span><span class="s1">m2.fit().anova_table)</span>


<span class="s0">def </span><span class="s1">test_repeated_measures_aggregate_func_mean():</span>
    <span class="s1">double_data = pd.concat([data</span><span class="s0">, </span><span class="s1">data]</span><span class="s0">, </span><span class="s1">axis=</span><span class="s2">0</span><span class="s1">)</span>
    <span class="s1">m1 = AnovaRM(double_data</span><span class="s0">, </span><span class="s3">'DV'</span><span class="s0">, </span><span class="s3">'id'</span><span class="s0">, </span><span class="s1">within=[</span><span class="s3">'A'</span><span class="s0">, </span><span class="s3">'B'</span><span class="s0">, </span><span class="s3">'D'</span><span class="s1">]</span><span class="s0">,</span>
                 <span class="s1">aggregate_func=np.mean)</span>

    <span class="s1">m2 = AnovaRM(double_data</span><span class="s0">, </span><span class="s3">'DV'</span><span class="s0">, </span><span class="s3">'id'</span><span class="s0">, </span><span class="s1">within=[</span><span class="s3">'A'</span><span class="s0">, </span><span class="s3">'B'</span><span class="s0">, </span><span class="s3">'D'</span><span class="s1">]</span><span class="s0">,</span>
                 <span class="s1">aggregate_func=</span><span class="s3">'mean'</span><span class="s1">)</span>

    <span class="s1">assert_equal(m1.aggregate_func</span><span class="s0">, </span><span class="s1">m2.aggregate_func)</span>


<span class="s0">def </span><span class="s1">test_repeated_measures_aggregate_compare_with_ezANOVA():</span>
    <span class="s5"># Results should reproduces those from R's `ezANOVA` (library ez).</span>
    <span class="s1">ez = pd.DataFrame(</span>
        <span class="s1">{</span><span class="s3">'F Value'</span><span class="s1">: [</span><span class="s2">8.7650709</span><span class="s0">, </span><span class="s2">8.4985785</span><span class="s0">, </span><span class="s2">20.5076546</span><span class="s0">, </span><span class="s2">0.8457797</span><span class="s0">, </span><span class="s2">21.7593382</span><span class="s0">,</span>
                     <span class="s2">6.2416695</span><span class="s0">, </span><span class="s2">5.4253359</span><span class="s1">]</span><span class="s0">,</span>
         <span class="s3">'Num DF'</span><span class="s1">: [</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s1">]</span><span class="s0">,</span>
         <span class="s3">'Den DF'</span><span class="s1">: [</span><span class="s2">7</span><span class="s0">, </span><span class="s2">14</span><span class="s0">, </span><span class="s2">7</span><span class="s0">, </span><span class="s2">14</span><span class="s0">, </span><span class="s2">7</span><span class="s0">, </span><span class="s2">14</span><span class="s0">, </span><span class="s2">14</span><span class="s1">]</span><span class="s0">,</span>
         <span class="s3">'Pr &gt; F'</span><span class="s1">: [</span><span class="s2">0.021087505</span><span class="s0">, </span><span class="s2">0.003833921</span><span class="s0">, </span><span class="s2">0.002704428</span><span class="s0">, </span><span class="s2">0.450021759</span><span class="s0">,</span>
                    <span class="s2">0.002301792</span><span class="s0">, </span><span class="s2">0.011536846</span><span class="s0">, </span><span class="s2">0.018010647</span><span class="s1">]}</span><span class="s0">,</span>
        <span class="s1">index=pd.Index([</span><span class="s3">'A'</span><span class="s0">, </span><span class="s3">'B'</span><span class="s0">, </span><span class="s3">'D'</span><span class="s0">, </span><span class="s3">'A:B'</span><span class="s0">, </span><span class="s3">'A:D'</span><span class="s0">, </span><span class="s3">'B:D'</span><span class="s0">, </span><span class="s3">'A:B:D'</span><span class="s1">]))</span>
    <span class="s1">ez = ez[[</span><span class="s3">'F Value'</span><span class="s0">, </span><span class="s3">'Num DF'</span><span class="s0">, </span><span class="s3">'Den DF'</span><span class="s0">, </span><span class="s3">'Pr &gt; F'</span><span class="s1">]]</span>

    <span class="s1">double_data = pd.concat([data</span><span class="s0">, </span><span class="s1">data]</span><span class="s0">, </span><span class="s1">axis=</span><span class="s2">0</span><span class="s1">)</span>
    <span class="s1">df = (AnovaRM(double_data</span><span class="s0">, </span><span class="s3">'DV'</span><span class="s0">, </span><span class="s3">'id'</span><span class="s0">, </span><span class="s1">within=[</span><span class="s3">'A'</span><span class="s0">, </span><span class="s3">'B'</span><span class="s0">, </span><span class="s3">'D'</span><span class="s1">]</span><span class="s0">,</span>
                  <span class="s1">aggregate_func=np.mean)</span>
          <span class="s1">.fit()</span>
          <span class="s1">.anova_table)</span>

    <span class="s1">assert_frame_equal(ez</span><span class="s0">, </span><span class="s1">df</span><span class="s0">, </span><span class="s1">check_dtype=</span><span class="s0">False</span><span class="s1">)</span>
</pre>
</body>
</html>