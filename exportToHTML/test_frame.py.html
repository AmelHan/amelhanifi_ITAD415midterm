<html>
<head>
<title>test_frame.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #629755; font-style: italic;}
.s1 { color: #a9b7c6;}
.s2 { color: #cc7832;}
.s3 { color: #6a8759;}
.s4 { color: #808080;}
.s5 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_frame.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot; Test cases for DataFrame.plot &quot;&quot;&quot;</span>
<span class="s2">from </span><span class="s1">datetime </span><span class="s2">import </span><span class="s1">(</span>
    <span class="s1">date</span><span class="s2">,</span>
    <span class="s1">datetime</span><span class="s2">,</span>
<span class="s1">)</span>
<span class="s2">import </span><span class="s1">gc</span>
<span class="s2">import </span><span class="s1">itertools</span>
<span class="s2">import </span><span class="s1">re</span>
<span class="s2">import </span><span class="s1">string</span>
<span class="s2">import </span><span class="s1">weakref</span>

<span class="s2">import </span><span class="s1">numpy </span><span class="s2">as </span><span class="s1">np</span>
<span class="s2">import </span><span class="s1">pytest</span>

<span class="s2">from </span><span class="s1">pandas.core.dtypes.api </span><span class="s2">import </span><span class="s1">is_list_like</span>

<span class="s2">import </span><span class="s1">pandas </span><span class="s2">as </span><span class="s1">pd</span>
<span class="s2">from </span><span class="s1">pandas </span><span class="s2">import </span><span class="s1">(</span>
    <span class="s1">DataFrame</span><span class="s2">,</span>
    <span class="s1">MultiIndex</span><span class="s2">,</span>
    <span class="s1">PeriodIndex</span><span class="s2">,</span>
    <span class="s1">Series</span><span class="s2">,</span>
    <span class="s1">bdate_range</span><span class="s2">,</span>
    <span class="s1">date_range</span><span class="s2">,</span>
    <span class="s1">plotting</span><span class="s2">,</span>
<span class="s1">)</span>
<span class="s2">import </span><span class="s1">pandas._testing </span><span class="s2">as </span><span class="s1">tm</span>
<span class="s2">from </span><span class="s1">pandas.tests.plotting.common </span><span class="s2">import </span><span class="s1">(</span>
    <span class="s1">_check_ax_scales</span><span class="s2">,</span>
    <span class="s1">_check_axes_shape</span><span class="s2">,</span>
    <span class="s1">_check_box_return_type</span><span class="s2">,</span>
    <span class="s1">_check_colors</span><span class="s2">,</span>
    <span class="s1">_check_data</span><span class="s2">,</span>
    <span class="s1">_check_grid_settings</span><span class="s2">,</span>
    <span class="s1">_check_has_errorbars</span><span class="s2">,</span>
    <span class="s1">_check_legend_labels</span><span class="s2">,</span>
    <span class="s1">_check_plot_works</span><span class="s2">,</span>
    <span class="s1">_check_text_labels</span><span class="s2">,</span>
    <span class="s1">_check_ticks_props</span><span class="s2">,</span>
    <span class="s1">_check_visible</span><span class="s2">,</span>
    <span class="s1">get_y_axis</span><span class="s2">,</span>
<span class="s1">)</span>

<span class="s2">from </span><span class="s1">pandas.io.formats.printing </span><span class="s2">import </span><span class="s1">pprint_thing</span>

<span class="s1">mpl = pytest.importorskip(</span><span class="s3">&quot;matplotlib&quot;</span><span class="s1">)</span>
<span class="s1">plt = pytest.importorskip(</span><span class="s3">&quot;matplotlib.pyplot&quot;</span><span class="s1">)</span>


<span class="s2">class </span><span class="s1">TestDataFramePlots:</span>
    <span class="s1">@pytest.mark.slow</span>
    <span class="s2">def </span><span class="s1">test_plot(self):</span>
        <span class="s1">df = tm.makeTimeDataFrame()</span>
        <span class="s1">_check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">grid=</span><span class="s2">False</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s2">def </span><span class="s1">test_plot_subplots(self):</span>
        <span class="s1">df = tm.makeTimeDataFrame()</span>
        <span class="s4"># _check_plot_works adds an ax so use default_axes=True to avoid warning</span>
        <span class="s1">axes = _check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">default_axes=</span><span class="s2">True, </span><span class="s1">subplots=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">_check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s5">4</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s5">4</span><span class="s2">, </span><span class="s5">1</span><span class="s1">))</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s2">def </span><span class="s1">test_plot_subplots_negative_layout(self):</span>
        <span class="s1">df = tm.makeTimeDataFrame()</span>
        <span class="s1">axes = _check_plot_works(</span>
            <span class="s1">df.plot</span><span class="s2">,</span>
            <span class="s1">default_axes=</span><span class="s2">True,</span>
            <span class="s1">subplots=</span><span class="s2">True,</span>
            <span class="s1">layout=(-</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">_check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s5">4</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s5">2</span><span class="s2">, </span><span class="s5">2</span><span class="s1">))</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s2">def </span><span class="s1">test_plot_subplots_use_index(self):</span>
        <span class="s1">df = tm.makeTimeDataFrame()</span>
        <span class="s1">axes = _check_plot_works(</span>
            <span class="s1">df.plot</span><span class="s2">,</span>
            <span class="s1">default_axes=</span><span class="s2">True,</span>
            <span class="s1">subplots=</span><span class="s2">True,</span>
            <span class="s1">use_index=</span><span class="s2">False,</span>
        <span class="s1">)</span>
        <span class="s1">_check_ticks_props(axes</span><span class="s2">, </span><span class="s1">xrot=</span><span class="s5">0</span><span class="s1">)</span>
        <span class="s1">_check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s5">4</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s5">4</span><span class="s2">, </span><span class="s5">1</span><span class="s1">))</span>

    <span class="s1">@pytest.mark.xfail(reason=</span><span class="s3">&quot;Api changed in 3.6.0&quot;</span><span class="s1">)</span>
    <span class="s1">@pytest.mark.slow</span>
    <span class="s2">def </span><span class="s1">test_plot_invalid_arg(self):</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;x&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: [</span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s1">]})</span>
        <span class="s1">msg = </span><span class="s3">&quot;'Line2D' object has no property 'blarg'&quot;</span>
        <span class="s2">with </span><span class="s1">pytest.raises(AttributeError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.plot.line(blarg=</span><span class="s2">True</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s2">def </span><span class="s1">test_plot_tick_props(self):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">3</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">index=list(string.ascii_letters[:</span><span class="s5">10</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>

        <span class="s1">ax = _check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">use_index=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">_check_ticks_props(ax</span><span class="s2">, </span><span class="s1">xrot=</span><span class="s5">0</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;kwargs&quot;</span><span class="s2">,</span>
        <span class="s1">[</span>
            <span class="s1">{</span><span class="s3">&quot;yticks&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">10</span><span class="s1">]}</span><span class="s2">,</span>
            <span class="s1">{</span><span class="s3">&quot;xticks&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">10</span><span class="s1">]}</span><span class="s2">,</span>
            <span class="s1">{</span><span class="s3">&quot;ylim&quot;</span><span class="s1">: (-</span><span class="s5">100</span><span class="s2">, </span><span class="s5">100</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;xlim&quot;</span><span class="s1">: (-</span><span class="s5">100</span><span class="s2">, </span><span class="s5">100</span><span class="s1">)}</span><span class="s2">,</span>
            <span class="s1">{</span><span class="s3">&quot;default_axes&quot;</span><span class="s1">: </span><span class="s2">True, </span><span class="s3">&quot;subplots&quot;</span><span class="s1">: </span><span class="s2">True, </span><span class="s3">&quot;title&quot;</span><span class="s1">: </span><span class="s3">&quot;blah&quot;</span><span class="s1">}</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_plot_other_args(self</span><span class="s2">, </span><span class="s1">kwargs):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">3</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">index=list(string.ascii_letters[:</span><span class="s5">10</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">_check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">**kwargs)</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s2">def </span><span class="s1">test_plot_visible_ax(self):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">3</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">index=list(string.ascii_letters[:</span><span class="s5">10</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s4"># We have to redo it here because _check_plot_works does two plots,</span>
        <span class="s4"># once without an ax kwarg and once with an ax kwarg and the new sharex</span>
        <span class="s4"># behaviour does not remove the visibility of the latter axis (as ax is</span>
        <span class="s4"># present).  see: https://github.com/pandas-dev/pandas/issues/9737</span>

        <span class="s1">axes = df.plot(subplots=</span><span class="s2">True, </span><span class="s1">title=</span><span class="s3">&quot;blah&quot;</span><span class="s1">)</span>
        <span class="s1">_check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s5">3</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s5">3</span><span class="s2">, </span><span class="s5">1</span><span class="s1">))</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes[:</span><span class="s5">2</span><span class="s1">]:</span>
            <span class="s1">_check_visible(ax.xaxis)  </span><span class="s4"># xaxis must be visible for grid</span>
            <span class="s1">_check_visible(ax.get_xticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">False</span><span class="s1">)</span>
            <span class="s1">_check_visible(ax.get_xticklabels(minor=</span><span class="s2">True</span><span class="s1">)</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">False</span><span class="s1">)</span>
            <span class="s1">_check_visible([ax.xaxis.get_label()]</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">False</span><span class="s1">)</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">[axes[</span><span class="s5">2</span><span class="s1">]]:</span>
            <span class="s1">_check_visible(ax.xaxis)</span>
            <span class="s1">_check_visible(ax.get_xticklabels())</span>
            <span class="s1">_check_visible([ax.xaxis.get_label()])</span>
            <span class="s1">_check_ticks_props(ax</span><span class="s2">, </span><span class="s1">xrot=</span><span class="s5">0</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s2">def </span><span class="s1">test_plot_title(self):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">3</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">index=list(string.ascii_letters[:</span><span class="s5">10</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">_check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">title=</span><span class="s3">&quot;blah&quot;</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s2">def </span><span class="s1">test_plot_multiindex(self):</span>
        <span class="s1">tuples = zip(string.ascii_letters[:</span><span class="s5">10</span><span class="s1">]</span><span class="s2">, </span><span class="s1">range(</span><span class="s5">10</span><span class="s1">))</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">3</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">index=MultiIndex.from_tuples(tuples)</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">ax = _check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">use_index=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">_check_ticks_props(ax</span><span class="s2">, </span><span class="s1">xrot=</span><span class="s5">0</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s2">def </span><span class="s1">test_plot_multiindex_unicode(self):</span>
        <span class="s4"># unicode</span>
        <span class="s1">index = MultiIndex.from_tuples(</span>
            <span class="s1">[</span>
                <span class="s1">(</span><span class="s3">&quot;</span><span class="s2">\u03b1</span><span class="s3">&quot;</span><span class="s2">, </span><span class="s5">0</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s1">(</span><span class="s3">&quot;</span><span class="s2">\u03b1</span><span class="s3">&quot;</span><span class="s2">, </span><span class="s5">1</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s1">(</span><span class="s3">&quot;</span><span class="s2">\u03b2</span><span class="s3">&quot;</span><span class="s2">, </span><span class="s5">2</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s1">(</span><span class="s3">&quot;</span><span class="s2">\u03b2</span><span class="s3">&quot;</span><span class="s2">, </span><span class="s5">3</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s1">(</span><span class="s3">&quot;</span><span class="s2">\u03b3</span><span class="s3">&quot;</span><span class="s2">, </span><span class="s5">4</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s1">(</span><span class="s3">&quot;</span><span class="s2">\u03b3</span><span class="s3">&quot;</span><span class="s2">, </span><span class="s5">5</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s1">(</span><span class="s3">&quot;</span><span class="s2">\u03b4</span><span class="s3">&quot;</span><span class="s2">, </span><span class="s5">6</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s1">(</span><span class="s3">&quot;</span><span class="s2">\u03b4</span><span class="s3">&quot;</span><span class="s2">, </span><span class="s5">7</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">]</span><span class="s2">,</span>
            <span class="s1">names=[</span><span class="s3">&quot;i0&quot;</span><span class="s2">, </span><span class="s3">&quot;i1&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">columns = MultiIndex.from_tuples(</span>
            <span class="s1">[(</span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s3">&quot;</span><span class="s2">\u0394</span><span class="s3">&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">(</span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s3">&quot;</span><span class="s2">\u0395</span><span class="s3">&quot;</span><span class="s1">)]</span><span class="s2">, </span><span class="s1">names=[</span><span class="s3">&quot;c0&quot;</span><span class="s2">, </span><span class="s3">&quot;c1&quot;</span><span class="s1">]</span>
        <span class="s1">)</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).integers(</span><span class="s5">0</span><span class="s2">, </span><span class="s5">10</span><span class="s2">, </span><span class="s1">(</span><span class="s5">8</span><span class="s2">, </span><span class="s5">2</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">columns=columns</span><span class="s2">,</span>
            <span class="s1">index=index</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">_check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">title=</span><span class="s3">&quot;</span><span class="s2">\u03A3</span><span class="s3">&quot;</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;layout&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s2">None, </span><span class="s1">(-</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">)])</span>
    <span class="s2">def </span><span class="s1">test_plot_single_column_bar(self</span><span class="s2">, </span><span class="s1">layout):</span>
        <span class="s4"># GH 6951</span>
        <span class="s4"># Test with single column</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;x&quot;</span><span class="s1">: np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random(</span><span class="s5">10</span><span class="s1">)})</span>
        <span class="s1">axes = _check_plot_works(df.plot.bar</span><span class="s2">, </span><span class="s1">subplots=</span><span class="s2">True, </span><span class="s1">layout=layout)</span>
        <span class="s1">_check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">))</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s2">def </span><span class="s1">test_plot_passed_ax(self):</span>
        <span class="s4"># When ax is supplied and required number of axes is 1,</span>
        <span class="s4"># passed ax should be used:</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;x&quot;</span><span class="s1">: np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random(</span><span class="s5">10</span><span class="s1">)})</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = mpl.pyplot.subplots()</span>
        <span class="s1">axes = df.plot.bar(subplots=</span><span class="s2">True, </span><span class="s1">ax=ax)</span>
        <span class="s2">assert </span><span class="s1">len(axes) == </span><span class="s5">1</span>
        <span class="s1">result = ax.axes</span>
        <span class="s2">assert </span><span class="s1">result </span><span class="s2">is </span><span class="s1">axes[</span><span class="s5">0</span><span class="s1">]</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;cols, x, y&quot;</span><span class="s2">,</span>
        <span class="s1">[</span>
            <span class="s1">[list(</span><span class="s3">&quot;ABCDE&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[[</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[[</span><span class="s3">&quot;C&quot;</span><span class="s2">, </span><span class="s3">&quot;A&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s2">, </span><span class="s3">&quot;A&quot;</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[[</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[[</span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[[</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;D&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;D&quot;</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[[</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;E&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;E&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_nullable_int_plot(self</span><span class="s2">, </span><span class="s1">cols</span><span class="s2">, </span><span class="s1">x</span><span class="s2">, </span><span class="s1">y):</span>
        <span class="s4"># GH 32073</span>
        <span class="s1">dates = [</span><span class="s3">&quot;2008&quot;</span><span class="s2">, </span><span class="s3">&quot;2009&quot;</span><span class="s2">, None, </span><span class="s3">&quot;2011&quot;</span><span class="s2">, </span><span class="s3">&quot;2012&quot;</span><span class="s1">]</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">{</span>
                <span class="s3">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s1">]</span><span class="s2">,</span>
                <span class="s3">&quot;B&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s1">]</span><span class="s2">,</span>
                <span class="s3">&quot;C&quot;</span><span class="s1">: np.array([</span><span class="s5">7</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s1">np.nan</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">, </span><span class="s1">dtype=object)</span><span class="s2">,</span>
                <span class="s3">&quot;D&quot;</span><span class="s1">: pd.to_datetime(dates</span><span class="s2">, </span><span class="s1">format=</span><span class="s3">&quot;%Y&quot;</span><span class="s1">).view(</span><span class="s3">&quot;i8&quot;</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s3">&quot;E&quot;</span><span class="s1">: pd.to_datetime(dates</span><span class="s2">, </span><span class="s1">format=</span><span class="s3">&quot;%Y&quot;</span><span class="s2">, </span><span class="s1">utc=</span><span class="s2">True</span><span class="s1">).view(</span><span class="s3">&quot;i8&quot;</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">}</span>
        <span class="s1">)</span>

        <span class="s1">_check_plot_works(df[cols].plot</span><span class="s2">, </span><span class="s1">x=x</span><span class="s2">, </span><span class="s1">y=y)</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;plot&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;line&quot;</span><span class="s2">, </span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s3">&quot;hist&quot;</span><span class="s2">, </span><span class="s3">&quot;pie&quot;</span><span class="s1">])</span>
    <span class="s2">def </span><span class="s1">test_integer_array_plot_series(self</span><span class="s2">, </span><span class="s1">plot):</span>
        <span class="s4"># GH 25587</span>
        <span class="s1">arr = pd.array([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s1">]</span><span class="s2">, </span><span class="s1">dtype=</span><span class="s3">&quot;UInt32&quot;</span><span class="s1">)</span>

        <span class="s1">s = Series(arr)</span>
        <span class="s1">_check_plot_works(getattr(s.plot</span><span class="s2">, </span><span class="s1">plot))</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;plot, kwargs&quot;</span><span class="s2">,</span>
        <span class="s1">[</span>
            <span class="s1">[</span><span class="s3">&quot;line&quot;</span><span class="s2">, </span><span class="s1">{}]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s1">{}]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s3">&quot;hist&quot;</span><span class="s2">, </span><span class="s1">{}]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s3">&quot;pie&quot;</span><span class="s2">, </span><span class="s1">{</span><span class="s3">&quot;y&quot;</span><span class="s1">: </span><span class="s3">&quot;y&quot;</span><span class="s1">}]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s3">&quot;scatter&quot;</span><span class="s2">, </span><span class="s1">{</span><span class="s3">&quot;x&quot;</span><span class="s1">: </span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: </span><span class="s3">&quot;y&quot;</span><span class="s1">}]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s3">&quot;hexbin&quot;</span><span class="s2">, </span><span class="s1">{</span><span class="s3">&quot;x&quot;</span><span class="s1">: </span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: </span><span class="s3">&quot;y&quot;</span><span class="s1">}]</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_integer_array_plot_df(self</span><span class="s2">, </span><span class="s1">plot</span><span class="s2">, </span><span class="s1">kwargs):</span>
        <span class="s4"># GH 25587</span>
        <span class="s1">arr = pd.array([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s1">]</span><span class="s2">, </span><span class="s1">dtype=</span><span class="s3">&quot;UInt32&quot;</span><span class="s1">)</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;x&quot;</span><span class="s1">: arr</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: arr})</span>
        <span class="s1">_check_plot_works(getattr(df.plot</span><span class="s2">, </span><span class="s1">plot)</span><span class="s2">, </span><span class="s1">**kwargs)</span>

    <span class="s2">def </span><span class="s1">test_nonnumeric_exclude(self):</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;A&quot;</span><span class="s1">: [</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]})</span>
        <span class="s1">ax = df.plot()</span>
        <span class="s2">assert </span><span class="s1">len(ax.get_lines()) == </span><span class="s5">1  </span><span class="s4"># B was plotted</span>

    <span class="s2">def </span><span class="s1">test_implicit_label(self):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">3</span><span class="s1">))</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s1">]</span>
        <span class="s1">)</span>
        <span class="s1">ax = df.plot(x=</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;b&quot;</span><span class="s1">)</span>
        <span class="s1">_check_text_labels(ax.xaxis.get_label()</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_donot_overwrite_index_name(self):</span>
        <span class="s4"># GH 8494</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">2</span><span class="s2">, </span><span class="s5">2</span><span class="s1">))</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">]</span>
        <span class="s1">)</span>
        <span class="s1">df.index.name = </span><span class="s3">&quot;NAME&quot;</span>
        <span class="s1">df.plot(y=</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s1">label=</span><span class="s3">&quot;LABEL&quot;</span><span class="s1">)</span>
        <span class="s2">assert </span><span class="s1">df.index.name == </span><span class="s3">&quot;NAME&quot;</span>

    <span class="s2">def </span><span class="s1">test_plot_xy(self):</span>
        <span class="s4"># columns.inferred_type == 'string'</span>
        <span class="s1">df = tm.makeTimeDataFrame(</span><span class="s5">5</span><span class="s1">)</span>
        <span class="s1">_check_data(df.plot(x=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">y=</span><span class="s5">1</span><span class="s1">)</span><span class="s2">, </span><span class="s1">df.set_index(</span><span class="s3">&quot;A&quot;</span><span class="s1">)[</span><span class="s3">&quot;B&quot;</span><span class="s1">].plot())</span>
        <span class="s1">_check_data(df.plot(x=</span><span class="s5">0</span><span class="s1">)</span><span class="s2">, </span><span class="s1">df.set_index(</span><span class="s3">&quot;A&quot;</span><span class="s1">).plot())</span>
        <span class="s1">_check_data(df.plot(y=</span><span class="s5">0</span><span class="s1">)</span><span class="s2">, </span><span class="s1">df.B.plot())</span>
        <span class="s1">_check_data(df.plot(x=</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;B&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">df.set_index(</span><span class="s3">&quot;A&quot;</span><span class="s1">).B.plot())</span>
        <span class="s1">_check_data(df.plot(x=</span><span class="s3">&quot;A&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">df.set_index(</span><span class="s3">&quot;A&quot;</span><span class="s1">).plot())</span>
        <span class="s1">_check_data(df.plot(y=</span><span class="s3">&quot;B&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">df.B.plot())</span>

    <span class="s2">def </span><span class="s1">test_plot_xy_int_cols(self):</span>
        <span class="s1">df = tm.makeTimeDataFrame(</span><span class="s5">5</span><span class="s1">)</span>
        <span class="s4"># columns.inferred_type == 'integer'</span>
        <span class="s1">df.columns = np.arange(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">len(df.columns) + </span><span class="s5">1</span><span class="s1">)</span>
        <span class="s1">_check_data(df.plot(x=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">y=</span><span class="s5">2</span><span class="s1">)</span><span class="s2">, </span><span class="s1">df.set_index(</span><span class="s5">1</span><span class="s1">)[</span><span class="s5">2</span><span class="s1">].plot())</span>
        <span class="s1">_check_data(df.plot(x=</span><span class="s5">1</span><span class="s1">)</span><span class="s2">, </span><span class="s1">df.set_index(</span><span class="s5">1</span><span class="s1">).plot())</span>
        <span class="s1">_check_data(df.plot(y=</span><span class="s5">1</span><span class="s1">)</span><span class="s2">, </span><span class="s1">df[</span><span class="s5">1</span><span class="s1">].plot())</span>

    <span class="s2">def </span><span class="s1">test_plot_xy_figsize_and_title(self):</span>
        <span class="s1">df = tm.makeTimeDataFrame(</span><span class="s5">5</span><span class="s1">)</span>
        <span class="s4"># figsize and title</span>
        <span class="s1">ax = df.plot(x=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">y=</span><span class="s5">2</span><span class="s2">, </span><span class="s1">title=</span><span class="s3">&quot;Test&quot;</span><span class="s2">, </span><span class="s1">figsize=(</span><span class="s5">16</span><span class="s2">, </span><span class="s5">8</span><span class="s1">))</span>
        <span class="s1">_check_text_labels(ax.title</span><span class="s2">, </span><span class="s3">&quot;Test&quot;</span><span class="s1">)</span>
        <span class="s1">_check_axes_shape(ax</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">)</span><span class="s2">, </span><span class="s1">figsize=(</span><span class="s5">16.0</span><span class="s2">, </span><span class="s5">8.0</span><span class="s1">))</span>

        <span class="s4"># columns.inferred_type == 'mixed'</span>
        <span class="s4"># TODO add MultiIndex test</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;input_log, expected_log&quot;</span><span class="s2">, </span><span class="s1">[(</span><span class="s2">True, </span><span class="s3">&quot;log&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">(</span><span class="s3">&quot;sym&quot;</span><span class="s2">, </span><span class="s3">&quot;symlog&quot;</span><span class="s1">)]</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_logscales(self</span><span class="s2">, </span><span class="s1">input_log</span><span class="s2">, </span><span class="s1">expected_log):</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;a&quot;</span><span class="s1">: np.arange(</span><span class="s5">100</span><span class="s1">)}</span><span class="s2">, </span><span class="s1">index=np.arange(</span><span class="s5">100</span><span class="s1">))</span>

        <span class="s1">ax = df.plot(logy=input_log)</span>
        <span class="s1">_check_ax_scales(ax</span><span class="s2">, </span><span class="s1">yaxis=expected_log)</span>
        <span class="s2">assert </span><span class="s1">ax.get_yscale() == expected_log</span>

        <span class="s1">ax = df.plot(logx=input_log)</span>
        <span class="s1">_check_ax_scales(ax</span><span class="s2">, </span><span class="s1">xaxis=expected_log)</span>
        <span class="s2">assert </span><span class="s1">ax.get_xscale() == expected_log</span>

        <span class="s1">ax = df.plot(loglog=input_log)</span>
        <span class="s1">_check_ax_scales(ax</span><span class="s2">, </span><span class="s1">xaxis=expected_log</span><span class="s2">, </span><span class="s1">yaxis=expected_log)</span>
        <span class="s2">assert </span><span class="s1">ax.get_xscale() == expected_log</span>
        <span class="s2">assert </span><span class="s1">ax.get_yscale() == expected_log</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;input_param&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;logx&quot;</span><span class="s2">, </span><span class="s3">&quot;logy&quot;</span><span class="s2">, </span><span class="s3">&quot;loglog&quot;</span><span class="s1">])</span>
    <span class="s2">def </span><span class="s1">test_invalid_logscale(self</span><span class="s2">, </span><span class="s1">input_param):</span>
        <span class="s4"># GH: 24867</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;a&quot;</span><span class="s1">: np.arange(</span><span class="s5">100</span><span class="s1">)}</span><span class="s2">, </span><span class="s1">index=np.arange(</span><span class="s5">100</span><span class="s1">))</span>

        <span class="s1">msg = </span><span class="s3">&quot;Boolean, None and 'sym' are valid options, 'sm' is given.&quot;</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.plot(**{input_param: </span><span class="s3">&quot;sm&quot;</span><span class="s1">})</span>

    <span class="s2">def </span><span class="s1">test_xcompat(self):</span>
        <span class="s1">df = tm.makeTimeDataFrame()</span>
        <span class="s1">ax = df.plot(x_compat=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">lines = ax.get_lines()</span>
        <span class="s2">assert not </span><span class="s1">isinstance(lines[</span><span class="s5">0</span><span class="s1">].get_xdata()</span><span class="s2">, </span><span class="s1">PeriodIndex)</span>
        <span class="s1">_check_ticks_props(ax</span><span class="s2">, </span><span class="s1">xrot=</span><span class="s5">30</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_xcompat_plot_params(self):</span>
        <span class="s1">df = tm.makeTimeDataFrame()</span>
        <span class="s1">plotting.plot_params[</span><span class="s3">&quot;xaxis.compat&quot;</span><span class="s1">] = </span><span class="s2">True</span>
        <span class="s1">ax = df.plot()</span>
        <span class="s1">lines = ax.get_lines()</span>
        <span class="s2">assert not </span><span class="s1">isinstance(lines[</span><span class="s5">0</span><span class="s1">].get_xdata()</span><span class="s2">, </span><span class="s1">PeriodIndex)</span>
        <span class="s1">_check_ticks_props(ax</span><span class="s2">, </span><span class="s1">xrot=</span><span class="s5">30</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_xcompat_plot_params_x_compat(self):</span>
        <span class="s1">df = tm.makeTimeDataFrame()</span>
        <span class="s1">plotting.plot_params[</span><span class="s3">&quot;x_compat&quot;</span><span class="s1">] = </span><span class="s2">False</span>

        <span class="s1">ax = df.plot()</span>
        <span class="s1">lines = ax.get_lines()</span>
        <span class="s2">assert not </span><span class="s1">isinstance(lines[</span><span class="s5">0</span><span class="s1">].get_xdata()</span><span class="s2">, </span><span class="s1">PeriodIndex)</span>
        <span class="s1">msg = </span><span class="s3">r&quot;PeriodDtype\[B\] is deprecated&quot;</span>
        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(FutureWarning</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s2">assert </span><span class="s1">isinstance(PeriodIndex(lines[</span><span class="s5">0</span><span class="s1">].get_xdata())</span><span class="s2">, </span><span class="s1">PeriodIndex)</span>

    <span class="s2">def </span><span class="s1">test_xcompat_plot_params_context_manager(self):</span>
        <span class="s1">df = tm.makeTimeDataFrame()</span>
        <span class="s4"># useful if you're plotting a bunch together</span>
        <span class="s2">with </span><span class="s1">plotting.plot_params.use(</span><span class="s3">&quot;x_compat&quot;</span><span class="s2">, True</span><span class="s1">):</span>
            <span class="s1">ax = df.plot()</span>
            <span class="s1">lines = ax.get_lines()</span>
            <span class="s2">assert not </span><span class="s1">isinstance(lines[</span><span class="s5">0</span><span class="s1">].get_xdata()</span><span class="s2">, </span><span class="s1">PeriodIndex)</span>
            <span class="s1">_check_ticks_props(ax</span><span class="s2">, </span><span class="s1">xrot=</span><span class="s5">30</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_xcompat_plot_period(self):</span>
        <span class="s1">df = tm.makeTimeDataFrame()</span>
        <span class="s1">ax = df.plot()</span>
        <span class="s1">lines = ax.get_lines()</span>
        <span class="s2">assert not </span><span class="s1">isinstance(lines[</span><span class="s5">0</span><span class="s1">].get_xdata()</span><span class="s2">, </span><span class="s1">PeriodIndex)</span>
        <span class="s1">msg = </span><span class="s3">r&quot;PeriodDtype\[B\] is deprecated &quot;</span>
        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(FutureWarning</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s2">assert </span><span class="s1">isinstance(PeriodIndex(lines[</span><span class="s5">0</span><span class="s1">].get_xdata())</span><span class="s2">, </span><span class="s1">PeriodIndex)</span>
        <span class="s1">_check_ticks_props(ax</span><span class="s2">, </span><span class="s1">xrot=</span><span class="s5">0</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_period_compat(self):</span>
        <span class="s4"># GH 9012</span>
        <span class="s4"># period-array conversions</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">21</span><span class="s2">, </span><span class="s5">2</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">index=bdate_range(datetime(</span><span class="s5">2000</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">)</span><span class="s2">, </span><span class="s1">datetime(</span><span class="s5">2000</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">31</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">columns=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">)</span>

        <span class="s1">df.plot()</span>
        <span class="s1">mpl.pyplot.axhline(y=</span><span class="s5">0</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;index_dtype&quot;</span><span class="s2">, </span><span class="s1">[np.int64</span><span class="s2">, </span><span class="s1">np.float64])</span>
    <span class="s2">def </span><span class="s1">test_unsorted_index(self</span><span class="s2">, </span><span class="s1">index_dtype):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">{</span><span class="s3">&quot;y&quot;</span><span class="s1">: np.arange(</span><span class="s5">100</span><span class="s1">)}</span><span class="s2">,</span>
            <span class="s1">index=pd.Index(np.arange(</span><span class="s5">99</span><span class="s2">, </span><span class="s1">-</span><span class="s5">1</span><span class="s2">, </span><span class="s1">-</span><span class="s5">1</span><span class="s1">)</span><span class="s2">, </span><span class="s1">dtype=index_dtype)</span><span class="s2">,</span>
            <span class="s1">dtype=np.int64</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">ax = df.plot()</span>
        <span class="s1">lines = ax.get_lines()[</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s1">rs = lines.get_xydata()</span>
        <span class="s1">rs = Series(rs[:</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">rs[:</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">dtype=np.int64</span><span class="s2">, </span><span class="s1">name=</span><span class="s3">&quot;y&quot;</span><span class="s1">)</span>
        <span class="s1">tm.assert_series_equal(rs</span><span class="s2">, </span><span class="s1">df.y</span><span class="s2">, </span><span class="s1">check_index_type=</span><span class="s2">False</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;df&quot;</span><span class="s2">,</span>
        <span class="s1">[</span>
            <span class="s1">DataFrame({</span><span class="s3">&quot;y&quot;</span><span class="s1">: [</span><span class="s5">0.0</span><span class="s2">, </span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s1">]}</span><span class="s2">, </span><span class="s1">index=[</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">0.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">2.0</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">DataFrame(</span>
                <span class="s1">{</span><span class="s3">&quot;y&quot;</span><span class="s1">: [</span><span class="s5">0.0</span><span class="s2">, </span><span class="s5">1.0</span><span class="s2">, </span><span class="s1">np.nan</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">4.0</span><span class="s2">, </span><span class="s5">5.0</span><span class="s2">, </span><span class="s5">6.0</span><span class="s1">]}</span><span class="s2">,</span>
                <span class="s1">index=[</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">0.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">, </span><span class="s1">np.nan</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">2.0</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_unsorted_index_lims(self</span><span class="s2">, </span><span class="s1">df):</span>
        <span class="s1">ax = df.plot()</span>
        <span class="s1">xmin</span><span class="s2">, </span><span class="s1">xmax = ax.get_xlim()</span>
        <span class="s1">lines = ax.get_lines()</span>
        <span class="s2">assert </span><span class="s1">xmin &lt;= np.nanmin(lines[</span><span class="s5">0</span><span class="s1">].get_data()[</span><span class="s5">0</span><span class="s1">])</span>
        <span class="s2">assert </span><span class="s1">xmax &gt;= np.nanmax(lines[</span><span class="s5">0</span><span class="s1">].get_data()[</span><span class="s5">0</span><span class="s1">])</span>

    <span class="s2">def </span><span class="s1">test_unsorted_index_lims_x_y(self):</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;y&quot;</span><span class="s1">: [</span><span class="s5">0.0</span><span class="s2">, </span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s1">: [</span><span class="s5">91.0</span><span class="s2">, </span><span class="s5">90.0</span><span class="s2">, </span><span class="s5">93.0</span><span class="s2">, </span><span class="s5">92.0</span><span class="s1">]})</span>
        <span class="s1">ax = df.plot(x=</span><span class="s3">&quot;z&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;y&quot;</span><span class="s1">)</span>
        <span class="s1">xmin</span><span class="s2">, </span><span class="s1">xmax = ax.get_xlim()</span>
        <span class="s1">lines = ax.get_lines()</span>
        <span class="s2">assert </span><span class="s1">xmin &lt;= np.nanmin(lines[</span><span class="s5">0</span><span class="s1">].get_data()[</span><span class="s5">0</span><span class="s1">])</span>
        <span class="s2">assert </span><span class="s1">xmax &gt;= np.nanmax(lines[</span><span class="s5">0</span><span class="s1">].get_data()[</span><span class="s5">0</span><span class="s1">])</span>

    <span class="s2">def </span><span class="s1">test_negative_log(self):</span>
        <span class="s1">df = -DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">6</span><span class="s2">, </span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">index=list(string.ascii_letters[:</span><span class="s5">6</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">columns=[</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s2">, </span><span class="s3">&quot;four&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">msg = </span><span class="s3">&quot;Log-y scales are not supported in area plot&quot;</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.plot.area(logy=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.plot.area(loglog=</span><span class="s2">True</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">_compare_stacked_y_cood(self</span><span class="s2">, </span><span class="s1">normal_lines</span><span class="s2">, </span><span class="s1">stacked_lines):</span>
        <span class="s1">base = np.zeros(len(normal_lines[</span><span class="s5">0</span><span class="s1">].get_data()[</span><span class="s5">1</span><span class="s1">]))</span>
        <span class="s2">for </span><span class="s1">nl</span><span class="s2">, </span><span class="s1">sl </span><span class="s2">in </span><span class="s1">zip(normal_lines</span><span class="s2">, </span><span class="s1">stacked_lines):</span>
            <span class="s1">base += nl.get_data()[</span><span class="s5">1</span><span class="s1">]  </span><span class="s4"># get y coordinates</span>
            <span class="s1">sy = sl.get_data()[</span><span class="s5">1</span><span class="s1">]</span>
            <span class="s1">tm.assert_numpy_array_equal(base</span><span class="s2">, </span><span class="s1">sy)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;kind&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;line&quot;</span><span class="s2">, </span><span class="s3">&quot;area&quot;</span><span class="s1">])</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;mult&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s5">1</span><span class="s2">, </span><span class="s1">-</span><span class="s5">1</span><span class="s1">])</span>
    <span class="s2">def </span><span class="s1">test_line_area_stacked(self</span><span class="s2">, </span><span class="s1">kind</span><span class="s2">, </span><span class="s1">mult):</span>
        <span class="s1">df = mult * DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">6</span><span class="s2">, </span><span class="s5">4</span><span class="s1">))</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;w&quot;</span><span class="s2">, </span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s1">]</span>
        <span class="s1">)</span>

        <span class="s1">ax1 = _check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">kind=kind</span><span class="s2">, </span><span class="s1">stacked=</span><span class="s2">False</span><span class="s1">)</span>
        <span class="s1">ax2 = _check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">kind=kind</span><span class="s2">, </span><span class="s1">stacked=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">self._compare_stacked_y_cood(ax1.lines</span><span class="s2">, </span><span class="s1">ax2.lines)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;kind&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;line&quot;</span><span class="s2">, </span><span class="s3">&quot;area&quot;</span><span class="s1">])</span>
    <span class="s2">def </span><span class="s1">test_line_area_stacked_sep_df(self</span><span class="s2">, </span><span class="s1">kind):</span>
        <span class="s4"># each column has either positive or negative value</span>
        <span class="s1">sep_df = DataFrame(</span>
            <span class="s1">{</span>
                <span class="s3">&quot;w&quot;</span><span class="s1">: np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random(</span><span class="s5">6</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s3">&quot;x&quot;</span><span class="s1">: np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random(</span><span class="s5">6</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s3">&quot;y&quot;</span><span class="s1">: -np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random(</span><span class="s5">6</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s3">&quot;z&quot;</span><span class="s1">: -np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random(</span><span class="s5">6</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">}</span>
        <span class="s1">)</span>
        <span class="s1">ax1 = _check_plot_works(sep_df.plot</span><span class="s2">, </span><span class="s1">kind=kind</span><span class="s2">, </span><span class="s1">stacked=</span><span class="s2">False</span><span class="s1">)</span>
        <span class="s1">ax2 = _check_plot_works(sep_df.plot</span><span class="s2">, </span><span class="s1">kind=kind</span><span class="s2">, </span><span class="s1">stacked=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">self._compare_stacked_y_cood(ax1.lines[:</span><span class="s5">2</span><span class="s1">]</span><span class="s2">, </span><span class="s1">ax2.lines[:</span><span class="s5">2</span><span class="s1">])</span>
        <span class="s1">self._compare_stacked_y_cood(ax1.lines[</span><span class="s5">2</span><span class="s1">:]</span><span class="s2">, </span><span class="s1">ax2.lines[</span><span class="s5">2</span><span class="s1">:])</span>

    <span class="s2">def </span><span class="s1">test_line_area_stacked_mixed(self):</span>
        <span class="s1">mixed_df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">6</span><span class="s2">, </span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">index=list(string.ascii_letters[:</span><span class="s5">6</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">columns=[</span><span class="s3">&quot;w&quot;</span><span class="s2">, </span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">_check_plot_works(mixed_df.plot</span><span class="s2">, </span><span class="s1">stacked=</span><span class="s2">False</span><span class="s1">)</span>

        <span class="s1">msg = (</span>
            <span class="s3">&quot;When stacked is True, each column must be either all positive or &quot;</span>
            <span class="s3">&quot;all negative. Column 'w' contains both positive and negative &quot;</span>
            <span class="s3">&quot;values&quot;</span>
        <span class="s1">)</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">mixed_df.plot(stacked=</span><span class="s2">True</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;kind&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;line&quot;</span><span class="s2">, </span><span class="s3">&quot;area&quot;</span><span class="s1">])</span>
    <span class="s2">def </span><span class="s1">test_line_area_stacked_positive_idx(self</span><span class="s2">, </span><span class="s1">kind):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">6</span><span class="s2">, </span><span class="s5">4</span><span class="s1">))</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;w&quot;</span><span class="s2">, </span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s1">]</span>
        <span class="s1">)</span>
        <span class="s4"># Use an index with strictly positive values, preventing</span>
        <span class="s4">#  matplotlib from warning about ignoring xlim</span>
        <span class="s1">df2 = df.set_index(df.index + </span><span class="s5">1</span><span class="s1">)</span>
        <span class="s1">_check_plot_works(df2.plot</span><span class="s2">, </span><span class="s1">kind=kind</span><span class="s2">, </span><span class="s1">logx=</span><span class="s2">True, </span><span class="s1">stacked=</span><span class="s2">True</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;idx&quot;</span><span class="s2">, </span><span class="s1">[range(</span><span class="s5">4</span><span class="s1">)</span><span class="s2">, </span><span class="s1">date_range(</span><span class="s3">&quot;2023-01-1&quot;</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;D&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">4</span><span class="s1">)]</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_line_area_nan_df(self</span><span class="s2">, </span><span class="s1">idx):</span>
        <span class="s1">values1 = [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s1">np.nan</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span>
        <span class="s1">values2 = [</span><span class="s5">3</span><span class="s2">, </span><span class="s1">np.nan</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;a&quot;</span><span class="s1">: values1</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">: values2}</span><span class="s2">, </span><span class="s1">index=idx)</span>

        <span class="s1">ax = _check_plot_works(df.plot)</span>
        <span class="s1">masked1 = ax.lines[</span><span class="s5">0</span><span class="s1">].get_ydata()</span>
        <span class="s1">masked2 = ax.lines[</span><span class="s5">1</span><span class="s1">].get_ydata()</span>
        <span class="s4"># remove nan for comparison purpose</span>

        <span class="s1">exp = np.array([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span><span class="s2">, </span><span class="s1">dtype=np.float64)</span>
        <span class="s1">tm.assert_numpy_array_equal(np.delete(masked1.data</span><span class="s2">, </span><span class="s5">2</span><span class="s1">)</span><span class="s2">, </span><span class="s1">exp)</span>

        <span class="s1">exp = np.array([</span><span class="s5">3</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">dtype=np.float64)</span>
        <span class="s1">tm.assert_numpy_array_equal(np.delete(masked2.data</span><span class="s2">, </span><span class="s5">1</span><span class="s1">)</span><span class="s2">, </span><span class="s1">exp)</span>
        <span class="s1">tm.assert_numpy_array_equal(masked1.mask</span><span class="s2">, </span><span class="s1">np.array([</span><span class="s2">False, False, True, False</span><span class="s1">]))</span>
        <span class="s1">tm.assert_numpy_array_equal(masked2.mask</span><span class="s2">, </span><span class="s1">np.array([</span><span class="s2">False, True, False, False</span><span class="s1">]))</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;idx&quot;</span><span class="s2">, </span><span class="s1">[range(</span><span class="s5">4</span><span class="s1">)</span><span class="s2">, </span><span class="s1">date_range(</span><span class="s3">&quot;2023-01-1&quot;</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;D&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">4</span><span class="s1">)]</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_line_area_nan_df_stacked(self</span><span class="s2">, </span><span class="s1">idx):</span>
        <span class="s1">values1 = [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s1">np.nan</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span>
        <span class="s1">values2 = [</span><span class="s5">3</span><span class="s2">, </span><span class="s1">np.nan</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;a&quot;</span><span class="s1">: values1</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">: values2}</span><span class="s2">, </span><span class="s1">index=idx)</span>

        <span class="s1">expected1 = np.array([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span><span class="s2">, </span><span class="s1">dtype=np.float64)</span>
        <span class="s1">expected2 = np.array([</span><span class="s5">3</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">dtype=np.float64)</span>

        <span class="s1">ax = _check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">stacked=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">tm.assert_numpy_array_equal(ax.lines[</span><span class="s5">0</span><span class="s1">].get_ydata()</span><span class="s2">, </span><span class="s1">expected1)</span>
        <span class="s1">tm.assert_numpy_array_equal(ax.lines[</span><span class="s5">1</span><span class="s1">].get_ydata()</span><span class="s2">, </span><span class="s1">expected1 + expected2)</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;idx&quot;</span><span class="s2">, </span><span class="s1">[range(</span><span class="s5">4</span><span class="s1">)</span><span class="s2">, </span><span class="s1">date_range(</span><span class="s3">&quot;2023-01-1&quot;</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;D&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">4</span><span class="s1">)]</span>
    <span class="s1">)</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;kwargs&quot;</span><span class="s2">, </span><span class="s1">[{}</span><span class="s2">, </span><span class="s1">{</span><span class="s3">&quot;stacked&quot;</span><span class="s1">: </span><span class="s2">False</span><span class="s1">}])</span>
    <span class="s2">def </span><span class="s1">test_line_area_nan_df_stacked_area(self</span><span class="s2">, </span><span class="s1">idx</span><span class="s2">, </span><span class="s1">kwargs):</span>
        <span class="s1">values1 = [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s1">np.nan</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span>
        <span class="s1">values2 = [</span><span class="s5">3</span><span class="s2">, </span><span class="s1">np.nan</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;a&quot;</span><span class="s1">: values1</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">: values2}</span><span class="s2">, </span><span class="s1">index=idx)</span>

        <span class="s1">expected1 = np.array([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span><span class="s2">, </span><span class="s1">dtype=np.float64)</span>
        <span class="s1">expected2 = np.array([</span><span class="s5">3</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">dtype=np.float64)</span>

        <span class="s1">ax = _check_plot_works(df.plot.area</span><span class="s2">, </span><span class="s1">**kwargs)</span>
        <span class="s1">tm.assert_numpy_array_equal(ax.lines[</span><span class="s5">0</span><span class="s1">].get_ydata()</span><span class="s2">, </span><span class="s1">expected1)</span>
        <span class="s2">if </span><span class="s1">kwargs:</span>
            <span class="s1">tm.assert_numpy_array_equal(ax.lines[</span><span class="s5">1</span><span class="s1">].get_ydata()</span><span class="s2">, </span><span class="s1">expected2)</span>
        <span class="s2">else</span><span class="s1">:</span>
            <span class="s1">tm.assert_numpy_array_equal(ax.lines[</span><span class="s5">1</span><span class="s1">].get_ydata()</span><span class="s2">, </span><span class="s1">expected1 + expected2)</span>

        <span class="s1">ax = _check_plot_works(df.plot.area</span><span class="s2">, </span><span class="s1">stacked=</span><span class="s2">False</span><span class="s1">)</span>
        <span class="s1">tm.assert_numpy_array_equal(ax.lines[</span><span class="s5">0</span><span class="s1">].get_ydata()</span><span class="s2">, </span><span class="s1">expected1)</span>
        <span class="s1">tm.assert_numpy_array_equal(ax.lines[</span><span class="s5">1</span><span class="s1">].get_ydata()</span><span class="s2">, </span><span class="s1">expected2)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;kwargs&quot;</span><span class="s2">, </span><span class="s1">[{}</span><span class="s2">, </span><span class="s1">{</span><span class="s3">&quot;secondary_y&quot;</span><span class="s1">: </span><span class="s2">True</span><span class="s1">}])</span>
    <span class="s2">def </span><span class="s1">test_line_lim(self</span><span class="s2">, </span><span class="s1">kwargs):</span>
        <span class="s1">df = DataFrame(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">6</span><span class="s2">, </span><span class="s5">3</span><span class="s1">))</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s1">])</span>
        <span class="s1">ax = df.plot(**kwargs)</span>
        <span class="s1">xmin</span><span class="s2">, </span><span class="s1">xmax = ax.get_xlim()</span>
        <span class="s1">lines = ax.get_lines()</span>
        <span class="s2">assert </span><span class="s1">xmin &lt;= lines[</span><span class="s5">0</span><span class="s1">].get_data()[</span><span class="s5">0</span><span class="s1">][</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s2">assert </span><span class="s1">xmax &gt;= lines[</span><span class="s5">0</span><span class="s1">].get_data()[</span><span class="s5">0</span><span class="s1">][-</span><span class="s5">1</span><span class="s1">]</span>

    <span class="s2">def </span><span class="s1">test_line_lim_subplots(self):</span>
        <span class="s1">df = DataFrame(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">6</span><span class="s2">, </span><span class="s5">3</span><span class="s1">))</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s1">])</span>
        <span class="s1">axes = df.plot(secondary_y=</span><span class="s2">True, </span><span class="s1">subplots=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">_check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s5">3</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s5">3</span><span class="s2">, </span><span class="s5">1</span><span class="s1">))</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes:</span>
            <span class="s2">assert </span><span class="s1">hasattr(ax</span><span class="s2">, </span><span class="s3">&quot;left_ax&quot;</span><span class="s1">)</span>
            <span class="s2">assert not </span><span class="s1">hasattr(ax</span><span class="s2">, </span><span class="s3">&quot;right_ax&quot;</span><span class="s1">)</span>
            <span class="s1">xmin</span><span class="s2">, </span><span class="s1">xmax = ax.get_xlim()</span>
            <span class="s1">lines = ax.get_lines()</span>
            <span class="s2">assert </span><span class="s1">xmin &lt;= lines[</span><span class="s5">0</span><span class="s1">].get_data()[</span><span class="s5">0</span><span class="s1">][</span><span class="s5">0</span><span class="s1">]</span>
            <span class="s2">assert </span><span class="s1">xmax &gt;= lines[</span><span class="s5">0</span><span class="s1">].get_data()[</span><span class="s5">0</span><span class="s1">][-</span><span class="s5">1</span><span class="s1">]</span>

    <span class="s1">@pytest.mark.xfail(</span>
        <span class="s1">strict=</span><span class="s2">False,</span>
        <span class="s1">reason=</span><span class="s3">&quot;2020-12-01 this has been failing periodically on the &quot;</span>
        <span class="s3">&quot;ymin==0 assertion for a week or so.&quot;</span><span class="s2">,</span>
    <span class="s1">)</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;stacked&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s2">True, False</span><span class="s1">])</span>
    <span class="s2">def </span><span class="s1">test_area_lim(self</span><span class="s2">, </span><span class="s1">stacked):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">6</span><span class="s2">, </span><span class="s5">4</span><span class="s1">))</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s2">, </span><span class="s3">&quot;four&quot;</span><span class="s1">]</span>
        <span class="s1">)</span>

        <span class="s1">neg_df = -df</span>

        <span class="s1">ax = _check_plot_works(df.plot.area</span><span class="s2">, </span><span class="s1">stacked=stacked)</span>
        <span class="s1">xmin</span><span class="s2">, </span><span class="s1">xmax = ax.get_xlim()</span>
        <span class="s1">ymin</span><span class="s2">, </span><span class="s1">ymax = ax.get_ylim()</span>
        <span class="s1">lines = ax.get_lines()</span>
        <span class="s2">assert </span><span class="s1">xmin &lt;= lines[</span><span class="s5">0</span><span class="s1">].get_data()[</span><span class="s5">0</span><span class="s1">][</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s2">assert </span><span class="s1">xmax &gt;= lines[</span><span class="s5">0</span><span class="s1">].get_data()[</span><span class="s5">0</span><span class="s1">][-</span><span class="s5">1</span><span class="s1">]</span>
        <span class="s2">assert </span><span class="s1">ymin == </span><span class="s5">0</span>

        <span class="s1">ax = _check_plot_works(neg_df.plot.area</span><span class="s2">, </span><span class="s1">stacked=stacked)</span>
        <span class="s1">ymin</span><span class="s2">, </span><span class="s1">ymax = ax.get_ylim()</span>
        <span class="s2">assert </span><span class="s1">ymax == </span><span class="s5">0</span>

    <span class="s2">def </span><span class="s1">test_area_sharey_dont_overwrite(self):</span>
        <span class="s4"># GH37942</span>
        <span class="s1">df = DataFrame(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">4</span><span class="s2">, </span><span class="s5">2</span><span class="s1">))</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">])</span>
        <span class="s1">fig</span><span class="s2">, </span><span class="s1">(ax1</span><span class="s2">, </span><span class="s1">ax2) = mpl.pyplot.subplots(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s1">sharey=</span><span class="s2">True</span><span class="s1">)</span>

        <span class="s1">df.plot(ax=ax1</span><span class="s2">, </span><span class="s1">kind=</span><span class="s3">&quot;area&quot;</span><span class="s1">)</span>
        <span class="s1">df.plot(ax=ax2</span><span class="s2">, </span><span class="s1">kind=</span><span class="s3">&quot;area&quot;</span><span class="s1">)</span>

        <span class="s2">assert </span><span class="s1">get_y_axis(ax1).joined(ax1</span><span class="s2">, </span><span class="s1">ax2)</span>
        <span class="s2">assert </span><span class="s1">get_y_axis(ax2).joined(ax1</span><span class="s2">, </span><span class="s1">ax2)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;stacked&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s2">True, False</span><span class="s1">])</span>
    <span class="s2">def </span><span class="s1">test_bar_linewidth(self</span><span class="s2">, </span><span class="s1">stacked):</span>
        <span class="s1">df = DataFrame(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">5</span><span class="s2">, </span><span class="s5">5</span><span class="s1">)))</span>

        <span class="s1">ax = df.plot.bar(stacked=stacked</span><span class="s2">, </span><span class="s1">linewidth=</span><span class="s5">2</span><span class="s1">)</span>
        <span class="s2">for </span><span class="s1">r </span><span class="s2">in </span><span class="s1">ax.patches:</span>
            <span class="s2">assert </span><span class="s1">r.get_linewidth() == </span><span class="s5">2</span>

    <span class="s2">def </span><span class="s1">test_bar_linewidth_subplots(self):</span>
        <span class="s1">df = DataFrame(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">5</span><span class="s2">, </span><span class="s5">5</span><span class="s1">)))</span>
        <span class="s4"># subplots</span>
        <span class="s1">axes = df.plot.bar(linewidth=</span><span class="s5">2</span><span class="s2">, </span><span class="s1">subplots=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">_check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s5">5</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s5">5</span><span class="s2">, </span><span class="s5">1</span><span class="s1">))</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes:</span>
            <span class="s2">for </span><span class="s1">r </span><span class="s2">in </span><span class="s1">ax.patches:</span>
                <span class="s2">assert </span><span class="s1">r.get_linewidth() == </span><span class="s5">2</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;meth, dim&quot;</span><span class="s2">, </span><span class="s1">[(</span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s3">&quot;get_width&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">(</span><span class="s3">&quot;barh&quot;</span><span class="s2">, </span><span class="s3">&quot;get_height&quot;</span><span class="s1">)]</span>
    <span class="s1">)</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;stacked&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s2">True, False</span><span class="s1">])</span>
    <span class="s2">def </span><span class="s1">test_bar_barwidth(self</span><span class="s2">, </span><span class="s1">meth</span><span class="s2">, </span><span class="s1">dim</span><span class="s2">, </span><span class="s1">stacked):</span>
        <span class="s1">df = DataFrame(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">5</span><span class="s2">, </span><span class="s5">5</span><span class="s1">)))</span>

        <span class="s1">width = </span><span class="s5">0.9</span>

        <span class="s1">ax = getattr(df.plot</span><span class="s2">, </span><span class="s1">meth)(stacked=stacked</span><span class="s2">, </span><span class="s1">width=width)</span>
        <span class="s2">for </span><span class="s1">r </span><span class="s2">in </span><span class="s1">ax.patches:</span>
            <span class="s2">if not </span><span class="s1">stacked:</span>
                <span class="s2">assert </span><span class="s1">getattr(r</span><span class="s2">, </span><span class="s1">dim)() == width / len(df.columns)</span>
            <span class="s2">else</span><span class="s1">:</span>
                <span class="s2">assert </span><span class="s1">getattr(r</span><span class="s2">, </span><span class="s1">dim)() == width</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;meth, dim&quot;</span><span class="s2">, </span><span class="s1">[(</span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s3">&quot;get_width&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">(</span><span class="s3">&quot;barh&quot;</span><span class="s2">, </span><span class="s3">&quot;get_height&quot;</span><span class="s1">)]</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_barh_barwidth_subplots(self</span><span class="s2">, </span><span class="s1">meth</span><span class="s2">, </span><span class="s1">dim):</span>
        <span class="s1">df = DataFrame(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">5</span><span class="s2">, </span><span class="s5">5</span><span class="s1">)))</span>

        <span class="s1">width = </span><span class="s5">0.9</span>

        <span class="s1">axes = getattr(df.plot</span><span class="s2">, </span><span class="s1">meth)(width=width</span><span class="s2">, </span><span class="s1">subplots=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes:</span>
            <span class="s2">for </span><span class="s1">r </span><span class="s2">in </span><span class="s1">ax.patches:</span>
                <span class="s2">assert </span><span class="s1">getattr(r</span><span class="s2">, </span><span class="s1">dim)() == width</span>

    <span class="s2">def </span><span class="s1">test_bar_bottom_left_bottom(self):</span>
        <span class="s1">df = DataFrame(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">5</span><span class="s2">, </span><span class="s5">5</span><span class="s1">)))</span>
        <span class="s1">ax = df.plot.bar(stacked=</span><span class="s2">False, </span><span class="s1">bottom=</span><span class="s5">1</span><span class="s1">)</span>
        <span class="s1">result = [p.get_y() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">ax.patches]</span>
        <span class="s2">assert </span><span class="s1">result == [</span><span class="s5">1</span><span class="s1">] * </span><span class="s5">25</span>

        <span class="s1">ax = df.plot.bar(stacked=</span><span class="s2">True, </span><span class="s1">bottom=[-</span><span class="s5">1</span><span class="s2">, </span><span class="s1">-</span><span class="s5">2</span><span class="s2">, </span><span class="s1">-</span><span class="s5">3</span><span class="s2">, </span><span class="s1">-</span><span class="s5">4</span><span class="s2">, </span><span class="s1">-</span><span class="s5">5</span><span class="s1">])</span>
        <span class="s1">result = [p.get_y() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">ax.patches[:</span><span class="s5">5</span><span class="s1">]]</span>
        <span class="s2">assert </span><span class="s1">result == [-</span><span class="s5">1</span><span class="s2">, </span><span class="s1">-</span><span class="s5">2</span><span class="s2">, </span><span class="s1">-</span><span class="s5">3</span><span class="s2">, </span><span class="s1">-</span><span class="s5">4</span><span class="s2">, </span><span class="s1">-</span><span class="s5">5</span><span class="s1">]</span>

    <span class="s2">def </span><span class="s1">test_bar_bottom_left_left(self):</span>
        <span class="s1">df = DataFrame(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">5</span><span class="s2">, </span><span class="s5">5</span><span class="s1">)))</span>
        <span class="s1">ax = df.plot.barh(stacked=</span><span class="s2">False, </span><span class="s1">left=np.array([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]))</span>
        <span class="s1">result = [p.get_x() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">ax.patches]</span>
        <span class="s2">assert </span><span class="s1">result == [</span><span class="s5">1</span><span class="s1">] * </span><span class="s5">25</span>

        <span class="s1">ax = df.plot.barh(stacked=</span><span class="s2">True, </span><span class="s1">left=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s1">])</span>
        <span class="s1">result = [p.get_x() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">ax.patches[:</span><span class="s5">5</span><span class="s1">]]</span>
        <span class="s2">assert </span><span class="s1">result == [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s1">]</span>

    <span class="s2">def </span><span class="s1">test_bar_bottom_left_subplots(self):</span>
        <span class="s1">df = DataFrame(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">5</span><span class="s2">, </span><span class="s5">5</span><span class="s1">)))</span>
        <span class="s1">axes = df.plot.bar(subplots=</span><span class="s2">True, </span><span class="s1">bottom=-</span><span class="s5">1</span><span class="s1">)</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes:</span>
            <span class="s1">result = [p.get_y() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">ax.patches]</span>
            <span class="s2">assert </span><span class="s1">result == [-</span><span class="s5">1</span><span class="s1">] * </span><span class="s5">5</span>

        <span class="s1">axes = df.plot.barh(subplots=</span><span class="s2">True, </span><span class="s1">left=np.array([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]))</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes:</span>
            <span class="s1">result = [p.get_x() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">ax.patches]</span>
            <span class="s2">assert </span><span class="s1">result == [</span><span class="s5">1</span><span class="s1">] * </span><span class="s5">5</span>

    <span class="s2">def </span><span class="s1">test_bar_nan(self):</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">10</span><span class="s2">, </span><span class="s1">np.nan</span><span class="s2">, </span><span class="s5">20</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s1">: [</span><span class="s5">5</span><span class="s2">, </span><span class="s5">10</span><span class="s2">, </span><span class="s5">20</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]})</span>
        <span class="s1">ax = df.plot.bar()</span>
        <span class="s1">expected = [</span><span class="s5">10</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">20</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">10</span><span class="s2">, </span><span class="s5">20</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span>
        <span class="s1">result = [p.get_height() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">ax.patches]</span>
        <span class="s2">assert </span><span class="s1">result == expected</span>

    <span class="s2">def </span><span class="s1">test_bar_nan_stacked(self):</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">10</span><span class="s2">, </span><span class="s1">np.nan</span><span class="s2">, </span><span class="s5">20</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s1">: [</span><span class="s5">5</span><span class="s2">, </span><span class="s5">10</span><span class="s2">, </span><span class="s5">20</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]})</span>
        <span class="s1">ax = df.plot.bar(stacked=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">expected = [</span><span class="s5">10</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">20</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">10</span><span class="s2">, </span><span class="s5">20</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span>
        <span class="s1">result = [p.get_height() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">ax.patches]</span>
        <span class="s2">assert </span><span class="s1">result == expected</span>

        <span class="s1">result = [p.get_y() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">ax.patches]</span>
        <span class="s1">expected = [</span><span class="s5">0.0</span><span class="s2">, </span><span class="s5">0.0</span><span class="s2">, </span><span class="s5">0.0</span><span class="s2">, </span><span class="s5">10.0</span><span class="s2">, </span><span class="s5">0.0</span><span class="s2">, </span><span class="s5">20.0</span><span class="s2">, </span><span class="s5">15.0</span><span class="s2">, </span><span class="s5">10.0</span><span class="s2">, </span><span class="s5">40.0</span><span class="s1">]</span>
        <span class="s2">assert </span><span class="s1">result == expected</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;idx&quot;</span><span class="s2">, </span><span class="s1">[pd.Index</span><span class="s2">, </span><span class="s1">pd.CategoricalIndex])</span>
    <span class="s2">def </span><span class="s1">test_bar_categorical(self</span><span class="s2">, </span><span class="s1">idx):</span>
        <span class="s4"># GH 13019</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">6</span><span class="s2">, </span><span class="s5">5</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">index=idx(list(</span><span class="s3">&quot;ABCDEF&quot;</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">columns=idx(list(</span><span class="s3">&quot;abcde&quot;</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">)</span>

        <span class="s1">ax = df.plot.bar()</span>
        <span class="s1">ticks = ax.xaxis.get_ticklocs()</span>
        <span class="s1">tm.assert_numpy_array_equal(ticks</span><span class="s2">, </span><span class="s1">np.array([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s1">]))</span>
        <span class="s2">assert </span><span class="s1">ax.get_xlim() == (-</span><span class="s5">0.5</span><span class="s2">, </span><span class="s5">5.5</span><span class="s1">)</span>
        <span class="s4"># check left-edge of bars</span>
        <span class="s2">assert </span><span class="s1">ax.patches[</span><span class="s5">0</span><span class="s1">].get_x() == -</span><span class="s5">0.25</span>
        <span class="s2">assert </span><span class="s1">ax.patches[-</span><span class="s5">1</span><span class="s1">].get_x() == </span><span class="s5">5.15</span>

        <span class="s1">ax = df.plot.bar(stacked=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">tm.assert_numpy_array_equal(ticks</span><span class="s2">, </span><span class="s1">np.array([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s1">]))</span>
        <span class="s2">assert </span><span class="s1">ax.get_xlim() == (-</span><span class="s5">0.5</span><span class="s2">, </span><span class="s5">5.5</span><span class="s1">)</span>
        <span class="s2">assert </span><span class="s1">ax.patches[</span><span class="s5">0</span><span class="s1">].get_x() == -</span><span class="s5">0.25</span>
        <span class="s2">assert </span><span class="s1">ax.patches[-</span><span class="s5">1</span><span class="s1">].get_x() == </span><span class="s5">4.75</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;x, y&quot;</span><span class="s2">, </span><span class="s1">[(</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">)])</span>
    <span class="s2">def </span><span class="s1">test_plot_scatter(self</span><span class="s2">, </span><span class="s1">x</span><span class="s2">, </span><span class="s1">y):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">6</span><span class="s2">, </span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">index=list(string.ascii_letters[:</span><span class="s5">6</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">columns=[</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s2">, </span><span class="s3">&quot;four&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">)</span>

        <span class="s1">_check_plot_works(df.plot.scatter</span><span class="s2">, </span><span class="s1">x=x</span><span class="s2">, </span><span class="s1">y=y)</span>

    <span class="s2">def </span><span class="s1">test_plot_scatter_error(self):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">6</span><span class="s2">, </span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">index=list(string.ascii_letters[:</span><span class="s5">6</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">columns=[</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s2">, </span><span class="s3">&quot;four&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">msg = re.escape(</span><span class="s3">&quot;scatter() missing 1 required positional argument: 'y'&quot;</span><span class="s1">)</span>
        <span class="s2">with </span><span class="s1">pytest.raises(TypeError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.plot.scatter(x=</span><span class="s3">&quot;x&quot;</span><span class="s1">)</span>
        <span class="s1">msg = re.escape(</span><span class="s3">&quot;scatter() missing 1 required positional argument: 'x'&quot;</span><span class="s1">)</span>
        <span class="s2">with </span><span class="s1">pytest.raises(TypeError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.plot.scatter(y=</span><span class="s3">&quot;y&quot;</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_plot_scatter_shape(self):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">6</span><span class="s2">, </span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">index=list(string.ascii_letters[:</span><span class="s5">6</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">columns=[</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s2">, </span><span class="s3">&quot;four&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s4"># GH 6951</span>
        <span class="s1">axes = df.plot(x=</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s1">kind=</span><span class="s3">&quot;scatter&quot;</span><span class="s2">, </span><span class="s1">subplots=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">_check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">))</span>

    <span class="s2">def </span><span class="s1">test_raise_error_on_datetime_time_data(self):</span>
        <span class="s4"># GH 8113, datetime.time type is not supported by matplotlib in scatter</span>
        <span class="s1">df = DataFrame(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal(</span><span class="s5">10</span><span class="s1">)</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;a&quot;</span><span class="s1">])</span>
        <span class="s1">df[</span><span class="s3">&quot;dtime&quot;</span><span class="s1">] = date_range(start=</span><span class="s3">&quot;2014-01-01&quot;</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;h&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">10</span><span class="s1">).time</span>
        <span class="s1">msg = </span><span class="s3">&quot;must be a string or a (real )?number, not 'datetime.time'&quot;</span>

        <span class="s2">with </span><span class="s1">pytest.raises(TypeError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.plot(kind=</span><span class="s3">&quot;scatter&quot;</span><span class="s2">, </span><span class="s1">x=</span><span class="s3">&quot;dtime&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;a&quot;</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;x, y&quot;</span><span class="s2">, </span><span class="s1">[(</span><span class="s3">&quot;dates&quot;</span><span class="s2">, </span><span class="s3">&quot;vals&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">(</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s1">)])</span>
    <span class="s2">def </span><span class="s1">test_scatterplot_datetime_data(self</span><span class="s2">, </span><span class="s1">x</span><span class="s2">, </span><span class="s1">y):</span>
        <span class="s4"># GH 30391</span>
        <span class="s1">dates = date_range(start=date(</span><span class="s5">2019</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">)</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">12</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;W&quot;</span><span class="s1">)</span>
        <span class="s1">vals = np.random.default_rng(</span><span class="s5">2</span><span class="s1">).normal(</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s1">len(dates))</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;dates&quot;</span><span class="s1">: dates</span><span class="s2">, </span><span class="s3">&quot;vals&quot;</span><span class="s1">: vals})</span>

        <span class="s1">_check_plot_works(df.plot.scatter</span><span class="s2">, </span><span class="s1">x=x</span><span class="s2">, </span><span class="s1">y=y)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;x, y&quot;</span><span class="s2">, </span><span class="s1">[(</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">(</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s1">)])</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;b_col&quot;</span><span class="s2">, </span><span class="s1">[[</span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s1">]])</span>
    <span class="s2">def </span><span class="s1">test_scatterplot_object_data(self</span><span class="s2">, </span><span class="s1">b_col</span><span class="s2">, </span><span class="s1">x</span><span class="s2">, </span><span class="s1">y):</span>
        <span class="s4"># GH 18755</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;a&quot;</span><span class="s1">: [</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">: b_col})</span>

        <span class="s1">_check_plot_works(df.plot.scatter</span><span class="s2">, </span><span class="s1">x=x</span><span class="s2">, </span><span class="s1">y=y)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;ordered&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s2">True, False</span><span class="s1">])</span>
    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;categories&quot;</span><span class="s2">,</span>
        <span class="s1">([</span><span class="s3">&quot;setosa&quot;</span><span class="s2">, </span><span class="s3">&quot;versicolor&quot;</span><span class="s2">, </span><span class="s3">&quot;virginica&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;versicolor&quot;</span><span class="s2">, </span><span class="s3">&quot;virginica&quot;</span><span class="s2">, </span><span class="s3">&quot;setosa&quot;</span><span class="s1">])</span><span class="s2">,</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_scatterplot_color_by_categorical(self</span><span class="s2">, </span><span class="s1">ordered</span><span class="s2">, </span><span class="s1">categories):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">[[</span><span class="s5">5.1</span><span class="s2">, </span><span class="s5">3.5</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s5">4.9</span><span class="s2">, </span><span class="s5">3.0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s5">7.0</span><span class="s2">, </span><span class="s5">3.2</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s5">6.4</span><span class="s2">, </span><span class="s5">3.2</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s5">5.9</span><span class="s2">, </span><span class="s5">3.0</span><span class="s1">]]</span><span class="s2">,</span>
            <span class="s1">columns=[</span><span class="s3">&quot;length&quot;</span><span class="s2">, </span><span class="s3">&quot;width&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">df[</span><span class="s3">&quot;species&quot;</span><span class="s1">] = pd.Categorical(</span>
            <span class="s1">[</span><span class="s3">&quot;setosa&quot;</span><span class="s2">, </span><span class="s3">&quot;setosa&quot;</span><span class="s2">, </span><span class="s3">&quot;virginica&quot;</span><span class="s2">, </span><span class="s3">&quot;virginica&quot;</span><span class="s2">, </span><span class="s3">&quot;versicolor&quot;</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">ordered=ordered</span><span class="s2">,</span>
            <span class="s1">categories=categories</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">ax = df.plot.scatter(x=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">y=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">c=</span><span class="s3">&quot;species&quot;</span><span class="s1">)</span>
        <span class="s1">(colorbar_collection</span><span class="s2">,</span><span class="s1">) = ax.collections</span>
        <span class="s1">colorbar = colorbar_collection.colorbar</span>

        <span class="s1">expected_ticks = np.array([</span><span class="s5">0.5</span><span class="s2">, </span><span class="s5">1.5</span><span class="s2">, </span><span class="s5">2.5</span><span class="s1">])</span>
        <span class="s1">result_ticks = colorbar.get_ticks()</span>
        <span class="s1">tm.assert_numpy_array_equal(result_ticks</span><span class="s2">, </span><span class="s1">expected_ticks)</span>

        <span class="s1">expected_boundaries = np.array([</span><span class="s5">0.0</span><span class="s2">, </span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s1">])</span>
        <span class="s1">result_boundaries = colorbar._boundaries</span>
        <span class="s1">tm.assert_numpy_array_equal(result_boundaries</span><span class="s2">, </span><span class="s1">expected_boundaries)</span>

        <span class="s1">expected_yticklabels = categories</span>
        <span class="s1">result_yticklabels = [i.get_text() </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">colorbar.ax.get_ymajorticklabels()]</span>
        <span class="s2">assert </span><span class="s1">all(i == j </span><span class="s2">for </span><span class="s1">i</span><span class="s2">, </span><span class="s1">j </span><span class="s2">in </span><span class="s1">zip(result_yticklabels</span><span class="s2">, </span><span class="s1">expected_yticklabels))</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;x, y&quot;</span><span class="s2">, </span><span class="s1">[(</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">(</span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s3">&quot;x&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">(</span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">)])</span>
    <span class="s2">def </span><span class="s1">test_plot_scatter_with_categorical_data(self</span><span class="s2">, </span><span class="s1">x</span><span class="s2">, </span><span class="s1">y):</span>
        <span class="s4"># after fixing GH 18755, should be able to plot categorical data</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;x&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: pd.Categorical([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s1">])})</span>

        <span class="s1">_check_plot_works(df.plot.scatter</span><span class="s2">, </span><span class="s1">x=x</span><span class="s2">, </span><span class="s1">y=y)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;x, y, c&quot;</span><span class="s2">, </span><span class="s1">[(</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">(</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">)])</span>
    <span class="s2">def </span><span class="s1">test_plot_scatter_with_c(self</span><span class="s2">, </span><span class="s1">x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s1">c):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).integers(low=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">high=</span><span class="s5">100</span><span class="s2">, </span><span class="s1">size=(</span><span class="s5">6</span><span class="s2">, </span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">index=list(string.ascii_letters[:</span><span class="s5">6</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">columns=[</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s2">, </span><span class="s3">&quot;four&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">)</span>

        <span class="s1">ax = df.plot.scatter(x=x</span><span class="s2">, </span><span class="s1">y=y</span><span class="s2">, </span><span class="s1">c=c)</span>
        <span class="s4"># default to Greys</span>
        <span class="s2">assert </span><span class="s1">ax.collections[</span><span class="s5">0</span><span class="s1">].cmap.name == </span><span class="s3">&quot;Greys&quot;</span>

        <span class="s2">assert </span><span class="s1">ax.collections[</span><span class="s5">0</span><span class="s1">].colorbar.ax.get_ylabel() == </span><span class="s3">&quot;z&quot;</span>

    <span class="s2">def </span><span class="s1">test_plot_scatter_with_c_props(self):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).integers(low=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">high=</span><span class="s5">100</span><span class="s2">, </span><span class="s1">size=(</span><span class="s5">6</span><span class="s2">, </span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">index=list(string.ascii_letters[:</span><span class="s5">6</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">columns=[</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s2">, </span><span class="s3">&quot;four&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">cm = </span><span class="s3">&quot;cubehelix&quot;</span>
        <span class="s1">ax = df.plot.scatter(x=</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s1">c=</span><span class="s3">&quot;z&quot;</span><span class="s2">, </span><span class="s1">colormap=cm)</span>
        <span class="s2">assert </span><span class="s1">ax.collections[</span><span class="s5">0</span><span class="s1">].cmap.name == cm</span>

        <span class="s4"># verify turning off colorbar works</span>
        <span class="s1">ax = df.plot.scatter(x=</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s1">c=</span><span class="s3">&quot;z&quot;</span><span class="s2">, </span><span class="s1">colorbar=</span><span class="s2">False</span><span class="s1">)</span>
        <span class="s2">assert </span><span class="s1">ax.collections[</span><span class="s5">0</span><span class="s1">].colorbar </span><span class="s2">is None</span>

        <span class="s4"># verify that we can still plot a solid color</span>
        <span class="s1">ax = df.plot.scatter(x=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">y=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">c=</span><span class="s3">&quot;red&quot;</span><span class="s1">)</span>
        <span class="s2">assert </span><span class="s1">ax.collections[</span><span class="s5">0</span><span class="s1">].colorbar </span><span class="s2">is None</span>
        <span class="s1">_check_colors(ax.collections</span><span class="s2">, </span><span class="s1">facecolors=[</span><span class="s3">&quot;r&quot;</span><span class="s1">])</span>

    <span class="s2">def </span><span class="s1">test_plot_scatter_with_c_array(self):</span>
        <span class="s4"># Ensure that we can pass an np.array straight through to matplotlib,</span>
        <span class="s4"># this functionality was accidentally removed previously.</span>
        <span class="s4"># See https://github.com/pandas-dev/pandas/issues/8852 for bug report</span>
        <span class="s4">#</span>
        <span class="s4"># Exercise colormap path and non-colormap path as they are independent</span>
        <span class="s4">#</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s1">: [</span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s1">]})</span>
        <span class="s1">red_rgba = [</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">0.0</span><span class="s2">, </span><span class="s5">0.0</span><span class="s2">, </span><span class="s5">1.0</span><span class="s1">]</span>
        <span class="s1">green_rgba = [</span><span class="s5">0.0</span><span class="s2">, </span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">0.0</span><span class="s2">, </span><span class="s5">1.0</span><span class="s1">]</span>
        <span class="s1">rgba_array = np.array([red_rgba</span><span class="s2">, </span><span class="s1">green_rgba])</span>
        <span class="s1">ax = df.plot.scatter(x=</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s1">c=rgba_array)</span>
        <span class="s4"># expect the face colors of the points in the non-colormap path to be</span>
        <span class="s4"># identical to the values we supplied, normally we'd be on shaky ground</span>
        <span class="s4"># comparing floats for equality but here we expect them to be</span>
        <span class="s4"># identical.</span>
        <span class="s1">tm.assert_numpy_array_equal(ax.collections[</span><span class="s5">0</span><span class="s1">].get_facecolor()</span><span class="s2">, </span><span class="s1">rgba_array)</span>
        <span class="s4"># we don't test the colors of the faces in this next plot because they</span>
        <span class="s4"># are dependent on the spring colormap, which may change its colors</span>
        <span class="s4"># later.</span>
        <span class="s1">float_array = np.array([</span><span class="s5">0.0</span><span class="s2">, </span><span class="s5">1.0</span><span class="s1">])</span>
        <span class="s1">df.plot.scatter(x=</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s1">c=float_array</span><span class="s2">, </span><span class="s1">cmap=</span><span class="s3">&quot;spring&quot;</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_plot_scatter_with_s(self):</span>
        <span class="s4"># this refers to GH 32904</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">3</span><span class="s1">)) * </span><span class="s5">100</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s1">]</span>
        <span class="s1">)</span>

        <span class="s1">ax = df.plot.scatter(x=</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s1">s=</span><span class="s3">&quot;c&quot;</span><span class="s1">)</span>
        <span class="s1">tm.assert_numpy_array_equal(df[</span><span class="s3">&quot;c&quot;</span><span class="s1">].values</span><span class="s2">, </span><span class="s1">right=ax.collections[</span><span class="s5">0</span><span class="s1">].get_sizes())</span>

    <span class="s2">def </span><span class="s1">test_plot_scatter_with_norm(self):</span>
        <span class="s4"># added while fixing GH 45809</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">3</span><span class="s1">)) * </span><span class="s5">100</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s1">]</span>
        <span class="s1">)</span>
        <span class="s1">norm = mpl.colors.LogNorm()</span>
        <span class="s1">ax = df.plot.scatter(x=</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s1">c=</span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s1">norm=norm)</span>
        <span class="s2">assert </span><span class="s1">ax.collections[</span><span class="s5">0</span><span class="s1">].norm </span><span class="s2">is </span><span class="s1">norm</span>

    <span class="s2">def </span><span class="s1">test_plot_scatter_without_norm(self):</span>
        <span class="s4"># added while fixing GH 45809</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">3</span><span class="s1">)) * </span><span class="s5">100</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s1">]</span>
        <span class="s1">)</span>
        <span class="s1">ax = df.plot.scatter(x=</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s1">c=</span><span class="s3">&quot;c&quot;</span><span class="s1">)</span>
        <span class="s1">plot_norm = ax.collections[</span><span class="s5">0</span><span class="s1">].norm</span>
        <span class="s1">color_min_max = (df.c.min()</span><span class="s2">, </span><span class="s1">df.c.max())</span>
        <span class="s1">default_norm = mpl.colors.Normalize(*color_min_max)</span>
        <span class="s2">for </span><span class="s1">value </span><span class="s2">in </span><span class="s1">df.c:</span>
            <span class="s2">assert </span><span class="s1">plot_norm(value) == default_norm(value)</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;kwargs&quot;</span><span class="s2">,</span>
        <span class="s1">[</span>
            <span class="s1">{}</span><span class="s2">,</span>
            <span class="s1">{</span><span class="s3">&quot;legend&quot;</span><span class="s1">: </span><span class="s2">False</span><span class="s1">}</span><span class="s2">,</span>
            <span class="s1">{</span><span class="s3">&quot;default_axes&quot;</span><span class="s1">: </span><span class="s2">True, </span><span class="s3">&quot;subplots&quot;</span><span class="s1">: </span><span class="s2">True</span><span class="s1">}</span><span class="s2">,</span>
            <span class="s1">{</span><span class="s3">&quot;stacked&quot;</span><span class="s1">: </span><span class="s2">True</span><span class="s1">}</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_plot_bar(self</span><span class="s2">, </span><span class="s1">kwargs):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">6</span><span class="s2">, </span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">index=list(string.ascii_letters[:</span><span class="s5">6</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">columns=[</span><span class="s3">&quot;one&quot;</span><span class="s2">, </span><span class="s3">&quot;two&quot;</span><span class="s2">, </span><span class="s3">&quot;three&quot;</span><span class="s2">, </span><span class="s3">&quot;four&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">)</span>

        <span class="s1">_check_plot_works(df.plot.bar</span><span class="s2">, </span><span class="s1">**kwargs)</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s2">def </span><span class="s1">test_plot_bar_int_col(self):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">15</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">index=list(string.ascii_letters[:</span><span class="s5">10</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">columns=range(</span><span class="s5">15</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">_check_plot_works(df.plot.bar)</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s2">def </span><span class="s1">test_plot_bar_ticks(self):</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;a&quot;</span><span class="s1">: [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]})</span>
        <span class="s1">ax = _check_plot_works(df.plot.bar)</span>
        <span class="s1">_check_ticks_props(ax</span><span class="s2">, </span><span class="s1">xrot=</span><span class="s5">90</span><span class="s1">)</span>

        <span class="s1">ax = df.plot.bar(rot=</span><span class="s5">35</span><span class="s2">, </span><span class="s1">fontsize=</span><span class="s5">10</span><span class="s1">)</span>
        <span class="s1">_check_ticks_props(ax</span><span class="s2">, </span><span class="s1">xrot=</span><span class="s5">35</span><span class="s2">, </span><span class="s1">xlabelsize=</span><span class="s5">10</span><span class="s2">, </span><span class="s1">ylabelsize=</span><span class="s5">10</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s2">def </span><span class="s1">test_plot_barh_ticks(self):</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;a&quot;</span><span class="s1">: [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]})</span>
        <span class="s1">ax = _check_plot_works(df.plot.barh)</span>
        <span class="s1">_check_ticks_props(ax</span><span class="s2">, </span><span class="s1">yrot=</span><span class="s5">0</span><span class="s1">)</span>

        <span class="s1">ax = df.plot.barh(rot=</span><span class="s5">55</span><span class="s2">, </span><span class="s1">fontsize=</span><span class="s5">11</span><span class="s1">)</span>
        <span class="s1">_check_ticks_props(ax</span><span class="s2">, </span><span class="s1">yrot=</span><span class="s5">55</span><span class="s2">, </span><span class="s1">ylabelsize=</span><span class="s5">11</span><span class="s2">, </span><span class="s1">xlabelsize=</span><span class="s5">11</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_boxplot(self</span><span class="s2">, </span><span class="s1">hist_df):</span>
        <span class="s1">df = hist_df</span>
        <span class="s1">numeric_cols = df._get_numeric_data().columns</span>
        <span class="s1">labels = [pprint_thing(c) </span><span class="s2">for </span><span class="s1">c </span><span class="s2">in </span><span class="s1">numeric_cols]</span>

        <span class="s1">ax = _check_plot_works(df.plot.box)</span>
        <span class="s1">_check_text_labels(ax.get_xticklabels()</span><span class="s2">, </span><span class="s1">labels)</span>
        <span class="s1">tm.assert_numpy_array_equal(</span>
            <span class="s1">ax.xaxis.get_ticklocs()</span><span class="s2">, </span><span class="s1">np.arange(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">len(numeric_cols) + </span><span class="s5">1</span><span class="s1">)</span>
        <span class="s1">)</span>
        <span class="s2">assert </span><span class="s1">len(ax.lines) == </span><span class="s5">7 </span><span class="s1">* len(numeric_cols)</span>

    <span class="s2">def </span><span class="s1">test_boxplot_series(self</span><span class="s2">, </span><span class="s1">hist_df):</span>
        <span class="s1">df = hist_df</span>
        <span class="s1">series = df[</span><span class="s3">&quot;height&quot;</span><span class="s1">]</span>
        <span class="s1">axes = series.plot.box(rot=</span><span class="s5">40</span><span class="s1">)</span>
        <span class="s1">_check_ticks_props(axes</span><span class="s2">, </span><span class="s1">xrot=</span><span class="s5">40</span><span class="s2">, </span><span class="s1">yrot=</span><span class="s5">0</span><span class="s1">)</span>

        <span class="s1">_check_plot_works(series.plot.box)</span>

    <span class="s2">def </span><span class="s1">test_boxplot_series_positions(self</span><span class="s2">, </span><span class="s1">hist_df):</span>
        <span class="s1">df = hist_df</span>
        <span class="s1">positions = np.array([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">6</span><span class="s2">, </span><span class="s5">7</span><span class="s1">])</span>
        <span class="s1">ax = df.plot.box(positions=positions)</span>
        <span class="s1">numeric_cols = df._get_numeric_data().columns</span>
        <span class="s1">labels = [pprint_thing(c) </span><span class="s2">for </span><span class="s1">c </span><span class="s2">in </span><span class="s1">numeric_cols]</span>
        <span class="s1">_check_text_labels(ax.get_xticklabels()</span><span class="s2">, </span><span class="s1">labels)</span>
        <span class="s1">tm.assert_numpy_array_equal(ax.xaxis.get_ticklocs()</span><span class="s2">, </span><span class="s1">positions)</span>
        <span class="s2">assert </span><span class="s1">len(ax.lines) == </span><span class="s5">7 </span><span class="s1">* len(numeric_cols)</span>

    <span class="s2">def </span><span class="s1">test_boxplot_vertical(self</span><span class="s2">, </span><span class="s1">hist_df):</span>
        <span class="s1">df = hist_df</span>
        <span class="s1">numeric_cols = df._get_numeric_data().columns</span>
        <span class="s1">labels = [pprint_thing(c) </span><span class="s2">for </span><span class="s1">c </span><span class="s2">in </span><span class="s1">numeric_cols]</span>

        <span class="s4"># if horizontal, yticklabels are rotated</span>
        <span class="s1">ax = df.plot.box(rot=</span><span class="s5">50</span><span class="s2">, </span><span class="s1">fontsize=</span><span class="s5">8</span><span class="s2">, </span><span class="s1">vert=</span><span class="s2">False</span><span class="s1">)</span>
        <span class="s1">_check_ticks_props(ax</span><span class="s2">, </span><span class="s1">xrot=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">yrot=</span><span class="s5">50</span><span class="s2">, </span><span class="s1">ylabelsize=</span><span class="s5">8</span><span class="s1">)</span>
        <span class="s1">_check_text_labels(ax.get_yticklabels()</span><span class="s2">, </span><span class="s1">labels)</span>
        <span class="s2">assert </span><span class="s1">len(ax.lines) == </span><span class="s5">7 </span><span class="s1">* len(numeric_cols)</span>

    <span class="s1">@pytest.mark.filterwarnings(</span><span class="s3">&quot;ignore:Attempt:UserWarning&quot;</span><span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_boxplot_vertical_subplots(self</span><span class="s2">, </span><span class="s1">hist_df):</span>
        <span class="s1">df = hist_df</span>
        <span class="s1">numeric_cols = df._get_numeric_data().columns</span>
        <span class="s1">labels = [pprint_thing(c) </span><span class="s2">for </span><span class="s1">c </span><span class="s2">in </span><span class="s1">numeric_cols]</span>
        <span class="s1">axes = _check_plot_works(</span>
            <span class="s1">df.plot.box</span><span class="s2">,</span>
            <span class="s1">default_axes=</span><span class="s2">True,</span>
            <span class="s1">subplots=</span><span class="s2">True,</span>
            <span class="s1">vert=</span><span class="s2">False,</span>
            <span class="s1">logx=</span><span class="s2">True,</span>
        <span class="s1">)</span>
        <span class="s1">_check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s5">3</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s1">))</span>
        <span class="s1">_check_ax_scales(axes</span><span class="s2">, </span><span class="s1">xaxis=</span><span class="s3">&quot;log&quot;</span><span class="s1">)</span>
        <span class="s2">for </span><span class="s1">ax</span><span class="s2">, </span><span class="s1">label </span><span class="s2">in </span><span class="s1">zip(axes</span><span class="s2">, </span><span class="s1">labels):</span>
            <span class="s1">_check_text_labels(ax.get_yticklabels()</span><span class="s2">, </span><span class="s1">[label])</span>
            <span class="s2">assert </span><span class="s1">len(ax.lines) == </span><span class="s5">7</span>

    <span class="s2">def </span><span class="s1">test_boxplot_vertical_positions(self</span><span class="s2">, </span><span class="s1">hist_df):</span>
        <span class="s1">df = hist_df</span>
        <span class="s1">numeric_cols = df._get_numeric_data().columns</span>
        <span class="s1">labels = [pprint_thing(c) </span><span class="s2">for </span><span class="s1">c </span><span class="s2">in </span><span class="s1">numeric_cols]</span>
        <span class="s1">positions = np.array([</span><span class="s5">3</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">8</span><span class="s1">])</span>
        <span class="s1">ax = df.plot.box(positions=positions</span><span class="s2">, </span><span class="s1">vert=</span><span class="s2">False</span><span class="s1">)</span>
        <span class="s1">_check_text_labels(ax.get_yticklabels()</span><span class="s2">, </span><span class="s1">labels)</span>
        <span class="s1">tm.assert_numpy_array_equal(ax.yaxis.get_ticklocs()</span><span class="s2">, </span><span class="s1">positions)</span>
        <span class="s2">assert </span><span class="s1">len(ax.lines) == </span><span class="s5">7 </span><span class="s1">* len(numeric_cols)</span>

    <span class="s2">def </span><span class="s1">test_boxplot_return_type_invalid(self):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">6</span><span class="s2">, </span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">index=list(string.ascii_letters[:</span><span class="s5">6</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">columns=[</span><span class="s3">&quot;one&quot;</span><span class="s2">, </span><span class="s3">&quot;two&quot;</span><span class="s2">, </span><span class="s3">&quot;three&quot;</span><span class="s2">, </span><span class="s3">&quot;four&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">msg = </span><span class="s3">&quot;return_type must be {None, 'axes', 'dict', 'both'}&quot;</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.plot.box(return_type=</span><span class="s3">&quot;not_a_type&quot;</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;return_type&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;dict&quot;</span><span class="s2">, </span><span class="s3">&quot;axes&quot;</span><span class="s2">, </span><span class="s3">&quot;both&quot;</span><span class="s1">])</span>
    <span class="s2">def </span><span class="s1">test_boxplot_return_type_invalid_type(self</span><span class="s2">, </span><span class="s1">return_type):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">6</span><span class="s2">, </span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">index=list(string.ascii_letters[:</span><span class="s5">6</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">columns=[</span><span class="s3">&quot;one&quot;</span><span class="s2">, </span><span class="s3">&quot;two&quot;</span><span class="s2">, </span><span class="s3">&quot;three&quot;</span><span class="s2">, </span><span class="s3">&quot;four&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">result = df.plot.box(return_type=return_type)</span>
        <span class="s1">_check_box_return_type(result</span><span class="s2">, </span><span class="s1">return_type)</span>

    <span class="s2">def </span><span class="s1">test_kde_df(self):</span>
        <span class="s1">pytest.importorskip(</span><span class="s3">&quot;scipy&quot;</span><span class="s1">)</span>
        <span class="s1">df = DataFrame(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">100</span><span class="s2">, </span><span class="s5">4</span><span class="s1">)))</span>
        <span class="s1">ax = _check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">kind=</span><span class="s3">&quot;kde&quot;</span><span class="s1">)</span>
        <span class="s1">expected = [pprint_thing(c) </span><span class="s2">for </span><span class="s1">c </span><span class="s2">in </span><span class="s1">df.columns]</span>
        <span class="s1">_check_legend_labels(ax</span><span class="s2">, </span><span class="s1">labels=expected)</span>
        <span class="s1">_check_ticks_props(ax</span><span class="s2">, </span><span class="s1">xrot=</span><span class="s5">0</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_kde_df_rot(self):</span>
        <span class="s1">pytest.importorskip(</span><span class="s3">&quot;scipy&quot;</span><span class="s1">)</span>
        <span class="s1">df = DataFrame(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">4</span><span class="s1">)))</span>
        <span class="s1">ax = df.plot(kind=</span><span class="s3">&quot;kde&quot;</span><span class="s2">, </span><span class="s1">rot=</span><span class="s5">20</span><span class="s2">, </span><span class="s1">fontsize=</span><span class="s5">5</span><span class="s1">)</span>
        <span class="s1">_check_ticks_props(ax</span><span class="s2">, </span><span class="s1">xrot=</span><span class="s5">20</span><span class="s2">, </span><span class="s1">xlabelsize=</span><span class="s5">5</span><span class="s2">, </span><span class="s1">ylabelsize=</span><span class="s5">5</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_kde_df_subplots(self):</span>
        <span class="s1">pytest.importorskip(</span><span class="s3">&quot;scipy&quot;</span><span class="s1">)</span>
        <span class="s1">df = DataFrame(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">4</span><span class="s1">)))</span>
        <span class="s1">axes = _check_plot_works(</span>
            <span class="s1">df.plot</span><span class="s2">,</span>
            <span class="s1">default_axes=</span><span class="s2">True,</span>
            <span class="s1">kind=</span><span class="s3">&quot;kde&quot;</span><span class="s2">,</span>
            <span class="s1">subplots=</span><span class="s2">True,</span>
        <span class="s1">)</span>
        <span class="s1">_check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s5">4</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s5">4</span><span class="s2">, </span><span class="s5">1</span><span class="s1">))</span>

    <span class="s2">def </span><span class="s1">test_kde_df_logy(self):</span>
        <span class="s1">pytest.importorskip(</span><span class="s3">&quot;scipy&quot;</span><span class="s1">)</span>
        <span class="s1">df = DataFrame(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">4</span><span class="s1">)))</span>
        <span class="s1">axes = df.plot(kind=</span><span class="s3">&quot;kde&quot;</span><span class="s2">, </span><span class="s1">logy=</span><span class="s2">True, </span><span class="s1">subplots=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">_check_ax_scales(axes</span><span class="s2">, </span><span class="s1">yaxis=</span><span class="s3">&quot;log&quot;</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_kde_missing_vals(self):</span>
        <span class="s1">pytest.importorskip(</span><span class="s3">&quot;scipy&quot;</span><span class="s1">)</span>
        <span class="s1">df = DataFrame(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).uniform(size=(</span><span class="s5">100</span><span class="s2">, </span><span class="s5">4</span><span class="s1">)))</span>
        <span class="s1">df.loc[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">] = np.nan</span>
        <span class="s1">_check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">kind=</span><span class="s3">&quot;kde&quot;</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_hist_df(self):</span>
        <span class="s1">df = DataFrame(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">100</span><span class="s2">, </span><span class="s5">4</span><span class="s1">)))</span>

        <span class="s1">ax = _check_plot_works(df.plot.hist)</span>
        <span class="s1">expected = [pprint_thing(c) </span><span class="s2">for </span><span class="s1">c </span><span class="s2">in </span><span class="s1">df.columns]</span>
        <span class="s1">_check_legend_labels(ax</span><span class="s2">, </span><span class="s1">labels=expected)</span>

        <span class="s1">axes = _check_plot_works(</span>
            <span class="s1">df.plot.hist</span><span class="s2">,</span>
            <span class="s1">default_axes=</span><span class="s2">True,</span>
            <span class="s1">subplots=</span><span class="s2">True,</span>
            <span class="s1">logy=</span><span class="s2">True,</span>
        <span class="s1">)</span>
        <span class="s1">_check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s5">4</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s5">4</span><span class="s2">, </span><span class="s5">1</span><span class="s1">))</span>
        <span class="s1">_check_ax_scales(axes</span><span class="s2">, </span><span class="s1">yaxis=</span><span class="s3">&quot;log&quot;</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_hist_df_series(self):</span>
        <span class="s1">series = Series(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random(</span><span class="s5">10</span><span class="s1">))</span>
        <span class="s1">axes = series.plot.hist(rot=</span><span class="s5">40</span><span class="s1">)</span>
        <span class="s1">_check_ticks_props(axes</span><span class="s2">, </span><span class="s1">xrot=</span><span class="s5">40</span><span class="s2">, </span><span class="s1">yrot=</span><span class="s5">0</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_hist_df_series_cumulative_density(self):</span>
        <span class="s2">from </span><span class="s1">matplotlib.patches </span><span class="s2">import </span><span class="s1">Rectangle</span>

        <span class="s1">series = Series(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random(</span><span class="s5">10</span><span class="s1">))</span>
        <span class="s1">ax = series.plot.hist(cumulative=</span><span class="s2">True, </span><span class="s1">bins=</span><span class="s5">4</span><span class="s2">, </span><span class="s1">density=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s4"># height of last bin (index 5) must be 1.0</span>
        <span class="s1">rects = [x </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">ax.get_children() </span><span class="s2">if </span><span class="s1">isinstance(x</span><span class="s2">, </span><span class="s1">Rectangle)]</span>
        <span class="s1">tm.assert_almost_equal(rects[-</span><span class="s5">1</span><span class="s1">].get_height()</span><span class="s2">, </span><span class="s5">1.0</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_hist_df_series_cumulative(self):</span>
        <span class="s2">from </span><span class="s1">matplotlib.patches </span><span class="s2">import </span><span class="s1">Rectangle</span>

        <span class="s1">series = Series(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random(</span><span class="s5">10</span><span class="s1">))</span>
        <span class="s1">ax = series.plot.hist(cumulative=</span><span class="s2">True, </span><span class="s1">bins=</span><span class="s5">4</span><span class="s1">)</span>
        <span class="s1">rects = [x </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">ax.get_children() </span><span class="s2">if </span><span class="s1">isinstance(x</span><span class="s2">, </span><span class="s1">Rectangle)]</span>

        <span class="s1">tm.assert_almost_equal(rects[-</span><span class="s5">2</span><span class="s1">].get_height()</span><span class="s2">, </span><span class="s5">10.0</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_hist_df_orientation(self):</span>
        <span class="s1">df = DataFrame(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">4</span><span class="s1">)))</span>
        <span class="s4"># if horizontal, yticklabels are rotated</span>
        <span class="s1">axes = df.plot.hist(rot=</span><span class="s5">50</span><span class="s2">, </span><span class="s1">fontsize=</span><span class="s5">8</span><span class="s2">, </span><span class="s1">orientation=</span><span class="s3">&quot;horizontal&quot;</span><span class="s1">)</span>
        <span class="s1">_check_ticks_props(axes</span><span class="s2">, </span><span class="s1">xrot=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">yrot=</span><span class="s5">50</span><span class="s2">, </span><span class="s1">ylabelsize=</span><span class="s5">8</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;weights&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s5">0.1 </span><span class="s1">* np.ones(shape=(</span><span class="s5">100</span><span class="s2">,</span><span class="s1">))</span><span class="s2">, </span><span class="s5">0.1 </span><span class="s1">* np.ones(shape=(</span><span class="s5">100</span><span class="s2">, </span><span class="s5">2</span><span class="s1">))]</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_hist_weights(self</span><span class="s2">, </span><span class="s1">weights):</span>
        <span class="s4"># GH 33173</span>

        <span class="s1">df = DataFrame(</span>
            <span class="s1">dict(zip([</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">2</span><span class="s2">, </span><span class="s5">100</span><span class="s1">))))</span>
        <span class="s1">)</span>

        <span class="s1">ax1 = _check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">kind=</span><span class="s3">&quot;hist&quot;</span><span class="s2">, </span><span class="s1">weights=weights)</span>
        <span class="s1">ax2 = _check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">kind=</span><span class="s3">&quot;hist&quot;</span><span class="s1">)</span>

        <span class="s1">patch_height_with_weights = [patch.get_height() </span><span class="s2">for </span><span class="s1">patch </span><span class="s2">in </span><span class="s1">ax1.patches]</span>

        <span class="s4"># original heights with no weights, and we manually multiply with example</span>
        <span class="s4"># weights, so after multiplication, they should be almost same</span>
        <span class="s1">expected_patch_height = [</span><span class="s5">0.1 </span><span class="s1">* patch.get_height() </span><span class="s2">for </span><span class="s1">patch </span><span class="s2">in </span><span class="s1">ax2.patches]</span>

        <span class="s1">tm.assert_almost_equal(patch_height_with_weights</span><span class="s2">, </span><span class="s1">expected_patch_height)</span>

    <span class="s2">def </span><span class="s1">_check_box_coord(</span>
        <span class="s1">self</span><span class="s2">,</span>
        <span class="s1">patches</span><span class="s2">,</span>
        <span class="s1">expected_y=</span><span class="s2">None,</span>
        <span class="s1">expected_h=</span><span class="s2">None,</span>
        <span class="s1">expected_x=</span><span class="s2">None,</span>
        <span class="s1">expected_w=</span><span class="s2">None,</span>
    <span class="s1">):</span>
        <span class="s1">result_y = np.array([p.get_y() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">patches])</span>
        <span class="s1">result_height = np.array([p.get_height() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">patches])</span>
        <span class="s1">result_x = np.array([p.get_x() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">patches])</span>
        <span class="s1">result_width = np.array([p.get_width() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">patches])</span>
        <span class="s4"># dtype is depending on above values, no need to check</span>

        <span class="s2">if </span><span class="s1">expected_y </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">tm.assert_numpy_array_equal(result_y</span><span class="s2">, </span><span class="s1">expected_y</span><span class="s2">, </span><span class="s1">check_dtype=</span><span class="s2">False</span><span class="s1">)</span>
        <span class="s2">if </span><span class="s1">expected_h </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">tm.assert_numpy_array_equal(result_height</span><span class="s2">, </span><span class="s1">expected_h</span><span class="s2">, </span><span class="s1">check_dtype=</span><span class="s2">False</span><span class="s1">)</span>
        <span class="s2">if </span><span class="s1">expected_x </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">tm.assert_numpy_array_equal(result_x</span><span class="s2">, </span><span class="s1">expected_x</span><span class="s2">, </span><span class="s1">check_dtype=</span><span class="s2">False</span><span class="s1">)</span>
        <span class="s2">if </span><span class="s1">expected_w </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">tm.assert_numpy_array_equal(result_width</span><span class="s2">, </span><span class="s1">expected_w</span><span class="s2">, </span><span class="s1">check_dtype=</span><span class="s2">False</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;data&quot;</span><span class="s2">,</span>
        <span class="s1">[</span>
            <span class="s1">{</span>
                <span class="s3">&quot;A&quot;</span><span class="s1">: np.repeat(np.array([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s1">])</span><span class="s2">, </span><span class="s1">np.array([</span><span class="s5">10</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s5">6</span><span class="s1">]))</span><span class="s2">,</span>
                <span class="s3">&quot;B&quot;</span><span class="s1">: np.repeat(np.array([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s1">])</span><span class="s2">, </span><span class="s1">np.array([</span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s1">]))</span><span class="s2">,</span>
                <span class="s3">&quot;C&quot;</span><span class="s1">: np.repeat(np.array([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s1">])</span><span class="s2">, </span><span class="s1">np.array([</span><span class="s5">6</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s5">10</span><span class="s1">]))</span><span class="s2">,</span>
            <span class="s1">}</span><span class="s2">,</span>
            <span class="s1">{</span>
                <span class="s3">&quot;A&quot;</span><span class="s1">: np.repeat(</span>
                    <span class="s1">np.array([np.nan</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s1">])</span><span class="s2">, </span><span class="s1">np.array([</span><span class="s5">3</span><span class="s2">, </span><span class="s5">10</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s5">6</span><span class="s1">])</span>
                <span class="s1">)</span><span class="s2">,</span>
                <span class="s3">&quot;B&quot;</span><span class="s1">: np.repeat(</span>
                    <span class="s1">np.array([</span><span class="s5">1</span><span class="s2">, </span><span class="s1">np.nan</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s1">])</span><span class="s2">, </span><span class="s1">np.array([</span><span class="s5">8</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s1">])</span>
                <span class="s1">)</span><span class="s2">,</span>
                <span class="s3">&quot;C&quot;</span><span class="s1">: np.repeat(</span>
                    <span class="s1">np.array([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s1">np.nan</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s1">])</span><span class="s2">, </span><span class="s1">np.array([</span><span class="s5">6</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s5">10</span><span class="s1">])</span>
                <span class="s1">)</span><span class="s2">,</span>
            <span class="s1">}</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_hist_df_coord(self</span><span class="s2">, </span><span class="s1">data):</span>
        <span class="s1">df = DataFrame(data)</span>

        <span class="s1">ax = df.plot.hist(bins=</span><span class="s5">5</span><span class="s1">)</span>
        <span class="s1">self._check_box_coord(</span>
            <span class="s1">ax.patches[:</span><span class="s5">5</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">expected_y=np.array([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">expected_h=np.array([</span><span class="s5">10</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s5">6</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">self._check_box_coord(</span>
            <span class="s1">ax.patches[</span><span class="s5">5</span><span class="s1">:</span><span class="s5">10</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">expected_y=np.array([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">expected_h=np.array([</span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">self._check_box_coord(</span>
            <span class="s1">ax.patches[</span><span class="s5">10</span><span class="s1">:]</span><span class="s2">,</span>
            <span class="s1">expected_y=np.array([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">expected_h=np.array([</span><span class="s5">6</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s5">10</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>

        <span class="s1">ax = df.plot.hist(bins=</span><span class="s5">5</span><span class="s2">, </span><span class="s1">stacked=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">self._check_box_coord(</span>
            <span class="s1">ax.patches[:</span><span class="s5">5</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">expected_y=np.array([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">expected_h=np.array([</span><span class="s5">10</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s5">6</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">self._check_box_coord(</span>
            <span class="s1">ax.patches[</span><span class="s5">5</span><span class="s1">:</span><span class="s5">10</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">expected_y=np.array([</span><span class="s5">10</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s5">6</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">expected_h=np.array([</span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">self._check_box_coord(</span>
            <span class="s1">ax.patches[</span><span class="s5">10</span><span class="s1">:]</span><span class="s2">,</span>
            <span class="s1">expected_y=np.array([</span><span class="s5">18</span><span class="s2">, </span><span class="s5">17</span><span class="s2">, </span><span class="s5">16</span><span class="s2">, </span><span class="s5">15</span><span class="s2">, </span><span class="s5">14</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">expected_h=np.array([</span><span class="s5">6</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s5">10</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>

        <span class="s1">axes = df.plot.hist(bins=</span><span class="s5">5</span><span class="s2">, </span><span class="s1">stacked=</span><span class="s2">True, </span><span class="s1">subplots=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">self._check_box_coord(</span>
            <span class="s1">axes[</span><span class="s5">0</span><span class="s1">].patches</span><span class="s2">,</span>
            <span class="s1">expected_y=np.array([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">expected_h=np.array([</span><span class="s5">10</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s5">6</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">self._check_box_coord(</span>
            <span class="s1">axes[</span><span class="s5">1</span><span class="s1">].patches</span><span class="s2">,</span>
            <span class="s1">expected_y=np.array([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">expected_h=np.array([</span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">self._check_box_coord(</span>
            <span class="s1">axes[</span><span class="s5">2</span><span class="s1">].patches</span><span class="s2">,</span>
            <span class="s1">expected_y=np.array([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">expected_h=np.array([</span><span class="s5">6</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s5">10</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>

        <span class="s4"># horizontal</span>
        <span class="s1">ax = df.plot.hist(bins=</span><span class="s5">5</span><span class="s2">, </span><span class="s1">orientation=</span><span class="s3">&quot;horizontal&quot;</span><span class="s1">)</span>
        <span class="s1">self._check_box_coord(</span>
            <span class="s1">ax.patches[:</span><span class="s5">5</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">expected_x=np.array([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">expected_w=np.array([</span><span class="s5">10</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s5">6</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">self._check_box_coord(</span>
            <span class="s1">ax.patches[</span><span class="s5">5</span><span class="s1">:</span><span class="s5">10</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">expected_x=np.array([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">expected_w=np.array([</span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">self._check_box_coord(</span>
            <span class="s1">ax.patches[</span><span class="s5">10</span><span class="s1">:]</span><span class="s2">,</span>
            <span class="s1">expected_x=np.array([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">expected_w=np.array([</span><span class="s5">6</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s5">10</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>

        <span class="s1">ax = df.plot.hist(bins=</span><span class="s5">5</span><span class="s2">, </span><span class="s1">stacked=</span><span class="s2">True, </span><span class="s1">orientation=</span><span class="s3">&quot;horizontal&quot;</span><span class="s1">)</span>
        <span class="s1">self._check_box_coord(</span>
            <span class="s1">ax.patches[:</span><span class="s5">5</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">expected_x=np.array([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">expected_w=np.array([</span><span class="s5">10</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s5">6</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">self._check_box_coord(</span>
            <span class="s1">ax.patches[</span><span class="s5">5</span><span class="s1">:</span><span class="s5">10</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">expected_x=np.array([</span><span class="s5">10</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s5">6</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">expected_w=np.array([</span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">self._check_box_coord(</span>
            <span class="s1">ax.patches[</span><span class="s5">10</span><span class="s1">:]</span><span class="s2">,</span>
            <span class="s1">expected_x=np.array([</span><span class="s5">18</span><span class="s2">, </span><span class="s5">17</span><span class="s2">, </span><span class="s5">16</span><span class="s2">, </span><span class="s5">15</span><span class="s2">, </span><span class="s5">14</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">expected_w=np.array([</span><span class="s5">6</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s5">10</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>

        <span class="s1">axes = df.plot.hist(</span>
            <span class="s1">bins=</span><span class="s5">5</span><span class="s2">, </span><span class="s1">stacked=</span><span class="s2">True, </span><span class="s1">subplots=</span><span class="s2">True, </span><span class="s1">orientation=</span><span class="s3">&quot;horizontal&quot;</span>
        <span class="s1">)</span>
        <span class="s1">self._check_box_coord(</span>
            <span class="s1">axes[</span><span class="s5">0</span><span class="s1">].patches</span><span class="s2">,</span>
            <span class="s1">expected_x=np.array([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">expected_w=np.array([</span><span class="s5">10</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s5">6</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">self._check_box_coord(</span>
            <span class="s1">axes[</span><span class="s5">1</span><span class="s1">].patches</span><span class="s2">,</span>
            <span class="s1">expected_x=np.array([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">expected_w=np.array([</span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">self._check_box_coord(</span>
            <span class="s1">axes[</span><span class="s5">2</span><span class="s1">].patches</span><span class="s2">,</span>
            <span class="s1">expected_x=np.array([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">expected_w=np.array([</span><span class="s5">6</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s5">10</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_plot_int_columns(self):</span>
        <span class="s1">df = DataFrame(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">100</span><span class="s2">, </span><span class="s5">4</span><span class="s1">))).cumsum()</span>
        <span class="s1">_check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">legend=</span><span class="s2">True</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;markers&quot;</span><span class="s2">,</span>
        <span class="s1">[</span>
            <span class="s1">{</span><span class="s5">0</span><span class="s1">: </span><span class="s3">&quot;^&quot;</span><span class="s2">, </span><span class="s5">1</span><span class="s1">: </span><span class="s3">&quot;+&quot;</span><span class="s2">, </span><span class="s5">2</span><span class="s1">: </span><span class="s3">&quot;o&quot;</span><span class="s1">}</span><span class="s2">,</span>
            <span class="s1">{</span><span class="s5">0</span><span class="s1">: </span><span class="s3">&quot;^&quot;</span><span class="s2">, </span><span class="s5">1</span><span class="s1">: </span><span class="s3">&quot;+&quot;</span><span class="s1">}</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s3">&quot;^&quot;</span><span class="s2">, </span><span class="s3">&quot;+&quot;</span><span class="s2">, </span><span class="s3">&quot;o&quot;</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">[</span><span class="s3">&quot;^&quot;</span><span class="s2">, </span><span class="s3">&quot;+&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_style_by_column(self</span><span class="s2">, </span><span class="s1">markers):</span>
        <span class="s2">import </span><span class="s1">matplotlib.pyplot </span><span class="s2">as </span><span class="s1">plt</span>

        <span class="s1">fig = plt.gcf()</span>
        <span class="s1">fig.clf()</span>
        <span class="s1">fig.add_subplot(</span><span class="s5">111</span><span class="s1">)</span>
        <span class="s1">df = DataFrame(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">3</span><span class="s1">)))</span>
        <span class="s1">ax = df.plot(style=markers)</span>
        <span class="s2">for </span><span class="s1">idx</span><span class="s2">, </span><span class="s1">line </span><span class="s2">in </span><span class="s1">enumerate(ax.get_lines()[: len(markers)]):</span>
            <span class="s2">assert </span><span class="s1">line.get_marker() == markers[idx]</span>

    <span class="s2">def </span><span class="s1">test_line_label_none(self):</span>
        <span class="s1">s = Series([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">])</span>
        <span class="s1">ax = s.plot()</span>
        <span class="s2">assert </span><span class="s1">ax.get_legend() </span><span class="s2">is None</span>

        <span class="s1">ax = s.plot(legend=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s2">assert </span><span class="s1">ax.get_legend().get_texts()[</span><span class="s5">0</span><span class="s1">].get_text() == </span><span class="s3">&quot;&quot;</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;props, expected&quot;</span><span class="s2">,</span>
        <span class="s1">[</span>
            <span class="s1">(</span><span class="s3">&quot;boxprops&quot;</span><span class="s2">, </span><span class="s3">&quot;boxes&quot;</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;whiskerprops&quot;</span><span class="s2">, </span><span class="s3">&quot;whiskers&quot;</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;capprops&quot;</span><span class="s2">, </span><span class="s3">&quot;caps&quot;</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;medianprops&quot;</span><span class="s2">, </span><span class="s3">&quot;medians&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_specified_props_kwd_plot_box(self</span><span class="s2">, </span><span class="s1">props</span><span class="s2">, </span><span class="s1">expected):</span>
        <span class="s4"># GH 30346</span>
        <span class="s1">df = DataFrame({k: np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random(</span><span class="s5">100</span><span class="s1">) </span><span class="s2">for </span><span class="s1">k </span><span class="s2">in </span><span class="s3">&quot;ABC&quot;</span><span class="s1">})</span>
        <span class="s1">kwd = {props: {</span><span class="s3">&quot;color&quot;</span><span class="s1">: </span><span class="s3">&quot;C1&quot;</span><span class="s1">}}</span>
        <span class="s1">result = df.plot.box(return_type=</span><span class="s3">&quot;dict&quot;</span><span class="s2">, </span><span class="s1">**kwd)</span>

        <span class="s2">assert </span><span class="s1">result[expected][</span><span class="s5">0</span><span class="s1">].get_color() == </span><span class="s3">&quot;C1&quot;</span>

    <span class="s2">def </span><span class="s1">test_unordered_ts(self):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.array([</span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">, </span><span class="s5">1.0</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">index=[date(</span><span class="s5">2012</span><span class="s2">, </span><span class="s5">10</span><span class="s2">, </span><span class="s5">1</span><span class="s1">)</span><span class="s2">, </span><span class="s1">date(</span><span class="s5">2012</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s5">1</span><span class="s1">)</span><span class="s2">, </span><span class="s1">date(</span><span class="s5">2012</span><span class="s2">, </span><span class="s5">8</span><span class="s2">, </span><span class="s5">1</span><span class="s1">)]</span><span class="s2">,</span>
            <span class="s1">columns=[</span><span class="s3">&quot;test&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">ax = df.plot()</span>
        <span class="s1">xticks = ax.lines[</span><span class="s5">0</span><span class="s1">].get_xdata()</span>
        <span class="s2">assert </span><span class="s1">xticks[</span><span class="s5">0</span><span class="s1">] &lt; xticks[</span><span class="s5">1</span><span class="s1">]</span>
        <span class="s1">ydata = ax.lines[</span><span class="s5">0</span><span class="s1">].get_ydata()</span>
        <span class="s1">tm.assert_numpy_array_equal(ydata</span><span class="s2">, </span><span class="s1">np.array([</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s1">]))</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;kind&quot;</span><span class="s2">, </span><span class="s1">plotting.PlotAccessor._common_kinds)</span>
    <span class="s2">def </span><span class="s1">test_kind_both_ways(self</span><span class="s2">, </span><span class="s1">kind):</span>
        <span class="s1">pytest.importorskip(</span><span class="s3">&quot;scipy&quot;</span><span class="s1">)</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;x&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]})</span>
        <span class="s1">df.plot(kind=kind)</span>
        <span class="s1">getattr(df.plot</span><span class="s2">, </span><span class="s1">kind)()</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;kind&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;scatter&quot;</span><span class="s2">, </span><span class="s3">&quot;hexbin&quot;</span><span class="s1">])</span>
    <span class="s2">def </span><span class="s1">test_kind_both_ways_x_y(self</span><span class="s2">, </span><span class="s1">kind):</span>
        <span class="s1">pytest.importorskip(</span><span class="s3">&quot;scipy&quot;</span><span class="s1">)</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;x&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]})</span>
        <span class="s1">df.plot(</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s1">kind=kind)</span>
        <span class="s1">getattr(df.plot</span><span class="s2">, </span><span class="s1">kind)(</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;x&quot;</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;kind&quot;</span><span class="s2">, </span><span class="s1">plotting.PlotAccessor._common_kinds)</span>
    <span class="s2">def </span><span class="s1">test_all_invalid_plot_data(self</span><span class="s2">, </span><span class="s1">kind):</span>
        <span class="s1">df = DataFrame(list(</span><span class="s3">&quot;abcd&quot;</span><span class="s1">))</span>
        <span class="s1">msg = </span><span class="s3">&quot;no numeric data to plot&quot;</span>
        <span class="s2">with </span><span class="s1">pytest.raises(TypeError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.plot(kind=kind)</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;kind&quot;</span><span class="s2">, </span><span class="s1">list(plotting.PlotAccessor._common_kinds) + [</span><span class="s3">&quot;area&quot;</span><span class="s1">]</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_partially_invalid_plot_data_numeric(self</span><span class="s2">, </span><span class="s1">kind):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">2</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">dtype=object</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">df[np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random(df.shape[</span><span class="s5">0</span><span class="s1">]) &gt; </span><span class="s5">0.5</span><span class="s1">] = </span><span class="s3">&quot;a&quot;</span>
        <span class="s1">msg = </span><span class="s3">&quot;no numeric data to plot&quot;</span>
        <span class="s2">with </span><span class="s1">pytest.raises(TypeError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.plot(kind=kind)</span>

    <span class="s2">def </span><span class="s1">test_invalid_kind(self):</span>
        <span class="s1">df = DataFrame(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">2</span><span class="s1">)))</span>
        <span class="s1">msg = </span><span class="s3">&quot;invalid_plot_kind is not a valid plot kind&quot;</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.plot(kind=</span><span class="s3">&quot;invalid_plot_kind&quot;</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;x,y,lbl&quot;</span><span class="s2">,</span>
        <span class="s1">[</span>
            <span class="s1">([</span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">([</span><span class="s3">&quot;A&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_invalid_xy_args(self</span><span class="s2">, </span><span class="s1">x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s1">lbl):</span>
        <span class="s4"># GH 18671, 19699 allows y to be list-like but not x</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s1">: [</span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s1">: [</span><span class="s5">5</span><span class="s2">, </span><span class="s5">6</span><span class="s1">]})</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=</span><span class="s3">&quot;x must be a label or position&quot;</span><span class="s1">):</span>
            <span class="s1">df.plot(x=x</span><span class="s2">, </span><span class="s1">y=y</span><span class="s2">, </span><span class="s1">label=lbl)</span>

    <span class="s2">def </span><span class="s1">test_bad_label(self):</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s1">: [</span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s1">: [</span><span class="s5">5</span><span class="s2">, </span><span class="s5">6</span><span class="s1">]})</span>
        <span class="s1">msg = </span><span class="s3">&quot;label should be list-like and same length as y&quot;</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.plot(x=</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s1">y=[</span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">label=</span><span class="s3">&quot;bad_label&quot;</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;x,y&quot;</span><span class="s2">, </span><span class="s1">[(</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">([</span><span class="s3">&quot;A&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s1">)])</span>
    <span class="s2">def </span><span class="s1">test_invalid_xy_args_dup_cols(self</span><span class="s2">, </span><span class="s1">x</span><span class="s2">, </span><span class="s1">y):</span>
        <span class="s4"># GH 18671, 19699 allows y to be list-like but not x</span>
        <span class="s1">df = DataFrame([[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">5</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s5">2</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">6</span><span class="s1">]]</span><span class="s2">, </span><span class="s1">columns=list(</span><span class="s3">&quot;AAB&quot;</span><span class="s1">))</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=</span><span class="s3">&quot;x must be a label or position&quot;</span><span class="s1">):</span>
            <span class="s1">df.plot(x=x</span><span class="s2">, </span><span class="s1">y=y)</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;x,y,lbl,colors&quot;</span><span class="s2">,</span>
        <span class="s1">[</span>
            <span class="s1">(</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;B&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;b&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;red&quot;</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;red&quot;</span><span class="s2">, </span><span class="s3">&quot;blue&quot;</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;bokeh&quot;</span><span class="s2">, </span><span class="s3">&quot;cython&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;green&quot;</span><span class="s2">, </span><span class="s3">&quot;yellow&quot;</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_y_listlike(self</span><span class="s2">, </span><span class="s1">x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s1">lbl</span><span class="s2">, </span><span class="s1">colors):</span>
        <span class="s4"># GH 19699: tests list-like y and verifies lbls &amp; colors</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s1">: [</span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s1">: [</span><span class="s5">5</span><span class="s2">, </span><span class="s5">6</span><span class="s1">]})</span>
        <span class="s1">_check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">x=</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s1">y=y</span><span class="s2">, </span><span class="s1">label=lbl)</span>

        <span class="s1">ax = df.plot(x=x</span><span class="s2">, </span><span class="s1">y=y</span><span class="s2">, </span><span class="s1">label=lbl</span><span class="s2">, </span><span class="s1">color=colors)</span>
        <span class="s2">assert </span><span class="s1">len(ax.lines) == len(y)</span>
        <span class="s1">_check_colors(ax.get_lines()</span><span class="s2">, </span><span class="s1">linecolors=colors)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;x,y,colnames&quot;</span><span class="s2">, </span><span class="s1">[(</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s1">])</span><span class="s2">, </span><span class="s1">(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s1">[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s1">])])</span>
    <span class="s2">def </span><span class="s1">test_xy_args_integer(self</span><span class="s2">, </span><span class="s1">x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s1">colnames):</span>
        <span class="s4"># GH 20056: tests integer args for xy and checks col names</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s1">: [</span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s1">]})</span>
        <span class="s1">df.columns = colnames</span>
        <span class="s1">_check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">x=x</span><span class="s2">, </span><span class="s1">y=y)</span>

    <span class="s2">def </span><span class="s1">test_hexbin_basic(self):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">{</span>
                <span class="s3">&quot;A&quot;</span><span class="s1">: np.random.default_rng(</span><span class="s5">2</span><span class="s1">).uniform(size=</span><span class="s5">20</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s3">&quot;B&quot;</span><span class="s1">: np.random.default_rng(</span><span class="s5">2</span><span class="s1">).uniform(size=</span><span class="s5">20</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s3">&quot;C&quot;</span><span class="s1">: np.arange(</span><span class="s5">20</span><span class="s1">) + np.random.default_rng(</span><span class="s5">2</span><span class="s1">).uniform(size=</span><span class="s5">20</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">}</span>
        <span class="s1">)</span>

        <span class="s1">ax = df.plot.hexbin(x=</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s1">gridsize=</span><span class="s5">10</span><span class="s1">)</span>
        <span class="s4"># TODO: need better way to test. This just does existence.</span>
        <span class="s2">assert </span><span class="s1">len(ax.collections) == </span><span class="s5">1</span>

    <span class="s2">def </span><span class="s1">test_hexbin_basic_subplots(self):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">{</span>
                <span class="s3">&quot;A&quot;</span><span class="s1">: np.random.default_rng(</span><span class="s5">2</span><span class="s1">).uniform(size=</span><span class="s5">20</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s3">&quot;B&quot;</span><span class="s1">: np.random.default_rng(</span><span class="s5">2</span><span class="s1">).uniform(size=</span><span class="s5">20</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s3">&quot;C&quot;</span><span class="s1">: np.arange(</span><span class="s5">20</span><span class="s1">) + np.random.default_rng(</span><span class="s5">2</span><span class="s1">).uniform(size=</span><span class="s5">20</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">}</span>
        <span class="s1">)</span>
        <span class="s4"># GH 6951</span>
        <span class="s1">axes = df.plot.hexbin(x=</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s1">subplots=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s4"># hexbin should have 2 axes in the figure, 1 for plotting and another</span>
        <span class="s4"># is colorbar</span>
        <span class="s2">assert </span><span class="s1">len(axes[</span><span class="s5">0</span><span class="s1">].figure.axes) == </span><span class="s5">2</span>
        <span class="s4"># return value is single axes</span>
        <span class="s1">_check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">))</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;reduce_C&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s2">None, </span><span class="s1">np.std])</span>
    <span class="s2">def </span><span class="s1">test_hexbin_with_c(self</span><span class="s2">, </span><span class="s1">reduce_C):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">{</span>
                <span class="s3">&quot;A&quot;</span><span class="s1">: np.random.default_rng(</span><span class="s5">2</span><span class="s1">).uniform(size=</span><span class="s5">20</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s3">&quot;B&quot;</span><span class="s1">: np.random.default_rng(</span><span class="s5">2</span><span class="s1">).uniform(size=</span><span class="s5">20</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s3">&quot;C&quot;</span><span class="s1">: np.arange(</span><span class="s5">20</span><span class="s1">) + np.random.default_rng(</span><span class="s5">2</span><span class="s1">).uniform(size=</span><span class="s5">20</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">}</span>
        <span class="s1">)</span>

        <span class="s1">ax = df.plot.hexbin(x=</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s1">C=</span><span class="s3">&quot;C&quot;</span><span class="s2">, </span><span class="s1">reduce_C_function=reduce_C)</span>
        <span class="s2">assert </span><span class="s1">len(ax.collections) == </span><span class="s5">1</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;kwargs, expected&quot;</span><span class="s2">,</span>
        <span class="s1">[</span>
            <span class="s1">({}</span><span class="s2">, </span><span class="s3">&quot;BuGn&quot;</span><span class="s1">)</span><span class="s2">,  </span><span class="s4"># default cmap</span>
            <span class="s1">({</span><span class="s3">&quot;colormap&quot;</span><span class="s1">: </span><span class="s3">&quot;cubehelix&quot;</span><span class="s1">}</span><span class="s2">, </span><span class="s3">&quot;cubehelix&quot;</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">({</span><span class="s3">&quot;cmap&quot;</span><span class="s1">: </span><span class="s3">&quot;YlGn&quot;</span><span class="s1">}</span><span class="s2">, </span><span class="s3">&quot;YlGn&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_hexbin_cmap(self</span><span class="s2">, </span><span class="s1">kwargs</span><span class="s2">, </span><span class="s1">expected):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">{</span>
                <span class="s3">&quot;A&quot;</span><span class="s1">: np.random.default_rng(</span><span class="s5">2</span><span class="s1">).uniform(size=</span><span class="s5">20</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s3">&quot;B&quot;</span><span class="s1">: np.random.default_rng(</span><span class="s5">2</span><span class="s1">).uniform(size=</span><span class="s5">20</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s3">&quot;C&quot;</span><span class="s1">: np.arange(</span><span class="s5">20</span><span class="s1">) + np.random.default_rng(</span><span class="s5">2</span><span class="s1">).uniform(size=</span><span class="s5">20</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">}</span>
        <span class="s1">)</span>
        <span class="s1">ax = df.plot.hexbin(x=</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s1">**kwargs)</span>
        <span class="s2">assert </span><span class="s1">ax.collections[</span><span class="s5">0</span><span class="s1">].cmap.name == expected</span>

    <span class="s2">def </span><span class="s1">test_pie_df_err(self):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">5</span><span class="s2">, </span><span class="s5">3</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">columns=[</span><span class="s3">&quot;X&quot;</span><span class="s2">, </span><span class="s3">&quot;Y&quot;</span><span class="s2">, </span><span class="s3">&quot;Z&quot;</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">index=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">, </span><span class="s3">&quot;e&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">msg = </span><span class="s3">&quot;pie requires either y column or 'subplots=True'&quot;</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.plot.pie()</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;Y&quot;</span><span class="s2">, </span><span class="s5">2</span><span class="s1">])</span>
    <span class="s2">def </span><span class="s1">test_pie_df(self</span><span class="s2">, </span><span class="s1">y):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">5</span><span class="s2">, </span><span class="s5">3</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">columns=[</span><span class="s3">&quot;X&quot;</span><span class="s2">, </span><span class="s3">&quot;Y&quot;</span><span class="s2">, </span><span class="s3">&quot;Z&quot;</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">index=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">, </span><span class="s3">&quot;e&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">ax = _check_plot_works(df.plot.pie</span><span class="s2">, </span><span class="s1">y=y)</span>
        <span class="s1">_check_text_labels(ax.texts</span><span class="s2">, </span><span class="s1">df.index)</span>

    <span class="s2">def </span><span class="s1">test_pie_df_subplots(self):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">5</span><span class="s2">, </span><span class="s5">3</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">columns=[</span><span class="s3">&quot;X&quot;</span><span class="s2">, </span><span class="s3">&quot;Y&quot;</span><span class="s2">, </span><span class="s3">&quot;Z&quot;</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">index=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">, </span><span class="s3">&quot;e&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">axes = _check_plot_works(</span>
            <span class="s1">df.plot.pie</span><span class="s2">,</span>
            <span class="s1">default_axes=</span><span class="s2">True,</span>
            <span class="s1">subplots=</span><span class="s2">True,</span>
        <span class="s1">)</span>
        <span class="s2">assert </span><span class="s1">len(axes) == len(df.columns)</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes:</span>
            <span class="s1">_check_text_labels(ax.texts</span><span class="s2">, </span><span class="s1">df.index)</span>
        <span class="s2">for </span><span class="s1">ax</span><span class="s2">, </span><span class="s1">ylabel </span><span class="s2">in </span><span class="s1">zip(axes</span><span class="s2">, </span><span class="s1">df.columns):</span>
            <span class="s2">assert </span><span class="s1">ax.get_ylabel() == ylabel</span>

    <span class="s2">def </span><span class="s1">test_pie_df_labels_colors(self):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">5</span><span class="s2">, </span><span class="s5">3</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">columns=[</span><span class="s3">&quot;X&quot;</span><span class="s2">, </span><span class="s3">&quot;Y&quot;</span><span class="s2">, </span><span class="s3">&quot;Z&quot;</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">index=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">, </span><span class="s3">&quot;e&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">labels = [</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s2">, </span><span class="s3">&quot;D&quot;</span><span class="s2">, </span><span class="s3">&quot;E&quot;</span><span class="s1">]</span>
        <span class="s1">color_args = [</span><span class="s3">&quot;r&quot;</span><span class="s2">, </span><span class="s3">&quot;g&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;m&quot;</span><span class="s1">]</span>
        <span class="s1">axes = _check_plot_works(</span>
            <span class="s1">df.plot.pie</span><span class="s2">,</span>
            <span class="s1">default_axes=</span><span class="s2">True,</span>
            <span class="s1">subplots=</span><span class="s2">True,</span>
            <span class="s1">labels=labels</span><span class="s2">,</span>
            <span class="s1">colors=color_args</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s2">assert </span><span class="s1">len(axes) == len(df.columns)</span>

        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes:</span>
            <span class="s1">_check_text_labels(ax.texts</span><span class="s2">, </span><span class="s1">labels)</span>
            <span class="s1">_check_colors(ax.patches</span><span class="s2">, </span><span class="s1">facecolors=color_args)</span>

    <span class="s2">def </span><span class="s1">test_pie_df_nan(self):</span>
        <span class="s1">df = DataFrame(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">4</span><span class="s2">, </span><span class="s5">4</span><span class="s1">)))</span>
        <span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range(</span><span class="s5">4</span><span class="s1">):</span>
            <span class="s1">df.iloc[i</span><span class="s2">, </span><span class="s1">i] = np.nan</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">axes = mpl.pyplot.subplots(ncols=</span><span class="s5">4</span><span class="s1">)</span>

        <span class="s4"># GH 37668</span>
        <span class="s1">kwargs = {</span><span class="s3">&quot;normalize&quot;</span><span class="s1">: </span><span class="s2">True</span><span class="s1">}</span>

        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(</span><span class="s2">None</span><span class="s1">):</span>
            <span class="s1">df.plot.pie(subplots=</span><span class="s2">True, </span><span class="s1">ax=axes</span><span class="s2">, </span><span class="s1">legend=</span><span class="s2">True, </span><span class="s1">**kwargs)</span>

        <span class="s1">base_expected = [</span><span class="s3">&quot;0&quot;</span><span class="s2">, </span><span class="s3">&quot;1&quot;</span><span class="s2">, </span><span class="s3">&quot;2&quot;</span><span class="s2">, </span><span class="s3">&quot;3&quot;</span><span class="s1">]</span>
        <span class="s2">for </span><span class="s1">i</span><span class="s2">, </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">enumerate(axes):</span>
            <span class="s1">expected = list(base_expected)  </span><span class="s4"># force copy</span>
            <span class="s1">expected[i] = </span><span class="s3">&quot;&quot;</span>
            <span class="s1">result = [x.get_text() </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">ax.texts]</span>
            <span class="s2">assert </span><span class="s1">result == expected</span>

            <span class="s4"># legend labels</span>
            <span class="s4"># NaN's not included in legend with subplots</span>
            <span class="s4"># see https://github.com/pandas-dev/pandas/issues/8390</span>
            <span class="s1">result_labels = [x.get_text() </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">ax.get_legend().get_texts()]</span>
            <span class="s1">expected_labels = base_expected[:i] + base_expected[i + </span><span class="s5">1 </span><span class="s1">:]</span>
            <span class="s2">assert </span><span class="s1">result_labels == expected_labels</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;kwargs&quot;</span><span class="s2">,</span>
        <span class="s1">[</span>
            <span class="s1">{</span><span class="s3">&quot;logy&quot;</span><span class="s1">: </span><span class="s2">True</span><span class="s1">}</span><span class="s2">,</span>
            <span class="s1">{</span><span class="s3">&quot;logx&quot;</span><span class="s1">: </span><span class="s2">True, </span><span class="s3">&quot;logy&quot;</span><span class="s1">: </span><span class="s2">True</span><span class="s1">}</span><span class="s2">,</span>
            <span class="s1">{</span><span class="s3">&quot;loglog&quot;</span><span class="s1">: </span><span class="s2">True</span><span class="s1">}</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot(self</span><span class="s2">, </span><span class="s1">kwargs):</span>
        <span class="s1">d = {</span><span class="s3">&quot;x&quot;</span><span class="s1">: np.arange(</span><span class="s5">12</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: np.arange(</span><span class="s5">12</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s1">-</span><span class="s5">1</span><span class="s1">)}</span>
        <span class="s1">df = DataFrame(d)</span>
        <span class="s1">d_err = {</span><span class="s3">&quot;x&quot;</span><span class="s1">: np.ones(</span><span class="s5">12</span><span class="s1">) * </span><span class="s5">0.2</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: np.ones(</span><span class="s5">12</span><span class="s1">) * </span><span class="s5">0.4</span><span class="s1">}</span>
        <span class="s1">df_err = DataFrame(d_err)</span>

        <span class="s4"># check line plots</span>
        <span class="s1">ax = _check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">yerr=df_err</span><span class="s2">, </span><span class="s1">**kwargs)</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">2</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot_bar(self):</span>
        <span class="s1">d = {</span><span class="s3">&quot;x&quot;</span><span class="s1">: np.arange(</span><span class="s5">12</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: np.arange(</span><span class="s5">12</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s1">-</span><span class="s5">1</span><span class="s1">)}</span>
        <span class="s1">df = DataFrame(d)</span>
        <span class="s1">d_err = {</span><span class="s3">&quot;x&quot;</span><span class="s1">: np.ones(</span><span class="s5">12</span><span class="s1">) * </span><span class="s5">0.2</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: np.ones(</span><span class="s5">12</span><span class="s1">) * </span><span class="s5">0.4</span><span class="s1">}</span>
        <span class="s1">df_err = DataFrame(d_err)</span>
        <span class="s1">ax = _check_plot_works(</span>
            <span class="s1">(df + </span><span class="s5">1</span><span class="s1">).plot</span><span class="s2">, </span><span class="s1">yerr=df_err</span><span class="s2">, </span><span class="s1">xerr=df_err</span><span class="s2">, </span><span class="s1">kind=</span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s1">log=</span><span class="s2">True</span>
        <span class="s1">)</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">2</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">2</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot_yerr_array(self):</span>
        <span class="s1">d = {</span><span class="s3">&quot;x&quot;</span><span class="s1">: np.arange(</span><span class="s5">12</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: np.arange(</span><span class="s5">12</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s1">-</span><span class="s5">1</span><span class="s1">)}</span>
        <span class="s1">df = DataFrame(d)</span>
        <span class="s4"># yerr is raw error values</span>
        <span class="s1">ax = _check_plot_works(df[</span><span class="s3">&quot;y&quot;</span><span class="s1">].plot</span><span class="s2">, </span><span class="s1">yerr=np.ones(</span><span class="s5">12</span><span class="s1">) * </span><span class="s5">0.4</span><span class="s1">)</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">1</span><span class="s1">)</span>

        <span class="s1">ax = _check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">yerr=np.ones((</span><span class="s5">2</span><span class="s2">, </span><span class="s5">12</span><span class="s1">)) * </span><span class="s5">0.4</span><span class="s1">)</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">2</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;yerr&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;yerr&quot;</span><span class="s2">, </span><span class="s3">&quot;&quot;</span><span class="s1">])</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot_column_name(self</span><span class="s2">, </span><span class="s1">yerr):</span>
        <span class="s1">d = {</span><span class="s3">&quot;x&quot;</span><span class="s1">: np.arange(</span><span class="s5">12</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: np.arange(</span><span class="s5">12</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s1">-</span><span class="s5">1</span><span class="s1">)}</span>
        <span class="s1">df = DataFrame(d)</span>
        <span class="s1">df[yerr] = np.ones(</span><span class="s5">12</span><span class="s1">) * </span><span class="s5">0.2</span>

        <span class="s1">ax = _check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">yerr=yerr)</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">2</span><span class="s1">)</span>

        <span class="s1">ax = _check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s1">x=</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s1">yerr=yerr)</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">1</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot_external_valueerror(self):</span>
        <span class="s1">d = {</span><span class="s3">&quot;x&quot;</span><span class="s1">: np.arange(</span><span class="s5">12</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: np.arange(</span><span class="s5">12</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s1">-</span><span class="s5">1</span><span class="s1">)}</span>
        <span class="s1">df = DataFrame(d)</span>
        <span class="s2">with </span><span class="s1">tm.external_error_raised(ValueError):</span>
            <span class="s1">df.plot(yerr=np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal(</span><span class="s5">11</span><span class="s1">))</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot_external_typeerror(self):</span>
        <span class="s1">d = {</span><span class="s3">&quot;x&quot;</span><span class="s1">: np.arange(</span><span class="s5">12</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: np.arange(</span><span class="s5">12</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s1">-</span><span class="s5">1</span><span class="s1">)}</span>
        <span class="s1">df = DataFrame(d)</span>
        <span class="s1">df_err = DataFrame({</span><span class="s3">&quot;x&quot;</span><span class="s1">: [</span><span class="s3">&quot;zzz&quot;</span><span class="s1">] * </span><span class="s5">12</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: [</span><span class="s3">&quot;zzz&quot;</span><span class="s1">] * </span><span class="s5">12</span><span class="s1">})</span>
        <span class="s2">with </span><span class="s1">tm.external_error_raised(TypeError):</span>
            <span class="s1">df.plot(yerr=df_err)</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;kind&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;line&quot;</span><span class="s2">, </span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s3">&quot;barh&quot;</span><span class="s1">])</span>
    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;y_err&quot;</span><span class="s2">,</span>
        <span class="s1">[</span>
            <span class="s1">Series(np.ones(</span><span class="s5">12</span><span class="s1">) * </span><span class="s5">0.2</span><span class="s2">, </span><span class="s1">name=</span><span class="s3">&quot;x&quot;</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">DataFrame({</span><span class="s3">&quot;x&quot;</span><span class="s1">: np.ones(</span><span class="s5">12</span><span class="s1">) * </span><span class="s5">0.2</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: np.ones(</span><span class="s5">12</span><span class="s1">) * </span><span class="s5">0.4</span><span class="s1">})</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot_different_yerr(self</span><span class="s2">, </span><span class="s1">kind</span><span class="s2">, </span><span class="s1">y_err):</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;x&quot;</span><span class="s1">: np.arange(</span><span class="s5">12</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: np.arange(</span><span class="s5">12</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s1">-</span><span class="s5">1</span><span class="s1">)})</span>

        <span class="s1">ax = _check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">yerr=y_err</span><span class="s2">, </span><span class="s1">kind=kind)</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">2</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;kind&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;line&quot;</span><span class="s2">, </span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s3">&quot;barh&quot;</span><span class="s1">])</span>
    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;y_err, x_err&quot;</span><span class="s2">,</span>
        <span class="s1">[</span>
            <span class="s1">(</span>
                <span class="s1">DataFrame({</span><span class="s3">&quot;x&quot;</span><span class="s1">: np.ones(</span><span class="s5">12</span><span class="s1">) * </span><span class="s5">0.2</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: np.ones(</span><span class="s5">12</span><span class="s1">) * </span><span class="s5">0.4</span><span class="s1">})</span><span class="s2">,</span>
                <span class="s1">DataFrame({</span><span class="s3">&quot;x&quot;</span><span class="s1">: np.ones(</span><span class="s5">12</span><span class="s1">) * </span><span class="s5">0.2</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: np.ones(</span><span class="s5">12</span><span class="s1">) * </span><span class="s5">0.4</span><span class="s1">})</span><span class="s2">,</span>
            <span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(Series(np.ones(</span><span class="s5">12</span><span class="s1">) * </span><span class="s5">0.2</span><span class="s2">, </span><span class="s1">name=</span><span class="s3">&quot;x&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">Series(np.ones(</span><span class="s5">12</span><span class="s1">) * </span><span class="s5">0.2</span><span class="s2">, </span><span class="s1">name=</span><span class="s3">&quot;x&quot;</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s5">0.2</span><span class="s2">, </span><span class="s5">0.2</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot_different_yerr_xerr(self</span><span class="s2">, </span><span class="s1">kind</span><span class="s2">, </span><span class="s1">y_err</span><span class="s2">, </span><span class="s1">x_err):</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;x&quot;</span><span class="s1">: np.arange(</span><span class="s5">12</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: np.arange(</span><span class="s5">12</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s1">-</span><span class="s5">1</span><span class="s1">)})</span>
        <span class="s1">ax = _check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">yerr=y_err</span><span class="s2">, </span><span class="s1">xerr=x_err</span><span class="s2">, </span><span class="s1">kind=kind)</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">2</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">2</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;kind&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;line&quot;</span><span class="s2">, </span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s3">&quot;barh&quot;</span><span class="s1">])</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot_different_yerr_xerr_subplots(self</span><span class="s2">, </span><span class="s1">kind):</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;x&quot;</span><span class="s1">: np.arange(</span><span class="s5">12</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: np.arange(</span><span class="s5">12</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s1">-</span><span class="s5">1</span><span class="s1">)})</span>
        <span class="s1">df_err = DataFrame({</span><span class="s3">&quot;x&quot;</span><span class="s1">: np.ones(</span><span class="s5">12</span><span class="s1">) * </span><span class="s5">0.2</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: np.ones(</span><span class="s5">12</span><span class="s1">) * </span><span class="s5">0.4</span><span class="s1">})</span>
        <span class="s1">axes = _check_plot_works(</span>
            <span class="s1">df.plot</span><span class="s2">,</span>
            <span class="s1">default_axes=</span><span class="s2">True,</span>
            <span class="s1">yerr=df_err</span><span class="s2">,</span>
            <span class="s1">xerr=df_err</span><span class="s2">,</span>
            <span class="s1">subplots=</span><span class="s2">True,</span>
            <span class="s1">kind=kind</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">_check_has_errorbars(axes</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">1</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.xfail(reason=</span><span class="s3">&quot;Iterator is consumed&quot;</span><span class="s2">, </span><span class="s1">raises=ValueError)</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot_iterator(self):</span>
        <span class="s1">d = {</span><span class="s3">&quot;x&quot;</span><span class="s1">: np.arange(</span><span class="s5">12</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: np.arange(</span><span class="s5">12</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s1">-</span><span class="s5">1</span><span class="s1">)}</span>
        <span class="s1">df = DataFrame(d)</span>

        <span class="s4"># yerr is iterator</span>
        <span class="s1">ax = _check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">yerr=itertools.repeat(</span><span class="s5">0.1</span><span class="s2">, </span><span class="s1">len(df)))</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">2</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_errorbar_with_integer_column_names(self):</span>
        <span class="s4"># test with integer column names</span>
        <span class="s1">df = DataFrame(np.abs(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">2</span><span class="s1">))))</span>
        <span class="s1">df_err = DataFrame(np.abs(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">2</span><span class="s1">))))</span>
        <span class="s1">ax = _check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">yerr=df_err)</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">2</span><span class="s1">)</span>
        <span class="s1">ax = _check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">y=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">1</span><span class="s1">)</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">1</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;kind&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;line&quot;</span><span class="s2">, </span><span class="s3">&quot;bar&quot;</span><span class="s1">])</span>
    <span class="s2">def </span><span class="s1">test_errorbar_with_partial_columns_kind(self</span><span class="s2">, </span><span class="s1">kind):</span>
        <span class="s1">df = DataFrame(np.abs(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">3</span><span class="s1">))))</span>
        <span class="s1">df_err = DataFrame(</span>
            <span class="s1">np.abs(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">2</span><span class="s1">)))</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span>
        <span class="s1">)</span>
        <span class="s1">ax = _check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">yerr=df_err</span><span class="s2">, </span><span class="s1">kind=kind)</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">2</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s2">def </span><span class="s1">test_errorbar_with_partial_columns_dti(self):</span>
        <span class="s1">df = DataFrame(np.abs(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">3</span><span class="s1">))))</span>
        <span class="s1">df_err = DataFrame(</span>
            <span class="s1">np.abs(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">2</span><span class="s1">)))</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span>
        <span class="s1">)</span>
        <span class="s1">ix = date_range(</span><span class="s3">&quot;1/1/2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">10</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;M&quot;</span><span class="s1">)</span>
        <span class="s1">df.set_index(ix</span><span class="s2">, </span><span class="s1">inplace=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">df_err.set_index(ix</span><span class="s2">, </span><span class="s1">inplace=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">ax = _check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">yerr=df_err</span><span class="s2">, </span><span class="s1">kind=</span><span class="s3">&quot;line&quot;</span><span class="s1">)</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">2</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;err_box&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s2">lambda </span><span class="s1">x: x</span><span class="s2">, </span><span class="s1">DataFrame])</span>
    <span class="s2">def </span><span class="s1">test_errorbar_with_partial_columns_box(self</span><span class="s2">, </span><span class="s1">err_box):</span>
        <span class="s1">d = {</span><span class="s3">&quot;x&quot;</span><span class="s1">: np.arange(</span><span class="s5">12</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: np.arange(</span><span class="s5">12</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s1">-</span><span class="s5">1</span><span class="s1">)}</span>
        <span class="s1">df = DataFrame(d)</span>
        <span class="s1">err = err_box({</span><span class="s3">&quot;x&quot;</span><span class="s1">: np.ones(</span><span class="s5">12</span><span class="s1">) * </span><span class="s5">0.2</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s1">: np.ones(</span><span class="s5">12</span><span class="s1">) * </span><span class="s5">0.4</span><span class="s1">})</span>
        <span class="s1">ax = _check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">yerr=err)</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">1</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;kind&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;line&quot;</span><span class="s2">, </span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s3">&quot;barh&quot;</span><span class="s1">])</span>
    <span class="s2">def </span><span class="s1">test_errorbar_timeseries(self</span><span class="s2">, </span><span class="s1">kind):</span>
        <span class="s1">d = {</span><span class="s3">&quot;x&quot;</span><span class="s1">: np.arange(</span><span class="s5">12</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: np.arange(</span><span class="s5">12</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s1">-</span><span class="s5">1</span><span class="s1">)}</span>
        <span class="s1">d_err = {</span><span class="s3">&quot;x&quot;</span><span class="s1">: np.ones(</span><span class="s5">12</span><span class="s1">) * </span><span class="s5">0.2</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: np.ones(</span><span class="s5">12</span><span class="s1">) * </span><span class="s5">0.4</span><span class="s1">}</span>

        <span class="s4"># check time-series plots</span>
        <span class="s1">ix = date_range(</span><span class="s3">&quot;1/1/2000&quot;</span><span class="s2">, </span><span class="s3">&quot;1/1/2001&quot;</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;M&quot;</span><span class="s1">)</span>
        <span class="s1">tdf = DataFrame(d</span><span class="s2">, </span><span class="s1">index=ix)</span>
        <span class="s1">tdf_err = DataFrame(d_err</span><span class="s2">, </span><span class="s1">index=ix)</span>

        <span class="s1">ax = _check_plot_works(tdf.plot</span><span class="s2">, </span><span class="s1">yerr=tdf_err</span><span class="s2">, </span><span class="s1">kind=kind)</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">2</span><span class="s1">)</span>

        <span class="s1">ax = _check_plot_works(tdf.plot</span><span class="s2">, </span><span class="s1">yerr=d_err</span><span class="s2">, </span><span class="s1">kind=kind)</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">2</span><span class="s1">)</span>

        <span class="s1">ax = _check_plot_works(tdf.plot</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s1">yerr=tdf_err[</span><span class="s3">&quot;x&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">kind=kind)</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">1</span><span class="s1">)</span>

        <span class="s1">ax = _check_plot_works(tdf.plot</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s1">kind=kind)</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">1</span><span class="s1">)</span>

        <span class="s1">ax = _check_plot_works(tdf.plot</span><span class="s2">, </span><span class="s1">yerr=tdf_err</span><span class="s2">, </span><span class="s1">kind=kind)</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">2</span><span class="s1">)</span>

        <span class="s1">axes = _check_plot_works(</span>
            <span class="s1">tdf.plot</span><span class="s2">,</span>
            <span class="s1">default_axes=</span><span class="s2">True,</span>
            <span class="s1">kind=kind</span><span class="s2">,</span>
            <span class="s1">yerr=tdf_err</span><span class="s2">,</span>
            <span class="s1">subplots=</span><span class="s2">True,</span>
        <span class="s1">)</span>
        <span class="s1">_check_has_errorbars(axes</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">1</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_errorbar_asymmetrical(self):</span>
        <span class="s1">err = np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">3</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">5</span><span class="s1">))</span>

        <span class="s4"># each column is [0, 1, 2, 3, 4], [3, 4, 5, 6, 7]...</span>
        <span class="s1">df = DataFrame(np.arange(</span><span class="s5">15</span><span class="s1">).reshape(</span><span class="s5">3</span><span class="s2">, </span><span class="s5">5</span><span class="s1">)).T</span>

        <span class="s1">ax = df.plot(yerr=err</span><span class="s2">, </span><span class="s1">xerr=err / </span><span class="s5">2</span><span class="s1">)</span>

        <span class="s1">yerr_0_0 = ax.collections[</span><span class="s5">1</span><span class="s1">].get_paths()[</span><span class="s5">0</span><span class="s1">].vertices[:</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]</span>
        <span class="s1">expected_0_0 = err[</span><span class="s5">0</span><span class="s2">, </span><span class="s1">:</span><span class="s2">, </span><span class="s5">0</span><span class="s1">] * np.array([-</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">])</span>
        <span class="s1">tm.assert_almost_equal(yerr_0_0</span><span class="s2">, </span><span class="s1">expected_0_0)</span>

        <span class="s1">msg = re.escape(</span>
            <span class="s3">&quot;Asymmetrical error bars should be provided with the shape (3, 2, 5)&quot;</span>
        <span class="s1">)</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.plot(yerr=err.T)</span>

    <span class="s2">def </span><span class="s1">test_table(self):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">3</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">index=list(string.ascii_letters[:</span><span class="s5">10</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">_check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">table=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">_check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">table=df)</span>

        <span class="s4"># GH 35945 UserWarning</span>
        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(</span><span class="s2">None</span><span class="s1">):</span>
            <span class="s1">ax = df.plot()</span>
            <span class="s2">assert </span><span class="s1">len(ax.tables) == </span><span class="s5">0</span>
            <span class="s1">plotting.table(ax</span><span class="s2">, </span><span class="s1">df.T)</span>
            <span class="s2">assert </span><span class="s1">len(ax.tables) == </span><span class="s5">1</span>

    <span class="s2">def </span><span class="s1">test_errorbar_scatter(self):</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.abs(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">5</span><span class="s2">, </span><span class="s5">2</span><span class="s1">)))</span><span class="s2">,</span>
            <span class="s1">index=range(</span><span class="s5">5</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">columns=[</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">df_err = DataFrame(</span>
            <span class="s1">np.abs(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">5</span><span class="s2">, </span><span class="s5">2</span><span class="s1">))) / </span><span class="s5">5</span><span class="s2">,</span>
            <span class="s1">index=range(</span><span class="s5">5</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">columns=[</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">)</span>

        <span class="s1">ax = _check_plot_works(df.plot.scatter</span><span class="s2">, </span><span class="s1">x=</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;y&quot;</span><span class="s1">)</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">0</span><span class="s1">)</span>
        <span class="s1">ax = _check_plot_works(df.plot.scatter</span><span class="s2">, </span><span class="s1">x=</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s1">xerr=df_err)</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">0</span><span class="s1">)</span>

        <span class="s1">ax = _check_plot_works(df.plot.scatter</span><span class="s2">, </span><span class="s1">x=</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s1">yerr=df_err)</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">1</span><span class="s1">)</span>
        <span class="s1">ax = _check_plot_works(df.plot.scatter</span><span class="s2">, </span><span class="s1">x=</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s1">xerr=df_err</span><span class="s2">, </span><span class="s1">yerr=df_err)</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">1</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_errorbar_scatter_color(self):</span>
        <span class="s2">def </span><span class="s1">_check_errorbar_color(containers</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">has_err=</span><span class="s3">&quot;has_xerr&quot;</span><span class="s1">):</span>
            <span class="s1">lines = []</span>
            <span class="s1">errs = next(c.lines </span><span class="s2">for </span><span class="s1">c </span><span class="s2">in </span><span class="s1">ax.containers </span><span class="s2">if </span><span class="s1">getattr(c</span><span class="s2">, </span><span class="s1">has_err</span><span class="s2">, False</span><span class="s1">))</span>
            <span class="s2">for </span><span class="s1">el </span><span class="s2">in </span><span class="s1">errs:</span>
                <span class="s2">if </span><span class="s1">is_list_like(el):</span>
                    <span class="s1">lines.extend(el)</span>
                <span class="s2">else</span><span class="s1">:</span>
                    <span class="s1">lines.append(el)</span>
            <span class="s1">err_lines = [x </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">lines </span><span class="s2">if </span><span class="s1">x </span><span class="s2">in </span><span class="s1">ax.collections]</span>
            <span class="s1">_check_colors(err_lines</span><span class="s2">, </span><span class="s1">linecolors=np.array([expected] * len(err_lines)))</span>

        <span class="s4"># GH 8081</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.abs(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">5</span><span class="s1">)))</span><span class="s2">,</span>
            <span class="s1">columns=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">, </span><span class="s3">&quot;e&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">ax = df.plot.scatter(x=</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s3">&quot;d&quot;</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s3">&quot;e&quot;</span><span class="s2">, </span><span class="s1">c=</span><span class="s3">&quot;red&quot;</span><span class="s1">)</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">1</span><span class="s1">)</span>
        <span class="s1">_check_errorbar_color(ax.containers</span><span class="s2">, </span><span class="s3">&quot;red&quot;</span><span class="s2">, </span><span class="s1">has_err=</span><span class="s3">&quot;has_xerr&quot;</span><span class="s1">)</span>
        <span class="s1">_check_errorbar_color(ax.containers</span><span class="s2">, </span><span class="s3">&quot;red&quot;</span><span class="s2">, </span><span class="s1">has_err=</span><span class="s3">&quot;has_yerr&quot;</span><span class="s1">)</span>

        <span class="s1">ax = df.plot.scatter(x=</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s3">&quot;e&quot;</span><span class="s2">, </span><span class="s1">color=</span><span class="s3">&quot;green&quot;</span><span class="s1">)</span>
        <span class="s1">_check_has_errorbars(ax</span><span class="s2">, </span><span class="s1">xerr=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">yerr=</span><span class="s5">1</span><span class="s1">)</span>
        <span class="s1">_check_errorbar_color(ax.containers</span><span class="s2">, </span><span class="s3">&quot;green&quot;</span><span class="s2">, </span><span class="s1">has_err=</span><span class="s3">&quot;has_yerr&quot;</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_scatter_unknown_colormap(self):</span>
        <span class="s4"># GH#48726</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;a&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">: </span><span class="s5">4</span><span class="s1">})</span>
        <span class="s2">with </span><span class="s1">pytest.raises((ValueError</span><span class="s2">, </span><span class="s1">KeyError)</span><span class="s2">, </span><span class="s1">match=</span><span class="s3">&quot;'unknown' is not a&quot;</span><span class="s1">):</span>
            <span class="s1">df.plot(x=</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s1">colormap=</span><span class="s3">&quot;unknown&quot;</span><span class="s2">, </span><span class="s1">kind=</span><span class="s3">&quot;scatter&quot;</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_sharex_and_ax(self):</span>
        <span class="s4"># https://github.com/pandas-dev/pandas/issues/9737 using gridspec,</span>
        <span class="s4"># the axis in fig.get_axis() are sorted differently than pandas</span>
        <span class="s4"># expected them, so make sure that only the right ones are removed</span>
        <span class="s2">import </span><span class="s1">matplotlib.pyplot </span><span class="s2">as </span><span class="s1">plt</span>

        <span class="s1">plt.close(</span><span class="s3">&quot;all&quot;</span><span class="s1">)</span>
        <span class="s1">gs</span><span class="s2">, </span><span class="s1">axes = _generate_4_axes_via_gridspec()</span>

        <span class="s1">df = DataFrame(</span>
            <span class="s1">{</span>
                <span class="s3">&quot;a&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">6</span><span class="s1">]</span><span class="s2">,</span>
                <span class="s3">&quot;b&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">6</span><span class="s1">]</span><span class="s2">,</span>
                <span class="s3">&quot;c&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">6</span><span class="s1">]</span><span class="s2">,</span>
                <span class="s3">&quot;d&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">6</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">}</span>
        <span class="s1">)</span>

        <span class="s2">def </span><span class="s1">_check(axes):</span>
            <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes:</span>
                <span class="s2">assert </span><span class="s1">len(ax.lines) == </span><span class="s5">1</span>
                <span class="s1">_check_visible(ax.get_yticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
            <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">[axes[</span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">axes[</span><span class="s5">2</span><span class="s1">]]:</span>
                <span class="s1">_check_visible(ax.get_xticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">False</span><span class="s1">)</span>
                <span class="s1">_check_visible(ax.get_xticklabels(minor=</span><span class="s2">True</span><span class="s1">)</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">False</span><span class="s1">)</span>
            <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">[axes[</span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">axes[</span><span class="s5">3</span><span class="s1">]]:</span>
                <span class="s1">_check_visible(ax.get_xticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
                <span class="s1">_check_visible(ax.get_xticklabels(minor=</span><span class="s2">True</span><span class="s1">)</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>

        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes:</span>
            <span class="s1">df.plot(x=</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s1">title=</span><span class="s3">&quot;title&quot;</span><span class="s2">, </span><span class="s1">ax=ax</span><span class="s2">, </span><span class="s1">sharex=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">gs.tight_layout(plt.gcf())</span>
        <span class="s1">_check(axes)</span>
        <span class="s1">plt.close(</span><span class="s3">&quot;all&quot;</span><span class="s1">)</span>

        <span class="s1">gs</span><span class="s2">, </span><span class="s1">axes = _generate_4_axes_via_gridspec()</span>
        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(UserWarning):</span>
            <span class="s1">axes = df.plot(subplots=</span><span class="s2">True, </span><span class="s1">ax=axes</span><span class="s2">, </span><span class="s1">sharex=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">_check(axes)</span>

    <span class="s2">def </span><span class="s1">test_sharex_false_and_ax(self):</span>
        <span class="s4"># https://github.com/pandas-dev/pandas/issues/9737 using gridspec,</span>
        <span class="s4"># the axis in fig.get_axis() are sorted differently than pandas</span>
        <span class="s4"># expected them, so make sure that only the right ones are removed</span>
        <span class="s2">import </span><span class="s1">matplotlib.pyplot </span><span class="s2">as </span><span class="s1">plt</span>

        <span class="s1">df = DataFrame(</span>
            <span class="s1">{</span>
                <span class="s3">&quot;a&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">6</span><span class="s1">]</span><span class="s2">,</span>
                <span class="s3">&quot;b&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">6</span><span class="s1">]</span><span class="s2">,</span>
                <span class="s3">&quot;c&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">6</span><span class="s1">]</span><span class="s2">,</span>
                <span class="s3">&quot;d&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">6</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">}</span>
        <span class="s1">)</span>
        <span class="s1">gs</span><span class="s2">, </span><span class="s1">axes = _generate_4_axes_via_gridspec()</span>
        <span class="s4"># without sharex, no labels should be touched!</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes:</span>
            <span class="s1">df.plot(x=</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s1">title=</span><span class="s3">&quot;title&quot;</span><span class="s2">, </span><span class="s1">ax=ax)</span>

        <span class="s1">gs.tight_layout(plt.gcf())</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes:</span>
            <span class="s2">assert </span><span class="s1">len(ax.lines) == </span><span class="s5">1</span>
            <span class="s1">_check_visible(ax.get_yticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
            <span class="s1">_check_visible(ax.get_xticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
            <span class="s1">_check_visible(ax.get_xticklabels(minor=</span><span class="s2">True</span><span class="s1">)</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_sharey_and_ax(self):</span>
        <span class="s4"># https://github.com/pandas-dev/pandas/issues/9737 using gridspec,</span>
        <span class="s4"># the axis in fig.get_axis() are sorted differently than pandas</span>
        <span class="s4"># expected them, so make sure that only the right ones are removed</span>
        <span class="s2">import </span><span class="s1">matplotlib.pyplot </span><span class="s2">as </span><span class="s1">plt</span>

        <span class="s1">gs</span><span class="s2">, </span><span class="s1">axes = _generate_4_axes_via_gridspec()</span>

        <span class="s1">df = DataFrame(</span>
            <span class="s1">{</span>
                <span class="s3">&quot;a&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">6</span><span class="s1">]</span><span class="s2">,</span>
                <span class="s3">&quot;b&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">6</span><span class="s1">]</span><span class="s2">,</span>
                <span class="s3">&quot;c&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">6</span><span class="s1">]</span><span class="s2">,</span>
                <span class="s3">&quot;d&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">6</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">}</span>
        <span class="s1">)</span>

        <span class="s2">def </span><span class="s1">_check(axes):</span>
            <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes:</span>
                <span class="s2">assert </span><span class="s1">len(ax.lines) == </span><span class="s5">1</span>
                <span class="s1">_check_visible(ax.get_xticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
                <span class="s1">_check_visible(ax.get_xticklabels(minor=</span><span class="s2">True</span><span class="s1">)</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
            <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">[axes[</span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">axes[</span><span class="s5">1</span><span class="s1">]]:</span>
                <span class="s1">_check_visible(ax.get_yticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
            <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">[axes[</span><span class="s5">2</span><span class="s1">]</span><span class="s2">, </span><span class="s1">axes[</span><span class="s5">3</span><span class="s1">]]:</span>
                <span class="s1">_check_visible(ax.get_yticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">False</span><span class="s1">)</span>

        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes:</span>
            <span class="s1">df.plot(x=</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s1">title=</span><span class="s3">&quot;title&quot;</span><span class="s2">, </span><span class="s1">ax=ax</span><span class="s2">, </span><span class="s1">sharey=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">gs.tight_layout(plt.gcf())</span>
        <span class="s1">_check(axes)</span>
        <span class="s1">plt.close(</span><span class="s3">&quot;all&quot;</span><span class="s1">)</span>

        <span class="s1">gs</span><span class="s2">, </span><span class="s1">axes = _generate_4_axes_via_gridspec()</span>
        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(UserWarning):</span>
            <span class="s1">axes = df.plot(subplots=</span><span class="s2">True, </span><span class="s1">ax=axes</span><span class="s2">, </span><span class="s1">sharey=</span><span class="s2">True</span><span class="s1">)</span>

        <span class="s1">gs.tight_layout(plt.gcf())</span>
        <span class="s1">_check(axes)</span>

    <span class="s2">def </span><span class="s1">test_sharey_and_ax_tight(self):</span>
        <span class="s4"># https://github.com/pandas-dev/pandas/issues/9737 using gridspec,</span>
        <span class="s2">import </span><span class="s1">matplotlib.pyplot </span><span class="s2">as </span><span class="s1">plt</span>

        <span class="s1">df = DataFrame(</span>
            <span class="s1">{</span>
                <span class="s3">&quot;a&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">6</span><span class="s1">]</span><span class="s2">,</span>
                <span class="s3">&quot;b&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">6</span><span class="s1">]</span><span class="s2">,</span>
                <span class="s3">&quot;c&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">6</span><span class="s1">]</span><span class="s2">,</span>
                <span class="s3">&quot;d&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">6</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">}</span>
        <span class="s1">)</span>
        <span class="s1">gs</span><span class="s2">, </span><span class="s1">axes = _generate_4_axes_via_gridspec()</span>
        <span class="s4"># without sharex, no labels should be touched!</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes:</span>
            <span class="s1">df.plot(x=</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s1">title=</span><span class="s3">&quot;title&quot;</span><span class="s2">, </span><span class="s1">ax=ax)</span>

        <span class="s1">gs.tight_layout(plt.gcf())</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes:</span>
            <span class="s2">assert </span><span class="s1">len(ax.lines) == </span><span class="s5">1</span>
            <span class="s1">_check_visible(ax.get_yticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
            <span class="s1">_check_visible(ax.get_xticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
            <span class="s1">_check_visible(ax.get_xticklabels(minor=</span><span class="s2">True</span><span class="s1">)</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;kind&quot;</span><span class="s2">, </span><span class="s1">plotting.PlotAccessor._all_kinds)</span>
    <span class="s2">def </span><span class="s1">test_memory_leak(self</span><span class="s2">, </span><span class="s1">kind):</span>
        <span class="s0">&quot;&quot;&quot;Check that every plot type gets properly collected.&quot;&quot;&quot;</span>
        <span class="s1">pytest.importorskip(</span><span class="s3">&quot;scipy&quot;</span><span class="s1">)</span>
        <span class="s1">args = {}</span>
        <span class="s2">if </span><span class="s1">kind </span><span class="s2">in </span><span class="s1">[</span><span class="s3">&quot;hexbin&quot;</span><span class="s2">, </span><span class="s3">&quot;scatter&quot;</span><span class="s2">, </span><span class="s3">&quot;pie&quot;</span><span class="s1">]:</span>
            <span class="s1">df = DataFrame(</span>
                <span class="s1">{</span>
                    <span class="s3">&quot;A&quot;</span><span class="s1">: np.random.default_rng(</span><span class="s5">2</span><span class="s1">).uniform(size=</span><span class="s5">20</span><span class="s1">)</span><span class="s2">,</span>
                    <span class="s3">&quot;B&quot;</span><span class="s1">: np.random.default_rng(</span><span class="s5">2</span><span class="s1">).uniform(size=</span><span class="s5">20</span><span class="s1">)</span><span class="s2">,</span>
                    <span class="s3">&quot;C&quot;</span><span class="s1">: np.arange(</span><span class="s5">20</span><span class="s1">) + np.random.default_rng(</span><span class="s5">2</span><span class="s1">).uniform(size=</span><span class="s5">20</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s1">}</span>
            <span class="s1">)</span>
            <span class="s1">args = {</span><span class="s3">&quot;x&quot;</span><span class="s1">: </span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: </span><span class="s3">&quot;B&quot;</span><span class="s1">}</span>
        <span class="s2">elif </span><span class="s1">kind == </span><span class="s3">&quot;area&quot;</span><span class="s1">:</span>
            <span class="s1">df = tm.makeTimeDataFrame().abs()</span>
        <span class="s2">else</span><span class="s1">:</span>
            <span class="s1">df = tm.makeTimeDataFrame()</span>

        <span class="s4"># Use a weakref so we can see if the object gets collected without</span>
        <span class="s4"># also preventing it from being collected</span>
        <span class="s1">ref = weakref.ref(df.plot(kind=kind</span><span class="s2">, </span><span class="s1">**args))</span>

        <span class="s4"># have matplotlib delete all the figures</span>
        <span class="s1">plt.close(</span><span class="s3">&quot;all&quot;</span><span class="s1">)</span>
        <span class="s4"># force a garbage collection</span>
        <span class="s1">gc.collect()</span>
        <span class="s2">assert </span><span class="s1">ref() </span><span class="s2">is None</span>

    <span class="s2">def </span><span class="s1">test_df_gridspec_patterns_vert_horiz(self):</span>
        <span class="s4"># GH 10819</span>
        <span class="s2">from </span><span class="s1">matplotlib </span><span class="s2">import </span><span class="s1">gridspec</span>
        <span class="s2">import </span><span class="s1">matplotlib.pyplot </span><span class="s2">as </span><span class="s1">plt</span>

        <span class="s1">ts = Series(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal(</span><span class="s5">10</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">index=date_range(</span><span class="s3">&quot;1/1/2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">10</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">)</span>

        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">2</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">index=ts.index</span><span class="s2">,</span>
            <span class="s1">columns=list(</span><span class="s3">&quot;AB&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">)</span>

        <span class="s2">def </span><span class="s1">_get_vertical_grid():</span>
            <span class="s1">gs = gridspec.GridSpec(</span><span class="s5">3</span><span class="s2">, </span><span class="s5">1</span><span class="s1">)</span>
            <span class="s1">fig = plt.figure()</span>
            <span class="s1">ax1 = fig.add_subplot(gs[:</span><span class="s5">2</span><span class="s2">, </span><span class="s1">:])</span>
            <span class="s1">ax2 = fig.add_subplot(gs[</span><span class="s5">2</span><span class="s2">, </span><span class="s1">:])</span>
            <span class="s2">return </span><span class="s1">ax1</span><span class="s2">, </span><span class="s1">ax2</span>

        <span class="s2">def </span><span class="s1">_get_horizontal_grid():</span>
            <span class="s1">gs = gridspec.GridSpec(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s1">)</span>
            <span class="s1">fig = plt.figure()</span>
            <span class="s1">ax1 = fig.add_subplot(gs[:</span><span class="s2">, </span><span class="s1">:</span><span class="s5">2</span><span class="s1">])</span>
            <span class="s1">ax2 = fig.add_subplot(gs[:</span><span class="s2">, </span><span class="s5">2</span><span class="s1">])</span>
            <span class="s2">return </span><span class="s1">ax1</span><span class="s2">, </span><span class="s1">ax2</span>

        <span class="s2">for </span><span class="s1">ax1</span><span class="s2">, </span><span class="s1">ax2 </span><span class="s2">in </span><span class="s1">[_get_vertical_grid()</span><span class="s2">, </span><span class="s1">_get_horizontal_grid()]:</span>
            <span class="s1">ax1 = ts.plot(ax=ax1)</span>
            <span class="s2">assert </span><span class="s1">len(ax1.lines) == </span><span class="s5">1</span>
            <span class="s1">ax2 = df.plot(ax=ax2)</span>
            <span class="s2">assert </span><span class="s1">len(ax2.lines) == </span><span class="s5">2</span>
            <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">[ax1</span><span class="s2">, </span><span class="s1">ax2]:</span>
                <span class="s1">_check_visible(ax.get_yticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
                <span class="s1">_check_visible(ax.get_xticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
                <span class="s1">_check_visible(ax.get_xticklabels(minor=</span><span class="s2">True</span><span class="s1">)</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
            <span class="s1">plt.close(</span><span class="s3">&quot;all&quot;</span><span class="s1">)</span>

        <span class="s4"># subplots=True</span>
        <span class="s2">for </span><span class="s1">ax1</span><span class="s2">, </span><span class="s1">ax2 </span><span class="s2">in </span><span class="s1">[_get_vertical_grid()</span><span class="s2">, </span><span class="s1">_get_horizontal_grid()]:</span>
            <span class="s1">axes = df.plot(subplots=</span><span class="s2">True, </span><span class="s1">ax=[ax1</span><span class="s2">, </span><span class="s1">ax2])</span>
            <span class="s2">assert </span><span class="s1">len(ax1.lines) == </span><span class="s5">1</span>
            <span class="s2">assert </span><span class="s1">len(ax2.lines) == </span><span class="s5">1</span>
            <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes:</span>
                <span class="s1">_check_visible(ax.get_yticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
                <span class="s1">_check_visible(ax.get_xticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
                <span class="s1">_check_visible(ax.get_xticklabels(minor=</span><span class="s2">True</span><span class="s1">)</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
            <span class="s1">plt.close(</span><span class="s3">&quot;all&quot;</span><span class="s1">)</span>

        <span class="s4"># vertical / subplots / sharex=True / sharey=True</span>
        <span class="s1">ax1</span><span class="s2">, </span><span class="s1">ax2 = _get_vertical_grid()</span>
        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(UserWarning):</span>
            <span class="s1">axes = df.plot(subplots=</span><span class="s2">True, </span><span class="s1">ax=[ax1</span><span class="s2">, </span><span class="s1">ax2]</span><span class="s2">, </span><span class="s1">sharex=</span><span class="s2">True, </span><span class="s1">sharey=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s2">assert </span><span class="s1">len(axes[</span><span class="s5">0</span><span class="s1">].lines) == </span><span class="s5">1</span>
        <span class="s2">assert </span><span class="s1">len(axes[</span><span class="s5">1</span><span class="s1">].lines) == </span><span class="s5">1</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">[ax1</span><span class="s2">, </span><span class="s1">ax2]:</span>
            <span class="s4"># yaxis are visible because there is only one column</span>
            <span class="s1">_check_visible(ax.get_yticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s4"># xaxis of axes0 (top) are hidden</span>
        <span class="s1">_check_visible(axes[</span><span class="s5">0</span><span class="s1">].get_xticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">False</span><span class="s1">)</span>
        <span class="s1">_check_visible(axes[</span><span class="s5">0</span><span class="s1">].get_xticklabels(minor=</span><span class="s2">True</span><span class="s1">)</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">False</span><span class="s1">)</span>
        <span class="s1">_check_visible(axes[</span><span class="s5">1</span><span class="s1">].get_xticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">_check_visible(axes[</span><span class="s5">1</span><span class="s1">].get_xticklabels(minor=</span><span class="s2">True</span><span class="s1">)</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">plt.close(</span><span class="s3">&quot;all&quot;</span><span class="s1">)</span>

        <span class="s4"># horizontal / subplots / sharex=True / sharey=True</span>
        <span class="s1">ax1</span><span class="s2">, </span><span class="s1">ax2 = _get_horizontal_grid()</span>
        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(UserWarning):</span>
            <span class="s1">axes = df.plot(subplots=</span><span class="s2">True, </span><span class="s1">ax=[ax1</span><span class="s2">, </span><span class="s1">ax2]</span><span class="s2">, </span><span class="s1">sharex=</span><span class="s2">True, </span><span class="s1">sharey=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s2">assert </span><span class="s1">len(axes[</span><span class="s5">0</span><span class="s1">].lines) == </span><span class="s5">1</span>
        <span class="s2">assert </span><span class="s1">len(axes[</span><span class="s5">1</span><span class="s1">].lines) == </span><span class="s5">1</span>
        <span class="s1">_check_visible(axes[</span><span class="s5">0</span><span class="s1">].get_yticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s4"># yaxis of axes1 (right) are hidden</span>
        <span class="s1">_check_visible(axes[</span><span class="s5">1</span><span class="s1">].get_yticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">False</span><span class="s1">)</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">[ax1</span><span class="s2">, </span><span class="s1">ax2]:</span>
            <span class="s4"># xaxis are visible because there is only one column</span>
            <span class="s1">_check_visible(ax.get_xticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
            <span class="s1">_check_visible(ax.get_xticklabels(minor=</span><span class="s2">True</span><span class="s1">)</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">plt.close(</span><span class="s3">&quot;all&quot;</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_df_gridspec_patterns_boxed(self):</span>
        <span class="s4"># GH 10819</span>
        <span class="s2">from </span><span class="s1">matplotlib </span><span class="s2">import </span><span class="s1">gridspec</span>
        <span class="s2">import </span><span class="s1">matplotlib.pyplot </span><span class="s2">as </span><span class="s1">plt</span>

        <span class="s1">ts = Series(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal(</span><span class="s5">10</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">index=date_range(</span><span class="s3">&quot;1/1/2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">10</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">)</span>

        <span class="s4"># boxed</span>
        <span class="s2">def </span><span class="s1">_get_boxed_grid():</span>
            <span class="s1">gs = gridspec.GridSpec(</span><span class="s5">3</span><span class="s2">, </span><span class="s5">3</span><span class="s1">)</span>
            <span class="s1">fig = plt.figure()</span>
            <span class="s1">ax1 = fig.add_subplot(gs[:</span><span class="s5">2</span><span class="s2">, </span><span class="s1">:</span><span class="s5">2</span><span class="s1">])</span>
            <span class="s1">ax2 = fig.add_subplot(gs[:</span><span class="s5">2</span><span class="s2">, </span><span class="s5">2</span><span class="s1">])</span>
            <span class="s1">ax3 = fig.add_subplot(gs[</span><span class="s5">2</span><span class="s2">, </span><span class="s1">:</span><span class="s5">2</span><span class="s1">])</span>
            <span class="s1">ax4 = fig.add_subplot(gs[</span><span class="s5">2</span><span class="s2">, </span><span class="s5">2</span><span class="s1">])</span>
            <span class="s2">return </span><span class="s1">ax1</span><span class="s2">, </span><span class="s1">ax2</span><span class="s2">, </span><span class="s1">ax3</span><span class="s2">, </span><span class="s1">ax4</span>

        <span class="s1">axes = _get_boxed_grid()</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">10</span><span class="s2">, </span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">index=ts.index</span><span class="s2">,</span>
            <span class="s1">columns=list(</span><span class="s3">&quot;ABCD&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">axes = df.plot(subplots=</span><span class="s2">True, </span><span class="s1">ax=axes)</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes:</span>
            <span class="s2">assert </span><span class="s1">len(ax.lines) == </span><span class="s5">1</span>
            <span class="s4"># axis are visible because these are not shared</span>
            <span class="s1">_check_visible(ax.get_yticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
            <span class="s1">_check_visible(ax.get_xticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
            <span class="s1">_check_visible(ax.get_xticklabels(minor=</span><span class="s2">True</span><span class="s1">)</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">plt.close(</span><span class="s3">&quot;all&quot;</span><span class="s1">)</span>

        <span class="s4"># subplots / sharex=True / sharey=True</span>
        <span class="s1">axes = _get_boxed_grid()</span>
        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(UserWarning):</span>
            <span class="s1">axes = df.plot(subplots=</span><span class="s2">True, </span><span class="s1">ax=axes</span><span class="s2">, </span><span class="s1">sharex=</span><span class="s2">True, </span><span class="s1">sharey=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes:</span>
            <span class="s2">assert </span><span class="s1">len(ax.lines) == </span><span class="s5">1</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">[axes[</span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">axes[</span><span class="s5">2</span><span class="s1">]]:  </span><span class="s4"># left column</span>
            <span class="s1">_check_visible(ax.get_yticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">[axes[</span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">axes[</span><span class="s5">3</span><span class="s1">]]:  </span><span class="s4"># right column</span>
            <span class="s1">_check_visible(ax.get_yticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">False</span><span class="s1">)</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">[axes[</span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">axes[</span><span class="s5">1</span><span class="s1">]]:  </span><span class="s4"># top row</span>
            <span class="s1">_check_visible(ax.get_xticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">False</span><span class="s1">)</span>
            <span class="s1">_check_visible(ax.get_xticklabels(minor=</span><span class="s2">True</span><span class="s1">)</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">False</span><span class="s1">)</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">[axes[</span><span class="s5">2</span><span class="s1">]</span><span class="s2">, </span><span class="s1">axes[</span><span class="s5">3</span><span class="s1">]]:  </span><span class="s4"># bottom row</span>
            <span class="s1">_check_visible(ax.get_xticklabels()</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
            <span class="s1">_check_visible(ax.get_xticklabels(minor=</span><span class="s2">True</span><span class="s1">)</span><span class="s2">, </span><span class="s1">visible=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">plt.close(</span><span class="s3">&quot;all&quot;</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_df_grid_settings(self):</span>
        <span class="s4"># Make sure plot defaults to rcParams['axes.grid'] setting, GH 9792</span>
        <span class="s1">_check_grid_settings(</span>
            <span class="s1">DataFrame({</span><span class="s3">&quot;a&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">: [</span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s1">]})</span><span class="s2">,</span>
            <span class="s1">plotting.PlotAccessor._dataframe_kinds</span><span class="s2">,</span>
            <span class="s1">kws={</span><span class="s3">&quot;x&quot;</span><span class="s1">: </span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: </span><span class="s3">&quot;b&quot;</span><span class="s1">}</span><span class="s2">,</span>
        <span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_plain_axes(self):</span>
        <span class="s4"># supplied ax itself is a SubplotAxes, but figure contains also</span>
        <span class="s4"># a plain Axes object (GH11556)</span>
        <span class="s1">fig</span><span class="s2">, </span><span class="s1">ax = mpl.pyplot.subplots()</span>
        <span class="s1">fig.add_axes([</span><span class="s5">0.2</span><span class="s2">, </span><span class="s5">0.2</span><span class="s2">, </span><span class="s5">0.2</span><span class="s2">, </span><span class="s5">0.2</span><span class="s1">])</span>
        <span class="s1">Series(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random(</span><span class="s5">10</span><span class="s1">)).plot(ax=ax)</span>

    <span class="s2">def </span><span class="s1">test_plain_axes_df(self):</span>
        <span class="s4"># supplied ax itself is a plain Axes, but because the cmap keyword</span>
        <span class="s4"># a new ax is created for the colorbar -&gt; also multiples axes (GH11520)</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">{</span>
                <span class="s3">&quot;a&quot;</span><span class="s1">: np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal(</span><span class="s5">8</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s3">&quot;b&quot;</span><span class="s1">: np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal(</span><span class="s5">8</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">}</span>
        <span class="s1">)</span>
        <span class="s1">fig = mpl.pyplot.figure()</span>
        <span class="s1">ax = fig.add_axes((</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">))</span>
        <span class="s1">df.plot(kind=</span><span class="s3">&quot;scatter&quot;</span><span class="s2">, </span><span class="s1">ax=ax</span><span class="s2">, </span><span class="s1">x=</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s1">c=</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">cmap=</span><span class="s3">&quot;hsv&quot;</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_plain_axes_make_axes_locatable(self):</span>
        <span class="s4"># other examples</span>
        <span class="s1">fig</span><span class="s2">, </span><span class="s1">ax = mpl.pyplot.subplots()</span>
        <span class="s2">from </span><span class="s1">mpl_toolkits.axes_grid1 </span><span class="s2">import </span><span class="s1">make_axes_locatable</span>

        <span class="s1">divider = make_axes_locatable(ax)</span>
        <span class="s1">cax = divider.append_axes(</span><span class="s3">&quot;right&quot;</span><span class="s2">, </span><span class="s1">size=</span><span class="s3">&quot;5%&quot;</span><span class="s2">, </span><span class="s1">pad=</span><span class="s5">0.05</span><span class="s1">)</span>
        <span class="s1">Series(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random(</span><span class="s5">10</span><span class="s1">)).plot(ax=ax)</span>
        <span class="s1">Series(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random(</span><span class="s5">10</span><span class="s1">)).plot(ax=cax)</span>

    <span class="s2">def </span><span class="s1">test_plain_axes_make_inset_axes(self):</span>
        <span class="s1">fig</span><span class="s2">, </span><span class="s1">ax = mpl.pyplot.subplots()</span>
        <span class="s2">from </span><span class="s1">mpl_toolkits.axes_grid1.inset_locator </span><span class="s2">import </span><span class="s1">inset_axes</span>

        <span class="s1">iax = inset_axes(ax</span><span class="s2">, </span><span class="s1">width=</span><span class="s3">&quot;30%&quot;</span><span class="s2">, </span><span class="s1">height=</span><span class="s5">1.0</span><span class="s2">, </span><span class="s1">loc=</span><span class="s5">3</span><span class="s1">)</span>
        <span class="s1">Series(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random(</span><span class="s5">10</span><span class="s1">)).plot(ax=ax)</span>
        <span class="s1">Series(np.random.default_rng(</span><span class="s5">2</span><span class="s1">).random(</span><span class="s5">10</span><span class="s1">)).plot(ax=iax)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;method&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;line&quot;</span><span class="s2">, </span><span class="s3">&quot;barh&quot;</span><span class="s2">, </span><span class="s3">&quot;bar&quot;</span><span class="s1">])</span>
    <span class="s2">def </span><span class="s1">test_secondary_axis_font_size(self</span><span class="s2">, </span><span class="s1">method):</span>
        <span class="s4"># GH: 12565</span>
        <span class="s1">df = (</span>
            <span class="s1">DataFrame(</span>
                <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">15</span><span class="s2">, </span><span class="s5">2</span><span class="s1">))</span><span class="s2">, </span><span class="s1">columns=list(</span><span class="s3">&quot;AB&quot;</span><span class="s1">)</span>
            <span class="s1">)</span>
            <span class="s1">.assign(C=</span><span class="s2">lambda </span><span class="s1">df: df.B.cumsum())</span>
            <span class="s1">.assign(D=</span><span class="s2">lambda </span><span class="s1">df: df.C * </span><span class="s5">1.1</span><span class="s1">)</span>
        <span class="s1">)</span>

        <span class="s1">fontsize = </span><span class="s5">20</span>
        <span class="s1">sy = [</span><span class="s3">&quot;C&quot;</span><span class="s2">, </span><span class="s3">&quot;D&quot;</span><span class="s1">]</span>

        <span class="s1">kwargs = {</span><span class="s3">&quot;secondary_y&quot;</span><span class="s1">: sy</span><span class="s2">, </span><span class="s3">&quot;fontsize&quot;</span><span class="s1">: fontsize</span><span class="s2">, </span><span class="s3">&quot;mark_right&quot;</span><span class="s1">: </span><span class="s2">True</span><span class="s1">}</span>
        <span class="s1">ax = getattr(df.plot</span><span class="s2">, </span><span class="s1">method)(**kwargs)</span>
        <span class="s1">_check_ticks_props(axes=ax.right_ax</span><span class="s2">, </span><span class="s1">ylabelsize=fontsize)</span>

    <span class="s2">def </span><span class="s1">test_x_string_values_ticks(self):</span>
        <span class="s4"># Test if string plot index have a fixed xtick position</span>
        <span class="s4"># GH: 7612, GH: 22334</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">{</span>
                <span class="s3">&quot;sales&quot;</span><span class="s1">: [</span><span class="s5">3</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span><span class="s2">,</span>
                <span class="s3">&quot;visits&quot;</span><span class="s1">: [</span><span class="s5">20</span><span class="s2">, </span><span class="s5">42</span><span class="s2">, </span><span class="s5">28</span><span class="s1">]</span><span class="s2">,</span>
                <span class="s3">&quot;day&quot;</span><span class="s1">: [</span><span class="s3">&quot;Monday&quot;</span><span class="s2">, </span><span class="s3">&quot;Tuesday&quot;</span><span class="s2">, </span><span class="s3">&quot;Wednesday&quot;</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">}</span>
        <span class="s1">)</span>
        <span class="s1">ax = df.plot.area(x=</span><span class="s3">&quot;day&quot;</span><span class="s1">)</span>
        <span class="s1">ax.set_xlim(-</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s1">)</span>
        <span class="s1">xticklabels = [t.get_text() </span><span class="s2">for </span><span class="s1">t </span><span class="s2">in </span><span class="s1">ax.get_xticklabels()]</span>
        <span class="s1">labels_position = dict(zip(xticklabels</span><span class="s2">, </span><span class="s1">ax.get_xticks()))</span>
        <span class="s4"># Testing if the label stayed at the right position</span>
        <span class="s2">assert </span><span class="s1">labels_position[</span><span class="s3">&quot;Monday&quot;</span><span class="s1">] == </span><span class="s5">0.0</span>
        <span class="s2">assert </span><span class="s1">labels_position[</span><span class="s3">&quot;Tuesday&quot;</span><span class="s1">] == </span><span class="s5">1.0</span>
        <span class="s2">assert </span><span class="s1">labels_position[</span><span class="s3">&quot;Wednesday&quot;</span><span class="s1">] == </span><span class="s5">2.0</span>

    <span class="s2">def </span><span class="s1">test_x_multiindex_values_ticks(self):</span>
        <span class="s4"># Test if multiindex plot index have a fixed xtick position</span>
        <span class="s4"># GH: 15912</span>
        <span class="s1">index = MultiIndex.from_product([[</span><span class="s5">2012</span><span class="s2">, </span><span class="s5">2013</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]])</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">np.random.default_rng(</span><span class="s5">2</span><span class="s1">).standard_normal((</span><span class="s5">4</span><span class="s2">, </span><span class="s5">2</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">columns=[</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">index=index</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">ax = df.plot()</span>
        <span class="s1">ax.set_xlim(-</span><span class="s5">1</span><span class="s2">, </span><span class="s5">4</span><span class="s1">)</span>
        <span class="s1">xticklabels = [t.get_text() </span><span class="s2">for </span><span class="s1">t </span><span class="s2">in </span><span class="s1">ax.get_xticklabels()]</span>
        <span class="s1">labels_position = dict(zip(xticklabels</span><span class="s2">, </span><span class="s1">ax.get_xticks()))</span>
        <span class="s4"># Testing if the label stayed at the right position</span>
        <span class="s2">assert </span><span class="s1">labels_position[</span><span class="s3">&quot;(2012, 1)&quot;</span><span class="s1">] == </span><span class="s5">0.0</span>
        <span class="s2">assert </span><span class="s1">labels_position[</span><span class="s3">&quot;(2012, 2)&quot;</span><span class="s1">] == </span><span class="s5">1.0</span>
        <span class="s2">assert </span><span class="s1">labels_position[</span><span class="s3">&quot;(2013, 1)&quot;</span><span class="s1">] == </span><span class="s5">2.0</span>
        <span class="s2">assert </span><span class="s1">labels_position[</span><span class="s3">&quot;(2013, 2)&quot;</span><span class="s1">] == </span><span class="s5">3.0</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;kind&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;line&quot;</span><span class="s2">, </span><span class="s3">&quot;area&quot;</span><span class="s1">])</span>
    <span class="s2">def </span><span class="s1">test_xlim_plot_line(self</span><span class="s2">, </span><span class="s1">kind):</span>
        <span class="s4"># test if xlim is set correctly in plot.line and plot.area</span>
        <span class="s4"># GH 27686</span>
        <span class="s1">df = DataFrame([</span><span class="s5">2</span><span class="s2">, </span><span class="s5">4</span><span class="s1">]</span><span class="s2">, </span><span class="s1">index=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">])</span>
        <span class="s1">ax = df.plot(kind=kind)</span>
        <span class="s1">xlims = ax.get_xlim()</span>
        <span class="s2">assert </span><span class="s1">xlims[</span><span class="s5">0</span><span class="s1">] &lt; </span><span class="s5">1</span>
        <span class="s2">assert </span><span class="s1">xlims[</span><span class="s5">1</span><span class="s1">] &gt; </span><span class="s5">2</span>

    <span class="s2">def </span><span class="s1">test_xlim_plot_line_correctly_in_mixed_plot_type(self):</span>
        <span class="s4"># test if xlim is set correctly when ax contains multiple different kinds</span>
        <span class="s4"># of plots, GH 27686</span>
        <span class="s1">fig</span><span class="s2">, </span><span class="s1">ax = mpl.pyplot.subplots()</span>

        <span class="s1">indexes = [</span><span class="s3">&quot;k1&quot;</span><span class="s2">, </span><span class="s3">&quot;k2&quot;</span><span class="s2">, </span><span class="s3">&quot;k3&quot;</span><span class="s2">, </span><span class="s3">&quot;k4&quot;</span><span class="s1">]</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">{</span>
                <span class="s3">&quot;s1&quot;</span><span class="s1">: [</span><span class="s5">1000</span><span class="s2">, </span><span class="s5">2000</span><span class="s2">, </span><span class="s5">1500</span><span class="s2">, </span><span class="s5">2000</span><span class="s1">]</span><span class="s2">,</span>
                <span class="s3">&quot;s2&quot;</span><span class="s1">: [</span><span class="s5">900</span><span class="s2">, </span><span class="s5">1400</span><span class="s2">, </span><span class="s5">2000</span><span class="s2">, </span><span class="s5">3000</span><span class="s1">]</span><span class="s2">,</span>
                <span class="s3">&quot;s3&quot;</span><span class="s1">: [</span><span class="s5">1500</span><span class="s2">, </span><span class="s5">1500</span><span class="s2">, </span><span class="s5">1600</span><span class="s2">, </span><span class="s5">1200</span><span class="s1">]</span><span class="s2">,</span>
                <span class="s3">&quot;secondary_y&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">}</span><span class="s2">,</span>
            <span class="s1">index=indexes</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">df[[</span><span class="s3">&quot;s1&quot;</span><span class="s2">, </span><span class="s3">&quot;s2&quot;</span><span class="s2">, </span><span class="s3">&quot;s3&quot;</span><span class="s1">]].plot.bar(ax=ax</span><span class="s2">, </span><span class="s1">stacked=</span><span class="s2">False</span><span class="s1">)</span>
        <span class="s1">df[[</span><span class="s3">&quot;secondary_y&quot;</span><span class="s1">]].plot(ax=ax</span><span class="s2">, </span><span class="s1">secondary_y=</span><span class="s2">True</span><span class="s1">)</span>

        <span class="s1">xlims = ax.get_xlim()</span>
        <span class="s2">assert </span><span class="s1">xlims[</span><span class="s5">0</span><span class="s1">] &lt; </span><span class="s5">0</span>
        <span class="s2">assert </span><span class="s1">xlims[</span><span class="s5">1</span><span class="s1">] &gt; </span><span class="s5">3</span>

        <span class="s4"># make sure axis labels are plotted correctly as well</span>
        <span class="s1">xticklabels = [t.get_text() </span><span class="s2">for </span><span class="s1">t </span><span class="s2">in </span><span class="s1">ax.get_xticklabels()]</span>
        <span class="s2">assert </span><span class="s1">xticklabels == indexes</span>

    <span class="s2">def </span><span class="s1">test_plot_no_rows(self):</span>
        <span class="s4"># GH 27758</span>
        <span class="s1">df = DataFrame(columns=[</span><span class="s3">&quot;foo&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">dtype=int)</span>
        <span class="s2">assert </span><span class="s1">df.empty</span>
        <span class="s1">ax = df.plot()</span>
        <span class="s2">assert </span><span class="s1">len(ax.get_lines()) == </span><span class="s5">1</span>
        <span class="s1">line = ax.get_lines()[</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s2">assert </span><span class="s1">len(line.get_xdata()) == </span><span class="s5">0</span>
        <span class="s2">assert </span><span class="s1">len(line.get_ydata()) == </span><span class="s5">0</span>

    <span class="s2">def </span><span class="s1">test_plot_no_numeric_data(self):</span>
        <span class="s1">df = DataFrame([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s1">])</span>
        <span class="s2">with </span><span class="s1">pytest.raises(TypeError</span><span class="s2">, </span><span class="s1">match=</span><span class="s3">&quot;no numeric data to plot&quot;</span><span class="s1">):</span>
            <span class="s1">df.plot()</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;kind&quot;</span><span class="s2">, </span><span class="s1">(</span><span class="s3">&quot;line&quot;</span><span class="s2">, </span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s3">&quot;barh&quot;</span><span class="s2">, </span><span class="s3">&quot;hist&quot;</span><span class="s2">, </span><span class="s3">&quot;kde&quot;</span><span class="s2">, </span><span class="s3">&quot;density&quot;</span><span class="s2">, </span><span class="s3">&quot;area&quot;</span><span class="s2">, </span><span class="s3">&quot;pie&quot;</span><span class="s1">)</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_group_subplot(self</span><span class="s2">, </span><span class="s1">kind):</span>
        <span class="s1">pytest.importorskip(</span><span class="s3">&quot;scipy&quot;</span><span class="s1">)</span>
        <span class="s1">d = {</span>
            <span class="s3">&quot;a&quot;</span><span class="s1">: np.arange(</span><span class="s5">10</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s3">&quot;b&quot;</span><span class="s1">: np.arange(</span><span class="s5">10</span><span class="s1">) + </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;c&quot;</span><span class="s1">: np.arange(</span><span class="s5">10</span><span class="s1">) + </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;d&quot;</span><span class="s1">: np.arange(</span><span class="s5">10</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s3">&quot;e&quot;</span><span class="s1">: np.arange(</span><span class="s5">10</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">}</span>
        <span class="s1">df = DataFrame(d)</span>

        <span class="s1">axes = df.plot(subplots=[(</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;e&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">(</span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s1">)]</span><span class="s2">, </span><span class="s1">kind=kind)</span>
        <span class="s2">assert </span><span class="s1">len(axes) == </span><span class="s5">3  </span><span class="s4"># 2 groups + single column a</span>

        <span class="s1">expected_labels = ([</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;e&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;a&quot;</span><span class="s1">])</span>
        <span class="s2">for </span><span class="s1">ax</span><span class="s2">, </span><span class="s1">labels </span><span class="s2">in </span><span class="s1">zip(axes</span><span class="s2">, </span><span class="s1">expected_labels):</span>
            <span class="s2">if </span><span class="s1">kind != </span><span class="s3">&quot;pie&quot;</span><span class="s1">:</span>
                <span class="s1">_check_legend_labels(ax</span><span class="s2">, </span><span class="s1">labels=labels)</span>
            <span class="s2">if </span><span class="s1">kind == </span><span class="s3">&quot;line&quot;</span><span class="s1">:</span>
                <span class="s2">assert </span><span class="s1">len(ax.lines) == len(labels)</span>

    <span class="s2">def </span><span class="s1">test_group_subplot_series_notimplemented(self):</span>
        <span class="s1">ser = Series(range(</span><span class="s5">1</span><span class="s1">))</span>
        <span class="s1">msg = </span><span class="s3">&quot;An iterable subplots for a Series&quot;</span>
        <span class="s2">with </span><span class="s1">pytest.raises(NotImplementedError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">ser.plot(subplots=[(</span><span class="s3">&quot;a&quot;</span><span class="s2">,</span><span class="s1">)])</span>

    <span class="s2">def </span><span class="s1">test_group_subplot_multiindex_notimplemented(self):</span>
        <span class="s1">df = DataFrame(np.eye(</span><span class="s5">2</span><span class="s1">)</span><span class="s2">, </span><span class="s1">columns=MultiIndex.from_tuples([(</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s1">)</span><span class="s2">, </span><span class="s1">(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">)]))</span>
        <span class="s1">msg = </span><span class="s3">&quot;An iterable subplots for a DataFrame with a MultiIndex&quot;</span>
        <span class="s2">with </span><span class="s1">pytest.raises(NotImplementedError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.plot(subplots=[(</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s1">)])</span>

    <span class="s2">def </span><span class="s1">test_group_subplot_nonunique_cols_notimplemented(self):</span>
        <span class="s1">df = DataFrame(np.eye(</span><span class="s5">2</span><span class="s1">)</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s1">])</span>
        <span class="s1">msg = </span><span class="s3">&quot;An iterable subplots for a DataFrame with non-unique&quot;</span>
        <span class="s2">with </span><span class="s1">pytest.raises(NotImplementedError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.plot(subplots=[(</span><span class="s3">&quot;a&quot;</span><span class="s2">,</span><span class="s1">)])</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;subplots, expected_msg&quot;</span><span class="s2">,</span>
        <span class="s1">[</span>
            <span class="s1">(</span><span class="s5">123</span><span class="s2">, </span><span class="s3">&quot;subplots should be a bool or an iterable&quot;</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;each entry should be a list/tuple&quot;</span><span class="s1">)</span><span class="s2">,  </span><span class="s4"># iterable of non-iterable</span>
            <span class="s1">((</span><span class="s5">1</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;each entry should be a list/tuple&quot;</span><span class="s1">)</span><span class="s2">,  </span><span class="s4"># iterable of non-iterable</span>
            <span class="s1">((</span><span class="s3">&quot;a&quot;</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;each entry should be a list/tuple&quot;</span><span class="s1">)</span><span class="s2">,  </span><span class="s4"># iterable of strings</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_group_subplot_bad_input(self</span><span class="s2">, </span><span class="s1">subplots</span><span class="s2">, </span><span class="s1">expected_msg):</span>
        <span class="s4"># Make sure error is raised when subplots is not a properly</span>
        <span class="s4"># formatted iterable. Only iterables of iterables are permitted, and</span>
        <span class="s4"># entries should not be strings.</span>
        <span class="s1">d = {</span><span class="s3">&quot;a&quot;</span><span class="s1">: np.arange(</span><span class="s5">10</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">: np.arange(</span><span class="s5">10</span><span class="s1">)}</span>
        <span class="s1">df = DataFrame(d)</span>

        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=expected_msg):</span>
            <span class="s1">df.plot(subplots=subplots)</span>

    <span class="s2">def </span><span class="s1">test_group_subplot_invalid_column_name(self):</span>
        <span class="s1">d = {</span><span class="s3">&quot;a&quot;</span><span class="s1">: np.arange(</span><span class="s5">10</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">: np.arange(</span><span class="s5">10</span><span class="s1">)}</span>
        <span class="s1">df = DataFrame(d)</span>

        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=</span><span class="s3">r&quot;Column label\(s\) \['bad_name'\]&quot;</span><span class="s1">):</span>
            <span class="s1">df.plot(subplots=[(</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;bad_name&quot;</span><span class="s1">)])</span>

    <span class="s2">def </span><span class="s1">test_group_subplot_duplicated_column(self):</span>
        <span class="s1">d = {</span><span class="s3">&quot;a&quot;</span><span class="s1">: np.arange(</span><span class="s5">10</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">: np.arange(</span><span class="s5">10</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s1">: np.arange(</span><span class="s5">10</span><span class="s1">)}</span>
        <span class="s1">df = DataFrame(d)</span>

        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=</span><span class="s3">&quot;should be in only one subplot&quot;</span><span class="s1">):</span>
            <span class="s1">df.plot(subplots=[(</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">(</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s1">)])</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;kind&quot;</span><span class="s2">, </span><span class="s1">(</span><span class="s3">&quot;box&quot;</span><span class="s2">, </span><span class="s3">&quot;scatter&quot;</span><span class="s2">, </span><span class="s3">&quot;hexbin&quot;</span><span class="s1">))</span>
    <span class="s2">def </span><span class="s1">test_group_subplot_invalid_kind(self</span><span class="s2">, </span><span class="s1">kind):</span>
        <span class="s1">d = {</span><span class="s3">&quot;a&quot;</span><span class="s1">: np.arange(</span><span class="s5">10</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">: np.arange(</span><span class="s5">10</span><span class="s1">)}</span>
        <span class="s1">df = DataFrame(d)</span>
        <span class="s2">with </span><span class="s1">pytest.raises(</span>
            <span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match=</span><span class="s3">&quot;When subplots is an iterable, kind must be one of&quot;</span>
        <span class="s1">):</span>
            <span class="s1">df.plot(subplots=[(</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">)]</span><span class="s2">, </span><span class="s1">kind=kind)</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;index_name, old_label, new_label&quot;</span><span class="s2">,</span>
        <span class="s1">[</span>
            <span class="s1">(</span><span class="s2">None, </span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s3">&quot;new&quot;</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;old&quot;</span><span class="s2">, </span><span class="s3">&quot;old&quot;</span><span class="s2">, </span><span class="s3">&quot;new&quot;</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s2">None, </span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s3">&quot;&quot;</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s2">None, </span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s5">1</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s2">None, </span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">)</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;kind&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;line&quot;</span><span class="s2">, </span><span class="s3">&quot;area&quot;</span><span class="s2">, </span><span class="s3">&quot;bar&quot;</span><span class="s1">])</span>
    <span class="s2">def </span><span class="s1">test_xlabel_ylabel_dataframe_single_plot(</span>
        <span class="s1">self</span><span class="s2">, </span><span class="s1">kind</span><span class="s2">, </span><span class="s1">index_name</span><span class="s2">, </span><span class="s1">old_label</span><span class="s2">, </span><span class="s1">new_label</span>
    <span class="s1">):</span>
        <span class="s4"># GH 9093</span>
        <span class="s1">df = DataFrame([[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s5">2</span><span class="s2">, </span><span class="s5">5</span><span class="s1">]]</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;Type A&quot;</span><span class="s2">, </span><span class="s3">&quot;Type B&quot;</span><span class="s1">])</span>
        <span class="s1">df.index.name = index_name</span>

        <span class="s4"># default is the ylabel is not shown and xlabel is index name</span>
        <span class="s1">ax = df.plot(kind=kind)</span>
        <span class="s2">assert </span><span class="s1">ax.get_xlabel() == old_label</span>
        <span class="s2">assert </span><span class="s1">ax.get_ylabel() == </span><span class="s3">&quot;&quot;</span>

        <span class="s4"># old xlabel will be overridden and assigned ylabel will be used as ylabel</span>
        <span class="s1">ax = df.plot(kind=kind</span><span class="s2">, </span><span class="s1">ylabel=new_label</span><span class="s2">, </span><span class="s1">xlabel=new_label)</span>
        <span class="s2">assert </span><span class="s1">ax.get_ylabel() == str(new_label)</span>
        <span class="s2">assert </span><span class="s1">ax.get_xlabel() == str(new_label)</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;xlabel, ylabel&quot;</span><span class="s2">,</span>
        <span class="s1">[</span>
            <span class="s1">(</span><span class="s2">None, None</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;X Label&quot;</span><span class="s2">, None</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s2">None, </span><span class="s3">&quot;Y Label&quot;</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;X Label&quot;</span><span class="s2">, </span><span class="s3">&quot;Y Label&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">)</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;kind&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;scatter&quot;</span><span class="s2">, </span><span class="s3">&quot;hexbin&quot;</span><span class="s1">])</span>
    <span class="s2">def </span><span class="s1">test_xlabel_ylabel_dataframe_plane_plot(self</span><span class="s2">, </span><span class="s1">kind</span><span class="s2">, </span><span class="s1">xlabel</span><span class="s2">, </span><span class="s1">ylabel):</span>
        <span class="s4"># GH 37001</span>
        <span class="s1">xcol = </span><span class="s3">&quot;Type A&quot;</span>
        <span class="s1">ycol = </span><span class="s3">&quot;Type B&quot;</span>
        <span class="s1">df = DataFrame([[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s5">2</span><span class="s2">, </span><span class="s5">5</span><span class="s1">]]</span><span class="s2">, </span><span class="s1">columns=[xcol</span><span class="s2">, </span><span class="s1">ycol])</span>

        <span class="s4"># default is the labels are column names</span>
        <span class="s1">ax = df.plot(kind=kind</span><span class="s2">, </span><span class="s1">x=xcol</span><span class="s2">, </span><span class="s1">y=ycol</span><span class="s2">, </span><span class="s1">xlabel=xlabel</span><span class="s2">, </span><span class="s1">ylabel=ylabel)</span>
        <span class="s2">assert </span><span class="s1">ax.get_xlabel() == (xcol </span><span class="s2">if </span><span class="s1">xlabel </span><span class="s2">is None else </span><span class="s1">xlabel)</span>
        <span class="s2">assert </span><span class="s1">ax.get_ylabel() == (ycol </span><span class="s2">if </span><span class="s1">ylabel </span><span class="s2">is None else </span><span class="s1">ylabel)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;secondary_y&quot;</span><span class="s2">, </span><span class="s1">(</span><span class="s2">False, True</span><span class="s1">))</span>
    <span class="s2">def </span><span class="s1">test_secondary_y(self</span><span class="s2">, </span><span class="s1">secondary_y):</span>
        <span class="s1">ax_df = DataFrame([</span><span class="s5">0</span><span class="s1">]).plot(</span>
            <span class="s1">secondary_y=secondary_y</span><span class="s2">, </span><span class="s1">ylabel=</span><span class="s3">&quot;Y&quot;</span><span class="s2">, </span><span class="s1">ylim=(</span><span class="s5">0</span><span class="s2">, </span><span class="s5">100</span><span class="s1">)</span><span class="s2">, </span><span class="s1">yticks=[</span><span class="s5">99</span><span class="s1">]</span>
        <span class="s1">)</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">ax_df.figure.axes:</span>
            <span class="s2">if </span><span class="s1">ax.yaxis.get_visible():</span>
                <span class="s2">assert </span><span class="s1">ax.get_ylabel() == </span><span class="s3">&quot;Y&quot;</span>
                <span class="s2">assert </span><span class="s1">ax.get_ylim() == (</span><span class="s5">0</span><span class="s2">, </span><span class="s5">100</span><span class="s1">)</span>
                <span class="s2">assert </span><span class="s1">ax.get_yticks()[</span><span class="s5">0</span><span class="s1">] == </span><span class="s5">99</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s2">def </span><span class="s1">test_plot_no_warning(self):</span>
        <span class="s4"># GH 55138</span>
        <span class="s4"># TODO(3.0): this can be removed once Period[B] deprecation is enforced</span>
        <span class="s1">df = tm.makeTimeDataFrame()</span>
        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(</span><span class="s2">False</span><span class="s1">):</span>
            <span class="s1">_ = df.plot()</span>
            <span class="s1">_ = df.T.plot()</span>


<span class="s2">def </span><span class="s1">_generate_4_axes_via_gridspec():</span>
    <span class="s2">import </span><span class="s1">matplotlib.pyplot </span><span class="s2">as </span><span class="s1">plt</span>

    <span class="s1">gs = mpl.gridspec.GridSpec(</span><span class="s5">2</span><span class="s2">, </span><span class="s5">2</span><span class="s1">)</span>
    <span class="s1">ax_tl = plt.subplot(gs[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">])</span>
    <span class="s1">ax_ll = plt.subplot(gs[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s1">])</span>
    <span class="s1">ax_tr = plt.subplot(gs[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s1">])</span>
    <span class="s1">ax_lr = plt.subplot(gs[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">])</span>

    <span class="s2">return </span><span class="s1">gs</span><span class="s2">, </span><span class="s1">[ax_tl</span><span class="s2">, </span><span class="s1">ax_ll</span><span class="s2">, </span><span class="s1">ax_tr</span><span class="s2">, </span><span class="s1">ax_lr]</span>
</pre>
</body>
</html>