<html>
<head>
<title>transform.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #808080;}
.s3 { color: #6897bb;}
.s4 { color: #6a8759;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
transform.py</font>
</center></td></tr></table>
<pre><span class="s0">class </span><span class="s1">scaler:</span>
    <span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
    <span class="s0">import </span><span class="s1">sklearn.datasets </span><span class="s0">as </span><span class="s1">sd</span>
    <span class="s0">import </span><span class="s1">skelm</span>
    <span class="s0">from </span><span class="s1">sklearn.preprocessing </span><span class="s0">import </span><span class="s1">StandardScaler</span>
    <span class="s0">def </span><span class="s1">__init__(self</span><span class="s0">, </span><span class="s1">dataframe):</span>
        <span class="s2">#pd.__init__(csv_file)</span>
        <span class="s2">#super(Scaler,self).__init__(csv_file)</span>
        <span class="s1">self.df=dataframe</span>
    
    <span class="s0">def </span><span class="s1">make(self</span><span class="s0">,</span><span class="s1">cs):</span>
        <span class="s1">sh = self.df.shape</span>
        <span class="s1">info = sh[</span><span class="s3">1</span><span class="s1">]-</span><span class="s3">1</span><span class="s1">+self.np.random.randint(</span><span class="s3">2</span><span class="s1">)</span>
        <span class="s1">non_info = sh[</span><span class="s3">1</span><span class="s1">]-info</span>
        <span class="s1">clss = self.np.size(self.np.unique(self.df.iloc[:</span><span class="s0">,</span><span class="s1">-</span><span class="s3">1</span><span class="s1">]))</span>
        <span class="s1">X</span><span class="s0">,</span><span class="s1">y = self.sd.make_classification(n_samples=sh[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                                     <span class="s1">n_features=sh[</span><span class="s3">1</span><span class="s1">]</span><span class="s0">,</span>
                                     <span class="s1">n_informative=info</span><span class="s0">, </span>
                                     <span class="s1">n_redundant=non_info</span><span class="s0">, </span>
                                     <span class="s1">n_repeated=</span><span class="s3">0</span><span class="s0">,</span>
                                     <span class="s1">n_classes=clss</span><span class="s0">, </span>
                                     <span class="s1">n_clusters_per_class=</span><span class="s3">1</span><span class="s0">,</span>
                                     <span class="s1">weights=self.np.array([(</span><span class="s3">1</span><span class="s1">/clss) </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range(clss)])</span><span class="s0">,</span>
                                     <span class="s1">scale=[</span><span class="s3">1</span><span class="s0">,</span><span class="s3">250</span><span class="s0">,</span><span class="s3">400</span><span class="s0">,</span><span class="s3">0.01</span><span class="s0">,</span><span class="s3">1</span><span class="s0">,</span><span class="s3">3.5</span><span class="s0">,</span><span class="s3">3.5</span><span class="s0">,</span><span class="s3">100000</span><span class="s0">,</span><span class="s3">0.001</span><span class="s0">,</span><span class="s3">0.1</span><span class="s1">] </span><span class="s0">if </span><span class="s1">sh[</span><span class="s3">1</span><span class="s1">]==</span><span class="s3">10 </span><span class="s0">else </span><span class="s1">[</span><span class="s3">1 </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range(sh[</span><span class="s3">1</span><span class="s1">])]</span><span class="s0">,</span>
                                     <span class="s1">class_sep=cs</span><span class="s0">,</span>
                                     <span class="s1">shift=</span><span class="s0">None</span><span class="s1">)</span>
        <span class="s1">X=self.np.abs(X)</span>
        <span class="s0">return </span><span class="s1">X</span><span class="s0">,</span><span class="s1">y</span>
    
    <span class="s0">def </span><span class="s1">performance(self</span><span class="s0">,</span><span class="s1">X</span><span class="s0">,</span><span class="s1">y):</span>
        <span class="s0">from </span><span class="s1">sklearn.model_selection </span><span class="s0">import </span><span class="s1">train_test_split </span><span class="s0">as </span><span class="s1">tts</span>
        <span class="s0">from </span><span class="s1">sklearn.pipeline </span><span class="s0">import </span><span class="s1">make_pipeline</span>
        <span class="s2">#idx=int(0.8*self.df.shape[0])</span>
        <span class="s2">#X1,X_1,y1,y_1=X[0:idx,:],X[idx:,:],y[0:idx],y[idx:]</span>
        <span class="s1">X1</span><span class="s0">, </span><span class="s1">X_1</span><span class="s0">, </span><span class="s1">y1</span><span class="s0">, </span><span class="s1">y_1 = tts(X</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s1">test_size=</span><span class="s3">.2</span><span class="s0">,</span><span class="s1">random_state=</span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">clf=self.skelm.ELMClassifier(n_neurons=</span><span class="s3">120</span><span class="s1">)</span>
        <span class="s1">regr = make_pipeline(self.StandardScaler()</span><span class="s0">, </span><span class="s1">clf)</span>
        <span class="s1">regr.fit(X1</span><span class="s0">,</span><span class="s1">y1)</span>
        <span class="s1">pred=regr.predict(X_1)</span>
        <span class="s1">per=sum(pred==y_1)/y_1.shape[</span><span class="s3">0</span><span class="s1">]</span>
        <span class="s0">return </span><span class="s1">per</span>
    
    <span class="s0">def </span><span class="s1">fit(self):</span>
        <span class="s1">i=</span><span class="s3">0</span><span class="s1">; value=</span><span class="s3">0.5</span>
        <span class="s1">print(</span><span class="s4">'Fit Initialized'</span><span class="s1">)</span>
        <span class="s0">while True</span><span class="s1">:</span>
          <span class="s1">i+=</span><span class="s3">1</span>
          <span class="s1">value+=</span><span class="s3">0.01</span>
          <span class="s1">X</span><span class="s0">,</span><span class="s1">y=self.make(cs=value)</span>
          <span class="s0">for </span><span class="s1">j </span><span class="s0">in </span><span class="s1">range(</span><span class="s3">10</span><span class="s1">):</span>
            <span class="s1">acc=self.performance(X</span><span class="s0">,</span><span class="s1">y)</span>
            <span class="s0">if </span><span class="s3">100</span><span class="s1">*abs(acc-</span><span class="s3">0.78</span><span class="s1">)&lt;=</span><span class="s3">1</span><span class="s1">:</span>
              <span class="s0">break</span>
            <span class="s0">else</span><span class="s1">:</span>
              <span class="s0">continue</span>
          <span class="s0">if </span><span class="s3">100</span><span class="s1">*abs(acc-</span><span class="s3">0.78</span><span class="s1">)&lt;=</span><span class="s3">1</span><span class="s1">:</span>
            <span class="s0">break</span>
          <span class="s0">else</span><span class="s1">:</span>
            <span class="s0">continue</span>
        <span class="s1">print(</span><span class="s4">'Fit Finished. Returning data'</span><span class="s1">)</span>
        <span class="s0">return </span><span class="s1">X</span><span class="s0">,</span><span class="s1">y</span>
    
<span class="s0">if </span><span class="s1">__name__==</span><span class="s4">'__main__'</span><span class="s1">:</span>
    <span class="s0">import </span><span class="s1">pandas </span><span class="s0">as </span><span class="s1">pd</span>
    <span class="s1">sc=scaler(dataframe=pd.read_csv(</span><span class="s4">'aus.csv'</span><span class="s1">))</span>
    <span class="s1">X</span><span class="s0">,</span><span class="s1">y=sc.fit()</span></pre>
</body>
</html>