<html>
<head>
<title>test_discrete.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #a9b7c6;}
.s1 { color: #cc7832;}
.s2 { color: #808080;}
.s3 { color: #6897bb;}
.s4 { color: #629755; font-style: italic;}
.s5 { color: #6a8759;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_discrete.py</font>
</center></td></tr></table>
<pre>

<span class="s1">import </span><span class="s0">numpy </span><span class="s1">as </span><span class="s0">np</span>
<span class="s1">from </span><span class="s0">numpy.testing </span><span class="s1">import </span><span class="s0">assert_allclose</span><span class="s1">, </span><span class="s0">assert_equal</span>

<span class="s1">from </span><span class="s0">scipy </span><span class="s1">import </span><span class="s0">stats</span>
<span class="s1">from </span><span class="s0">scipy.stats </span><span class="s1">import </span><span class="s0">poisson</span><span class="s1">, </span><span class="s0">nbinom</span>

<span class="s1">from </span><span class="s0">statsmodels.tools.tools </span><span class="s1">import </span><span class="s0">Bunch</span>

<span class="s1">from </span><span class="s0">statsmodels.distributions.discrete </span><span class="s1">import </span><span class="s0">(</span>
    <span class="s0">genpoisson_p</span><span class="s1">,</span>
    <span class="s0">truncatedpoisson</span><span class="s1">,</span>
    <span class="s0">truncatednegbin</span><span class="s1">,</span>
    <span class="s0">zipoisson</span><span class="s1">,</span>
    <span class="s0">zinegbin</span><span class="s1">,</span>
    <span class="s0">zigenpoisson</span><span class="s1">,</span>
    <span class="s0">DiscretizedCount</span><span class="s1">,</span>
    <span class="s0">DiscretizedModel</span>
    <span class="s0">)</span>


<span class="s1">class </span><span class="s0">TestGenpoisson_p:</span>
    <span class="s2"># Test Generalized Poisson Destribution</span>

    <span class="s1">def </span><span class="s0">test_pmf_p1(self):</span>
        <span class="s0">poisson_pmf = poisson.pmf(</span><span class="s3">1</span><span class="s1">, </span><span class="s3">1</span><span class="s0">)</span>
        <span class="s0">genpoisson_pmf = genpoisson_p.pmf(</span><span class="s3">1</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">1</span><span class="s0">)</span>
        <span class="s0">assert_allclose(poisson_pmf</span><span class="s1">, </span><span class="s0">genpoisson_pmf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-15</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_pmf_p2(self):</span>
        <span class="s0">poisson_pmf = poisson.pmf(</span><span class="s3">2</span><span class="s1">, </span><span class="s3">2</span><span class="s0">)</span>
        <span class="s0">genpoisson_pmf = genpoisson_p.pmf(</span><span class="s3">2</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">2</span><span class="s0">)</span>
        <span class="s0">assert_allclose(poisson_pmf</span><span class="s1">, </span><span class="s0">genpoisson_pmf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-15</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_pmf_p5(self):</span>
        <span class="s0">poisson_pmf = poisson.pmf(</span><span class="s3">10</span><span class="s1">, </span><span class="s3">2</span><span class="s0">)</span>
        <span class="s0">genpoisson_pmf_5 = genpoisson_p.pmf(</span><span class="s3">10</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">1e-25</span><span class="s1">, </span><span class="s3">5</span><span class="s0">)</span>
        <span class="s0">assert_allclose(poisson_pmf</span><span class="s1">, </span><span class="s0">genpoisson_pmf_5</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-12</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_logpmf_p1(self):</span>
        <span class="s0">poisson_pmf = poisson.logpmf(</span><span class="s3">5</span><span class="s1">, </span><span class="s3">2</span><span class="s0">)</span>
        <span class="s0">genpoisson_pmf = genpoisson_p.logpmf(</span><span class="s3">5</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">1</span><span class="s0">)</span>
        <span class="s0">assert_allclose(poisson_pmf</span><span class="s1">, </span><span class="s0">genpoisson_pmf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-15</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_logpmf_p2(self):</span>
        <span class="s0">poisson_pmf = poisson.logpmf(</span><span class="s3">6</span><span class="s1">, </span><span class="s3">1</span><span class="s0">)</span>
        <span class="s0">genpoisson_pmf = genpoisson_p.logpmf(</span><span class="s3">6</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">2</span><span class="s0">)</span>
        <span class="s0">assert_allclose(poisson_pmf</span><span class="s1">, </span><span class="s0">genpoisson_pmf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-15</span><span class="s0">)</span>


<span class="s1">class </span><span class="s0">TestTruncatedPoisson:</span>
    <span class="s4">&quot;&quot;&quot; 
    Test Truncated Poisson distribution 
    &quot;&quot;&quot;</span>
    <span class="s1">def </span><span class="s0">test_pmf_zero(self):</span>
        <span class="s0">poisson_pmf = poisson.pmf(</span><span class="s3">2</span><span class="s1">, </span><span class="s3">2</span><span class="s0">) / poisson.sf(</span><span class="s3">0</span><span class="s1">, </span><span class="s3">2</span><span class="s0">)</span>
        <span class="s0">tpoisson_pmf = truncatedpoisson.pmf(</span><span class="s3">2</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">assert_allclose(poisson_pmf</span><span class="s1">, </span><span class="s0">tpoisson_pmf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-7</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_logpmf_zero(self):</span>
        <span class="s0">poisson_logpmf = poisson.logpmf(</span><span class="s3">2</span><span class="s1">, </span><span class="s3">2</span><span class="s0">) - np.log(poisson.sf(</span><span class="s3">0</span><span class="s1">, </span><span class="s3">2</span><span class="s0">))</span>
        <span class="s0">tpoisson_logpmf = truncatedpoisson.logpmf(</span><span class="s3">2</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">assert_allclose(poisson_logpmf</span><span class="s1">, </span><span class="s0">tpoisson_logpmf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-7</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_pmf(self):</span>
        <span class="s0">poisson_pmf = poisson.pmf(</span><span class="s3">4</span><span class="s1">, </span><span class="s3">6</span><span class="s0">) / (</span><span class="s3">1 </span><span class="s0">- poisson.cdf(</span><span class="s3">2</span><span class="s1">, </span><span class="s3">6</span><span class="s0">))</span>
        <span class="s0">tpoisson_pmf = truncatedpoisson.pmf(</span><span class="s3">4</span><span class="s1">, </span><span class="s3">6</span><span class="s1">, </span><span class="s3">2</span><span class="s0">)</span>
        <span class="s0">assert_allclose(poisson_pmf</span><span class="s1">, </span><span class="s0">tpoisson_pmf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-7</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_logpmf(self):</span>
        <span class="s0">poisson_logpmf = poisson.logpmf(</span><span class="s3">4</span><span class="s1">, </span><span class="s3">6</span><span class="s0">) - np.log(poisson.sf(</span><span class="s3">2</span><span class="s1">, </span><span class="s3">6</span><span class="s0">))</span>
        <span class="s0">tpoisson_logpmf = truncatedpoisson.logpmf(</span><span class="s3">4</span><span class="s1">, </span><span class="s3">6</span><span class="s1">, </span><span class="s3">2</span><span class="s0">)</span>
        <span class="s0">assert_allclose(poisson_logpmf</span><span class="s1">, </span><span class="s0">tpoisson_logpmf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-7</span><span class="s0">)</span>


<span class="s1">class </span><span class="s0">TestZIPoisson:</span>

    <span class="s1">def </span><span class="s0">test_pmf_zero(self):</span>
        <span class="s0">poisson_pmf = poisson.pmf(</span><span class="s3">3</span><span class="s1">, </span><span class="s3">2</span><span class="s0">)</span>
        <span class="s0">zipoisson_pmf = zipoisson.pmf(</span><span class="s3">3</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">assert_allclose(poisson_pmf</span><span class="s1">, </span><span class="s0">zipoisson_pmf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-12</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_logpmf_zero(self):</span>
        <span class="s0">poisson_logpmf = poisson.logpmf(</span><span class="s3">5</span><span class="s1">, </span><span class="s3">1</span><span class="s0">)</span>
        <span class="s0">zipoisson_logpmf = zipoisson.logpmf(</span><span class="s3">5</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">assert_allclose(poisson_logpmf</span><span class="s1">, </span><span class="s0">zipoisson_logpmf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-12</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_pmf(self):</span>
        <span class="s0">poisson_pmf = poisson.pmf(</span><span class="s3">2</span><span class="s1">, </span><span class="s3">2</span><span class="s0">)</span>
        <span class="s0">zipoisson_pmf = zipoisson.pmf(</span><span class="s3">2</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">0.1</span><span class="s0">)</span>
        <span class="s0">assert_allclose(poisson_pmf</span><span class="s1">, </span><span class="s0">zipoisson_pmf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">5e-2</span><span class="s1">, </span><span class="s0">atol=</span><span class="s3">5e-2</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_logpmf(self):</span>
        <span class="s0">poisson_logpmf = poisson.logpmf(</span><span class="s3">7</span><span class="s1">, </span><span class="s3">3</span><span class="s0">)</span>
        <span class="s0">zipoisson_logpmf = zipoisson.logpmf(</span><span class="s3">7</span><span class="s1">, </span><span class="s3">3</span><span class="s1">, </span><span class="s3">0.1</span><span class="s0">)</span>
        <span class="s0">assert_allclose(poisson_logpmf</span><span class="s1">, </span><span class="s0">zipoisson_logpmf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">5e-2</span><span class="s1">, </span><span class="s0">atol=</span><span class="s3">5e-2</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_cdf_zero(self):</span>
        <span class="s0">poisson_cdf = poisson.cdf(</span><span class="s3">3</span><span class="s1">, </span><span class="s3">2</span><span class="s0">)</span>
        <span class="s0">zipoisson_cdf = zipoisson.cdf(</span><span class="s3">3</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">assert_allclose(poisson_cdf</span><span class="s1">, </span><span class="s0">zipoisson_cdf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-12</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_ppf_zero(self):</span>
        <span class="s0">poisson_ppf = poisson.ppf(</span><span class="s3">5</span><span class="s1">, </span><span class="s3">1</span><span class="s0">)</span>
        <span class="s0">zipoisson_ppf = zipoisson.ppf(</span><span class="s3">5</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">assert_allclose(poisson_ppf</span><span class="s1">, </span><span class="s0">zipoisson_ppf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-12</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_mean_var(self):</span>
        <span class="s0">poisson_mean</span><span class="s1">, </span><span class="s0">poisson_var = poisson.mean(</span><span class="s3">12</span><span class="s0">)</span><span class="s1">, </span><span class="s0">poisson.var(</span><span class="s3">12</span><span class="s0">)</span>
        <span class="s0">zipoisson_mean = zipoisson.mean(</span><span class="s3">12</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">zipoisson_var = zipoisson.var(</span><span class="s3">12</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">assert_allclose(poisson_mean</span><span class="s1">, </span><span class="s0">zipoisson_mean</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-10</span><span class="s0">)</span>
        <span class="s0">assert_allclose(poisson_var</span><span class="s1">, </span><span class="s0">zipoisson_var</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-10</span><span class="s0">)</span>

        <span class="s0">m = np.array([</span><span class="s3">1</span><span class="s1">, </span><span class="s3">5</span><span class="s1">, </span><span class="s3">10</span><span class="s0">])</span>
        <span class="s0">poisson_mean</span><span class="s1">, </span><span class="s0">poisson_var = poisson.mean(m)</span><span class="s1">, </span><span class="s0">poisson.var(m)</span>
        <span class="s0">zipoisson_mean = zipoisson.mean(m</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">zipoisson_var = zipoisson.var(m</span><span class="s1">, </span><span class="s3">0.0</span><span class="s0">)</span>
        <span class="s0">assert_allclose(poisson_mean</span><span class="s1">, </span><span class="s0">zipoisson_mean</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-10</span><span class="s0">)</span>
        <span class="s0">assert_allclose(poisson_var</span><span class="s1">, </span><span class="s0">zipoisson_var</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-10</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_moments(self):</span>
        <span class="s0">poisson_m1</span><span class="s1">, </span><span class="s0">poisson_m2 = poisson.moment(</span><span class="s3">1</span><span class="s1">, </span><span class="s3">12</span><span class="s0">)</span><span class="s1">, </span><span class="s0">poisson.moment(</span><span class="s3">2</span><span class="s1">, </span><span class="s3">12</span><span class="s0">)</span>
        <span class="s0">zip_m0 = zipoisson.moment(</span><span class="s3">0</span><span class="s1">, </span><span class="s3">12</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">zip_m1 = zipoisson.moment(</span><span class="s3">1</span><span class="s1">, </span><span class="s3">12</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">zip_m2 = zipoisson.moment(</span><span class="s3">2</span><span class="s1">, </span><span class="s3">12</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">assert_allclose(</span><span class="s3">1</span><span class="s1">, </span><span class="s0">zip_m0</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-10</span><span class="s0">)</span>
        <span class="s0">assert_allclose(poisson_m1</span><span class="s1">, </span><span class="s0">zip_m1</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-10</span><span class="s0">)</span>
        <span class="s0">assert_allclose(poisson_m2</span><span class="s1">, </span><span class="s0">zip_m2</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-10</span><span class="s0">)</span>


<span class="s1">class </span><span class="s0">TestZIGeneralizedPoisson:</span>
    <span class="s1">def </span><span class="s0">test_pmf_zero(self):</span>
        <span class="s0">gp_pmf = genpoisson_p.pmf(</span><span class="s3">3</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">1</span><span class="s0">)</span>
        <span class="s0">zigp_pmf = zigenpoisson.pmf(</span><span class="s3">3</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">assert_allclose(gp_pmf</span><span class="s1">, </span><span class="s0">zigp_pmf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-12</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_logpmf_zero(self):</span>
        <span class="s0">gp_logpmf = genpoisson_p.logpmf(</span><span class="s3">7</span><span class="s1">, </span><span class="s3">3</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">1</span><span class="s0">)</span>
        <span class="s0">zigp_logpmf = zigenpoisson.logpmf(</span><span class="s3">7</span><span class="s1">, </span><span class="s3">3</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">assert_allclose(gp_logpmf</span><span class="s1">, </span><span class="s0">zigp_logpmf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-12</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_pmf(self):</span>
        <span class="s0">gp_pmf = genpoisson_p.pmf(</span><span class="s3">3</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">2</span><span class="s0">)</span>
        <span class="s0">zigp_pmf = zigenpoisson.pmf(</span><span class="s3">3</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">0.1</span><span class="s0">)</span>
        <span class="s0">assert_allclose(gp_pmf</span><span class="s1">, </span><span class="s0">zigp_pmf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">5e-2</span><span class="s1">, </span><span class="s0">atol=</span><span class="s3">5e-2</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_logpmf(self):</span>
        <span class="s0">gp_logpmf = genpoisson_p.logpmf(</span><span class="s3">2</span><span class="s1">, </span><span class="s3">3</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">2</span><span class="s0">)</span>
        <span class="s0">zigp_logpmf = zigenpoisson.logpmf(</span><span class="s3">2</span><span class="s1">, </span><span class="s3">3</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">0.1</span><span class="s0">)</span>
        <span class="s0">assert_allclose(gp_logpmf</span><span class="s1">, </span><span class="s0">zigp_logpmf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">5e-2</span><span class="s1">, </span><span class="s0">atol=</span><span class="s3">5e-2</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_mean_var(self):</span>

        <span class="s2"># compare with Poisson special case</span>
        <span class="s0">m = np.array([</span><span class="s3">1</span><span class="s1">, </span><span class="s3">5</span><span class="s1">, </span><span class="s3">10</span><span class="s0">])</span>
        <span class="s0">poisson_mean</span><span class="s1">, </span><span class="s0">poisson_var = poisson.mean(m)</span><span class="s1">, </span><span class="s0">poisson.var(m)</span>
        <span class="s0">zigenpoisson_mean = zigenpoisson.mean(m</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">zigenpoisson_var = zigenpoisson.var(m</span><span class="s1">, </span><span class="s3">0.0</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">assert_allclose(poisson_mean</span><span class="s1">, </span><span class="s0">zigenpoisson_mean</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-10</span><span class="s0">)</span>
        <span class="s0">assert_allclose(poisson_var</span><span class="s1">, </span><span class="s0">zigenpoisson_var</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-10</span><span class="s0">)</span>


<span class="s1">class </span><span class="s0">TestZiNBP:</span>

    <span class="s1">def </span><span class="s0">test_pmf_p2(self):</span>
        <span class="s0">n</span><span class="s1">, </span><span class="s0">p = zinegbin.convert_params(</span><span class="s3">30</span><span class="s1">, </span><span class="s3">0.1</span><span class="s1">, </span><span class="s3">2</span><span class="s0">)</span>
        <span class="s0">nb_pmf = nbinom.pmf(</span><span class="s3">100</span><span class="s1">, </span><span class="s0">n</span><span class="s1">, </span><span class="s0">p)</span>
        <span class="s0">tnb_pmf = zinegbin.pmf(</span><span class="s3">100</span><span class="s1">, </span><span class="s3">30</span><span class="s1">, </span><span class="s3">0.1</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">0.01</span><span class="s0">)</span>
        <span class="s0">assert_allclose(nb_pmf</span><span class="s1">, </span><span class="s0">tnb_pmf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-5</span><span class="s1">, </span><span class="s0">atol=</span><span class="s3">1e-5</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_logpmf_p2(self):</span>
        <span class="s0">n</span><span class="s1">, </span><span class="s0">p = zinegbin.convert_params(</span><span class="s3">10</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">2</span><span class="s0">)</span>
        <span class="s0">nb_logpmf = nbinom.logpmf(</span><span class="s3">200</span><span class="s1">, </span><span class="s0">n</span><span class="s1">, </span><span class="s0">p)</span>
        <span class="s0">tnb_logpmf = zinegbin.logpmf(</span><span class="s3">200</span><span class="s1">, </span><span class="s3">10</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">0.01</span><span class="s0">)</span>
        <span class="s0">assert_allclose(nb_logpmf</span><span class="s1">, </span><span class="s0">tnb_logpmf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-2</span><span class="s1">, </span><span class="s0">atol=</span><span class="s3">1e-2</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_cdf_p2(self):</span>
        <span class="s0">n</span><span class="s1">, </span><span class="s0">p = zinegbin.convert_params(</span><span class="s3">30</span><span class="s1">, </span><span class="s3">0.1</span><span class="s1">, </span><span class="s3">2</span><span class="s0">)</span>
        <span class="s0">nbinom_cdf = nbinom.cdf(</span><span class="s3">10</span><span class="s1">, </span><span class="s0">n</span><span class="s1">, </span><span class="s0">p)</span>
        <span class="s0">zinbinom_cdf = zinegbin.cdf(</span><span class="s3">10</span><span class="s1">, </span><span class="s3">30</span><span class="s1">, </span><span class="s3">0.1</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">assert_allclose(nbinom_cdf</span><span class="s1">, </span><span class="s0">zinbinom_cdf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-12</span><span class="s1">, </span><span class="s0">atol=</span><span class="s3">1e-12</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_ppf_p2(self):</span>
        <span class="s0">n</span><span class="s1">, </span><span class="s0">p = zinegbin.convert_params(</span><span class="s3">100</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">2</span><span class="s0">)</span>
        <span class="s0">nbinom_ppf = nbinom.ppf(</span><span class="s3">0.27</span><span class="s1">, </span><span class="s0">n</span><span class="s1">, </span><span class="s0">p)</span>
        <span class="s0">zinbinom_ppf = zinegbin.ppf(</span><span class="s3">0.27</span><span class="s1">, </span><span class="s3">100</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">assert_allclose(nbinom_ppf</span><span class="s1">, </span><span class="s0">zinbinom_ppf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-12</span><span class="s1">, </span><span class="s0">atol=</span><span class="s3">1e-12</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_mran_var_p2(self):</span>
        <span class="s0">n</span><span class="s1">, </span><span class="s0">p = zinegbin.convert_params(</span><span class="s3">7</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">2</span><span class="s0">)</span>
        <span class="s0">nbinom_mean</span><span class="s1">, </span><span class="s0">nbinom_var = nbinom.mean(n</span><span class="s1">, </span><span class="s0">p)</span><span class="s1">, </span><span class="s0">nbinom.var(n</span><span class="s1">, </span><span class="s0">p)</span>
        <span class="s0">zinb_mean = zinegbin.mean(</span><span class="s3">7</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">zinb_var = zinegbin.var(</span><span class="s3">7</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">assert_allclose(nbinom_mean</span><span class="s1">, </span><span class="s0">zinb_mean</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-10</span><span class="s0">)</span>
        <span class="s0">assert_allclose(nbinom_var</span><span class="s1">, </span><span class="s0">zinb_var</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-10</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_moments_p2(self):</span>
        <span class="s0">n</span><span class="s1">, </span><span class="s0">p = zinegbin.convert_params(</span><span class="s3">7</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">2</span><span class="s0">)</span>
        <span class="s0">nb_m1</span><span class="s1">, </span><span class="s0">nb_m2 = nbinom.moment(</span><span class="s3">1</span><span class="s1">, </span><span class="s0">n</span><span class="s1">, </span><span class="s0">p)</span><span class="s1">, </span><span class="s0">nbinom.moment(</span><span class="s3">2</span><span class="s1">, </span><span class="s0">n</span><span class="s1">, </span><span class="s0">p)</span>
        <span class="s0">zinb_m0 = zinegbin.moment(</span><span class="s3">0</span><span class="s1">, </span><span class="s3">7</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">zinb_m1 = zinegbin.moment(</span><span class="s3">1</span><span class="s1">, </span><span class="s3">7</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">zinb_m2 = zinegbin.moment(</span><span class="s3">2</span><span class="s1">, </span><span class="s3">7</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">assert_allclose(</span><span class="s3">1</span><span class="s1">, </span><span class="s0">zinb_m0</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-10</span><span class="s0">)</span>
        <span class="s0">assert_allclose(nb_m1</span><span class="s1">, </span><span class="s0">zinb_m1</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-10</span><span class="s0">)</span>
        <span class="s0">assert_allclose(nb_m2</span><span class="s1">, </span><span class="s0">zinb_m2</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-10</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_pmf(self):</span>
        <span class="s0">n</span><span class="s1">, </span><span class="s0">p = zinegbin.convert_params(</span><span class="s3">1</span><span class="s1">, </span><span class="s3">0.9</span><span class="s1">, </span><span class="s3">1</span><span class="s0">)</span>
        <span class="s0">nb_logpmf = nbinom.pmf(</span><span class="s3">2</span><span class="s1">, </span><span class="s0">n</span><span class="s1">, </span><span class="s0">p)</span>
        <span class="s0">tnb_pmf = zinegbin.pmf(</span><span class="s3">2</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">0.9</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">0.5</span><span class="s0">)</span>
        <span class="s0">assert_allclose(nb_logpmf</span><span class="s1">, </span><span class="s0">tnb_pmf * </span><span class="s3">2</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-7</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_logpmf(self):</span>
        <span class="s0">n</span><span class="s1">, </span><span class="s0">p = zinegbin.convert_params(</span><span class="s3">5</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">1</span><span class="s0">)</span>
        <span class="s0">nb_logpmf = nbinom.logpmf(</span><span class="s3">2</span><span class="s1">, </span><span class="s0">n</span><span class="s1">, </span><span class="s0">p)</span>
        <span class="s0">tnb_logpmf = zinegbin.logpmf(</span><span class="s3">2</span><span class="s1">, </span><span class="s3">5</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">0.005</span><span class="s0">)</span>
        <span class="s0">assert_allclose(nb_logpmf</span><span class="s1">, </span><span class="s0">tnb_logpmf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-2</span><span class="s1">, </span><span class="s0">atol=</span><span class="s3">1e-2</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_cdf(self):</span>
        <span class="s0">n</span><span class="s1">, </span><span class="s0">p = zinegbin.convert_params(</span><span class="s3">1</span><span class="s1">, </span><span class="s3">0.9</span><span class="s1">, </span><span class="s3">1</span><span class="s0">)</span>
        <span class="s0">nbinom_cdf = nbinom.cdf(</span><span class="s3">2</span><span class="s1">, </span><span class="s0">n</span><span class="s1">, </span><span class="s0">p)</span>
        <span class="s0">zinbinom_cdf = zinegbin.cdf(</span><span class="s3">2</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">0.9</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">assert_allclose(nbinom_cdf</span><span class="s1">, </span><span class="s0">zinbinom_cdf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-12</span><span class="s1">, </span><span class="s0">atol=</span><span class="s3">1e-12</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_ppf(self):</span>
        <span class="s0">n</span><span class="s1">, </span><span class="s0">p = zinegbin.convert_params(</span><span class="s3">5</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">1</span><span class="s0">)</span>
        <span class="s0">nbinom_ppf = nbinom.ppf(</span><span class="s3">0.71</span><span class="s1">, </span><span class="s0">n</span><span class="s1">, </span><span class="s0">p)</span>
        <span class="s0">zinbinom_ppf = zinegbin.ppf(</span><span class="s3">0.71</span><span class="s1">, </span><span class="s3">5</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">assert_allclose(nbinom_ppf</span><span class="s1">, </span><span class="s0">zinbinom_ppf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-12</span><span class="s1">, </span><span class="s0">atol=</span><span class="s3">1e-12</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_convert(self):</span>
        <span class="s0">n</span><span class="s1">, </span><span class="s0">p = zinegbin.convert_params(</span><span class="s3">25</span><span class="s1">, </span><span class="s3">0.85</span><span class="s1">, </span><span class="s3">2</span><span class="s0">)</span>
        <span class="s0">n_true</span><span class="s1">, </span><span class="s0">p_true = </span><span class="s3">1.1764705882352942</span><span class="s1">, </span><span class="s3">0.04494382022471911</span>
        <span class="s0">assert_allclose(n</span><span class="s1">, </span><span class="s0">n_true</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-12</span><span class="s1">, </span><span class="s0">atol=</span><span class="s3">1e-12</span><span class="s0">)</span>
        <span class="s0">assert_allclose(p</span><span class="s1">, </span><span class="s0">p_true</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-12</span><span class="s1">, </span><span class="s0">atol=</span><span class="s3">1e-12</span><span class="s0">)</span>

        <span class="s0">n</span><span class="s1">, </span><span class="s0">p = zinegbin.convert_params(</span><span class="s3">7</span><span class="s1">, </span><span class="s3">0.17</span><span class="s1">, </span><span class="s3">1</span><span class="s0">)</span>
        <span class="s0">n_true</span><span class="s1">, </span><span class="s0">p_true = </span><span class="s3">41.17647058823529</span><span class="s1">, </span><span class="s3">0.8547008547008547</span>
        <span class="s0">assert_allclose(n</span><span class="s1">, </span><span class="s0">n_true</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-12</span><span class="s1">, </span><span class="s0">atol=</span><span class="s3">1e-12</span><span class="s0">)</span>
        <span class="s0">assert_allclose(p</span><span class="s1">, </span><span class="s0">p_true</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-12</span><span class="s1">, </span><span class="s0">atol=</span><span class="s3">1e-12</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_mean_var(self):</span>
        <span class="s1">for </span><span class="s0">m </span><span class="s1">in </span><span class="s0">[</span><span class="s3">9</span><span class="s1">, </span><span class="s0">np.array([</span><span class="s3">1</span><span class="s1">, </span><span class="s3">5</span><span class="s1">, </span><span class="s3">10</span><span class="s0">])]:</span>
            <span class="s0">n</span><span class="s1">, </span><span class="s0">p = zinegbin.convert_params(m</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">1</span><span class="s0">)</span>
            <span class="s0">nbinom_mean</span><span class="s1">, </span><span class="s0">nbinom_var = nbinom.mean(n</span><span class="s1">, </span><span class="s0">p)</span><span class="s1">, </span><span class="s0">nbinom.var(n</span><span class="s1">, </span><span class="s0">p)</span>
            <span class="s0">zinb_mean = zinegbin.mean(m</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
            <span class="s0">zinb_var = zinegbin.var(m</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
            <span class="s0">assert_allclose(nbinom_mean</span><span class="s1">, </span><span class="s0">zinb_mean</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-10</span><span class="s0">)</span>
            <span class="s0">assert_allclose(nbinom_var</span><span class="s1">, </span><span class="s0">zinb_var</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-10</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_moments(self):</span>
        <span class="s0">n</span><span class="s1">, </span><span class="s0">p = zinegbin.convert_params(</span><span class="s3">9</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">1</span><span class="s0">)</span>
        <span class="s0">nb_m1</span><span class="s1">, </span><span class="s0">nb_m2 = nbinom.moment(</span><span class="s3">1</span><span class="s1">, </span><span class="s0">n</span><span class="s1">, </span><span class="s0">p)</span><span class="s1">, </span><span class="s0">nbinom.moment(</span><span class="s3">2</span><span class="s1">, </span><span class="s0">n</span><span class="s1">, </span><span class="s0">p)</span>
        <span class="s0">zinb_m0 = zinegbin.moment(</span><span class="s3">0</span><span class="s1">, </span><span class="s3">9</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">zinb_m1 = zinegbin.moment(</span><span class="s3">1</span><span class="s1">, </span><span class="s3">9</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">zinb_m2 = zinegbin.moment(</span><span class="s3">2</span><span class="s1">, </span><span class="s3">9</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">assert_allclose(</span><span class="s3">1</span><span class="s1">, </span><span class="s0">zinb_m0</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-10</span><span class="s0">)</span>
        <span class="s0">assert_allclose(nb_m1</span><span class="s1">, </span><span class="s0">zinb_m1</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-10</span><span class="s0">)</span>
        <span class="s0">assert_allclose(nb_m2</span><span class="s1">, </span><span class="s0">zinb_m2</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-10</span><span class="s0">)</span>


<span class="s1">class </span><span class="s0">CheckDiscretized():</span>

    <span class="s1">def </span><span class="s0">convert_params(self</span><span class="s1">, </span><span class="s0">params):</span>
        <span class="s0">args = params.tolist()</span>
        <span class="s0">args.insert(-</span><span class="s3">1</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s1">return </span><span class="s0">args</span>

    <span class="s1">def </span><span class="s0">test_basic(self):</span>
        <span class="s0">d_offset = self.d_offset</span>
        <span class="s0">ddistr = self.ddistr</span>
        <span class="s0">paramg = self.paramg</span>
        <span class="s0">paramd = self.paramd</span>
        <span class="s0">shapes = self.shapes</span>
        <span class="s0">start_params = self.start_params</span>

        <span class="s0">np.random.seed(</span><span class="s3">987146</span><span class="s0">)</span>

        <span class="s0">dp = DiscretizedCount(ddistr</span><span class="s1">, </span><span class="s0">d_offset)</span>
        <span class="s1">assert </span><span class="s0">dp.shapes == shapes</span>
        <span class="s0">xi = np.arange(</span><span class="s3">5</span><span class="s0">)</span>
        <span class="s0">p = dp._pmf(xi</span><span class="s1">, </span><span class="s0">*paramd)</span>

        <span class="s0">cdf1 = ddistr.cdf(xi</span><span class="s1">, </span><span class="s0">*paramg)</span>
        <span class="s0">p1 = np.diff(cdf1)</span>
        <span class="s0">assert_allclose(p[: len(p1)]</span><span class="s1">, </span><span class="s0">p1</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-13</span><span class="s0">)</span>
        <span class="s0">cdf = dp._cdf(xi</span><span class="s1">, </span><span class="s0">*paramd)</span>
        <span class="s0">assert_allclose(cdf[: len(cdf1) - </span><span class="s3">1</span><span class="s0">]</span><span class="s1">, </span><span class="s0">cdf1[</span><span class="s3">1</span><span class="s0">:]</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-13</span><span class="s0">)</span>

        <span class="s2"># check that scipy dispatch methods work</span>
        <span class="s0">p2 = dp.pmf(xi</span><span class="s1">, </span><span class="s0">*paramd)</span>
        <span class="s0">assert_allclose(p2</span><span class="s1">, </span><span class="s0">p</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-13</span><span class="s0">)</span>
        <span class="s0">cdf2 = dp.cdf(xi</span><span class="s1">, </span><span class="s0">*paramd)</span>
        <span class="s0">assert_allclose(cdf2</span><span class="s1">, </span><span class="s0">cdf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-13</span><span class="s0">)</span>
        <span class="s0">sf = dp.sf(xi</span><span class="s1">, </span><span class="s0">*paramd)</span>
        <span class="s0">assert_allclose(sf</span><span class="s1">, </span><span class="s3">1 </span><span class="s0">- cdf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-13</span><span class="s0">)</span>

        <span class="s0">nobs = </span><span class="s3">2000</span>

        <span class="s0">xx = dp.rvs(*paramd</span><span class="s1">, </span><span class="s0">size=nobs)  </span><span class="s2"># , random_state=987146)</span>
        <span class="s2"># check that we go a non-trivial rvs</span>
        <span class="s1">assert </span><span class="s0">len(xx) == nobs</span>
        <span class="s1">assert </span><span class="s0">xx.var() &gt; </span><span class="s3">0.001</span>
        <span class="s0">mod = DiscretizedModel(xx</span><span class="s1">, </span><span class="s0">distr=dp)</span>
        <span class="s0">res = mod.fit(start_params=start_params)</span>
        <span class="s0">p = mod.predict(res.params</span><span class="s1">, </span><span class="s0">which=</span><span class="s5">&quot;probs&quot;</span><span class="s0">)</span>
        <span class="s0">args = self.convert_params(res.params)</span>
        <span class="s0">p1 = -np.diff(ddistr.sf(np.arange(</span><span class="s3">21</span><span class="s0">)</span><span class="s1">, </span><span class="s0">*args))</span>
        <span class="s0">assert_allclose(p</span><span class="s1">, </span><span class="s0">p1</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-13</span><span class="s0">)</span>

        <span class="s2"># using cdf limits precision to computation around 1</span>
        <span class="s0">p1 = np.diff(ddistr.cdf(np.arange(</span><span class="s3">21</span><span class="s0">)</span><span class="s1">, </span><span class="s0">*args))</span>
        <span class="s0">assert_allclose(p</span><span class="s1">, </span><span class="s0">p1</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-13</span><span class="s1">, </span><span class="s0">atol=</span><span class="s3">1e-15</span><span class="s0">)</span>
        <span class="s0">freq = np.bincount(xx.astype(int))</span>
        <span class="s2"># truncate at last observed</span>
        <span class="s0">k = len(freq)</span>
        <span class="s1">if </span><span class="s0">k &gt; </span><span class="s3">10</span><span class="s0">:</span>
            <span class="s2"># reduce low count bins for heavy tailed distributions</span>
            <span class="s0">k = </span><span class="s3">10</span>
            <span class="s0">freq[k - </span><span class="s3">1</span><span class="s0">] += freq[k:].sum()</span>
            <span class="s0">freq = freq[:k]</span>
        <span class="s0">p = mod.predict(res.params</span><span class="s1">, </span><span class="s0">which=</span><span class="s5">&quot;probs&quot;</span><span class="s1">, </span><span class="s0">k_max=k)</span>
        <span class="s0">p[k - </span><span class="s3">1</span><span class="s0">] += </span><span class="s3">1 </span><span class="s0">- p[:k].sum()</span>
        <span class="s0">tchi2 = stats.chisquare(freq</span><span class="s1">, </span><span class="s0">p[:k] * nobs)</span>
        <span class="s1">assert </span><span class="s0">tchi2.pvalue &gt; </span><span class="s3">0.01</span>

        <span class="s2"># estimated distribution methods rvs, ppf</span>
        <span class="s2"># frozen distribution with estimated parameters</span>
        <span class="s2"># Todo results method</span>
        <span class="s0">dfr = mod.get_distr(res.params)</span>
        <span class="s0">nobs_rvs = </span><span class="s3">500</span>
        <span class="s0">rvs = dfr.rvs(size=nobs_rvs)</span>
        <span class="s0">freq = np.bincount(rvs)</span>
        <span class="s0">p = mod.predict(res.params</span><span class="s1">, </span><span class="s0">which=</span><span class="s5">&quot;probs&quot;</span><span class="s1">, </span><span class="s0">k_max=nobs_rvs)</span>
        <span class="s0">k = len(freq)</span>
        <span class="s0">p[k - </span><span class="s3">1</span><span class="s0">] += </span><span class="s3">1 </span><span class="s0">- p[:k].sum()</span>
        <span class="s0">tchi2 = stats.chisquare(freq</span><span class="s1">, </span><span class="s0">p[:k] * nobs_rvs)</span>
        <span class="s1">assert </span><span class="s0">tchi2.pvalue &gt; </span><span class="s3">0.01</span>

        <span class="s2"># round trip cdf-ppf</span>
        <span class="s0">q = dfr.ppf(dfr.cdf(np.arange(-</span><span class="s3">1</span><span class="s1">, </span><span class="s3">5</span><span class="s0">) + </span><span class="s3">1e-6</span><span class="s0">))</span>
        <span class="s0">q1 = np.array([-</span><span class="s3">1.</span><span class="s1">,  </span><span class="s3">1.</span><span class="s1">,  </span><span class="s3">2.</span><span class="s1">,  </span><span class="s3">3.</span><span class="s1">,  </span><span class="s3">4.</span><span class="s1">,  </span><span class="s3">5.</span><span class="s0">])</span>
        <span class="s0">assert_equal(q</span><span class="s1">, </span><span class="s0">q1)</span>
        <span class="s0">p = np.maximum(dfr.cdf(np.arange(-</span><span class="s3">1</span><span class="s1">, </span><span class="s3">5</span><span class="s0">)) - </span><span class="s3">1e-6</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">q = dfr.ppf(p)</span>
        <span class="s0">q1 = np.arange(-</span><span class="s3">1</span><span class="s1">, </span><span class="s3">5</span><span class="s0">)</span>
        <span class="s0">assert_equal(q</span><span class="s1">, </span><span class="s0">q1)</span>
        <span class="s0">q = dfr.ppf(dfr.cdf(np.arange(</span><span class="s3">5</span><span class="s0">)))</span>
        <span class="s0">q1 = np.arange(</span><span class="s3">0</span><span class="s1">, </span><span class="s3">5</span><span class="s0">)</span>
        <span class="s0">assert_equal(q</span><span class="s1">, </span><span class="s0">q1)</span>
        <span class="s0">q = dfr.isf(</span><span class="s3">1 </span><span class="s0">- dfr.cdf(np.arange(-</span><span class="s3">1</span><span class="s1">, </span><span class="s3">5</span><span class="s0">) + </span><span class="s3">1e-6</span><span class="s0">))</span>
        <span class="s0">q1 = np.array([-</span><span class="s3">1.</span><span class="s1">,  </span><span class="s3">1.</span><span class="s1">,  </span><span class="s3">2.</span><span class="s1">,  </span><span class="s3">3.</span><span class="s1">,  </span><span class="s3">4.</span><span class="s1">,  </span><span class="s3">5.</span><span class="s0">])</span>
        <span class="s0">assert_equal(q</span><span class="s1">, </span><span class="s0">q1)</span>


<span class="s1">class </span><span class="s0">TestDiscretizedGamma(CheckDiscretized):</span>

    <span class="s0">@classmethod</span>
    <span class="s1">def </span><span class="s0">setup_class(cls):</span>
        <span class="s0">cls.d_offset = </span><span class="s3">0</span>
        <span class="s0">cls.ddistr = stats.gamma</span>
        <span class="s0">cls.paramg = (</span><span class="s3">5</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">0.5</span><span class="s0">)  </span><span class="s2"># include constant so we can use args</span>
        <span class="s0">cls.paramd = (</span><span class="s3">5</span><span class="s1">, </span><span class="s3">0.5</span><span class="s0">)</span>
        <span class="s0">cls.shapes = </span><span class="s5">&quot;a, s&quot;</span>

        <span class="s0">cls.start_params = (</span><span class="s3">1</span><span class="s1">, </span><span class="s3">0.5</span><span class="s0">)</span>


<span class="s1">class </span><span class="s0">TestDiscretizedExponential(CheckDiscretized):</span>

    <span class="s0">@classmethod</span>
    <span class="s1">def </span><span class="s0">setup_class(cls):</span>
        <span class="s0">cls.d_offset = </span><span class="s3">0</span>
        <span class="s0">cls.ddistr = stats.expon</span>
        <span class="s0">cls.paramg = (</span><span class="s3">0</span><span class="s1">, </span><span class="s3">5</span><span class="s0">)  </span><span class="s2"># include constant so we can use args</span>
        <span class="s0">cls.paramd = (</span><span class="s3">5</span><span class="s1">,</span><span class="s0">)</span>
        <span class="s0">cls.shapes = </span><span class="s5">&quot;s&quot;</span>

        <span class="s0">cls.start_params = (</span><span class="s3">0.5</span><span class="s0">)</span>


<span class="s1">class </span><span class="s0">TestDiscretizedLomax(CheckDiscretized):</span>

    <span class="s0">@classmethod</span>
    <span class="s1">def </span><span class="s0">setup_class(cls):</span>
        <span class="s0">cls.d_offset = </span><span class="s3">0</span>
        <span class="s0">cls.ddistr = stats.lomax  </span><span class="s2"># instead of pareto to avoid p(y=0) = 0</span>
        <span class="s0">cls.paramg = (</span><span class="s3">2</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">1.5</span><span class="s0">)  </span><span class="s2"># include constant so we can use args</span>
        <span class="s0">cls.paramd = (</span><span class="s3">2</span><span class="s1">, </span><span class="s3">1.5</span><span class="s1">,</span><span class="s0">)</span>
        <span class="s0">cls.shapes = </span><span class="s5">&quot;c, s&quot;</span>

        <span class="s0">cls.start_params = (</span><span class="s3">0.5</span><span class="s1">, </span><span class="s3">0.5</span><span class="s0">)</span>


<span class="s1">class </span><span class="s0">TestDiscretizedBurr12(CheckDiscretized):</span>

    <span class="s0">@classmethod</span>
    <span class="s1">def </span><span class="s0">setup_class(cls):</span>
        <span class="s0">cls.d_offset = </span><span class="s3">0</span>
        <span class="s0">cls.ddistr = stats.burr12  </span><span class="s2"># should be lomax as special case of burr12</span>
        <span class="s0">cls.paramg = (</span><span class="s3">2</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">1.5</span><span class="s0">)</span>
        <span class="s0">cls.paramd = (</span><span class="s3">2</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">1.5</span><span class="s0">)</span>
        <span class="s0">cls.shapes = </span><span class="s5">&quot;c, d, s&quot;</span>

        <span class="s0">cls.start_params = (</span><span class="s3">0.5</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">0.5</span><span class="s0">)</span>


<span class="s1">class </span><span class="s0">TestDiscretizedGammaEx():</span>
    <span class="s2"># strike outbreaks example from Ch... 2012</span>

    <span class="s1">def </span><span class="s0">test_all(self):</span>
        <span class="s2"># expand frequencies to observations, (no freq_weights yet)</span>
        <span class="s0">freq = [</span><span class="s3">46</span><span class="s1">, </span><span class="s3">76</span><span class="s1">, </span><span class="s3">24</span><span class="s1">, </span><span class="s3">9</span><span class="s1">, </span><span class="s3">1</span><span class="s0">]</span>
        <span class="s0">y = np.repeat(np.arange(</span><span class="s3">5</span><span class="s0">)</span><span class="s1">, </span><span class="s0">freq)</span>
        <span class="s2"># results from article table 7</span>
        <span class="s0">res1 = Bunch(</span>
            <span class="s0">params=[</span><span class="s3">3.52636</span><span class="s1">, </span><span class="s3">0.425617</span><span class="s0">]</span><span class="s1">,</span>
            <span class="s0">llf=-</span><span class="s3">187.469</span><span class="s1">,</span>
            <span class="s0">chi2=</span><span class="s3">1.701208</span><span class="s1">,  </span><span class="s2"># chisquare test</span>
            <span class="s0">df_model=</span><span class="s3">0</span><span class="s1">,</span>
            <span class="s0">p=</span><span class="s3">0.4272</span><span class="s1">,  </span><span class="s2"># p-value for chi2</span>
            <span class="s0">aic=</span><span class="s3">378.938</span><span class="s1">,</span>
            <span class="s0">probs=[</span><span class="s3">46.48</span><span class="s1">, </span><span class="s3">73.72</span><span class="s1">, </span><span class="s3">27.88</span><span class="s1">, </span><span class="s3">6.5</span><span class="s1">, </span><span class="s3">1.42</span><span class="s0">])</span>

        <span class="s0">dp = DiscretizedCount(stats.gamma)</span>
        <span class="s0">mod = DiscretizedModel(y</span><span class="s1">, </span><span class="s0">distr=dp)</span>
        <span class="s0">res = mod.fit(start_params=[</span><span class="s3">1</span><span class="s1">, </span><span class="s3">1</span><span class="s0">])</span>
        <span class="s0">nobs = len(y)</span>

        <span class="s0">assert_allclose(res.params</span><span class="s1">, </span><span class="s0">res1.params</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-5</span><span class="s0">)</span>
        <span class="s0">assert_allclose(res.llf</span><span class="s1">, </span><span class="s0">res1.llf</span><span class="s1">, </span><span class="s0">atol=</span><span class="s3">6e-3</span><span class="s0">)</span>
        <span class="s0">assert_allclose(res.aic</span><span class="s1">, </span><span class="s0">res1.aic</span><span class="s1">, </span><span class="s0">atol=</span><span class="s3">6e-3</span><span class="s0">)</span>
        <span class="s0">assert_equal(res.df_model</span><span class="s1">, </span><span class="s0">res1.df_model)</span>

        <span class="s0">probs = mod.predict(res.params</span><span class="s1">, </span><span class="s0">which=</span><span class="s5">&quot;probs&quot;</span><span class="s0">)</span>
        <span class="s0">probs_trunc = probs[:len(res1.probs)]</span>
        <span class="s0">probs_trunc[-</span><span class="s3">1</span><span class="s0">] += </span><span class="s3">1 </span><span class="s0">- probs_trunc.sum()</span>
        <span class="s0">assert_allclose(probs_trunc * nobs</span><span class="s1">, </span><span class="s0">res1.probs</span><span class="s1">, </span><span class="s0">atol=</span><span class="s3">6e-2</span><span class="s0">)</span>

        <span class="s0">assert_allclose(np.sum(freq)</span><span class="s1">, </span><span class="s0">(probs_trunc * nobs).sum()</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-10</span><span class="s0">)</span>
        <span class="s0">res_chi2 = stats.chisquare(freq</span><span class="s1">, </span><span class="s0">probs_trunc * nobs</span><span class="s1">,</span>
                                   <span class="s0">ddof=len(res.params))</span>
        <span class="s2"># regression test, numbers from running test</span>
        <span class="s2"># close but not identical to article</span>
        <span class="s0">assert_allclose(res_chi2.statistic</span><span class="s1">, </span><span class="s3">1.70409356</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-7</span><span class="s0">)</span>
        <span class="s0">assert_allclose(res_chi2.pvalue</span><span class="s1">, </span><span class="s3">0.42654100</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-7</span><span class="s0">)</span>

        <span class="s2"># smoke test for summary</span>
        <span class="s0">res.summary()</span>

        <span class="s0">np.random.seed(</span><span class="s3">987146</span><span class="s0">)</span>
        <span class="s0">res_boots = res.bootstrap()</span>
        <span class="s2"># only loose check, small default n_rep=100, agreement at around 3%</span>
        <span class="s0">assert_allclose(res.params</span><span class="s1">, </span><span class="s0">res_boots[</span><span class="s3">0</span><span class="s0">]</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">0.05</span><span class="s0">)</span>
        <span class="s0">assert_allclose(res.bse</span><span class="s1">, </span><span class="s0">res_boots[</span><span class="s3">1</span><span class="s0">]</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">0.05</span><span class="s0">)</span>


<span class="s1">class </span><span class="s0">TestGeometric():</span>

    <span class="s1">def </span><span class="s0">test_all(self):</span>
        <span class="s0">p_geom = </span><span class="s3">0.6</span>
        <span class="s0">scale_dexpon = -</span><span class="s3">1 </span><span class="s0">/ np.log(</span><span class="s3">1</span><span class="s0">-p_geom)</span>
        <span class="s0">dgeo = stats.geom(p_geom</span><span class="s1">, </span><span class="s0">loc=-</span><span class="s3">1</span><span class="s0">)</span>
        <span class="s0">dpg = DiscretizedCount(stats.expon)(scale_dexpon)</span>

        <span class="s0">xi = np.arange(</span><span class="s3">6</span><span class="s0">)</span>
        <span class="s0">pmf1 = dgeo.pmf(xi)</span>
        <span class="s0">pmf = dpg.pmf(xi)</span>
        <span class="s0">assert_allclose(pmf</span><span class="s1">, </span><span class="s0">pmf1</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-10</span><span class="s0">)</span>
        <span class="s0">cdf1 = dgeo.cdf(xi)</span>
        <span class="s0">cdf = dpg.cdf(xi)</span>
        <span class="s0">assert_allclose(cdf</span><span class="s1">, </span><span class="s0">cdf1</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-10</span><span class="s0">)</span>
        <span class="s0">sf1 = dgeo.sf(xi)</span>
        <span class="s0">sf = dpg.sf(xi)</span>
        <span class="s0">assert_allclose(sf</span><span class="s1">, </span><span class="s0">sf1</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-10</span><span class="s0">)</span>

        <span class="s0">ppf1 = dgeo.ppf(cdf1)</span>
        <span class="s0">ppf = dpg.ppf(cdf1)</span>
        <span class="s0">assert_equal(ppf</span><span class="s1">, </span><span class="s0">ppf1)</span>
        <span class="s0">ppf1 = dgeo.ppf(cdf1 - </span><span class="s3">1e-8</span><span class="s0">)</span>
        <span class="s0">ppf = dpg.ppf(cdf1 - </span><span class="s3">1e-8</span><span class="s0">)</span>
        <span class="s0">assert_equal(ppf</span><span class="s1">, </span><span class="s0">ppf1)</span>
        <span class="s0">ppf1 = dgeo.ppf(cdf1 + </span><span class="s3">1e-8</span><span class="s0">)</span>
        <span class="s0">ppf = dpg.ppf(cdf1 + </span><span class="s3">1e-8</span><span class="s0">)</span>
        <span class="s0">assert_equal(ppf</span><span class="s1">, </span><span class="s0">ppf1)</span>
        <span class="s0">ppf1 = dgeo.ppf(</span><span class="s3">0</span><span class="s0">)  </span><span class="s2"># incorrect in scipy &lt; 1.5.0</span>
        <span class="s0">ppf = dpg.ppf(</span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">assert_equal(ppf</span><span class="s1">, </span><span class="s0">-</span><span class="s3">1</span><span class="s0">)</span>

        <span class="s2"># isf</span>
        <span class="s0">isf1 = dgeo.isf(sf1)</span>
        <span class="s0">isf = dpg.isf(sf1)</span>
        <span class="s0">assert_equal(isf</span><span class="s1">, </span><span class="s0">isf1)</span>
        <span class="s0">isf1 = dgeo.isf(sf1 - </span><span class="s3">1e-8</span><span class="s0">)</span>
        <span class="s0">isf = dpg.isf(sf1 - </span><span class="s3">1e-8</span><span class="s0">)</span>
        <span class="s0">assert_equal(isf</span><span class="s1">, </span><span class="s0">isf1)</span>
        <span class="s0">isf1 = dgeo.isf(sf1 + </span><span class="s3">1e-8</span><span class="s0">)</span>
        <span class="s0">isf = dpg.isf(sf1 + </span><span class="s3">1e-8</span><span class="s0">)</span>
        <span class="s0">assert_equal(isf</span><span class="s1">, </span><span class="s0">isf1)</span>
        <span class="s0">isf1 = dgeo.isf(</span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">isf = dpg.isf(</span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">assert_equal(isf</span><span class="s1">, </span><span class="s0">isf1)  </span><span class="s2"># inf</span>
        <span class="s0">isf1 = dgeo.isf(</span><span class="s3">1</span><span class="s0">)  </span><span class="s2"># currently incorrect in scipy</span>
        <span class="s0">isf = dpg.isf(</span><span class="s3">1</span><span class="s0">)</span>
        <span class="s0">assert_equal(isf</span><span class="s1">, </span><span class="s0">-</span><span class="s3">1</span><span class="s0">)</span>


<span class="s1">class </span><span class="s0">TestTruncatedNBP:</span>
    <span class="s4">&quot;&quot;&quot; 
    Test Truncated Poisson distribution 
    &quot;&quot;&quot;</span>
    <span class="s1">def </span><span class="s0">test_pmf_zero(self):</span>
        <span class="s0">n</span><span class="s1">, </span><span class="s0">p = truncatednegbin.convert_params(</span><span class="s3">5</span><span class="s1">, </span><span class="s3">0.1</span><span class="s1">, </span><span class="s3">2</span><span class="s0">)</span>
        <span class="s0">nb_pmf = nbinom.pmf(</span><span class="s3">1</span><span class="s1">, </span><span class="s0">n</span><span class="s1">, </span><span class="s0">p) / nbinom.sf(</span><span class="s3">0</span><span class="s1">, </span><span class="s0">n</span><span class="s1">, </span><span class="s0">p)</span>
        <span class="s0">tnb_pmf = truncatednegbin.pmf(</span><span class="s3">1</span><span class="s1">, </span><span class="s3">5</span><span class="s1">, </span><span class="s3">0.1</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">assert_allclose(nb_pmf</span><span class="s1">, </span><span class="s0">tnb_pmf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-5</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_logpmf_zero(self):</span>
        <span class="s0">n</span><span class="s1">, </span><span class="s0">p = truncatednegbin.convert_params(</span><span class="s3">5</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">2</span><span class="s0">)</span>
        <span class="s0">nb_logpmf = nbinom.logpmf(</span><span class="s3">1</span><span class="s1">, </span><span class="s0">n</span><span class="s1">, </span><span class="s0">p) - np.log(nbinom.sf(</span><span class="s3">0</span><span class="s1">, </span><span class="s0">n</span><span class="s1">, </span><span class="s0">p))</span>
        <span class="s0">tnb_logpmf = truncatednegbin.logpmf(</span><span class="s3">1</span><span class="s1">, </span><span class="s3">5</span><span class="s1">, </span><span class="s3">1</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>
        <span class="s0">assert_allclose(nb_logpmf</span><span class="s1">, </span><span class="s0">tnb_logpmf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-2</span><span class="s1">, </span><span class="s0">atol=</span><span class="s3">1e-2</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_pmf(self):</span>
        <span class="s0">n</span><span class="s1">, </span><span class="s0">p = truncatednegbin.convert_params(</span><span class="s3">2</span><span class="s1">, </span><span class="s3">0.5</span><span class="s1">, </span><span class="s3">2</span><span class="s0">)</span>
        <span class="s0">nb_logpmf = nbinom.pmf(</span><span class="s3">6</span><span class="s1">, </span><span class="s0">n</span><span class="s1">, </span><span class="s0">p) / nbinom.sf(</span><span class="s3">5</span><span class="s1">, </span><span class="s0">n</span><span class="s1">, </span><span class="s0">p)</span>
        <span class="s0">tnb_pmf = truncatednegbin.pmf(</span><span class="s3">6</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">0.5</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">5</span><span class="s0">)</span>
        <span class="s0">assert_allclose(nb_logpmf</span><span class="s1">, </span><span class="s0">tnb_pmf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-7</span><span class="s0">)</span>

        <span class="s0">tnb_pmf = truncatednegbin.pmf(</span><span class="s3">5</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">0.5</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">5</span><span class="s0">)</span>
        <span class="s0">assert_equal(tnb_pmf</span><span class="s1">, </span><span class="s3">0</span><span class="s0">)</span>

    <span class="s1">def </span><span class="s0">test_logpmf(self):</span>
        <span class="s0">n</span><span class="s1">, </span><span class="s0">p = truncatednegbin.convert_params(</span><span class="s3">5</span><span class="s1">, </span><span class="s3">0.1</span><span class="s1">, </span><span class="s3">2</span><span class="s0">)</span>
        <span class="s0">nb_logpmf = nbinom.logpmf(</span><span class="s3">6</span><span class="s1">, </span><span class="s0">n</span><span class="s1">, </span><span class="s0">p) - np.log(nbinom.sf(</span><span class="s3">5</span><span class="s1">, </span><span class="s0">n</span><span class="s1">, </span><span class="s0">p))</span>
        <span class="s0">tnb_logpmf = truncatednegbin.logpmf(</span><span class="s3">6</span><span class="s1">, </span><span class="s3">5</span><span class="s1">, </span><span class="s3">0.1</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">5</span><span class="s0">)</span>

        <span class="s0">assert_allclose(nb_logpmf</span><span class="s1">, </span><span class="s0">tnb_logpmf</span><span class="s1">, </span><span class="s0">rtol=</span><span class="s3">1e-7</span><span class="s0">)</span>

        <span class="s0">tnb_logpmf = truncatednegbin.logpmf(</span><span class="s3">5</span><span class="s1">, </span><span class="s3">5</span><span class="s1">, </span><span class="s3">0.1</span><span class="s1">, </span><span class="s3">2</span><span class="s1">, </span><span class="s3">5</span><span class="s0">)</span>
        <span class="s1">assert </span><span class="s0">np.isneginf(tnb_logpmf)</span>
</pre>
</body>
</html>