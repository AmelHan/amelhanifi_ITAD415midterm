<html>
<head>
<title>results_ar.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #629755; font-style: italic;}
.s3 { color: #6a8759;}
.s4 { color: #808080;}
.s5 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
results_ar.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">os</span>

<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>

<span class="s1">cur_dir = os.path.dirname(os.path.abspath(__file__))</span>


<span class="s0">class </span><span class="s1">ARLagResults:</span>
    <span class="s2">&quot;&quot;&quot; 
    Results are from R vars::VARselect for sunspot data. 
 
    Comands run were 
 
    var_select &lt;- VARselect(SUNACTIVITY, lag.max=16, type=c(&quot;const&quot;)) 
    &quot;&quot;&quot;</span>
    <span class="s0">def </span><span class="s1">__init__(self</span><span class="s0">, </span><span class="s1">type=</span><span class="s3">&quot;const&quot;</span><span class="s1">):</span>
        <span class="s4"># order of results is AIC, HQ, SC, FPE</span>
        <span class="s0">if </span><span class="s1">type == </span><span class="s3">&quot;const&quot;</span><span class="s1">:</span>
            <span class="s1">ic = [</span>
                <span class="s5">6.311751824815273</span><span class="s0">, </span><span class="s5">6.321813007357017</span><span class="s0">,  </span><span class="s5">6.336872456958734</span><span class="s0">,</span>
                <span class="s5">551.009492543133547</span><span class="s0">, </span><span class="s5">5.647615009344886</span><span class="s0">, </span><span class="s5">5.662706783157502</span><span class="s0">,</span>
                <span class="s5">5.685295957560077</span><span class="s0">, </span><span class="s5">283.614444209634655</span><span class="s0">,  </span><span class="s5">5.634199640773091</span><span class="s0">,</span>
                <span class="s5">5.654322005856580</span><span class="s0">, </span><span class="s5">5.684440905060013</span><span class="s0">, </span><span class="s5">279.835333966272003</span><span class="s0">,</span>
                <span class="s5">5.639415797766900</span><span class="s0">,  </span><span class="s5">5.664568754121261</span><span class="s0">,  </span><span class="s5">5.702217378125553</span><span class="s0">,</span>
                <span class="s5">281.299267441683185</span><span class="s0">,  </span><span class="s5">5.646102475432464</span><span class="s0">,  </span><span class="s5">5.676286023057697</span><span class="s0">,</span>
                <span class="s5">5.721464371862848</span><span class="s0">, </span><span class="s5">283.187210932784524</span><span class="s0">,  </span><span class="s5">5.628416873122441</span><span class="s0">,</span>
                <span class="s5">5.663631012018546</span><span class="s0">,  </span><span class="s5">5.716339085624555</span><span class="s0">, </span><span class="s5">278.223839284844701</span><span class="s0">,</span>
                <span class="s5">5.584204185137150</span><span class="s0">,  </span><span class="s5">5.624448915304128</span><span class="s0">,  </span><span class="s5">5.684686713710994</span><span class="s0">,</span>
                <span class="s5">266.191975554941564</span><span class="s0">,  </span><span class="s5">5.541163244029505</span><span class="s0">,  </span><span class="s5">5.586438565467356</span><span class="s0">,</span>
                <span class="s5">5.654206088675081</span><span class="s0">, </span><span class="s5">254.979353737235556</span><span class="s0">, </span><span class="s5">5.483155367013447</span><span class="s0">,</span>
                <span class="s5">5.533461279722170</span><span class="s0">,  </span><span class="s5">5.608758527730753</span><span class="s0">, </span><span class="s5">240.611088468544949</span><span class="s0">,</span>
                <span class="s5">5.489939895595428</span><span class="s0">,  </span><span class="s5">5.545276399575022</span><span class="s0">,  </span><span class="s5">5.628103372384465</span><span class="s0">,</span>
                <span class="s5">242.251199397394288</span><span class="s0">,  </span><span class="s5">5.496713895370946</span><span class="s0">,  </span><span class="s5">5.557080990621412</span><span class="s0">,</span>
                <span class="s5">5.647437688231713</span><span class="s0">, </span><span class="s5">243.900349905069504</span><span class="s0">,  </span><span class="s5">5.503539311586831</span><span class="s0">,</span>
                <span class="s5">5.568936998108170</span><span class="s0">,  </span><span class="s5">5.666823420519329</span><span class="s0">, </span><span class="s5">245.573823561989144</span><span class="s0">,</span>
                <span class="s5">5.510365149977393</span><span class="s0">,  </span><span class="s5">5.580793427769605</span><span class="s0">,  </span><span class="s5">5.686209574981622</span><span class="s0">,</span>
                <span class="s5">247.259396991133599</span><span class="s0">,  </span><span class="s5">5.513740912139918</span><span class="s0">,  </span><span class="s5">5.589199781203001</span><span class="s0">,</span>
                <span class="s5">5.702145653215877</span><span class="s0">, </span><span class="s5">248.099655693709479</span><span class="s0">,  </span><span class="s5">5.515627471325321</span><span class="s0">,</span>
                <span class="s5">5.596116931659277</span><span class="s0">,  </span><span class="s5">5.716592528473011</span><span class="s0">, </span><span class="s5">248.572915484827206</span><span class="s0">,</span>
                <span class="s5">5.515935627515806</span><span class="s0">,  </span><span class="s5">5.601455679120634</span><span class="s0">,  </span><span class="s5">5.729461000735226</span><span class="s0">,</span>
                <span class="s5">248.654927915301300</span><span class="s1">]</span>
            <span class="s1">self.ic = np.asarray(ic).reshape(</span><span class="s5">4</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1</span><span class="s0">, </span><span class="s1">order=</span><span class="s3">'F'</span><span class="s1">)</span>


<span class="s0">class </span><span class="s1">ARResultsOLS:</span>
    <span class="s2">&quot;&quot;&quot; 
    Results of fitting an AR(9) model to the sunspot data. 
 
    Results were taken from Stata using the var command. 
   &quot;&quot;&quot;</span>
    <span class="s0">def </span><span class="s1">__init__(self</span><span class="s0">, </span><span class="s1">constant=</span><span class="s0">True</span><span class="s1">):</span>
        <span class="s1">self.avobs = </span><span class="s5">300.</span>
        <span class="s0">if </span><span class="s1">constant:</span>
            <span class="s1">self.params = [</span>
                <span class="s5">6.7430535917332</span><span class="s0">, </span><span class="s5">1.1649421971129</span><span class="s0">,  </span><span class="s1">-</span><span class="s5">.40535742259304</span><span class="s0">,</span>
                <span class="s1">-</span><span class="s5">.16653934246587</span><span class="s0">,  </span><span class="s5">.14980629416032</span><span class="s0">,  </span><span class="s1">-</span><span class="s5">.09462417064796</span><span class="s0">,</span>
                <span class="s5">.00491001240749</span><span class="s0">,  </span><span class="s5">.0504665930841</span><span class="s0">, </span><span class="s1">-</span><span class="s5">.08635349190816</span><span class="s0">,</span>
                <span class="s5">.25349103194757</span><span class="s1">]</span>
            <span class="s4"># These are returned by stata VAR, using the (V)AR scale/sigma</span>
            <span class="s4"># we return the true OLS bse by default</span>
            <span class="s4"># the stata residuals can be achieved</span>
            <span class="s4"># by np.sqrt(np.diag(res1.cov_params()))</span>
            <span class="s1">self.bse_stata = [</span>
                <span class="s5">2.413485601</span><span class="s0">, </span><span class="s5">.0560359041</span><span class="s0">, </span><span class="s5">.0874490762</span><span class="s0">,</span>
                <span class="s5">.0900894414</span><span class="s0">, </span><span class="s5">.0899348339</span><span class="s0">, </span><span class="s5">.0900100797</span><span class="s0">,</span>
                <span class="s5">.0898385666</span><span class="s0">, </span><span class="s5">.0896997939</span><span class="s0">, </span><span class="s5">.0869773089</span><span class="s0">,</span>
                <span class="s5">.0559505756</span><span class="s1">]</span>
            <span class="s4"># The below are grom gretl's ARIMA command with conditional</span>
            <span class="s4"># maximum likelihood</span>
            <span class="s1">self.bse_gretl = [</span>
                <span class="s5">2.45474</span><span class="s0">, </span><span class="s5">0.0569939</span><span class="s0">, </span><span class="s5">0.0889440</span><span class="s0">, </span><span class="s5">0.0916295</span><span class="s0">,</span>
                <span class="s5">0.0914723</span><span class="s0">, </span><span class="s5">0.0915488</span><span class="s0">, </span><span class="s5">0.0913744</span><span class="s0">, </span><span class="s5">0.0912332</span><span class="s0">,</span>
                <span class="s5">0.0884642</span><span class="s0">, </span><span class="s5">0.0569071</span><span class="s1">]</span>
            <span class="s1">self.rmse = </span><span class="s5">15.1279294937327</span>
            <span class="s1">self.fpe = </span><span class="s5">236.4827257929261</span>
            <span class="s1">self.llf = -</span><span class="s5">1235.559128419549</span>
            <span class="s4"># NOTE: we use a different definition of these ic than Stata</span>
            <span class="s4"># but our order selection results agree with R VARselect</span>
            <span class="s4"># close to Stata for Lutkepohl but we penalize the ic for</span>
            <span class="s4"># the trend terms</span>
            <span class="s4"># self.bic = 8.427186938618863</span>
            <span class="s4"># self.aic = 8.30372752279699</span>
            <span class="s4"># self.hqic = 8.353136159250697</span>

            <span class="s4"># NOTE: predictions were taken from gretl, but agree with Stata</span>
            <span class="s4">#   test predict</span>
            <span class="s4"># TODO: remove one of the files</span>
            <span class="s1">filename = os.path.join(cur_dir</span><span class="s0">, </span><span class="s3">&quot;AROLSConstantPredict.csv&quot;</span><span class="s1">)</span>
            <span class="s1">predictresults = np.loadtxt(filename)</span>
            <span class="s1">fv = predictresults[:</span><span class="s5">300</span><span class="s0">, </span><span class="s5">0</span><span class="s1">]</span>
            <span class="s1">pv = predictresults[</span><span class="s5">300</span><span class="s1">:</span><span class="s0">, </span><span class="s5">1</span><span class="s1">]</span>
            <span class="s0">del </span><span class="s1">predictresults</span>

            <span class="s4"># cases - in sample predict</span>
            <span class="s4"># n = -1, start = 0 (fitted values)</span>
            <span class="s1">self.FVOLSnneg1start0 = fv</span>
            <span class="s4"># n=-1, start=9</span>
            <span class="s1">self.FVOLSnneg1start9 = fv</span>
            <span class="s4"># n=-1, start=100</span>
            <span class="s1">self.FVOLSnneg1start100 = fv[</span><span class="s5">100</span><span class="s1">-</span><span class="s5">9</span><span class="s1">:]</span>
            <span class="s4"># n = 200, start = 0</span>
            <span class="s1">self.FVOLSn200start0 = fv[:</span><span class="s5">192</span><span class="s1">]</span>
            <span class="s4"># n = 200, start = 200</span>
            <span class="s1">self.FVOLSn200start200 = np.hstack((fv[</span><span class="s5">200</span><span class="s1">-</span><span class="s5">9</span><span class="s1">:]</span><span class="s0">, </span><span class="s1">pv[:</span><span class="s5">101</span><span class="s1">-</span><span class="s5">9</span><span class="s1">]))</span>
            <span class="s4"># n = 200, start = -109 use above</span>
            <span class="s1">self.FVOLSn200startneg109 = self.FVOLSn200start200</span>
            <span class="s4"># n = 100, start = 325, post-sample forecasting</span>
            <span class="s1">self.FVOLSn100start325 = np.hstack((fv[-</span><span class="s5">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">pv))</span>
            <span class="s4"># n = 301, start = 9</span>
            <span class="s1">self.FVOLSn301start9 = np.hstack((fv</span><span class="s0">, </span><span class="s1">pv[:</span><span class="s5">2</span><span class="s1">]))</span>
            <span class="s4"># n = 301, start = 0</span>
            <span class="s1">self.FVOLSdefault = fv</span>
            <span class="s4"># n = 4, start = 312</span>
            <span class="s1">self.FVOLSn4start312 = np.hstack((fv[-</span><span class="s5">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">pv[:</span><span class="s5">8</span><span class="s1">]))</span>
            <span class="s4"># n = 15, start = 312</span>
            <span class="s1">self.FVOLSn15start312 = np.hstack((fv[-</span><span class="s5">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">pv[:</span><span class="s5">19</span><span class="s1">]))</span>

        <span class="s0">elif not </span><span class="s1">constant:</span>
            <span class="s1">self.params = [</span>
                <span class="s5">1.19582389902985</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.40591818219637</span><span class="s0">,</span>
                <span class="s1">-</span><span class="s5">0.15813796884843</span><span class="s0">, </span><span class="s5">0.16620079925202</span><span class="s0">,</span>
                <span class="s1">-</span><span class="s5">0.08570200254617</span><span class="s0">, </span><span class="s5">0.01876298948686</span><span class="s0">,</span>
                <span class="s5">0.06130211910707</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.08461507700047</span><span class="s0">,</span>
                <span class="s5">0.27995084653313</span><span class="s1">]</span>
            <span class="s1">self.bse_stata = [</span>
                <span class="s5">.055645055</span><span class="s0">, </span><span class="s5">.088579237</span><span class="s0">, </span><span class="s5">.0912031179</span><span class="s0">, </span><span class="s5">.0909032462</span><span class="s0">,</span>
                <span class="s5">.0911161784</span><span class="s0">, </span><span class="s5">.0908611473</span><span class="s0">, </span><span class="s5">.0907743174</span><span class="s0">, </span><span class="s5">.0880993504</span><span class="s0">,</span>
                <span class="s5">.0558560278</span><span class="s1">]</span>
            <span class="s1">self.bse_gretl = [</span>
                <span class="s5">0.0564990</span><span class="s0">, </span><span class="s5">0.0899386</span><span class="s0">, </span><span class="s5">0.0926027</span><span class="s0">, </span><span class="s5">0.0922983</span><span class="s0">,</span>
                <span class="s5">0.0925145</span><span class="s0">, </span><span class="s5">0.0922555</span><span class="s0">, </span><span class="s5">0.0921674</span><span class="s0">, </span><span class="s5">0.0894513</span><span class="s0">,</span>
                <span class="s5">0.0567132</span><span class="s1">]</span>
            <span class="s1">self.rmse = </span><span class="s5">15.29712618677774</span>
            <span class="s1">self.sigma = </span><span class="s5">226.9820074869752</span>
            <span class="s1">self.llf = -</span><span class="s5">1239.41217278661</span>
            <span class="s4"># See note above; TODO: be more specific about &quot;above&quot;</span>
            <span class="s4"># self.bic = 8.433861292817106</span>
            <span class="s4"># self.hqic = 8.367215591385756</span>
            <span class="s4"># self.aic = 8.322747818577421</span>
            <span class="s1">self.fpe = </span><span class="s5">241.0221316614273</span>

            <span class="s1">filename = os.path.join(cur_dir</span><span class="s0">, </span><span class="s3">&quot;AROLSNoConstantPredict.csv&quot;</span><span class="s1">)</span>
            <span class="s1">predictresults = np.loadtxt(filename)</span>
            <span class="s1">fv = predictresults[:</span><span class="s5">300</span><span class="s0">, </span><span class="s5">0</span><span class="s1">]</span>
            <span class="s1">pv = predictresults[</span><span class="s5">300</span><span class="s1">:</span><span class="s0">, </span><span class="s5">1</span><span class="s1">]</span>
            <span class="s0">del </span><span class="s1">predictresults</span>

            <span class="s4"># cases - in sample predict</span>
            <span class="s4"># n = -1, start = 0 (fitted values)</span>
            <span class="s1">self.FVOLSnneg1start0 = fv</span>
            <span class="s4"># n=-1, start=9</span>
            <span class="s1">self.FVOLSnneg1start9 = fv</span>
            <span class="s4"># n=-1, start=100</span>
            <span class="s1">self.FVOLSnneg1start100 = fv[</span><span class="s5">100</span><span class="s1">-</span><span class="s5">9</span><span class="s1">:]</span>
            <span class="s4"># n = 200, start = 0</span>
            <span class="s1">self.FVOLSn200start0 = fv[:</span><span class="s5">192</span><span class="s1">]</span>
            <span class="s4"># n = 200, start = 200</span>
            <span class="s1">self.FVOLSn200start200 = np.hstack((fv[</span><span class="s5">200</span><span class="s1">-</span><span class="s5">9</span><span class="s1">:]</span><span class="s0">, </span><span class="s1">pv[:</span><span class="s5">101</span><span class="s1">-</span><span class="s5">9</span><span class="s1">]))</span>
            <span class="s4"># n = 200, start = -109 use above</span>
            <span class="s1">self.FVOLSn200startneg109 = self.FVOLSn200start200</span>
            <span class="s4"># n = 100, start = 325, post-sample forecasting</span>
            <span class="s1">self.FVOLSn100start325 = np.hstack((fv[-</span><span class="s5">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">pv))</span>
            <span class="s4"># n = 301, start = 9</span>
            <span class="s1">self.FVOLSn301start9 = np.hstack((fv</span><span class="s0">, </span><span class="s1">pv[:</span><span class="s5">2</span><span class="s1">]))</span>
            <span class="s4"># n = 301, start = 0</span>
            <span class="s1">self.FVOLSdefault = fv</span>
            <span class="s4"># n = 4, start = 312</span>
            <span class="s1">self.FVOLSn4start312 = np.hstack((fv[-</span><span class="s5">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">pv[:</span><span class="s5">8</span><span class="s1">]))</span>
            <span class="s4"># n = 15, start = 312</span>
            <span class="s1">self.FVOLSn15start312 = np.hstack((fv[-</span><span class="s5">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">pv[:</span><span class="s5">19</span><span class="s1">]))</span>


<span class="s0">class </span><span class="s1">ARResultsMLE:</span>
    <span class="s2">&quot;&quot;&quot; 
    Results of fitting an AR(9) model to the sunspot data using exact MLE. 
 
    Results were taken from gretl. 
    &quot;&quot;&quot;</span>
    <span class="s0">def </span><span class="s1">__init__(self</span><span class="s0">, </span><span class="s1">constant=</span><span class="s0">True</span><span class="s1">):</span>
        <span class="s1">self.avobs = </span><span class="s5">300</span>
        <span class="s0">if </span><span class="s1">constant:</span>

            <span class="s4"># NOTE: Stata's estimated parameters differ from gretl</span>
            <span class="s1">filename = os.path.join(cur_dir</span><span class="s0">, </span><span class="s3">&quot;ARMLEConstantPredict.csv&quot;</span><span class="s1">)</span>
            <span class="s1">filename2 = os.path.join(cur_dir</span><span class="s0">,</span>
                                     <span class="s3">'results_ar_forecast_mle_dynamic.csv'</span><span class="s1">)</span>
            <span class="s1">predictresults = np.loadtxt(filename</span><span class="s0">, </span><span class="s1">delimiter=</span><span class="s3">&quot;,&quot;</span><span class="s1">)</span>
            <span class="s1">pv = predictresults[:</span><span class="s0">, </span><span class="s5">1</span><span class="s1">]</span>
            <span class="s1">dynamicpv = np.genfromtxt(filename2</span><span class="s0">, </span><span class="s1">delimiter=</span><span class="s3">&quot;,&quot;</span><span class="s0">, </span><span class="s1">skip_header=</span><span class="s5">1</span><span class="s1">)</span>

            <span class="s4"># cases - in sample predict</span>
            <span class="s4"># start = 0 (fitted values)</span>
            <span class="s1">self.FVMLEdefault = pv[:</span><span class="s5">309</span><span class="s1">]</span>
            <span class="s4"># start=9</span>
            <span class="s1">self.FVMLEstart9end308 = pv[</span><span class="s5">9</span><span class="s1">:</span><span class="s5">309</span><span class="s1">]</span>
            <span class="s4"># start=100, end=309</span>
            <span class="s1">self.FVMLEstart100end308 = pv[</span><span class="s5">100</span><span class="s1">:</span><span class="s5">309</span><span class="s1">]</span>
            <span class="s4"># start = 0, end</span>
            <span class="s1">self.FVMLEstart0end200 = pv[:</span><span class="s5">201</span><span class="s1">]</span>
            <span class="s4"># n = 200, start = 200</span>
            <span class="s1">self.FVMLEstart200end334 = pv[</span><span class="s5">200</span><span class="s1">:]</span>
            <span class="s4"># start = 309, end=334 post-sample forecasting</span>
            <span class="s1">self.FVMLEstart308end334 = pv[</span><span class="s5">308</span><span class="s1">:]</span>
            <span class="s4"># end = 310, start = 9</span>
            <span class="s1">self.FVMLEstart9end309 = pv[</span><span class="s5">9</span><span class="s1">:</span><span class="s5">310</span><span class="s1">]</span>
            <span class="s4"># end = 301, start = 0</span>
            <span class="s1">self.FVMLEstart0end301 = pv[:</span><span class="s5">302</span><span class="s1">]</span>
            <span class="s4"># end = 312, start = 4</span>
            <span class="s1">self.FVMLEstart4end312 = pv[</span><span class="s5">4</span><span class="s1">:</span><span class="s5">313</span><span class="s1">]</span>
            <span class="s4"># end = 7, start = 2</span>
            <span class="s1">self.FVMLEstart2end7 = pv[</span><span class="s5">2</span><span class="s1">:</span><span class="s5">8</span><span class="s1">]</span>

            <span class="s1">self.fcdyn = dynamicpv[:</span><span class="s0">, </span><span class="s5">0</span><span class="s1">]</span>
            <span class="s1">self.fcdyn2 = dynamicpv[:</span><span class="s0">, </span><span class="s5">1</span><span class="s1">]</span>
            <span class="s1">self.fcdyn3 = dynamicpv[:</span><span class="s0">, </span><span class="s5">2</span><span class="s1">]</span>
            <span class="s1">self.fcdyn4 = dynamicpv[:</span><span class="s0">, </span><span class="s5">3</span><span class="s1">]</span>

        <span class="s0">else</span><span class="s1">:</span>
            <span class="s0">pass</span>
</pre>
</body>
</html>