<html>
<head>
<title>model_results.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #808080;}
.s3 { color: #629755; font-style: italic;}
.s4 { color: #6a8759;}
.s5 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
model_results.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">import </span><span class="s1">os</span>
<span class="s0">import </span><span class="s1">scikits.statsmodels </span><span class="s0">as </span><span class="s1">models</span>
<span class="s0">from </span><span class="s1">scikits.statsmodels </span><span class="s0">import </span><span class="s1">tools</span>
<span class="s0">import </span><span class="s1">glm_test_resids</span>

<span class="s2">### GLM MODEL RESULTS ###</span>

<span class="s0">class </span><span class="s1">Lbw(object):</span>
    <span class="s3">''' 
    The LBW data can be found here  
 
    http://www.stata-press.com/data/r9/rmain.html 
    '''</span>
    <span class="s0">def </span><span class="s1">__init__(self):</span>
        <span class="s2"># data set up for data not in datasets</span>
        <span class="s1">filename = os.path.join(os.path.dirname(os.path.abspath(__file__))</span><span class="s0">, </span>
            <span class="s4">&quot;stata_lbw_glm.csv&quot;</span><span class="s1">)</span>
        <span class="s1">data=np.recfromcsv(filename</span><span class="s0">, </span><span class="s1">converters={</span><span class="s5">4</span><span class="s1">: </span><span class="s0">lambda </span><span class="s1">s: s.strip(</span><span class="s4">&quot;</span><span class="s0">\&quot;</span><span class="s4">&quot;</span><span class="s1">)})</span>
        <span class="s1">data = tools.categorical(data</span><span class="s0">, </span><span class="s1">col=</span><span class="s4">'race'</span><span class="s0">, </span><span class="s1">drop=</span><span class="s0">True</span><span class="s1">)</span>
        <span class="s1">self.endog = data.low</span>
        <span class="s1">design = np.column_stack((data[</span><span class="s4">'age'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">data[</span><span class="s4">'lwt'</span><span class="s1">]</span><span class="s0">, </span>
                    <span class="s1">data[</span><span class="s4">'_black'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">data[</span><span class="s4">'_other'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">data[</span><span class="s4">'smoke'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">data[</span><span class="s4">'ptl'</span><span class="s1">]</span><span class="s0">, </span>
                    <span class="s1">data[</span><span class="s4">'ht'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">data[</span><span class="s4">'ui'</span><span class="s1">]))</span>
        <span class="s1">self.exog = tools.add_constant(design)</span>
        <span class="s2"># Results for Canonical Logit Link</span>
        <span class="s1">self.params = (-</span><span class="s5">.02710031</span><span class="s0">, </span><span class="s1">-</span><span class="s5">.01515082</span><span class="s0">, </span><span class="s5">1.26264728</span><span class="s0">, </span>
                        <span class="s5">.86207916</span><span class="s0">, </span><span class="s5">.92334482</span><span class="s0">, </span><span class="s5">.54183656</span><span class="s0">, </span><span class="s5">1.83251780</span><span class="s0">, </span>
                        <span class="s5">.75851348</span><span class="s0">, </span><span class="s5">.46122388</span><span class="s1">)</span>
        <span class="s1">self.bse = (</span><span class="s5">0.036449917</span><span class="s0">, </span><span class="s5">0.006925765</span><span class="s0">, </span><span class="s5">0.526405169</span><span class="s0">, </span>
                <span class="s5">0.439146744</span><span class="s0">, </span><span class="s5">0.400820976</span><span class="s0">, </span><span class="s5">0.346246857</span><span class="s0">, </span><span class="s5">0.691623875</span><span class="s0">, </span>
                <span class="s5">0.459373871</span><span class="s0">, </span><span class="s5">1.204574885</span><span class="s1">)</span>
        <span class="s1">self.aic_R = </span><span class="s5">219.447991133</span>
        <span class="s1">self.aic_Stata = </span><span class="s5">1.1611</span>
        <span class="s1">self.deviance = </span><span class="s5">201.447991133</span>
        <span class="s1">self.scale = </span><span class="s5">1</span>
        <span class="s1">self.llf = -</span><span class="s5">100.7239955662511</span>
        <span class="s1">self.null_deviance = </span><span class="s5">234.671996193219</span>
        <span class="s1">self.bic = -</span><span class="s5">742.0665</span>
        <span class="s1">self.df_resid = </span><span class="s5">180</span>
        <span class="s1">self.df_model = </span><span class="s5">8</span>
        <span class="s1">self.df_null = </span><span class="s5">188</span>
        <span class="s1">self.pearson_chi2 = </span><span class="s5">182.0233425</span>
        <span class="s1">self.resids = glm_test_resids.lbw_resids</span>

<span class="s0">class </span><span class="s1">Cancer(object):</span>
    <span class="s3">''' 
    The Cancer data can be found here 
 
    http://www.stata-press.com/data/r10/rmain.html 
    '''</span>
    <span class="s0">def </span><span class="s1">__init__(self):</span>
        <span class="s1">filename = os.path.join(os.path.dirname(os.path.abspath(__file__))</span><span class="s0">,</span>
            <span class="s4">&quot;stata_cancer_glm.csv&quot;</span><span class="s1">)</span>
        <span class="s1">data = np.recfromcsv(filename)</span>
        <span class="s1">self.endog = data.studytime</span>
        <span class="s1">design = np.column_stack((data.age</span><span class="s0">,</span><span class="s1">data.drug))</span>
        <span class="s1">design = tools.categorical(design</span><span class="s0">, </span><span class="s1">col=</span><span class="s5">1</span><span class="s0">, </span><span class="s1">drop=</span><span class="s0">True</span><span class="s1">)</span>
        <span class="s1">design = np.delete(design</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s1">axis=</span><span class="s5">1</span><span class="s1">) </span><span class="s2"># drop first dummy</span>
        <span class="s1">self.exog = tools.add_constant(design)</span>

<span class="s0">class </span><span class="s1">Medpar1(object):</span>
    <span class="s3">''' 
    The medpar1 data can be found here 
 
    http://www.stata-press.com/data/hh2/medpar1 
    '''</span>
    <span class="s0">def </span><span class="s1">__init__(self):</span>
        <span class="s1">filename = os.path.join(os.path.dirname(os.path.abspath(__file__))</span><span class="s0">,</span>
            <span class="s4">&quot;stata_medpar1_glm.csv&quot;</span><span class="s1">)</span>
        <span class="s1">data = np.recfromcsv(filename</span><span class="s0">, </span><span class="s1">converters ={</span><span class="s5">1</span><span class="s1">: </span><span class="s0">lambda </span><span class="s1">s: s.strip(</span><span class="s4">&quot;</span><span class="s0">\&quot;</span><span class="s4">&quot;</span><span class="s1">)})</span>
        <span class="s1">self.endog = data.los</span>
        <span class="s1">design = np.column_stack((data.admitype</span><span class="s0">, </span><span class="s1">data.codes))</span>
        <span class="s1">design = tools.categorical(design</span><span class="s0">, </span><span class="s1">col=</span><span class="s5">0</span><span class="s0">, </span><span class="s1">drop=</span><span class="s0">True</span><span class="s1">)</span>
        <span class="s1">design = np.delete(design</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s1">axis=</span><span class="s5">1</span><span class="s1">) </span><span class="s2"># drop first dummy</span>
        <span class="s1">self.exog = tools.add_constant(design)</span>


<span class="s0">class </span><span class="s1">Cpunish(object):</span>
    <span class="s3">''' 
    The following are from the R script in models.datasets.cpunish 
    Slightly different than published results, but should be correct 
    Probably due to rounding in cleaning? 
    '''</span>
    <span class="s0">def </span><span class="s1">__init__(self):</span>
        <span class="s1">self.params = (</span><span class="s5">2.611017e-04</span><span class="s0">, </span><span class="s5">7.781801e-02</span><span class="s0">, </span><span class="s1">-</span><span class="s5">9.493111e-02</span><span class="s0">, </span><span class="s5">2.969349e-01</span><span class="s0">,</span>
                <span class="s5">2.301183e+00</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.872207e+01</span><span class="s0">, </span><span class="s1">-</span><span class="s5">6.801480e+00</span><span class="s1">)</span>
        <span class="s1">self.bse = (</span><span class="s5">5.187132e-05</span><span class="s0">, </span><span class="s5">7.940193e-02</span><span class="s0">, </span><span class="s5">2.291926e-02</span><span class="s0">, </span><span class="s5">4.375164e-01</span><span class="s0">, </span>
                <span class="s5">4.283826e-01</span><span class="s0">, </span><span class="s5">4.283961e+00</span><span class="s0">, </span><span class="s5">4.146850e+00</span><span class="s1">)</span>
        <span class="s1">self.null_deviance = </span><span class="s5">136.57281747225</span>
        <span class="s1">self.df_null = </span><span class="s5">16</span>
        <span class="s1">self.deviance = </span><span class="s5">18.59164</span>
        <span class="s1">self.df_resid = </span><span class="s5">10</span>
        <span class="s1">self.df_model = </span><span class="s5">6</span>
        <span class="s1">self.aic_R = </span><span class="s5">77.85466   </span><span class="s2"># same as Stata</span>
        <span class="s1">self.aic_Stata = </span><span class="s5">4.579686</span>
        <span class="s1">self.bic = -</span><span class="s5">9.740492</span>
        <span class="s1">self.llf = -</span><span class="s5">31.92732831</span>
        <span class="s1">self.scale = </span><span class="s5">1</span>
        <span class="s1">self.pearson_chi2 = </span><span class="s5">24.75374835</span>
        <span class="s1">self.resids = glm_test_resids.cpunish_resids</span>

<span class="s0">class </span><span class="s1">Scotvote(object):</span>
    <span class="s0">def </span><span class="s1">__init__(self):</span>
        <span class="s1">self.params = (</span><span class="s5">4.961768e-05</span><span class="s0">, </span><span class="s5">2.034423e-03</span><span class="s0">, </span><span class="s1">-</span><span class="s5">7.181429e-05</span><span class="s0">, </span><span class="s5">1.118520e-04</span><span class="s0">,</span>
                <span class="s1">-</span><span class="s5">1.467515e-07</span><span class="s0">, </span><span class="s1">-</span><span class="s5">5.186831e-04</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.42717498e-06</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.776527e-02</span><span class="s1">)</span>
        <span class="s1">self.bse = (</span><span class="s5">1.621577e-05</span><span class="s0">, </span><span class="s5">5.320802e-04</span><span class="s0">, </span><span class="s5">2.711664e-05</span><span class="s0">, </span><span class="s5">4.057691e-05</span><span class="s0">, </span>
            <span class="s5">1.236569e-07</span><span class="s0">, </span><span class="s5">2.402534e-04</span><span class="s0">, </span><span class="s5">7.460253e-07</span><span class="s0">, </span><span class="s5">1.147922e-02</span><span class="s1">)</span>
        <span class="s1">self.null_deviance = </span><span class="s5">0.536072</span>
        <span class="s1">self.df_null = </span><span class="s5">31</span>
        <span class="s1">self.deviance = </span><span class="s5">0.087388516417        </span>
        <span class="s1">self.df_resid = </span><span class="s5">24</span>
        <span class="s1">self.df_model = </span><span class="s5">7</span>
        <span class="s1">self.aic_R = </span><span class="s5">182.947045954721</span>
        <span class="s1">self.aic_Stata = </span><span class="s5">10.72212        </span>
        <span class="s1">self.bic = -</span><span class="s5">83.09027</span>
        <span class="s1">self.llf = -</span><span class="s5">163.5539382 </span><span class="s2"># from Stata, same as ours with scale = 1</span>
        <span class="s1">self.llf_R = -</span><span class="s5">82.47352  </span><span class="s2"># Very close to ours as is</span>
        <span class="s1">self.scale = </span><span class="s5">0.003584283</span>
        <span class="s1">self.pearson_chi2 = </span><span class="s5">.0860228056</span>
        <span class="s1">self.resids = glm_test_resids.scotvote_resids</span>

<span class="s0">class </span><span class="s1">Star98(object):</span>
    <span class="s0">def </span><span class="s1">__init__(self):</span>
        <span class="s1">self.params = (-</span><span class="s5">0.0168150366</span><span class="s0">,  </span><span class="s5">0.0099254766</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.0187242148</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">0.0142385609</span><span class="s0">, </span><span class="s5">0.2544871730</span><span class="s0">,  </span><span class="s5">0.2406936644</span><span class="s0">,  </span><span class="s5">0.0804086739</span><span class="s0">,</span>
            <span class="s1">-</span><span class="s5">1.9521605027</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.3340864748</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.1690221685</span><span class="s0">,  </span><span class="s5">0.0049167021</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">0.0035799644</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.0140765648</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.0040049918</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.0039063958</span><span class="s0">,  </span>
            <span class="s5">0.0917143006</span><span class="s0">,  </span><span class="s5">0.0489898381</span><span class="s0">,  </span><span class="s5">0.0080407389</span><span class="s0">,  </span><span class="s5">0.0002220095</span><span class="s0">,</span>
            <span class="s1">-</span><span class="s5">0.0022492486</span><span class="s0">, </span><span class="s5">2.9588779262</span><span class="s1">)</span>
        <span class="s1">self.bse = (</span><span class="s5">4.339467e-04</span><span class="s0">, </span><span class="s5">6.013714e-04</span><span class="s0">, </span><span class="s5">7.435499e-04</span><span class="s0">, </span><span class="s5">4.338655e-04</span><span class="s0">,</span>
            <span class="s5">2.994576e-02</span><span class="s0">, </span><span class="s5">5.713824e-02</span><span class="s0">, </span><span class="s5">1.392359e-02</span><span class="s0">, </span><span class="s5">3.168109e-01</span><span class="s0">,</span>
            <span class="s5">6.126411e-02</span><span class="s0">, </span><span class="s5">3.270139e-02</span><span class="s0">, </span><span class="s5">1.253877e-03</span><span class="s0">, </span><span class="s5">2.254633e-04</span><span class="s0">, </span>
            <span class="s5">1.904573e-03</span><span class="s0">, </span><span class="s5">4.739838e-04</span><span class="s0">, </span><span class="s5">9.623650e-04</span><span class="s0">, </span><span class="s5">1.450923e-02</span><span class="s0">, </span>
            <span class="s5">7.451666e-03</span><span class="s0">, </span><span class="s5">1.499497e-03</span><span class="s0">, </span><span class="s5">2.988794e-05</span><span class="s0">, </span><span class="s5">3.489838e-04</span><span class="s0">, </span>
            <span class="s5">1.546712e+00</span><span class="s1">)</span>
        <span class="s1">self.null_deviance = </span><span class="s5">34345.3688931</span>
        <span class="s1">self.df_null = </span><span class="s5">302</span>
        <span class="s1">self.deviance = </span><span class="s5">4078.76541772        </span>
        <span class="s1">self.df_resid = </span><span class="s5">282</span>
        <span class="s1">self.df_model = </span><span class="s5">20</span>
        <span class="s1">self.aic_R = </span><span class="s5">6039.22511799</span>
        <span class="s1">self.aic_Stata = </span><span class="s5">19.93144        </span>
        <span class="s1">self.bic = </span><span class="s5">2467.494</span>
        <span class="s1">self.llf = -</span><span class="s5">2998.612928</span>
        <span class="s1">self.scale = </span><span class="s5">1.</span>
        <span class="s1">self.pearson_chi2 = </span><span class="s5">4051.921614</span>
        <span class="s1">self.resids = glm_test_resids.star98_resids</span>

<span class="s0">class </span><span class="s1">InvGauss():</span>
    <span class="s3">''' 
    Data was generated by Hardin and Hilbe using Stata. 
    Note only the first 5000 observations are used because 
    the models code currently uses np.eye. 
    '''</span>
<span class="s2">#        np.random.seed(54321)</span>
<span class="s2">#        x1 = np.abs(stats.norm.ppf((np.random.random(5000))))</span>
<span class="s2">#        x2 = np.abs(stats.norm.ppf((np.random.random(5000))))</span>
<span class="s2">#        X = np.column_stack((x1,x2))</span>
<span class="s2">#        X = add_constant(X)</span>
<span class="s2">#        params = np.array([.5, -.25, 1])</span>
<span class="s2">#        eta = np.dot(X, params)</span>
<span class="s2">#        mu = 1/np.sqrt(eta)</span>
<span class="s2">#        sigma = .5</span>
<span class="s2">#       This isn't correct.  Errors need to be normally distributed</span>
<span class="s2">#       But Y needs to be Inverse Gaussian, so we could build it up</span>
<span class="s2">#       by throwing out data?</span>
<span class="s2">#       Refs: Lai (2009) Generating inverse Gaussian random variates by</span>
<span class="s2">#        approximation</span>
<span class="s2"># Atkinson (1982) The simulation of generalized inverse gaussian and</span>
<span class="s2">#        hyperbolic random variables seems to be the canonical ref</span>
<span class="s2">#        Y = np.dot(X,params) + np.random.wald(mu, sigma, 1000)</span>
<span class="s2">#        model = GLM(Y, X, family=models.family.InverseGaussian(link=\</span>
<span class="s2">#            models.family.links.identity))</span>

    <span class="s0">def </span><span class="s1">__init__(self):</span>
        <span class="s2"># set up data #</span>
        <span class="s1">filename = os.path.join(os.path.dirname(os.path.abspath(__file__))</span><span class="s0">, </span>
            <span class="s4">&quot;inv_gaussian.csv&quot;</span><span class="s1">)</span>
        <span class="s1">data=np.genfromtxt(filename</span><span class="s0">, </span><span class="s1">delimiter=</span><span class="s4">&quot;,&quot;</span><span class="s0">, </span><span class="s1">skiprows=</span><span class="s5">1</span><span class="s1">)</span>
        <span class="s1">self.endog = data[:</span><span class="s5">5000</span><span class="s0">,</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s1">self.exog = data[:</span><span class="s5">5000</span><span class="s0">,</span><span class="s5">1</span><span class="s1">:]</span>
        <span class="s1">self.exog = tools.add_constant(self.exog)</span>
        <span class="s2"># Results</span>
<span class="s2">#NOTE: loglikelihood difference in R vs. Stata vs. Models</span>
<span class="s2"># is the same situation as gamma</span>
        <span class="s1">self.params = (</span><span class="s5">0.4519770</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.2508288</span><span class="s0">, </span><span class="s5">1.0359574</span><span class="s1">)</span>
        <span class="s1">self.bse = (</span><span class="s5">0.03148291</span><span class="s0">, </span><span class="s5">0.02237211</span><span class="s0">, </span><span class="s5">0.03429943</span><span class="s1">)</span>
        <span class="s1">self.null_deviance = </span><span class="s5">1520.673165475461</span>
        <span class="s1">self.df_null = </span><span class="s5">4999</span>
        <span class="s1">self.deviance = </span><span class="s5">1423.943980407997        </span>
        <span class="s1">self.df_resid = </span><span class="s5">4997</span>
        <span class="s1">self.df_model = </span><span class="s5">2</span>
        <span class="s1">self.aic_R = </span><span class="s5">5059.41911646446</span>
        <span class="s1">self.aic_Stata = </span><span class="s5">1.55228        </span>
        <span class="s1">self.bic = -</span><span class="s5">41136.47</span>
        <span class="s1">self.llf = -</span><span class="s5">3877.700354 </span><span class="s2"># same as ours with scale set to 1</span>
        <span class="s1">self.llf_R = -</span><span class="s5">2525.70955823223  </span><span class="s2"># this is close to our defintion</span>
        <span class="s1">self.scale = </span><span class="s5">0.2867266359127567</span>
        <span class="s1">self.pearson_chi2 = </span><span class="s5">1432.771536</span>
        <span class="s1">self.resids = glm_test_resids.invgauss_resids</span>


<span class="s2">### REGRESSION MODEL RESULTS : OLS, GLS, WLS, AR###</span>

<span class="s0">class </span><span class="s1">Longley(object):</span>
    <span class="s3">''' 
    The results for the Longley dataset were obtained from NIST 
 
    http://www.itl.nist.gov/div898/strd/general/dataarchive.html 
 
    Other results were obtained from Stata 
    '''</span>
    <span class="s0">def </span><span class="s1">__init__(self):</span>
        <span class="s1">self.params = ( </span><span class="s5">15.0618722713733</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.358191792925910E-01</span><span class="s0">, </span>
                 <span class="s1">-</span><span class="s5">2.02022980381683</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.03322686717359</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.511041056535807E-01</span><span class="s0">, </span>
                 <span class="s5">1829.15146461355</span><span class="s0">, </span><span class="s1">-</span><span class="s5">3482258.63459582</span><span class="s1">) </span>
        <span class="s1">self.bse = (</span><span class="s5">84.9149257747669</span><span class="s0">, </span><span class="s5">0.334910077722432E-01</span><span class="s0">, </span>
                   <span class="s5">0.488399681651699</span><span class="s0">, </span><span class="s5">0.214274163161675</span><span class="s0">, </span><span class="s5">0.226073200069370</span><span class="s0">, </span>
                   <span class="s5">455.478499142212</span><span class="s0">, </span><span class="s5">890420.383607373</span><span class="s1">)</span>
        <span class="s1">self.conf_int = [(-</span><span class="s5">177.0291</span><span class="s0">,</span><span class="s5">207.1524</span><span class="s1">)</span><span class="s0">,</span>
                   <span class="s1">(-</span><span class="s5">.111581</span><span class="s0">,</span><span class="s5">.0399428</span><span class="s1">)</span><span class="s0">,</span><span class="s1">(-</span><span class="s5">3.125065</span><span class="s0">,</span><span class="s1">-</span><span class="s5">.9153928</span><span class="s1">)</span><span class="s0">,</span>
                   <span class="s1">(-</span><span class="s5">1.517948</span><span class="s0">,</span><span class="s1">-</span><span class="s5">.5485049</span><span class="s1">)</span><span class="s0">,</span><span class="s1">(-</span><span class="s5">.5625173</span><span class="s0">,</span><span class="s5">.4603083</span><span class="s1">)</span><span class="s0">,</span>
                   <span class="s1">(</span><span class="s5">798.7873</span><span class="s0">,</span><span class="s5">2859.515</span><span class="s1">)</span><span class="s0">,</span><span class="s1">(-</span><span class="s5">5496529</span><span class="s0">,</span><span class="s1">-</span><span class="s5">1467987</span><span class="s1">)]</span>
        <span class="s1">self.scale = </span><span class="s5">92936.0061673238 </span>
        <span class="s1">self.rsquared = </span><span class="s5">0.995479004577296</span>
        <span class="s1">self.rsquared_adj = </span><span class="s5">0.99246501</span>
        <span class="s1">self.df_model = </span><span class="s5">6</span>
        <span class="s1">self.df_resid = </span><span class="s5">9</span>
        <span class="s1">self.ess = </span><span class="s5">184172401.944494</span>
        <span class="s1">self.ssr = </span><span class="s5">836424.055505915</span>
        <span class="s1">self.mse_model = </span><span class="s5">30695400.3240823</span>
        <span class="s1">self.mse_resid = </span><span class="s5">92936.0061673238</span>
        <span class="s1">self.fvalue = </span><span class="s5">330.285339234588</span>
        <span class="s1">self.llf = -</span><span class="s5">109.6174</span>
        <span class="s1">self.aic = </span><span class="s5">233.2349</span>
        <span class="s1">self.bic = </span><span class="s5">238.643</span>
        <span class="s1">self.pvalues = np.array([ </span><span class="s5">0.86314083</span><span class="s0">,  </span><span class="s5">0.31268106</span><span class="s0">,  </span><span class="s5">0.00253509</span><span class="s0">,  </span>
            <span class="s5">0.00094437</span><span class="s0">,  </span><span class="s5">0.8262118 </span><span class="s0">, </span><span class="s5">0.0030368 </span><span class="s0">,  </span><span class="s5">0.0035604 </span><span class="s1">])</span>
<span class="s2">#pvalues from rmodelwrap</span>
        <span class="s1">self.resid = np.array((</span><span class="s5">267.34003</span><span class="s0">, </span><span class="s1">-</span><span class="s5">94.01394</span><span class="s0">, </span><span class="s5">46.28717</span><span class="s0">, </span><span class="s1">-</span><span class="s5">410.11462</span><span class="s0">, </span>
            <span class="s5">309.71459</span><span class="s0">, </span><span class="s1">-</span><span class="s5">249.31122</span><span class="s0">, </span><span class="s1">-</span><span class="s5">164.04896</span><span class="s0">, </span><span class="s1">-</span><span class="s5">13.18036</span><span class="s0">, </span><span class="s5">14.30477</span><span class="s0">, </span><span class="s5">455.39409</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">17.26893</span><span class="s0">, </span><span class="s1">-</span><span class="s5">39.05504</span><span class="s0">, </span><span class="s1">-</span><span class="s5">155.54997</span><span class="s0">, </span><span class="s1">-</span><span class="s5">85.67131</span><span class="s0">, </span><span class="s5">341.93151</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">206.75783</span><span class="s1">))</span>

    <span class="s1">HC0_se=(</span><span class="s5">51.22035</span><span class="s0">, </span><span class="s5">0.02458</span><span class="s0">, </span><span class="s5">0.38324</span><span class="s0">, </span><span class="s5">0.14625</span><span class="s0">, </span><span class="s5">0.15821</span><span class="s0">,</span>
               <span class="s5">428.38438</span><span class="s0">, </span><span class="s5">832212</span><span class="s1">)</span>
    <span class="s1">HC1_se=(</span><span class="s5">68.29380</span><span class="s0">, </span><span class="s5">0.03277</span><span class="s0">, </span><span class="s5">0.51099</span><span class="s0">, </span><span class="s5">0.19499</span><span class="s0">, </span><span class="s5">0.21094</span><span class="s0">,</span>
                <span class="s5">571.17917</span><span class="s0">, </span><span class="s5">1109615</span><span class="s1">)</span>
    <span class="s1">HC2_se=(</span><span class="s5">67.49208</span><span class="s0">, </span><span class="s5">0.03653</span><span class="s0">, </span><span class="s5">0.55334</span><span class="s0">, </span><span class="s5">0.20522</span><span class="s0">, </span><span class="s5">0.22324</span><span class="s0">,</span>
                <span class="s5">617.59295</span><span class="s0">, </span><span class="s5">1202370</span><span class="s1">)</span>
    <span class="s1">HC3_se=(</span><span class="s5">91.11939</span><span class="s0">, </span><span class="s5">0.05562</span><span class="s0">, </span><span class="s5">0.82213</span><span class="s0">, </span><span class="s5">0.29879</span><span class="s0">, </span><span class="s5">0.32491</span><span class="s0">,</span>
                <span class="s5">922.80784</span><span class="s0">, </span><span class="s5">1799477</span><span class="s1">)</span>

<span class="s0">class </span><span class="s1">LongleyGls(object):</span>
    <span class="s3">''' 
    The following results were obtained from running the test script with R.      
    '''</span>
    <span class="s0">def </span><span class="s1">__init__(self):</span>
        <span class="s1">self.params = (</span><span class="s5">6.73894832e-02</span><span class="s0">, </span><span class="s1">-</span><span class="s5">4.74273904e-01</span><span class="s0">, </span><span class="s5">9.48988771e+04</span><span class="s1">)</span>
        <span class="s1">self.bse = (</span><span class="s5">1.07033903e-02</span><span class="s0">, </span><span class="s5">1.53385472e-01</span><span class="s0">, </span><span class="s5">1.39447723e+04</span><span class="s1">)</span>
        <span class="s1">self.llf = -</span><span class="s5">121.4294962954981</span>
        <span class="s1">self.fittedvalues = [</span><span class="s5">59651.8255</span><span class="s0">, </span><span class="s5">60860.1385</span><span class="s0">, </span><span class="s5">60226.5336</span><span class="s0">, </span><span class="s5">61467.1268</span><span class="s0">, </span>
                <span class="s5">63914.0846</span><span class="s0">, </span><span class="s5">64561.9553</span><span class="s0">, </span><span class="s5">64935.9028</span><span class="s0">, </span><span class="s5">64249.1684</span><span class="s0">, </span><span class="s5">66010.0426</span><span class="s0">, </span>
                <span class="s5">66834.7630</span><span class="s0">, </span><span class="s5">67612.9309</span><span class="s0">, </span><span class="s5">67018.8998</span><span class="s0">, </span><span class="s5">68918.7758</span><span class="s0">, </span><span class="s5">69310.1280</span><span class="s0">, </span>
                <span class="s5">69181.4207</span><span class="s0">, </span><span class="s5">70598.8734</span><span class="s1">]</span>
        <span class="s1">self.resid = [</span><span class="s5">671.174465</span><span class="s0">, </span><span class="s5">261.861502</span><span class="s0">, </span><span class="s1">-</span><span class="s5">55.533603</span><span class="s0">, </span><span class="s1">-</span><span class="s5">280.126803</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">693.084618</span><span class="s0">, </span><span class="s1">-</span><span class="s5">922.955349</span><span class="s0">, </span><span class="s5">53.097212</span><span class="s0">, </span><span class="s1">-</span><span class="s5">488.168351</span><span class="s0">, </span><span class="s5">8.957367</span><span class="s0">, </span>
                <span class="s5">1022.236970</span><span class="s0">,  </span><span class="s5">556.069099</span><span class="s0">, </span><span class="s1">-</span><span class="s5">505.899787</span><span class="s0">, </span><span class="s1">-</span><span class="s5">263.775842</span><span class="s0">, </span><span class="s5">253.871965</span><span class="s0">, </span>
                <span class="s5">149.579309</span><span class="s0">, </span><span class="s1">-</span><span class="s5">47.873374</span><span class="s1">]</span>
        <span class="s1">self.scale = </span><span class="s5">542.443043098</span><span class="s1">**</span><span class="s5">2</span>
        <span class="s1">self.t = [</span><span class="s5">6.296088</span><span class="s0">, </span><span class="s1">-</span><span class="s5">3.092039</span><span class="s0">, </span><span class="s5">6.805337</span><span class="s1">]</span>
        <span class="s1">self.pvalues = [</span><span class="s5">2.761673e-05</span><span class="s0">, </span><span class="s5">8.577197e-03</span><span class="s0">, </span><span class="s5">1.252284e-05</span><span class="s1">]</span>
        <span class="s1">self.bic = </span><span class="s5">253.118790021</span>
        <span class="s1">self.aic = </span><span class="s5">250.858992591</span>

<span class="s2">### RLM MODEL RESULTS ###</span>

<span class="s0">def </span><span class="s1">_shift_intercept(arr):</span>
    <span class="s3">&quot;&quot;&quot; 
    A convenience function to make the SAS covariance matrix 
    compatible with stats.models.rlm covariance 
    &quot;&quot;&quot;</span>
    <span class="s1">side = np.sqrt(len(arr))</span>
    <span class="s1">arr = np.array(arr).reshape(side</span><span class="s0">,</span><span class="s1">side)</span>
    <span class="s1">tmp = np.zeros((side</span><span class="s0">,</span><span class="s1">side))</span>
    <span class="s1">tmp[:-</span><span class="s5">1</span><span class="s0">,</span><span class="s1">:-</span><span class="s5">1</span><span class="s1">] = arr[</span><span class="s5">1</span><span class="s1">:</span><span class="s0">,</span><span class="s5">1</span><span class="s1">:]</span>
    <span class="s1">tmp[-</span><span class="s5">1</span><span class="s0">,</span><span class="s1">-</span><span class="s5">1</span><span class="s1">] = arr[</span><span class="s5">0</span><span class="s0">,</span><span class="s5">0</span><span class="s1">]</span>
    <span class="s1">tmp[-</span><span class="s5">1</span><span class="s0">,</span><span class="s1">:-</span><span class="s5">1</span><span class="s1">] = arr[</span><span class="s5">0</span><span class="s0">,</span><span class="s5">1</span><span class="s1">:]</span>
    <span class="s1">tmp[:-</span><span class="s5">1</span><span class="s0">,</span><span class="s1">-</span><span class="s5">1</span><span class="s1">] = arr[</span><span class="s5">1</span><span class="s1">:</span><span class="s0">,</span><span class="s5">0</span><span class="s1">]</span>
    <span class="s0">return </span><span class="s1">tmp</span>

<span class="s0">class </span><span class="s1">Huber(object):</span>
    <span class="s1">huber_h1 = [</span><span class="s5">95.8813</span><span class="s0">, </span><span class="s5">0.19485</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.44161</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.13577</span><span class="s0">, </span><span class="s5">0.1949</span><span class="s0">, </span><span class="s5">0.01232</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">0.02474</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00484</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.4416</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.02474</span><span class="s0">, </span><span class="s5">0.09177</span><span class="s0">, </span><span class="s5">0.00001</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.1358</span><span class="s0">,</span>
            <span class="s1">-</span><span class="s5">0.00484</span><span class="s0">, </span><span class="s5">0.00001</span><span class="s0">, </span><span class="s5">0.01655</span><span class="s1">]</span>
    <span class="s1">h1 = _shift_intercept(huber_h1)</span>

    <span class="s1">huber_h2 = [</span><span class="s5">82.6191</span><span class="s0">, </span><span class="s5">0.07942</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.23915</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.95604</span><span class="s0">, </span><span class="s5">0.0794</span><span class="s0">, </span><span class="s5">0.01427</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">0.03013</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00344</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.2392</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.03013</span><span class="s0">, </span><span class="s5">0.10391</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00166</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.9560</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">0.00344</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00166</span><span class="s0">, </span><span class="s5">0.01392</span><span class="s1">]</span>
    <span class="s1">h2 = _shift_intercept(huber_h2)</span>

    <span class="s1">huber_h3 = [</span><span class="s5">70.1633</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.04533</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00790</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.78618</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.0453</span><span class="s0">, </span><span class="s5">0.01656</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">0.03608</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00203</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.0079</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.03608</span><span class="s0">,  </span><span class="s5">0.11610</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00333</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.7862</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">0.00203</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00333</span><span class="s0">,  </span><span class="s5">0.01138</span><span class="s1">]</span>
    <span class="s1">h3 = _shift_intercept(huber_h3)</span>

<span class="s0">class </span><span class="s1">Hampel(object):</span>
    <span class="s1">hampel_h1 = [</span><span class="s5">141.309</span><span class="s0">,  </span><span class="s5">0.28717</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.65085</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.67388</span><span class="s0">, </span><span class="s5">0.287</span><span class="s0">,  </span><span class="s5">0.01816</span><span class="s0">,</span>
            <span class="s1">-</span><span class="s5">0.03646</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00713</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.651</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.03646</span><span class="s0">,  </span><span class="s5">0.13524</span><span class="s0">,  </span><span class="s5">0.00001</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.674</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">0.00713</span><span class="s0">, </span><span class="s5">0.00001</span><span class="s0">,  </span><span class="s5">0.02439</span><span class="s1">]</span>
    <span class="s1">h1 = _shift_intercept(hampel_h1) </span>

    <span class="s1">hampel_h2 = [</span><span class="s5">135.248</span><span class="s0">,  </span><span class="s5">0.18207</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.36884</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.60217</span><span class="s0">, </span><span class="s5">0.182</span><span class="s0">, </span><span class="s5">0.02120</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">0.04563</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00567</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.369</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.04563</span><span class="s0">,  </span><span class="s5">0.15860</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00290</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.602</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">0.00567</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00290</span><span class="s0">, </span><span class="s5">0.02329</span><span class="s1">]  </span>
    <span class="s1">h2 = _shift_intercept(hampel_h2)</span>

    <span class="s1">hampel_h3 = [</span><span class="s5">128.921</span><span class="s0">,  </span><span class="s5">0.05409</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.02445</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.52732</span><span class="s0">, </span><span class="s5">0.054</span><span class="s0">,  </span><span class="s5">0.02514</span><span class="s0">,</span>
            <span class="s1">-</span><span class="s5">0.05732</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00392</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.024</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.05732</span><span class="s0">,  </span><span class="s5">0.18871</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00652</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.527</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">0.00392</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00652</span><span class="s0">,  </span><span class="s5">0.02212</span><span class="s1">]</span>
    <span class="s1">h3 = _shift_intercept(hampel_h3)</span>

<span class="s0">class </span><span class="s1">Bisquare(object):</span>
    <span class="s1">bisquare_h1 = [</span><span class="s5">90.3354</span><span class="s0">,  </span><span class="s5">0.18358</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.41607</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.07007</span><span class="s0">, </span><span class="s5">0.1836</span><span class="s0">, </span><span class="s5">0.01161</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">0.02331</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00456</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.4161</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.02331</span><span class="s0">,  </span><span class="s5">0.08646</span><span class="s0">, </span><span class="s5">0.00001</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.0701</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">0.00456</span><span class="s0">, </span><span class="s5">0.00001</span><span class="s0">,  </span><span class="s5">0.01559</span><span class="s1">]</span>
    <span class="s1">h1 = _shift_intercept(bisquare_h1)</span>

    <span class="s1">bisquare_h2 = [</span><span class="s5">67.82521</span><span class="s0">, </span><span class="s5">0.091288</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.29038</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.78124</span><span class="s0">, </span><span class="s5">0.091288</span><span class="s0">, </span>
            <span class="s5">0.013849</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.02914</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00352</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.29038</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.02914</span><span class="s0">, </span><span class="s5">0.101088</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.001</span><span class="s0">,</span>
            <span class="s1">-</span><span class="s5">0.78124</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00352</span><span class="s0">,   </span><span class="s1">-</span><span class="s5">0.001</span><span class="s0">, </span><span class="s5">0.011766</span><span class="s1">]</span>
    <span class="s1">h2 = _shift_intercept(bisquare_h2)</span>

    <span class="s1">bisquare_h3 = [</span><span class="s5">48.8983</span><span class="s0">, </span><span class="s5">0.000442</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.15919</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.53523</span><span class="s0">, </span><span class="s5">0.000442</span><span class="s0">, </span>
            <span class="s5">0.016113</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.03461</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00259</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.15919</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.03461</span><span class="s0">, </span><span class="s5">0.112728</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">0.00164</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.53523</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00259</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00164</span><span class="s0">, </span><span class="s5">0.008414</span><span class="s1">]</span>
    <span class="s1">h3 = _shift_intercept(bisquare_h3)</span>

<span class="s0">class </span><span class="s1">Andrews(object):</span>
    <span class="s1">andrews_h1 = [</span><span class="s5">87.5357</span><span class="s0">, </span><span class="s5">0.177891</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.40318</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.03691</span><span class="s0">, </span><span class="s5">0.177891</span><span class="s0">,  </span><span class="s5">0.01125</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">0.02258</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00442</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.40318</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.02258</span><span class="s0">, </span><span class="s5">0.083779</span><span class="s0">, </span><span class="s5">6.481E-6</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">1.03691</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00442</span><span class="s0">, </span><span class="s5">6.481E-6</span><span class="s0">,  </span><span class="s5">0.01511</span><span class="s1">]</span>
    <span class="s1">h1 = _shift_intercept(andrews_h1)</span>

    <span class="s1">andrews_h2 = [</span><span class="s5">66.50472</span><span class="s0">,  </span><span class="s5">0.10489</span><span class="s0">,  </span><span class="s1">-</span><span class="s5">0.3246</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.76664</span><span class="s0">, </span><span class="s5">0.10489</span><span class="s0">, </span><span class="s5">0.012786</span><span class="s0">,</span>
            <span class="s1">-</span><span class="s5">0.02651</span><span class="s0">,  </span><span class="s1">-</span><span class="s5">0.0036</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.3246</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.02651</span><span class="s0">,  </span><span class="s5">0.09406</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00065</span><span class="s0">,</span>
            <span class="s1">-</span><span class="s5">0.76664</span><span class="s0">,  </span><span class="s1">-</span><span class="s5">0.0036</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00065</span><span class="s0">, </span><span class="s5">0.011567</span><span class="s1">]</span>
    <span class="s1">h2 = _shift_intercept(andrews_h2)</span>

    <span class="s1">andrews_h3 = [</span><span class="s5">48.62157</span><span class="s0">, </span><span class="s5">0.034949</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.24633</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.53394</span><span class="s0">, </span><span class="s5">0.034949</span><span class="s0">, </span><span class="s5">0.014088</span><span class="s0">,</span>
                <span class="s1">-</span><span class="s5">0.02956</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00287</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.24633</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.02956</span><span class="s0">, </span><span class="s5">0.100628</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00104</span><span class="s0">,</span>
                <span class="s1">-</span><span class="s5">0.53394</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00287</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00104</span><span class="s0">, </span><span class="s5">0.008441</span><span class="s1">]</span>
    <span class="s1">h3 = _shift_intercept(andrews_h3)</span>

    <span class="s1">resid = [</span><span class="s5">2.503338458</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.608934536</span><span class="s0">, </span><span class="s5">3.5548678338</span><span class="s0">, </span><span class="s5">6.9333705014</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">1.768179527</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.417404513</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.392991531</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.392991531</span><span class="s0">,</span>
            <span class="s1">-</span><span class="s5">1.704759385</span><span class="s0">,</span><span class="s1">-</span><span class="s5">0.244545418</span><span class="s0">, </span><span class="s5">0.7659115325</span><span class="s0">, </span><span class="s5">0.3028635237</span><span class="s0">,</span>
            <span class="s1">-</span><span class="s5">3.019999429</span><span class="s0">,</span><span class="s1">-</span><span class="s5">1.434221475</span><span class="s0">,</span><span class="s5">2.1912017882</span><span class="s0">, </span><span class="s5">0.8543828047</span><span class="s0">,</span>
            <span class="s1">-</span><span class="s5">0.366664104</span><span class="s0">,</span><span class="s5">0.4192468573</span><span class="s0">,</span><span class="s5">0.8822948661</span><span class="s0">,</span><span class="s5">1.5378731634</span><span class="s0">,</span>
            <span class="s1">-</span><span class="s5">10.44592783</span><span class="s1">]</span>
    
    <span class="s1">sresids = [</span><span class="s5">1.0979293816</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.144242351</span><span class="s0">, </span><span class="s5">1.5591155202</span><span class="s0">, </span><span class="s5">3.040879735</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">0.775498914</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.06023995</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.610946684</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.172360612</span><span class="s0">,</span>
            <span class="s1">-</span><span class="s5">0.747683723</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.107254214</span><span class="s0">, </span><span class="s5">0.3359181307</span><span class="s0">, </span><span class="s5">0.1328317233</span><span class="s0">,</span>
            <span class="s1">-</span><span class="s5">1.324529688</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.629029563</span><span class="s0">, </span><span class="s5">0.9610305856</span><span class="s0">, </span><span class="s5">0.3747203984</span><span class="s0">,</span>
            <span class="s1">-</span><span class="s5">0.160813769</span><span class="s0">, </span><span class="s5">0.1838758324</span><span class="s0">, </span><span class="s5">0.3869622398</span><span class="s0">, </span><span class="s5">0.6744897502</span><span class="s0">,</span>
            <span class="s1">-</span><span class="s5">4.581438458</span><span class="s1">]</span>

    <span class="s1">weights = [</span><span class="s5">0.8916509101</span><span class="s0">, </span><span class="s5">0.8826581922</span><span class="s0">, </span><span class="s5">0.7888664106</span><span class="s0">, </span><span class="s5">0.3367252734</span><span class="s0">, </span>
            <span class="s5">0.9450252405</span><span class="s0">, </span><span class="s5">0.8987321912</span><span class="s0">, </span><span class="s5">0.9656622</span><span class="s0">, </span><span class="s5">0.9972406688</span><span class="s0">,</span>
            <span class="s5">0.948837669</span><span class="s0">, </span><span class="s5">0.9989310017</span><span class="s0">, </span><span class="s5">0.9895434667</span><span class="s0">, </span><span class="s5">0.998360628</span><span class="s0">,</span>
            <span class="s5">0.8447116551</span><span class="s0">, </span><span class="s5">0.9636222149</span><span class="s0">, </span><span class="s5">0.916330067</span><span class="s0">, </span><span class="s5">0.9869982597</span><span class="s0">,</span>
            <span class="s5">0.9975977354</span><span class="s0">, </span><span class="s5">0.9968600162</span><span class="s0">, </span><span class="s5">0.9861384742</span><span class="s0">, </span><span class="s5">0.9582432444</span><span class="s0">, </span><span class="s5">0</span><span class="s1">]</span>

    <span class="s1">conf_int = [(</span><span class="s5">0.7203</span><span class="s0">,</span><span class="s5">1.1360</span><span class="s1">)</span><span class="s0">,</span><span class="s1">(</span><span class="s5">.0819</span><span class="s0">,</span><span class="s5">1.2165</span><span class="s1">)</span><span class="s0">,</span><span class="s1">(-</span><span class="s5">.3532</span><span class="s0">,</span><span class="s5">.1287</span><span class="s1">)</span><span class="s0">,</span>
                <span class="s1">(-</span><span class="s5">60.6305</span><span class="s0">,</span><span class="s1">-</span><span class="s5">23.9555</span><span class="s1">)]</span>

    <span class="s0">def </span><span class="s1">__init__(self):</span>
        <span class="s1">self.params = [</span><span class="s5">0.9282</span><span class="s0">, </span><span class="s5">0.6492</span><span class="s0">, </span><span class="s1">-</span><span class="s5">.1123</span><span class="s0">,</span><span class="s1">-</span><span class="s5">42.2930</span><span class="s1">]</span>
        <span class="s1">self.bse = [</span><span class="s5">.1061</span><span class="s0">, </span><span class="s5">.2894</span><span class="s0">, </span><span class="s5">.1229</span><span class="s0">, </span><span class="s5">9.3561</span><span class="s1">]</span>
        <span class="s1">self.scale = </span><span class="s5">2.2801</span>
        <span class="s1">self.df_model = </span><span class="s5">3.</span>
        <span class="s1">self.df_resid = </span><span class="s5">17.</span>
        <span class="s1">self.bcov_unscaled = []</span>
        <span class="s1">self.h1 = self.h1</span>
        <span class="s1">self.h2 = self.h2</span>
        <span class="s1">self.h3 = self.h3</span>


<span class="s2">### RLM Results with Huber's Proposal 2 ###</span>
<span class="s2">### Obtained from SAS ###</span>

<span class="s0">class </span><span class="s1">HuberHuber(object):</span>
    <span class="s0">def </span><span class="s1">__init__(self):</span>
        <span class="s1">self.h1 = [</span><span class="s5">114.4936</span><span class="s0">, </span><span class="s5">0.232675</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.52734</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.35624</span><span class="s0">, </span><span class="s5">0.232675</span><span class="s0">, </span><span class="s5">0.014714</span><span class="s0">,</span>
                <span class="s1">-</span><span class="s5">0.02954</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00578</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.52734</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.02954</span><span class="s0">, </span><span class="s5">0.10958</span><span class="s0">, </span><span class="s5">8.476E-6</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">1.35624</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00578</span><span class="s0">, </span><span class="s5">8.476E-6</span><span class="s0">, </span><span class="s5">0.019764</span><span class="s1">]</span>
        <span class="s1">self.h1 = _shift_intercept(self.h1)</span>
        <span class="s1">self.h2 = [</span><span class="s5">103.2876</span><span class="s0">, </span><span class="s5">0.152602</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.33476</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.22084</span><span class="s0">, </span><span class="s5">0.152602</span><span class="s0">, </span><span class="s5">0.016904</span><span class="s0">,</span>
                <span class="s1">-</span><span class="s5">0.03766</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00434</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.33476</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.03766</span><span class="s0">, </span><span class="s5">0.132043</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00214</span><span class="s0">,</span>
                <span class="s1">-</span><span class="s5">1.22084</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00434</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00214</span><span class="s0">, </span><span class="s5">0.017739</span><span class="s1">]</span>
        <span class="s1">self.h2 = _shift_intercept(self.h2)</span>
        <span class="s1">self.h3 = [ </span><span class="s5">91.7544</span><span class="s0">, </span><span class="s5">0.064027</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.11379</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.08249</span><span class="s0">, </span><span class="s5">0.064027</span><span class="s0">, </span><span class="s5">0.019509</span><span class="s0">,</span>
                <span class="s1">-</span><span class="s5">0.04702</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00278</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.11379</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.04702</span><span class="s0">, </span><span class="s5">0.157872</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00462</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">1.08249</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00278</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00462</span><span class="s0">, </span><span class="s5">0.015677</span><span class="s1">]</span>
        <span class="s1">self.h3 = _shift_intercept(self.h3)</span>
        <span class="s1">self.resid = [</span><span class="s5">2.909155172</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.225912162</span><span class="s0">, </span><span class="s5">4.134132661</span><span class="s0">, </span><span class="s5">6.163172632</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">1.741815737</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.789321552</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.02642336</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.02642336</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">2.593402734</span><span class="s0">, </span><span class="s5">0.698655</span><span class="s0">, </span><span class="s5">1.914261011</span><span class="s0">, </span><span class="s5">1.826699492</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.031210331</span><span class="s0">,</span>
                <span class="s1">-</span><span class="s5">0.592975466</span><span class="s0">, </span><span class="s5">2.306098648</span><span class="s0">, </span><span class="s5">0.900896645</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.037551854</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">0.092080512</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.004518993</span><span class="s0">, </span><span class="s5">1.471737448</span><span class="s0">, </span><span class="s1">-</span><span class="s5">8.498372406</span><span class="s1">]</span>
        <span class="s1">self.sresids = [</span><span class="s5">0.883018497</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.675633129</span><span class="s0">, </span><span class="s5">1.25483702</span><span class="s0">, </span><span class="s5">1.870713355</span><span class="s0">,</span>
                <span class="s1">-</span><span class="s5">0.528694904</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.84664529</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.615082113</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.311551209</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">0.787177874</span><span class="s0">, </span><span class="s5">0.212063383</span><span class="s0">, </span><span class="s5">0.581037374</span><span class="s0">, </span><span class="s5">0.554459746</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">0.616535106</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.179986379</span><span class="s0">, </span><span class="s5">0.699972205</span><span class="s0">, </span><span class="s5">0.273449972</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">0.314929051</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.027949281</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.001371654</span><span class="s0">, </span><span class="s5">0.446717797</span><span class="s0">,</span>
                <span class="s1">-</span><span class="s5">2.579518651</span><span class="s1">]</span>
        <span class="s1">self.weights = [</span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">0.718977066</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">,</span>
                <span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">0.52141511</span><span class="s1">] </span>
        <span class="s1">self.conf_int = [(</span><span class="s5">0.5612</span><span class="s0">,</span><span class="s5">1.0367</span><span class="s1">)</span><span class="s0">,</span><span class="s1">(</span><span class="s5">.3987</span><span class="s0">,</span><span class="s5">1.6963</span><span class="s1">)</span><span class="s0">,</span>
                <span class="s1">(-</span><span class="s5">.4106</span><span class="s0">,</span><span class="s5">.1405</span><span class="s1">)</span><span class="s0">,</span><span class="s1">(-</span><span class="s5">62.0611</span><span class="s0">,</span><span class="s1">-</span><span class="s5">20.1172</span><span class="s1">)]</span>
        <span class="s1">self.params = (</span><span class="s5">.7990</span><span class="s0">,</span><span class="s5">1.0475</span><span class="s0">,</span><span class="s1">-</span><span class="s5">0.1351</span><span class="s0">,</span><span class="s1">-</span><span class="s5">41.0892</span><span class="s1">)</span>
        <span class="s1">self.bse = (</span><span class="s5">.1213</span><span class="s0">,</span><span class="s5">.3310</span><span class="s0">,</span><span class="s5">.1406</span><span class="s0">,</span><span class="s5">10.7002</span><span class="s1">)</span>
        <span class="s1">self.scale = </span><span class="s5">3.2946</span>
        <span class="s1">self.df_model = </span><span class="s5">3</span>
        <span class="s1">self.df_resid = </span><span class="s5">17</span>
        

<span class="s0">class </span><span class="s1">HampelHuber(object):</span>
    <span class="s0">def </span><span class="s1">__init__(self):</span>
        <span class="s1">self.h1 = [</span><span class="s5">147.4727</span><span class="s0">, </span><span class="s5">0.299695</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.67924</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.7469</span><span class="s0">, </span><span class="s5">0.299695</span><span class="s0">, </span><span class="s5">0.018952</span><span class="s0">,</span>
                <span class="s1">-</span><span class="s5">0.03805</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00744</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.67924</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.03805</span><span class="s0">, </span><span class="s5">0.141144</span><span class="s0">, </span><span class="s5">0.000011</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">1.7469</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00744</span><span class="s0">, </span><span class="s5">0.000011</span><span class="s0">, </span><span class="s5">0.025456</span><span class="s1">]</span>
        <span class="s1">self.h1 = _shift_intercept(self.h1)</span>
        <span class="s1">self.h2 = [</span><span class="s5">141.148</span><span class="s0">, </span><span class="s5">0.190007</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.38493</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.67206</span><span class="s0">, </span><span class="s5">0.190007</span><span class="s0">, </span><span class="s5">0.02213</span><span class="s0">,</span>
                <span class="s1">-</span><span class="s5">0.04762</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00592</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.38493</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.04762</span><span class="s0">, </span><span class="s5">0.165518</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00303</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">1.67206</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00592</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00303</span><span class="s0">, </span><span class="s5">0.024301</span><span class="s1">]</span>
        <span class="s1">self.h2 = _shift_intercept(self.h2)</span>
        <span class="s1">self.h3 = [</span><span class="s5">134.5444</span><span class="s0">, </span><span class="s5">0.05645</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.02552</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.59394</span><span class="s0">, </span><span class="s5">0.05645</span><span class="s0">, </span><span class="s5">0.026232</span><span class="s0">,</span>
                <span class="s1">-</span><span class="s5">0.05982</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00409</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.02552</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.05982</span><span class="s0">, </span><span class="s5">0.196946</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.0068</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">1.59394</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00409</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.0068</span><span class="s0">, </span><span class="s5">0.023083</span><span class="s1">]</span>
        <span class="s1">self.h3 = _shift_intercept(self.h3)</span>
        <span class="s1">self.resid = [</span><span class="s5">3.125725599</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.022218392</span><span class="s0">, </span><span class="s5">4.434082972</span><span class="s0">, </span><span class="s5">5.753880172</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">1.744479058</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.995299443</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.358455878</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.358455878</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">3.068281354</span><span class="s0">, </span><span class="s5">1.150212629</span><span class="s0">, </span><span class="s5">2.481708553</span><span class="s0">, </span><span class="s5">2.584584946</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">1.553899388</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.177335865</span><span class="s0">, </span><span class="s5">2.335744732</span><span class="s0">, </span><span class="s5">0.891912757</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">1.43012351</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.394515569</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.497391962</span><span class="s0">, </span><span class="s5">1.407968887</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">7.505098501</span><span class="s1">]</span>
        <span class="s1">self.sresids = [</span><span class="s5">0.952186413</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.616026205</span><span class="s0">, </span><span class="s5">1.350749906</span><span class="s0">, </span><span class="s5">1.752798302</span><span class="s0">,</span>
                <span class="s1">-</span><span class="s5">0.531418771</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.912454834</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.718453867</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.413824947</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">0.934687235</span><span class="s0">, </span><span class="s5">0.350388031</span><span class="s0">, </span><span class="s5">0.756000196</span><span class="s0">, </span><span class="s5">0.787339321</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">0.473362692</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.054021633</span><span class="s0">, </span><span class="s5">0.711535395</span><span class="s0">, </span><span class="s5">0.27170242</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">0.43565698</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.120180852</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.151519976</span><span class="s0">, </span><span class="s5">0.428908041</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">2.28627005</span><span class="s1">]</span>
        <span class="s1">self.weights = [</span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">,</span>
                <span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">1</span><span class="s0">, </span><span class="s5">0.874787298</span><span class="s1">]</span>
        <span class="s1">self.conf_int = [(</span><span class="s5">0.4619</span><span class="s0">,</span><span class="s5">1.0016</span><span class="s1">)</span><span class="s0">,</span><span class="s1">(</span><span class="s5">.5145</span><span class="s0">,</span><span class="s5">1.9872</span><span class="s1">)</span><span class="s0">,</span>
                <span class="s1">(-</span><span class="s5">.4607</span><span class="s0">,</span><span class="s5">.1648</span><span class="s1">)</span><span class="s0">,</span><span class="s1">(-</span><span class="s5">64.0727</span><span class="s0">,</span><span class="s1">-</span><span class="s5">16.4697</span><span class="s1">)]</span>
        <span class="s1">self.params = (</span><span class="s5">.7318</span><span class="s0">,</span><span class="s5">1.2508</span><span class="s0">,</span><span class="s1">-</span><span class="s5">0.1479</span><span class="s0">,</span><span class="s1">-</span><span class="s5">40.2712</span><span class="s1">)</span>
        <span class="s1">self.bse = (</span><span class="s5">.1377</span><span class="s0">, </span><span class="s5">.3757</span><span class="s0">, </span><span class="s5">.1596</span><span class="s0">, </span><span class="s5">12.1438</span><span class="s1">)</span>
        <span class="s1">self.scale = </span><span class="s5">3.2827</span>
        <span class="s1">self.df_model = </span><span class="s5">3</span>
        <span class="s1">self.df_resid = </span><span class="s5">17</span>

<span class="s0">class </span><span class="s1">BisquareHuber(object):</span>
    <span class="s0">def </span><span class="s1">__init__(self):</span>
        <span class="s1">self.h1 = [</span><span class="s5">129.9556</span><span class="s0">, </span><span class="s5">0.264097</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.59855</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.5394</span><span class="s0">, </span><span class="s5">0.264097</span><span class="s0">, </span>
                <span class="s5">0.016701</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.03353</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00656</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.59855</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.03353</span><span class="s0">, </span>
                <span class="s5">0.124379</span><span class="s0">, </span><span class="s5">9.621E-6</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.5394</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00656</span><span class="s0">, </span><span class="s5">9.621E-6</span><span class="s0">, </span><span class="s5">0.022433</span><span class="s1">]</span>
        <span class="s1">self.h1 = _shift_intercept(self.h1)</span>
        <span class="s1">self.h2 = [</span><span class="s5">109.7685</span><span class="s0">, </span><span class="s5">0.103038</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.25926</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.28355</span><span class="s0">, </span><span class="s5">0.103038</span><span class="s0">, </span><span class="s5">0.0214</span><span class="s0">,</span>
                <span class="s1">-</span><span class="s5">0.04688</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00453</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.25926</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.04688</span><span class="s0">, </span><span class="s5">0.158535</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00327</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">1.28355</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00453</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00327</span><span class="s0">, </span><span class="s5">0.018892</span><span class="s1">]</span>
        <span class="s1">self.h2 = _shift_intercept(self.h2)</span>
        <span class="s1">self.h3 = [</span><span class="s5">91.80527</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.09171</span><span class="s0">, </span><span class="s5">0.171716</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.05244</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.09171</span><span class="s0">, </span>
                <span class="s5">0.027999</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.06493</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00223</span><span class="s0">, </span><span class="s5">0.171716</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.06493</span><span class="s0">, </span><span class="s5">0.203254</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">0.0071</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.05244</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00223</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.0071</span><span class="s0">, </span><span class="s5">0.015584</span><span class="s1">]</span>
        <span class="s1">self.h3 = _shift_intercept(self.h3)</span>
        <span class="s1">self.resid = [</span><span class="s5">3.034895447</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.09863887</span><span class="s0">, </span><span class="s5">4.229870063</span><span class="s0">, </span><span class="s5">6.18871385</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">1.715906134</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.763596142</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.010080245</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.010080245</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">2.590747917</span><span class="s0">, </span><span class="s5">0.712961901</span><span class="s0">, </span><span class="s5">1.914770759</span><span class="s0">, </span><span class="s5">1.82892645</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.019969464</span><span class="s0">,</span>
            <span class="s1">-</span><span class="s5">0.598781979</span><span class="s0">, </span><span class="s5">2.260467209</span><span class="s0">, </span><span class="s5">0.859864256</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.057306197</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.122565974</span><span class="s0">,</span>
            <span class="s1">-</span><span class="s5">0.036721665</span><span class="s0">, </span><span class="s5">1.471074632</span><span class="s0">, </span><span class="s1">-</span><span class="s5">8.432085298</span><span class="s1">]</span>
        <span class="s1">self.sresids = [</span><span class="s5">0.918227061</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.634956635</span><span class="s0">, </span><span class="s5">1.279774287</span><span class="s0">, </span><span class="s5">1.872435025</span><span class="s0">,</span>
            <span class="s1">-</span><span class="s5">0.519158394</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.836143718</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.608162656</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.305606249</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.78384738</span><span class="s0">,                     </span><span class="s5">0.215711191</span><span class="s0">, </span><span class="s5">0.579326161</span><span class="s0">, </span><span class="s5">0.553353415</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.611154703</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.181165324</span><span class="s0">,</span>
            <span class="s5">0.683918836</span><span class="s0">, </span><span class="s5">0.26015744</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.319894764</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.037083121</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.011110375</span><span class="s0">,</span>
            <span class="s5">0.445083055</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.551181429</span><span class="s1">]</span>
        <span class="s1">self.weights = [</span><span class="s5">0.924649089</span><span class="s0">, </span><span class="s5">0.963600796</span><span class="s0">, </span><span class="s5">0.856330585</span><span class="s0">, </span><span class="s5">0.706048833</span><span class="s0">,</span>
            <span class="s5">0.975591792</span><span class="s0">, </span><span class="s5">0.937309703</span><span class="s0">, </span><span class="s5">0.966582366</span><span class="s0">, </span><span class="s5">0.991507994</span><span class="s0">, </span><span class="s5">0.944798311</span><span class="s0">, </span>
            <span class="s5">0.995764589</span><span class="s0">, </span><span class="s5">0.969652425</span><span class="s0">, </span><span class="s5">0.972293856</span><span class="s0">, </span><span class="s5">0.966255569</span><span class="s0">, </span><span class="s5">0.997011618</span><span class="s0">,</span>
            <span class="s5">0.957833493</span><span class="s0">, </span><span class="s5">0.993842376</span><span class="s0">, </span><span class="s5">0.990697247</span><span class="s0">, </span><span class="s5">0.9998747</span><span class="s0">, </span><span class="s5">0.999988752</span><span class="s0">,</span>
            <span class="s5">0.982030803</span><span class="s0">, </span><span class="s5">0.494874977</span><span class="s1">]</span>
        <span class="s1">self.conf_int = [(</span><span class="s5">0.5399</span><span class="s0">,</span><span class="s5">1.0465</span><span class="s1">)</span><span class="s0">,</span><span class="s1">(</span><span class="s5">.3565</span><span class="s0">,</span><span class="s5">1.7389</span><span class="s1">)</span><span class="s0">,</span>
                <span class="s1">(-</span><span class="s5">.4271</span><span class="s0">,</span><span class="s5">.1600</span><span class="s1">)</span><span class="s0">,</span><span class="s1">(-</span><span class="s5">63.2381</span><span class="s0">,</span><span class="s1">-</span><span class="s5">18.5517</span><span class="s1">)]</span>
        <span class="s1">self.params = (</span><span class="s5">.7932</span><span class="s0">, </span><span class="s5">1.0477</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.1335</span><span class="s0">, </span><span class="s1">-</span><span class="s5">40.8949</span><span class="s1">)</span>
        <span class="s1">self.bse = (</span><span class="s5">.1292</span><span class="s0">, </span><span class="s5">.3527</span><span class="s0">, </span><span class="s5">.1498</span><span class="s0">, </span><span class="s5">11.3998</span><span class="s1">)</span>
        <span class="s1">self.scale = </span><span class="s5">3.3052</span>
        <span class="s1">self.df_model = </span><span class="s5">3</span>
        <span class="s1">self.df_resid = </span><span class="s5">17</span>


<span class="s0">class </span><span class="s1">AndrewsHuber(object):</span>
    <span class="s0">def </span><span class="s1">__init__(self):</span>
        <span class="s1">self.h1 = [</span><span class="s5">129.9124</span><span class="s0">, </span><span class="s5">0.264009</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.59836</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.53888</span><span class="s0">, </span><span class="s5">0.264009</span><span class="s0">, </span>
                <span class="s5">0.016696</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.03352</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00656</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.59836</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.03352</span><span class="s0">, </span><span class="s5">0.124337</span><span class="s0">, </span>
                <span class="s5">9.618E-6</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.53888</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00656</span><span class="s0">, </span><span class="s5">9.618E-6</span><span class="s0">, </span><span class="s5">0.022425</span><span class="s1">]</span>
        <span class="s1">self.h1 = _shift_intercept(self.h1)</span>
        <span class="s1">self.h2 = [</span><span class="s5">109.7595</span><span class="s0">, </span><span class="s5">0.105022</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.26535</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.28332</span><span class="s0">, </span><span class="s5">.105022</span><span class="s0">, </span><span class="s5">0.021321</span><span class="s0">,</span>
                <span class="s1">-</span><span class="s5">0.04664</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00456</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.26535</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.04664</span><span class="s0">, </span><span class="s5">0.157885</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00321</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">1.28332</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00456</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00321</span><span class="s0">, </span><span class="s5">0.018895</span><span class="s1">]</span>
        <span class="s1">self.h2 = _shift_intercept(self.h2)</span>
        <span class="s1">self.h3 = [</span><span class="s5">91.82518</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.08649</span><span class="s0">, </span><span class="s5">0.155965</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.05238</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.08649</span><span class="s0">, </span><span class="s5">0.027785</span><span class="s0">,</span>
                <span class="s1">-</span><span class="s5">0.06427</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.0023</span><span class="s0">, </span><span class="s5">0.155965</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.06427</span><span class="s0">, </span><span class="s5">0.201544</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00693</span><span class="s0">,</span>
                <span class="s1">-</span><span class="s5">1.05238</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.0023</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.00693</span><span class="s0">, </span><span class="s5">0.015596</span><span class="s1">] </span>
        <span class="s1">self.h3 = _shift_intercept(self.h3)</span>
        <span class="s1">self.resid = [</span><span class="s5">3.040515104</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.093093543</span><span class="s0">, </span><span class="s5">4.235081748</span><span class="s0">, </span><span class="s5">6.188729166</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">1.714119676</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.762695255</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.009618953</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.009618953</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">2.591649784</span><span class="s0">, </span><span class="s5">0.715967584</span><span class="s0">, </span><span class="s5">1.918445405</span><span class="s0">, </span><span class="s5">1.833412337</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">2.016815123</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.595695587</span><span class="s0">, </span><span class="s5">2.260536347</span><span class="s0">, </span><span class="s5">0.859710406</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">1.059386228</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.1241257</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.039092633</span><span class="s0">, </span><span class="s5">1.471556455</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">8.424624872</span><span class="s1">]</span>
        <span class="s1">self.sresids = [</span><span class="s5">0.919639919</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.633081011</span><span class="s0">, </span><span class="s5">1.280950793</span><span class="s0">, </span><span class="s5">1.871854667</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">0.518455862</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.835610004</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.607833129</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.305371248</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">0.783875269</span><span class="s0">, </span><span class="s5">0.216552902</span><span class="s0">, </span><span class="s5">0.580256606</span><span class="s0">, </span><span class="s5">0.554537345</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">0.610009696</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.180175208</span><span class="s0">, </span><span class="s5">0.683726076</span><span class="s0">, </span><span class="s5">0.260029627</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">0.320423952</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.037543293</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.011824031</span><span class="s0">, </span><span class="s5">0.445089734</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">2.548127888</span><span class="s1">]</span>
        <span class="s1">self.weights = [</span><span class="s5">0.923215335</span><span class="s0">, </span><span class="s5">0.963157359</span><span class="s0">, </span><span class="s5">0.854300342</span><span class="s0">, </span><span class="s5">0.704674258</span><span class="s0">,</span>
                <span class="s5">0.975199805</span><span class="s0">, </span><span class="s5">0.936344742</span><span class="s0">, </span><span class="s5">0.9660077</span><span class="s0">, </span><span class="s5">0.991354016</span><span class="s0">, </span><span class="s5">0.943851708</span><span class="s0">,</span>
                <span class="s5">0.995646409</span><span class="s0">, </span><span class="s5">0.968993767</span><span class="s0">, </span><span class="s5">0.971658421</span><span class="s0">, </span><span class="s5">0.965766352</span><span class="s0">, </span><span class="s5">0.99698502</span><span class="s0">,</span>
                <span class="s5">0.957106815</span><span class="s0">, </span><span class="s5">0.993726436</span><span class="s0">, </span><span class="s5">0.990483134</span><span class="s0">, </span><span class="s5">0.999868981</span><span class="s0">, </span><span class="s5">0.999987004</span><span class="s0">,</span>
                <span class="s5">0.981686004</span><span class="s0">, </span><span class="s5">0.496752113</span><span class="s1">]</span>
        <span class="s1">self.conf_int = [(</span><span class="s5">0.5395</span><span class="s0">,</span><span class="s5">1.0460</span><span class="s1">)</span><span class="s0">,</span><span class="s1">(</span><span class="s5">.3575</span><span class="s0">,</span><span class="s5">1.7397</span><span class="s1">)</span><span class="s0">,</span>
                <span class="s1">(-</span><span class="s5">.4271</span><span class="s0">,</span><span class="s5">.1599</span><span class="s1">)</span><span class="s0">,</span><span class="s1">(-</span><span class="s5">63.2213</span><span class="s0">,</span><span class="s1">-</span><span class="s5">18.5423</span><span class="s1">)]</span>
        <span class="s1">self.params = (</span><span class="s5">.7928</span><span class="s0">, </span><span class="s5">1.0486</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.1336</span><span class="s0">, </span><span class="s1">-</span><span class="s5">40.8818</span><span class="s1">)</span>
        <span class="s1">self.bse = (</span><span class="s5">.1292</span><span class="s0">, </span><span class="s5">.3526</span><span class="s0">, </span><span class="s5">.1498</span><span class="s0">, </span><span class="s5">11.3979</span><span class="s1">)</span>
        <span class="s1">self.scale = </span><span class="s5">3.3062</span>
        <span class="s1">self.df_model = </span><span class="s5">3</span>
        <span class="s1">self.df_resid = </span><span class="s5">17</span>

<span class="s2">#### Discrete Model Tests ####</span>
<span class="s2"># Note that there is a slight refactor of the classes, so that one dataset </span>
<span class="s2"># might be used for more than one model</span>

<span class="s0">class </span><span class="s1">Anes():</span>
    <span class="s0">def </span><span class="s1">__init__(self):</span>
        <span class="s3">&quot;&quot;&quot; 
        Results are from Stata 11 (checked vs R nnet package). 
        &quot;&quot;&quot;</span>
        <span class="s1">self.nobs = </span><span class="s5">944</span>

    <span class="s0">def </span><span class="s1">mnlogit_basezero(self):</span>
        <span class="s1">params = [-</span><span class="s5">.01153598</span><span class="s0">, </span><span class="s5">.29771435</span><span class="s0">, </span><span class="s1">-</span><span class="s5">.024945</span><span class="s0">, </span><span class="s5">.08249144</span><span class="s0">, </span><span class="s5">.00519655</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">.37340167</span><span class="s0">, </span><span class="s1">-</span><span class="s5">.08875065</span><span class="s0">, </span><span class="s5">.39166864</span><span class="s0">, </span><span class="s1">-</span><span class="s5">.02289784</span><span class="s0">, </span><span class="s5">.18104276</span><span class="s0">, </span>
                <span class="s5">.04787398</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.2509132</span><span class="s0">, </span><span class="s1">-</span><span class="s5">.1059667</span><span class="s0">, </span><span class="s5">.57345051</span><span class="s0">, </span><span class="s1">-</span><span class="s5">.01485121</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">.00715242</span><span class="s0">, </span><span class="s5">.05757516</span><span class="s0">, </span><span class="s1">-</span><span class="s5">3.6655835</span><span class="s0">, </span><span class="s1">-</span><span class="s5">.0915567</span><span class="s0">, </span><span class="s5">1.2787718</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">.00868135</span><span class="s0">, </span><span class="s5">.19982796</span><span class="s0">, </span><span class="s5">.08449838</span><span class="s0">, </span><span class="s1">-</span><span class="s5">7.6138431</span><span class="s0">, </span><span class="s1">-</span><span class="s5">.0932846</span><span class="s0">, </span>
                <span class="s5">1.3469616</span><span class="s0">, </span><span class="s1">-</span><span class="s5">.01790407</span><span class="s0">, </span><span class="s5">.21693885</span><span class="s0">, </span><span class="s5">.08095841</span><span class="s0">, </span><span class="s1">-</span><span class="s5">7.0604782</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">.14088069</span><span class="s0">, </span><span class="s5">2.0700801</span><span class="s0">, </span><span class="s1">-</span><span class="s5">.00943265</span><span class="s0">, </span><span class="s5">.3219257</span><span class="s0">, </span><span class="s5">.10889408</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">12.105751</span><span class="s1">]</span>
        <span class="s1">self.params = np.reshape(params</span><span class="s0">, </span><span class="s1">(</span><span class="s5">6</span><span class="s0">,</span><span class="s1">-</span><span class="s5">1</span><span class="s1">))</span>
        <span class="s1">bse = [</span><span class="s5">.0342823657</span><span class="s0">, </span><span class="s5">.093626795</span><span class="s0">, </span><span class="s5">.0065248584</span><span class="s0">, </span><span class="s5">.0735865799</span><span class="s0">, </span>
                <span class="s5">.0176336937</span><span class="s0">, </span><span class="s5">.6298376313</span><span class="s0">, </span><span class="s5">.0391615553</span><span class="s0">, </span><span class="s5">.1082386919</span><span class="s0">, </span>
                <span class="s5">.0079144618</span><span class="s0">, </span><span class="s5">.0852893563</span><span class="s0">, </span><span class="s5">.0222809297</span><span class="s0">, </span><span class="s5">.7631899491</span><span class="s0">, </span>
                <span class="s5">.0570382292</span><span class="s0">, </span><span class="s5">.1585481337</span><span class="s0">, </span><span class="s5">.0113313133</span><span class="s0">, </span><span class="s5">.1262913234</span><span class="s0">, </span>
                <span class="s5">.0336142088</span><span class="s0">, </span><span class="s5">1.156541492</span><span class="s0">, </span><span class="s5">.0437902764</span><span class="s0">, </span><span class="s5">.1288965854</span><span class="s0">, </span>
                <span class="s5">.0084187486</span><span class="s0">, </span><span class="s5">.0941250559</span><span class="s0">, </span><span class="s5">.0261963632</span><span class="s0">, </span><span class="s5">.9575809602</span><span class="s0">, </span>
                <span class="s5">.0393516553</span><span class="s0">, </span><span class="s5">.1171860107</span><span class="s0">, </span><span class="s5">.0076110152</span><span class="s0">, </span><span class="s5">.0850070091</span><span class="s0">, </span>
                <span class="s5">.0229760791</span><span class="s0">, </span><span class="s5">.8443638283</span><span class="s0">, </span><span class="s5">.042138047</span><span class="s0">, </span><span class="s5">.1434089089</span><span class="s0">, </span>
                <span class="s5">.0081338625</span><span class="s0">, </span><span class="s5">.0910979921</span><span class="s0">, </span><span class="s5">.025300888</span><span class="s0">, </span><span class="s5">1.059954821</span><span class="s1">]</span>
        <span class="s1">self.bse = np.reshape(bse</span><span class="s0">, </span><span class="s1">(</span><span class="s5">6</span><span class="s0">,</span><span class="s1">-</span><span class="s5">1</span><span class="s1">))</span>
        <span class="s1">self.cov_params = </span><span class="s0">None</span>
        <span class="s1">self.llf = -</span><span class="s5">1461.922747312</span>
        <span class="s1">self.llnull = -</span><span class="s5">1750.34670999</span>
        <span class="s1">self.llr = </span><span class="s5">576.8479253554</span>
        <span class="s1">self.llr_pvalue = </span><span class="s5">1.8223179e-102</span>
        <span class="s1">self.prsquared = </span><span class="s5">.1647810465387</span>
        <span class="s1">self.df_model = </span><span class="s5">30</span>
        <span class="s1">self.df_resid = </span><span class="s5">944 </span><span class="s1">- </span><span class="s5">36</span>
        <span class="s1">self.J = </span><span class="s5">7</span>
        <span class="s1">self.K = </span><span class="s5">6</span>
        <span class="s1">self.aic = </span><span class="s5">2995.84549462</span>
        <span class="s1">self.bic = </span><span class="s5">3170.45003661</span>
        <span class="s1">z =  [-</span><span class="s5">.3364988051</span><span class="s0">, </span><span class="s5">3.179798597</span><span class="s0">,  </span><span class="s1">-</span><span class="s5">3.823070772</span><span class="s0">, </span><span class="s5">1.121012042</span><span class="s0">,</span>
            <span class="s5">.2946945327</span><span class="s0">, </span><span class="s1">-</span><span class="s5">.5928538661</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.266269864</span><span class="s0">, </span><span class="s5">3.618564069</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">2.893164162</span><span class="s0">, </span><span class="s5">2.122688754</span><span class="s0">, </span><span class="s5">2.148652536</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.949348555</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">1.857818873</span><span class="s0">, </span><span class="s5">3.616885888</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.310634214</span><span class="s0">, </span><span class="s1">-</span><span class="s5">.0566342868</span><span class="s0">, </span>
            <span class="s5">1.712822091</span><span class="s0">, </span><span class="s1">-</span><span class="s5">3.169435381</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.090799808</span><span class="s0">, </span><span class="s5">9.920912816</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">1.031191864</span><span class="s0">, </span><span class="s5">2.123004903</span><span class="s0">, </span><span class="s5">3.225576554</span><span class="s0">, </span><span class="s1">-</span><span class="s5">7.951122047</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">2.370538224</span><span class="s0">, </span><span class="s5">11.49421878</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.352389066</span><span class="s0">, </span><span class="s5">2.552011323</span><span class="s0">, </span>
            <span class="s5">3.523595639</span><span class="s0">, </span><span class="s1">-</span><span class="s5">8.361890935</span><span class="s0">, </span><span class="s1">-</span><span class="s5">3.34331327</span><span class="s0">, </span><span class="s5">14.43480847</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">1.159676452</span><span class="s0">, </span><span class="s5">3.533839715</span><span class="s0">, </span><span class="s5">4.303962885</span><span class="s0">, </span><span class="s1">-</span><span class="s5">11.42100649</span><span class="s1">]</span>
        <span class="s1">self.z = np.reshape(z</span><span class="s0">, </span><span class="s1">(</span><span class="s5">6</span><span class="s0">,</span><span class="s1">-</span><span class="s5">1</span><span class="s1">))</span>
        <span class="s1">pvalues = [</span><span class="s5">0.7364947525</span><span class="s0">, </span><span class="s5">0.0014737744</span><span class="s0">, </span><span class="s5">0.0001317999</span><span class="s0">, </span><span class="s5">0.2622827367</span><span class="s0">, </span>
            <span class="s5">0.7682272401</span><span class="s0">, </span><span class="s5">0.5532789548</span><span class="s0">, </span><span class="s5">0.0234348654</span><span class="s0">, </span><span class="s5">0.0002962422</span><span class="s0">, </span>
            <span class="s5">0.0038138191</span><span class="s0">, </span><span class="s5">0.0337799420</span><span class="s0">, </span><span class="s5">0.0316619538</span><span class="s0">, </span><span class="s5">0.0031844460</span><span class="s0">, </span>
            <span class="s5">0.0631947400</span><span class="s0">, </span><span class="s5">0.0002981687</span><span class="s0">, </span><span class="s5">0.1899813744</span><span class="s0">, </span><span class="s5">0.9548365214</span><span class="s0">, </span>
            <span class="s5">0.0867452747</span><span class="s0">, </span><span class="s5">0.0015273542</span><span class="s0">, </span><span class="s5">0.0365460134</span><span class="s0">, </span><span class="s5">3.37654e-23</span><span class="s0">, </span>
            <span class="s5">0.3024508550</span><span class="s0">, </span><span class="s5">0.0337534410</span><span class="s0">, </span><span class="s5">0.0012571921</span><span class="s0">, </span><span class="s5">1.84830e-15</span><span class="s0">, </span>
            <span class="s5">0.0177622072</span><span class="s0">, </span><span class="s5">1.41051e-30</span><span class="s0">, </span><span class="s5">0.0186532528</span><span class="s0">, </span><span class="s5">0.0107103038</span><span class="s0">, </span>
            <span class="s5">0.0004257334</span><span class="s0">, </span><span class="s5">6.17209e-17</span><span class="s0">, </span><span class="s5">0.0008278439</span><span class="s0">, </span><span class="s5">3.12513e-47</span><span class="s0">, </span>
            <span class="s5">0.2461805610</span><span class="s0">, </span><span class="s5">0.0004095694</span><span class="s0">, </span><span class="s5">0.0000167770</span><span class="s0">, </span><span class="s5">3.28408e-30</span><span class="s1">]</span>
        <span class="s1">self.pvalues = np.reshape(pvalues</span><span class="s0">, </span><span class="s1">(</span><span class="s5">6</span><span class="s0">,</span><span class="s1">-</span><span class="s5">1</span><span class="s1">))</span>
        <span class="s1">self.conf_int = [[[-</span><span class="s5">0.0787282</span><span class="s0">, </span><span class="s5">0.0556562</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s5">0.1142092</span><span class="s0">, </span><span class="s5">0.4812195</span><span class="s1">]</span><span class="s0">, </span>
            <span class="s1">[-</span><span class="s5">0.0377335</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.0121565</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s5">0.0617356</span><span class="s0">, </span><span class="s5">0.2267185</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s5">0.0293649</span><span class="s0">, </span>
            <span class="s5">0.0397580</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s5">1.6078610</span><span class="s0">, </span><span class="s5">0.8610574</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">[[-</span><span class="s5">0.1655059</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.0119954</span><span class="s1">]</span><span class="s0">, </span>
            <span class="s1">[</span><span class="s5">0.1795247</span><span class="s0">,	</span><span class="s5">0.6038126</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s5">0.0384099</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.0073858</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s5">0.0138787</span><span class="s0">,	</span>
            <span class="s5">0.3482068</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s5">0.0042042</span><span class="s0">,	</span><span class="s5">0.0915438</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s5">3.7467380</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.7550884</span><span class="s1">]]</span><span class="s0">, </span>
            <span class="s1">[[-</span><span class="s5">0.2177596</span><span class="s0">, </span><span class="s5">0.0058262</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s5">0.2627019</span><span class="s0">,	</span><span class="s5">0.8841991</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s5">0.0370602</span><span class="s0">, </span>
            <span class="s5">0.0073578</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s5">0.2546789</span><span class="s0">, </span><span class="s5">0.2403740</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s5">0.0083075</span><span class="s0">, </span><span class="s5">0.1234578</span><span class="s1">]</span><span class="s0">, </span>
            <span class="s1">[-</span><span class="s5">5.9323630</span><span class="s0">,</span><span class="s1">-</span><span class="s5">1.3988040</span><span class="s1">]]</span><span class="s0">,</span><span class="s1">[[-</span><span class="s5">0.1773841</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.0057293</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s5">1.0261390</span><span class="s0">,	</span>
            <span class="s5">1.5314040</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s5">0.0251818</span><span class="s0">, </span><span class="s5">0.0078191</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s5">0.0153462</span><span class="s0">,	</span><span class="s5">0.3843097</span><span class="s1">]</span><span class="s0">, </span>
            <span class="s1">[</span><span class="s5">0.0331544</span><span class="s0">,	</span><span class="s5">0.1358423</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s5">9.4906670</span><span class="s0">, </span><span class="s1">-</span><span class="s5">5.7370190</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">[[-</span><span class="s5">0.1704124</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">0.0161568</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s5">1.1172810</span><span class="s0">,	</span><span class="s5">1.5766420</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s5">0.0328214</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.0029868</span><span class="s1">]</span><span class="s0">, </span>
            <span class="s1">[</span><span class="s5">0.0503282</span><span class="s0">,	</span><span class="s5">0.3835495</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s5">0.0359261</span><span class="s0">,	</span><span class="s5">0.1259907</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s5">8.7154010</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">5.4055560</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">[[-</span><span class="s5">0.2234697</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.0582916</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s5">1.7890040</span><span class="s0">, </span><span class="s5">2.3511560</span><span class="s1">]</span><span class="s0">, </span>
            <span class="s1">[-</span><span class="s5">0.0253747</span><span class="s0">, </span><span class="s5">0.0065094</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s5">0.1433769</span><span class="s0">, </span><span class="s5">0.5004745</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s5">0.0593053</span><span class="s0">, </span>
            <span class="s5">0.1584829</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s5">14.1832200</span><span class="s0">, </span><span class="s1">-</span><span class="s5">10.0282800</span><span class="s1">]]]</span>

<span class="s0">class </span><span class="s1">Spector():</span>
    <span class="s3">&quot;&quot;&quot; 
    Results are from Stata 11 
    &quot;&quot;&quot;</span>
    <span class="s0">def </span><span class="s1">__init__(self):</span>
        <span class="s1">self.nobs = </span><span class="s5">32</span>

    <span class="s0">def </span><span class="s1">logit(self):</span>
        <span class="s1">self.params = [</span><span class="s5">2.82611297201</span><span class="s0">, </span><span class="s5">.0951576702557</span><span class="s0">, </span><span class="s5">2.37868772835</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">13.0213483201</span><span class="s1">]</span>
        <span class="s1">self.cov_params = [[</span><span class="s5">1.59502033639</span><span class="s0">, </span><span class="s1">-</span><span class="s5">.036920566629</span><span class="s0">, </span><span class="s5">.427615725153</span><span class="s0">,</span>
                <span class="s1">-</span><span class="s5">4.57347950298</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s5">.036920566629</span><span class="s0">, </span><span class="s5">.0200375937069</span><span class="s0">, </span>
                <span class="s5">.0149126464275</span><span class="s0">, </span><span class="s1">-</span><span class="s5">.346255757562</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s5">.427615725153 </span><span class="s0">, </span>
                <span class="s5">.0149126464275</span><span class="s0">, </span><span class="s5">1.13329715236</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.35916128427</span><span class="s1">]</span><span class="s0">, </span>
                <span class="s1">[-</span><span class="s5">4.57347950298</span><span class="s0">, </span><span class="s1">-</span><span class="s5">.346255757562</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.35916128427</span><span class="s0">, </span>
                <span class="s5">24.3179625937</span><span class="s1">]]</span>
        <span class="s1">self.bse = [</span><span class="s5">1.26294114526</span><span class="s0">, </span><span class="s5">.141554207662</span><span class="s0">, </span><span class="s5">1.06456430165</span><span class="s0">, </span><span class="s5">4.93132462871</span><span class="s1">]</span>
        <span class="s1">self.llf = -</span><span class="s5">12.8896334653335</span>
        <span class="s1">self.llnull = -</span><span class="s5">20.5917296966173</span>
        <span class="s1">self.df_model = </span><span class="s5">3</span>
        <span class="s1">self.df_resid = </span><span class="s5">32 </span><span class="s1">- </span><span class="s5">4  </span><span class="s2">#TODO: is this right? not reported in stata</span>
        <span class="s1">self.llr = </span><span class="s5">15.4041924625676</span>
        <span class="s1">self.prsquared = </span><span class="s5">.374038332124624</span>
        <span class="s1">self.llr_pvalue = </span><span class="s5">.00150187761112892</span>
        <span class="s1">self.aic = </span><span class="s5">33.779266930667</span>
        <span class="s1">self.bic = </span><span class="s5">39.642210541866</span>
        <span class="s1">self.z = [</span><span class="s5">2.237723415</span><span class="s0">, </span><span class="s5">0.6722348408</span><span class="s0">, </span><span class="s5">2.234423721</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.640537645</span><span class="s1">]</span>
        <span class="s1">self.conf_int = [[</span><span class="s5">.3507938</span><span class="s0">,</span><span class="s5">5.301432</span><span class="s1">]</span><span class="s0">,</span><span class="s1">[-</span><span class="s5">.1822835</span><span class="s0">,</span><span class="s5">.3725988</span><span class="s1">]</span><span class="s0">,</span><span class="s1">[</span><span class="s5">.29218</span><span class="s0">,</span>
                <span class="s5">4.465195</span><span class="s1">]</span><span class="s0">,</span><span class="s1">[-</span><span class="s5">22.68657</span><span class="s0">,</span><span class="s1">-</span><span class="s5">3.35613</span><span class="s1">]]</span>
        <span class="s1">self.pvalues = [</span><span class="s5">.0252390974</span><span class="s0">, </span><span class="s5">.5014342039</span><span class="s0">, </span><span class="s5">.0254552063</span><span class="s0">, </span><span class="s5">.0082774596</span><span class="s1">]</span>
        <span class="s1">self.margeff_nodummy_dydx = [</span><span class="s5">.36258084688424</span><span class="s0">,</span><span class="s5">.01220841099085</span><span class="s0">,</span>
                <span class="s5">.30517768382304</span><span class="s1">]</span>
        <span class="s1">self.margeff_nodummy_dydxmean = [</span><span class="s5">.53385885781692</span><span class="s0">,</span><span class="s5">.01797548988961</span><span class="s0">,</span>
                <span class="s5">.44933926079386</span><span class="s1">]</span>
        <span class="s1">self.margeff_nodummy_dydxmedian = [</span><span class="s5">.25009492465091</span><span class="s0">,</span><span class="s5">.00842091261329</span><span class="s0">,</span>
                <span class="s5">.2105003352955</span><span class="s1">]</span>

        <span class="s1">self.margeff_nodummy_dydxzero = [</span><span class="s5">6.252993785e-06</span><span class="s0">,</span><span class="s5">2.105437138e-07</span><span class="s0">,</span>
                <span class="s5">5.263030788e-06</span><span class="s1">]</span>
        <span class="s1">self.margeff_nodummy_dyex = [</span><span class="s5">1.1774000792198</span><span class="s0">,</span><span class="s5">.27896245178384</span><span class="s0">,</span>
                <span class="s5">.16960002159996</span><span class="s1">]</span>
        <span class="s1">self.margeff_nodummy_dyexmean = [</span><span class="s5">1.6641381583512</span><span class="s0">,</span><span class="s5">.39433730945339</span><span class="s0">,</span>
                <span class="s5">.19658592659731</span><span class="s1">]</span>
        <span class="s1">self.margeff_nodummy_dyexmedian = [</span><span class="s5">.76654095836557</span><span class="s0">,</span><span class="s5">.18947053379898</span><span class="s0">,</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s1">self.margeff_nodummy_dyexzero = [</span><span class="s5">0</span><span class="s0">,</span><span class="s5">0</span><span class="s0">,</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s1">self.margeff_nodummy_eydx = [</span><span class="s5">1.8546366266779</span><span class="s0">,</span><span class="s5">.06244722072812</span><span class="s0">,</span>
                <span class="s5">1.5610138123033</span><span class="s1">]</span>
        <span class="s1">self.margeff_nodummy_eydxmean = [</span><span class="s5">2.1116143062702</span><span class="s0">,</span><span class="s5">.0710998816585</span><span class="s0">,</span>
                <span class="s5">1.7773072368626</span><span class="s1">]</span>
        <span class="s1">self.margeff_nodummy_eydxmedian = [</span><span class="s5">2.5488082240624</span><span class="s0">,</span><span class="s5">.0858205793373</span><span class="s0">,</span>
                <span class="s5">2.1452853812126</span><span class="s1">]</span>
        <span class="s1">self.margeff_nodummy_eydxzero = [</span><span class="s5">2.8261067189993</span><span class="s0">,</span><span class="s5">.0951574597115</span><span class="s0">,</span>
                <span class="s5">2.3786824653103</span><span class="s1">]</span>
        <span class="s1">self.margeff_nodummy_eyex = [</span><span class="s5">5.4747106798973</span><span class="s0">,</span><span class="s5">1.3173389907576</span><span class="s0">,</span>
                <span class="s5">.44600395466634</span><span class="s1">]</span>
        <span class="s1">self.margeff_nodummy_eyexmean = [</span><span class="s5">6.5822977203268</span><span class="s0">,</span><span class="s5">1.5597536538833</span><span class="s0">,</span>
                <span class="s5">.77757191612739</span><span class="s1">]</span>
        <span class="s1">self.margeff_nodummy_eyexmedian = [</span><span class="s5">7.8120973525952</span><span class="s0">,</span><span class="s5">1.9309630350892</span><span class="s0">,</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s1">self.margeff_nodummy_eyexzero = [</span><span class="s5">0</span><span class="s0">,</span><span class="s5">0</span><span class="s0">,</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s2"># for below GPA = 2.0, psi = 1</span>
        <span class="s1">self.margeff_nodummy_atexog1 = [</span><span class="s5">.1456333017086</span><span class="s0">,</span><span class="s5">.00490359933927</span><span class="s0">,</span>
                <span class="s5">.12257689308426</span><span class="s1">]</span>
        <span class="s2"># for below GPA at mean, tuce = 21, psi = 0</span>
        <span class="s1">self.margeff_nodummy_atexog2 = [</span><span class="s5">.25105129214546</span><span class="s0">,</span><span class="s5">.00845311433473</span><span class="s0">,</span>
                <span class="s5">.2113052923675</span><span class="s1">]</span>
        <span class="s1">self.margeff_dummy_dydx = [</span><span class="s5">.36258084688424</span><span class="s0">,</span><span class="s5">.01220841099085</span><span class="s0">,</span>
                <span class="s5">.35751515254729</span><span class="s1">]</span>
        <span class="s1">self.margeff_dummy_dydxmean = [</span><span class="s5">.53385885781692</span><span class="s0">,</span><span class="s5">.01797548988961</span><span class="s0">,</span>
                <span class="s5">.4564984096959</span><span class="s1">]</span>
<span class="s2">#        self.margeff_dummy_dydxmedian</span>
<span class="s2">#        self.margeff_dummy_dydxzero</span>
        <span class="s1">self.margeff_dummy_eydx = [</span><span class="s5">1.8546366266779</span><span class="s0">,</span><span class="s5">.06244722072812</span><span class="s0">,</span>
                <span class="s5">1.5549034398832</span><span class="s1">]</span>
        <span class="s1">self.margeff_dummy_eydxmean = [</span><span class="s5">2.1116143062702</span><span class="s0">,</span><span class="s5">.0710998816585</span><span class="s0">,</span>
                <span class="s5">1.6631775707188</span><span class="s1">]</span>
<span class="s2">#        self.margeff_dummy_eydxmedian</span>
<span class="s2">#        self.margeff_dummy_eydxzero</span>
<span class="s2"># Factor variables not allowed in below </span>
<span class="s2">#        self.margeff_dummy_dyex</span>
<span class="s2">#        self.margeff_dummy_dyexmean</span>
<span class="s2">#        self.margeff_dummy_dyexmedian</span>
<span class="s2">#        self.margeff_dummy_dyexzero</span>
<span class="s2">#        self.margeff_dummy_eyex</span>
<span class="s2">#        self.margeff_dummy_eyex</span>
<span class="s2">#        self.margeff_dummy_eyex</span>
<span class="s2">#        self.margeff_dummy_eyex</span>
        <span class="s2"># for below GPA = 2.0, psi = 1</span>
        <span class="s1">self.margeff_dummy_atexog1 = [</span><span class="s5">.1456333017086</span><span class="s0">,</span><span class="s5">.00490359933927</span><span class="s0">,</span>
                <span class="s5">.0494715429937</span><span class="s1">]</span>
        <span class="s2"># for below GPA at mean, tuce = 21, psi = 0</span>
        <span class="s1">self.margeff_dummy_atexog2 = [</span><span class="s5">.25105129214546</span><span class="s0">,</span><span class="s5">.00845311433473</span><span class="s0">,</span>
                <span class="s5">.44265645632553</span><span class="s1">]</span>

    <span class="s0">def </span><span class="s1">probit(self):</span>
        <span class="s1">self.params = [</span><span class="s5">1.62581025407</span><span class="s0">, </span><span class="s5">.051728948442</span><span class="s0">, </span><span class="s5">1.42633236818</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">7.45232041607</span><span class="s1">]        </span>
        <span class="s1">self.cov_params =    [[</span><span class="s5">.481472955383</span><span class="s0">, </span><span class="s1">-</span><span class="s5">.01891350017</span><span class="s0">, </span><span class="s5">.105439226234</span><span class="s0">,</span>
            <span class="s1">-</span><span class="s5">1.1696681354</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s5">.01891350017</span><span class="s0">, </span><span class="s5">.00703757594</span><span class="s0">, </span><span class="s5">.002471864882</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">.101172838897</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s5">.105439226234</span><span class="s0">, </span><span class="s5">.002471864882</span><span class="s0">, </span><span class="s5">.354070126802</span><span class="s0">, </span>
            <span class="s1">-</span><span class="s5">.594791776765</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s5">1.1696681354</span><span class="s0">, </span><span class="s1">-</span><span class="s5">.101172838897</span><span class="s0">, </span><span class="s1">-</span><span class="s5">.594791776765</span><span class="s0">, </span>
            <span class="s5">6.46416639958</span><span class="s1">]]</span>
        <span class="s1">self.bse = [</span><span class="s5">.693882522754</span><span class="s0">, </span><span class="s5">.083890261293</span><span class="s0">, </span><span class="s5">.595037920474</span><span class="s0">, </span><span class="s5">2.54247249731</span><span class="s1">]</span>
        <span class="s1">self.llf = -</span><span class="s5">12.8188033249334</span>
        <span class="s1">self.llnull = -</span><span class="s5">20.5917296966173</span>
        <span class="s1">self.df_model = </span><span class="s5">3</span>
        <span class="s1">self.df_resid = </span><span class="s5">32 </span><span class="s1">- </span><span class="s5">4</span>
        <span class="s1">self.llr = </span><span class="s5">15.5458527433678</span>
        <span class="s1">self.prsquared = </span><span class="s5">.377478069409622</span>
        <span class="s1">self.llr_pvalue = </span><span class="s5">.00140489496775855</span>
        <span class="s1">self.aic = </span><span class="s5">33.637606649867</span>
        <span class="s1">self.bic = </span><span class="s5">39.500550261066</span>
        <span class="s1">self.z = [ </span><span class="s5">2.343062695</span><span class="s0">, </span><span class="s5">.6166263836</span><span class="s0">, </span><span class="s5">2.397044489</span><span class="s0">, </span><span class="s1">-</span><span class="s5">2.931131182</span><span class="s1">]</span>
        <span class="s1">self.conf_int = [[</span><span class="s5">.2658255</span><span class="s0">,</span><span class="s5">2.985795</span><span class="s1">]</span><span class="s0">,</span><span class="s1">[-</span><span class="s5">.1126929</span><span class="s0">,</span><span class="s5">.2161508</span><span class="s1">]</span><span class="s0">,</span><span class="s1">[</span><span class="s5">.2600795</span><span class="s0">,</span>
            <span class="s5">2.592585</span><span class="s1">]</span><span class="s0">,</span><span class="s1">[-</span><span class="s5">12.43547</span><span class="s0">,</span><span class="s1">-</span><span class="s5">2.469166</span><span class="s1">]]</span>
        <span class="s1">self.pvalues = [</span><span class="s5">.0191261688</span><span class="s0">, </span><span class="s5">.537481188</span><span class="s0">, </span><span class="s5">.0165279168</span><span class="s0">, </span><span class="s5">.0033773013</span><span class="s1">]</span>

<span class="s0">class </span><span class="s1">RandHIE():</span>
    <span class="s3">&quot;&quot;&quot; 
    Results obtained from Stata 11 
    &quot;&quot;&quot;</span>
    <span class="s0">def </span><span class="s1">__init__(self):</span>
        <span class="s1">self.nobs = </span><span class="s5">20190</span>

    <span class="s0">def </span><span class="s1">poisson(self):</span>
        <span class="s1">self.params =   [-</span><span class="s5">.052535114675</span><span class="s0">, </span><span class="s1">-</span><span class="s5">.247086797633</span><span class="s0">, </span><span class="s5">.035290201794</span><span class="s0">, </span>
                <span class="s1">-</span><span class="s5">.03457750643</span><span class="s0">, </span><span class="s5">.271713973711</span><span class="s0">, </span><span class="s5">.033941474461</span><span class="s0">, </span><span class="s1">-</span><span class="s5">.012635035534</span><span class="s0">, </span>
                <span class="s5">.054056326828</span><span class="s0">, </span><span class="s5">.206115121809</span><span class="s0">, </span><span class="s5">.700352877227</span><span class="s1">]</span>
        <span class="s1">self.cov_params = </span><span class="s0">None</span>
        <span class="s1">self.bse = [</span><span class="s5">.00288398915279</span><span class="s0">, </span><span class="s5">.01061725196728</span><span class="s0">, </span><span class="s5">.00182833684966</span><span class="s0">, </span>
                <span class="s5">.00161284852954</span><span class="s0">, </span><span class="s5">.01223913844387</span><span class="s0">, </span><span class="s5">.00056476496963</span><span class="s0">, </span>
                <span class="s5">.00925061122826</span><span class="s0">, </span><span class="s5">.01530987068312</span><span class="s0">, </span><span class="s5">.02627928267502</span><span class="s0">, </span>
                <span class="s5">.01116266712362</span><span class="s1">]</span>
        <span class="s1">self.llf = -</span><span class="s5">62419.588535018</span>
        <span class="s1">self.llnull = -</span><span class="s5">66647.181687959</span>
        <span class="s1">self.df_model = </span><span class="s5">9</span>
        <span class="s1">self.df_resid = self.nobs - self.df_model - </span><span class="s5">1</span>
        <span class="s1">self.llr = </span><span class="s5">8455.186305881856</span>
        <span class="s1">self.prsquared = </span><span class="s5">.0634324369893758</span>
        <span class="s1">self.llr_pvalue = </span><span class="s5">0</span>
        <span class="s1">self.aic = </span><span class="s5">124859.17707</span>
        <span class="s1">self.bic = </span><span class="s5">124938.306497</span>
        <span class="s1">self.z = [-</span><span class="s5">18.21612769</span><span class="s0">, </span><span class="s1">-</span><span class="s5">23.27219872</span><span class="s0">, </span><span class="s5">19.30180524</span><span class="s0">, </span><span class="s1">-</span><span class="s5">21.43878101</span><span class="s0">,</span>
                <span class="s5">22.20041672</span><span class="s0">, </span><span class="s5">60.09840604</span><span class="s0">, </span><span class="s1">-</span><span class="s5">1.36585953</span><span class="s0">, </span><span class="s5">3.53081538</span><span class="s0">, </span><span class="s5">7.84325525</span><span class="s0">,</span>
                <span class="s5">62.74063980</span><span class="s1">]     </span>
        <span class="s1">self.conf_int = [[ -</span><span class="s5">.0581876</span><span class="s0">, </span><span class="s1">-</span><span class="s5">.0468826</span><span class="s1">]</span><span class="s0">,</span><span class="s1">[-</span><span class="s5">0.2678962</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.2262774</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s5">0.0317067</span><span class="s0">, </span><span class="s5">0.0388737</span><span class="s1">]</span><span class="s0">,</span><span class="s1">[-</span><span class="s5">0.0377386</span><span class="s0">, </span><span class="s1">-</span><span class="s5">0.0314164</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s5">0.2477257</span><span class="s0">, </span><span class="s5">0.2957022</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s5">0.0328346</span><span class="s0">, </span><span class="s5">0.0350484</span><span class="s1">]</span><span class="s0">,</span><span class="s1">[-</span><span class="s5">0.0307659</span><span class="s0">, </span>
                    <span class="s5">0.0054958</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s5">0.0240495</span><span class="s0">, </span><span class="s5">0.0840631</span><span class="s1">]</span><span class="s0">,</span><span class="s1">[</span><span class="s5">0.1546087</span><span class="s0">, </span><span class="s5">0.2576216</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s5">0.6784745</span><span class="s0">, </span><span class="s5">0.7222313</span><span class="s1">]]</span>
        <span class="s1">self.pvalues = [</span><span class="s5">3.84415e-74</span><span class="s0">, </span><span class="s5">8.4800e-120</span><span class="s0">, </span><span class="s5">5.18652e-83</span><span class="s0">, </span><span class="s5">5.8116e-102</span><span class="s0">, </span>
                <span class="s5">3.4028e-109</span><span class="s0">, </span><span class="s5">0</span><span class="s0">, </span><span class="s5">.1719830562</span><span class="s0">, </span><span class="s5">.0004142808</span><span class="s0">, </span><span class="s5">4.39014e-15</span><span class="s0">, </span><span class="s5">0</span><span class="s1">]</span>

</pre>
</body>
</html>